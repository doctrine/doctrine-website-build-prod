<!DOCTYPE html>
<html>
    <head>
        <title>PHP Benchmarking Mythbusters - Doctrine: PHP Open Source Project</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="The Doctrine Project is an open-source PHP project that is home to home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
">

        <meta name="keywords" content="php,mysql,orm,dbal,database,mongodb,odm,annotations,migrations,cache,couchdb">

                    <meta name="robots" content="index, follow">
        
        
            <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.doctrine-project.org/2009/11/18/php-benchmarking-mythbusters.html"
        },
        "headline": "PHP Benchmarking Mythbusters",
        "image": [
            "https://www.doctrine-project.org/images/og.png"
        ],
        "datePublished": "2009-11-18T00:00:00-05:00",
        "dateModified": "2009-11-18T00:00:00-05:00",
        "author": {
            "@type": "Person",
            "name": "romanb"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Doctrine",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.doctrine-project.org/images/og.png"
            }
        },
        "description": "First of, this blog post sucks. I thought I would never write such a
senseless apples and oranges co"
    }
    </script>

        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?44b541"
                        integrity="sha384-8XfhfvnL/kdCCjhHXZQBX33XCU4qOmvFzeW0g80xRQD9j94Oo0FIP2hA+JZimref"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/2009/11/18/php-benchmarking-mythbusters.html" />
        <meta property="og:title" content="PHP Benchmarking Mythbusters - Doctrine: PHP Open Source Project" />
        <meta property="og:description" content="The Doctrine Project is an open-source PHP project that is home to home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
" />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/images/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

        
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/images/doctrine-logo.svg?c1fd47" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/doctrine-website/edit/master/source/blog/2009-11-18-php-benchmarking-mythbusters.md" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <main role="main" class="container-wrapper container">
            <article>
        <header>
            <h2>PHP Benchmarking Mythbusters</h2>
        </header>

        <p class="lead">
            Posted on <date>November 18, 2009</date>
                            by
                                    romanb
                                    </p>

        <div class="row">
            <div class="col">
                <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>
            </div>
        </div>

        <hr />

        <div>
                <p>First of, this blog post sucks. I thought I would never write such a
senseless apples and oranges comparison with artificial and meaningless
benchmarks, but I was just a bit astonished by the results that I would
like to share.</p>
<p>I use object-relational mapping tools in many different languages, from
Java to C# to PHP. One of the many supposedly lightweight alternatives
in PHP to Doctrine is Outlet. After stumbling upon this comment on a
<a href="http://stackoverflow.com/questions/185358/simple-php-orm">stackoverflow.com
post</a>:
<strong>&quot;Gotta second Outlet. Doctrine is comically bloated - it is WAY too
big to be a sensible choice for anything but the lightest of server
loads.&quot;</strong> I thought I take a look at Outlet. This ORM seems to consist
of only 9 classes! It can't get any more lightweight right? I assumed it
would blow Doctrine out of the water performance-wise in all situations.</p>
<p>So I downloaded Outlet 0.7 and created a simple test database with just
1 table. Then I wrote a small script that bootstraps Outlet, inserts 500
objects into the database and reads them out afterwards (Yes, it's
stupid, just like most other artificial benchmarks).</p>
<p>Environment is PHP 5.3.0 with APC.</p>
<pre><code class="language-{.sourceCode">&lt;?php
    echo PHP_EOL . (memory_get_usage() / 1024) . ' KB ' . PHP_EOL;

include 'config.php';

set_include_path(get_include_path() . PATH_SEPARATOR . __DIR__ . '/outlet');

require 'Outlet.php';

ini_set('error_reporting', E_ALL);

class Bug
{
    public $ID;
    public $Title;
    public $Description;
}

$config = array(
  'connection' =&gt; array(
    'dsn'      =&gt; 'mysql:host=localhost;dbname=outletbenchmark',
    'username' =&gt; $mysqlUsername,
    'password' =&gt; $mysqlPassword,
    'dialect' =&gt; 'mysql'
  ),
  'classes' =&gt; array(
    'Bug' =&gt; array(
      'table' =&gt; 'bugs',
      'props' =&gt; array(
        'ID'        =&gt; array('ID', 'int', array('pk' =&gt; true, 'autoIncrement' =&gt; true)),
        'Title'     =&gt; array('Title', 'varchar'),
        'Description' =&gt; array('Description', 'varchar')
      )
    )
  )
);
Outlet::init($config);
$outlet = Outlet::getInstance();
$outlet-&gt;createProxies();

$s = microtime(true);
$outlet-&gt;getConnection()-&gt;beginTransaction();
for ($i = 0; $i &lt; 500; ++$i) {
    $bug = new Bug;
    $bug-&gt;Title = 'This is a test bug';
    $bug-&gt;Description = 'Hey there!';

    $outlet-&gt;save($bug);
}
$outlet-&gt;getConnection()-&gt;commit();

$e = microtime(true);
echo "\nInsert:" . ($e - $s) . "\n";

$outlet-&gt;clearCache();

$s = microtime(true);
$bugs = $outlet-&gt;select('Bug');
$e = microtime(true);

$outlet-&gt;clearCache();

echo "\nQuery:" . ($e - $s) . "\n";

echo "\n" . (memory_get_usage() / 1024) . ' KB ' . PHP_EOL;

**CAUTION** First off, ini\_set('error\_reporting', E\_ALL); was
necessary to silence the following E\_STRICT warnings coming from
Outlet:

::

    Strict Standards: Non-static method OutletMapper::get() should not be called statically,
    assuming $this from incompatible context in /Users/robo/dev/php/outlet/outlet-0.7/classes
    /outlet/Outlet.php on line 184

    Strict Standards: Only variables should be passed by reference in /Users/robo/dev
    /php/outlet/outlet-0.7/classes/outlet/OutletMapper.php on line 546

Does not really look good (and does not speak for Outlet very
well), but anyway.</code></pre>
<p>I did the same for Doctrine 2.0, <em>without setting up a metadata or query
cache</em>.</p>
<pre><code class="language-{.sourceCode">&lt;?php
echo PHP_EOL . (memory_get_usage() / 1024) . ' KB ' . PHP_EOL;

include 'config.php';

require 'doctrine/Doctrine/Common/IsolatedClassLoader.php';

/**
 * @Entity
 * @Table(name="bugs")
 */
class Bug
{
    /** @Id @Column(type="integer") @GeneratedValue(strategy="AUTO") */
    public $ID;
    /** @Column(type="string") */
    public $Title;
    /** @Column(type="string") */
    public $Description;
}

$classLoader = new \Doctrine\Common\IsolatedClassLoader('Doctrine');
$classLoader-&gt;setBasePath(__DIR__ . '/doctrine');
$classLoader-&gt;register();

$config = new \Doctrine\ORM\Configuration;

$config-&gt;setProxyDir(__DIR__ . '/Proxies');
$config-&gt;setProxyNamespace('Proxies');
$connectionOptions = array(
    'driver' =&gt; 'pdo_mysql',
    'user' =&gt; $mysqlUsername,
    'password' =&gt; $mysqlPassword,
    'host' =&gt; 'localhost',
    'dbname' =&gt; 'doctrine2benchmark'
);

$em = \Doctrine\ORM\EntityManager::create($connectionOptions, $config);

$s = microtime(true);
for ($i = 0; $i &lt; 500; ++$i) {
    $bug = new Bug;
    $bug-&gt;Title = 'BBug';
    $bug-&gt;Description = 'Hello there!';

    $em-&gt;persist($bug);
}
$em-&gt;flush();

$e = microtime(true);
echo "\nInsert:" . ($e - $s) . "\n";

$em-&gt;clear();

$s = microtime(true);
$bugs = $em-&gt;getRepository('Bug')-&gt;findAll();
$e = microtime(true);

$em-&gt;clear();

echo "\nQuery:" . ($e - $s) . "\n";

echo "\n" . (memory_get_usage() / 1024) . ' KB ' . PHP_EOL;</code></pre>
<p>Here are my results.</p>
<h1>1st Run</h1>
<p>| Measurement | | Outlet | | Doctrine | | ------------ | |
----------------- | | ------------------- | | Insert Time | |
0.23142600059509 | | 0.11601996421814 | | Query Time | |
0.070523977279663 | | 0.025638818740845 | | Used Memory | | 644.5546875
KB | | 1061.83203125 KB |</p>
<p>No, I did not swap the numbers, I promise. You see that the D2 version
uses about 400KB more memory but the result of the timings are quite
surprising. Being curious I ran both scripts several times which means
the query section has to hydrate 500 objects more for each run.</p>
<h1>2nd Run</h1>
<p><strong>1st refresh (1000 objects)</strong></p>
<p>| Measurement | | Outlet | | Doctrine | | ------------ | |
----------------- | | ------------------- | | Insert Time | |
0.26595592498779 | | 0.11661005020142 | | Query Time | |
0.14437794685364 | | 0.052286863327026 | | Used Memory | | 875.0703125
KB | | 1313.15625 KB |</p>
<h1>3rd Run</h1>
<p><strong>2nd refresh (1500 objects)</strong></p>
<p>| Measurement | | Outlet | | Doctrine | | ------------ | |
----------------- | | ------------------- | | Insert Time | |
0.2314441204071 | | 0.11621117591858 | | Query Time | | 0.21359491348267
| | 0.079329013824463 | | Used Memory | | 1139.5859375 KB | | 1541.59375
KB |</p>
<p>Did you expect these results? After all Doctrine is so bloated, right?
(Doctrine 2 full package \~250 classes) and Outlet is so lightweight
(\~9 classes)?</p>
<p>Bottom line:</p>
<ul>
<li>The number of classes barely means anything. (Its probably a good
criterion if you're short on disk space).</li>
<li>&quot;Lightweight&quot; is a buzzword and meaningless without a reference
point.</li>
<li>Don't judge a library by its size and certainly dont try to draw
conclusions from the size to the performance, or worse to the
scalability. It just doesnt work.</li>
<li><em>Artificial benchmarks suck.</em></li>
<li>To all the folks hunting for everything lightweight and
micro-benchmarking all day long: You're wasting your time (Just like
I did with this stupid benchmark...).</li>
<li>Don't trust artificial benchmarks (Not even this one).</li>
</ul>
<p>PS: This is no post against Outlet, so if any Outlet guys or fans are
reading this, please don't feel offended. Since I dont know Outlet well
I'm sure I did a lot of things wrong but thats really not important
here. I am just making a stance against all the ridiculously stupid
artificial benchmarks out there that try to make people believe Doctrine
is slow and bloated. This post shows I can make it look the other way
around easily. That just shows how meaningless these comparisons are.</p>
<blockquote>
<p><strong>NOTE</strong> All the code used to run these benchmarks can be downloaded
from
<a href="https://www.doctrine-project.org/downloads/doctrine2outletbenchmark.zip">here</a>.
It is a zip archive containing all the code you need to run the
benchmarks yourself.</p>
</blockquote>
        </div>
    </article>
    </main>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?5b3818"
                            integrity="sha384-fyrn6RNWHQbvjdZgboYZiPqKrNVycvMxvrO82FIf25RgB+5BeS7O7XJQuvJOJH3O"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
