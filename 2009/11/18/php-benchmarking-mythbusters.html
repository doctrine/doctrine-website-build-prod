<!DOCTYPE html>
<html>
    <head>
        <title>PHP Benchmarking Mythbusters - Doctrine: PHP Open Source Project</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="The Doctrine Project is an open-source PHP project that is home to home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
">

        <meta name="keywords" content="php,mysql,orm,dbal,database,mongodb,odm,annotations,migrations,cache,couchdb">

                    <meta name="robots" content="index, follow">
        
        
            <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://www.doctrine-project.org/2009/11/18/php-benchmarking-mythbusters.html"
        },
        "headline": "PHP Benchmarking Mythbusters",
        "image": [
            "https://www.doctrine-project.org/images/og.png"
        ],
        "datePublished": "2009-11-18T00:00:00-05:00",
        "dateModified": "2009-11-18T00:00:00-05:00",
        "author": {
            "@type": "Person",
            "name": "romanb"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Doctrine",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.doctrine-project.org/images/og.png"
            }
        },
        "description": "First of, this blog post sucks. I thought I would never write such a senseless apples and oranges co"
    }
    </script>
    <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/prismjs.css?d2443b"
                            integrity="sha384-IcJ7eow//K0xRBscZjnk8kawYxbm2eUAZ9D6Xf/n0yuAi1NCvwOkep1S8XqPNB3E"
                        crossorigin="anonymous"
    />

        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?0e8060"
                        integrity="sha384-uWM8Ap71kVRCtCM3QzQOLqztvscP4nQrnWhodnVaUQW30oDwgZiD05Y6/M0G9kHC"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/2009/11/18/php-benchmarking-mythbusters.html" />
        <meta property="og:title" content="PHP Benchmarking Mythbusters - Doctrine: PHP Open Source Project" />
        <meta property="og:description" content="The Doctrine Project is an open-source PHP project that is home to home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
" />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

        
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/doctrine-website/edit/master/source/blog/2009-11-18-php-benchmarking-mythbusters.md" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <main role="main" class="container-wrapper container">
            <article>
        <div class="row">
            <div class="col-lg-8 col-12">
                <header>
                    <h2>PHP Benchmarking Mythbusters</h2>
                </header>

                <p class="lead">
                    Posted on <date>November 18, 2009</date>
                                            by
                                                    romanb
                                                            </p>
            </div>

            <div class="col-lg-4 col-12">
                <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>
            </div>
        </div>

        <hr />

        <div>
                
            
                
    <p>First of, this blog post sucks. I thought I would never write such a senseless apples and oranges comparison with artificial and meaningless benchmarks, but I was just a bit astonished by the results that I would like to share.</p>

                
    <p>I use object-relational mapping tools in many different languages, from Java to C# to PHP. One of the many supposedly lightweight alternatives in PHP to Doctrine is Outlet. After stumbling upon this comment on a <a href="http://stackoverflow.com/questions/185358/simple-php-orm">stackoverflow.com post</a>: <strong>&quot;Gotta second Outlet. Doctrine is comically bloated - it is WAY too big to be a sensible choice for anything but the lightest of server loads.&quot;</strong> I thought I take a look at Outlet. This ORM seems to consist of only 9 classes! It can&#039;t get any more lightweight right? I assumed it would blow Doctrine out of the water performance-wise in all situations.</p>

                
    <p>So I downloaded Outlet 0.7 and created a simple test database with just 1 table. Then I wrote a small script that bootstraps Outlet, inserts 500 objects into the database and reads them out afterwards (Yes, it&#039;s stupid, just like most other artificial benchmarks).</p>

                
    <p>Environment is PHP 5.3.0 with APC.</p>

                    <pre class="code-block-table" id="ac4cd770041bf4a8dfacb4fde4350f58c1da4e94"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="ac4cd770041bf4a8dfacb4fde4350f58c1da4e94"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php">    <span class="hljs-keyword">echo</span> PHP_EOL . (memory_get_usage() / <span class="hljs-number">1024</span>) . <span class="hljs-string">' KB '</span> . PHP_EOL;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">include</span> <span class="hljs-string">'config.php'</span>;</code><code class="line language-php"></code><code class="line language-php">set_include_path(get_include_path() . PATH_SEPARATOR . <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/outlet'</span>);</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">require</span> <span class="hljs-string">'Outlet.php'</span>;</code><code class="line language-php"></code><code class="line language-php">ini_set(<span class="hljs-string">'error_reporting'</span>, E_ALL);</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bug</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-keyword">public</span> $ID;</code><code class="line language-php">    <span class="hljs-keyword">public</span> $Title;</code><code class="line language-php">    <span class="hljs-keyword">public</span> $Description;</code><code class="line language-php">}</code><code class="line language-php"></code><code class="line language-php">$config = <span class="hljs-keyword">array</span>(</code><code class="line language-php">  <span class="hljs-string">'connection'</span> =&gt; <span class="hljs-keyword">array</span>(</code><code class="line language-php">    <span class="hljs-string">'dsn'</span>      =&gt; <span class="hljs-string">'mysql:host=localhost;dbname=outletbenchmark'</span>,</code><code class="line language-php">    <span class="hljs-string">'username'</span> =&gt; $mysqlUsername,</code><code class="line language-php">    <span class="hljs-string">'password'</span> =&gt; $mysqlPassword,</code><code class="line language-php">    <span class="hljs-string">'dialect'</span> =&gt; <span class="hljs-string">'mysql'</span></code><code class="line language-php">  ),</code><code class="line language-php">  <span class="hljs-string">'classes'</span> =&gt; <span class="hljs-keyword">array</span>(</code><code class="line language-php">    <span class="hljs-string">'Bug'</span> =&gt; <span class="hljs-keyword">array</span>(</code><code class="line language-php">      <span class="hljs-string">'table'</span> =&gt; <span class="hljs-string">'bugs'</span>,</code><code class="line language-php">      <span class="hljs-string">'props'</span> =&gt; <span class="hljs-keyword">array</span>(</code><code class="line language-php">        <span class="hljs-string">'ID'</span>        =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'ID'</span>, <span class="hljs-string">'int'</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">'pk'</span> =&gt; <span class="hljs-keyword">true</span>, <span class="hljs-string">'autoIncrement'</span> =&gt; <span class="hljs-keyword">true</span>)),</code><code class="line language-php">        <span class="hljs-string">'Title'</span>     =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'Title'</span>, <span class="hljs-string">'varchar'</span>),</code><code class="line language-php">        <span class="hljs-string">'Description'</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'Description'</span>, <span class="hljs-string">'varchar'</span>)</code><code class="line language-php">      )</code><code class="line language-php">    )</code><code class="line language-php">  )</code><code class="line language-php">);</code><code class="line language-php">Outlet::init($config);</code><code class="line language-php">$outlet = Outlet::getInstance();</code><code class="line language-php">$outlet-&gt;createProxies();</code><code class="line language-php"></code><code class="line language-php">$s = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php">$outlet-&gt;getConnection()-&gt;beginTransaction();</code><code class="line language-php"><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; <span class="hljs-number">500</span>; ++$i) {</code><code class="line language-php">    $bug = <span class="hljs-keyword">new</span> Bug;</code><code class="line language-php">    $bug-&gt;Title = <span class="hljs-string">'This is a test bug'</span>;</code><code class="line language-php">    $bug-&gt;Description = <span class="hljs-string">'Hey there!'</span>;</code><code class="line language-php"></code><code class="line language-php">    $outlet-&gt;save($bug);</code><code class="line language-php">}</code><code class="line language-php">$outlet-&gt;getConnection()-&gt;commit();</code><code class="line language-php"></code><code class="line language-php">$e = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\nInsert:"</span> . ($e - $s) . <span class="hljs-string">"\n"</span>;</code><code class="line language-php"></code><code class="line language-php">$outlet-&gt;clearCache();</code><code class="line language-php"></code><code class="line language-php">$s = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php">$bugs = $outlet-&gt;select(<span class="hljs-string">'Bug'</span>);</code><code class="line language-php">$e = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php"></code><code class="line language-php">$outlet-&gt;clearCache();</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\nQuery:"</span> . ($e - $s) . <span class="hljs-string">"\n"</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\n"</span> . (memory_get_usage() / <span class="hljs-number">1024</span>) . <span class="hljs-string">' KB '</span> . PHP_EOL;</code><code class="line language-php"></code><code class="line language-php">**CAUTION** First off, ini\_set(<span class="hljs-string">'error\_reporting'</span>, E\_ALL); was</code><code class="line language-php">necessary to silence the following E\_STRICT warnings coming from</code><code class="line language-php">Outlet:</code><code class="line language-php"></code><code class="line language-php">::</code><code class="line language-php"></code><code class="line language-php">    Strict Standards: Non-<span class="hljs-keyword">static</span> method OutletMapper::get() should not be called statically,</code><code class="line language-php">    assuming <span class="hljs-keyword">$this</span> from incompatible context in /Users/robo/dev/php/outlet/outlet<span class="hljs-number">-0.7</span>/classes</code><code class="line language-php">    /outlet/Outlet.php on line <span class="hljs-number">184</span></code><code class="line language-php"></code><code class="line language-php">    Strict Standards: Only variables should be passed by reference in /Users/robo/dev</code><code class="line language-php">    /php/outlet/outlet<span class="hljs-number">-0.7</span>/classes/outlet/OutletMapper.php on line <span class="hljs-number">546</span></code><code class="line language-php"></code><code class="line language-php">Does not really look good (<span class="hljs-keyword">and</span> does not speak <span class="hljs-keyword">for</span> Outlet very</code><code class="line language-php">well), but anyway.</code><code class="line language-php"></code><code class="empty"></code></pre>
                
    <p>I did the same for Doctrine 2.0, <em>without setting up a metadata or query cache</em>.</p>

                    <pre class="code-block-table" id="026eb9092ba01bf030f8b5443cf7c4e5dddd43a1"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="026eb9092ba01bf030f8b5443cf7c4e5dddd43a1"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-keyword">echo</span> PHP_EOL . (memory_get_usage() / <span class="hljs-number">1024</span>) . <span class="hljs-string">' KB '</span> . PHP_EOL;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">include</span> <span class="hljs-string">'config.php'</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">require</span> <span class="hljs-string">'doctrine/Doctrine/Common/IsolatedClassLoader.php'</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-comment">/**</span></code><code class="line language-php"> * @Entity</code><code class="line language-php"> * @Table(name=<span class="hljs-string">"bugs"</span>)</code><code class="line language-php"> */</code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bug</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> <span class="hljs-doctag">@Column</span>(type="integer") <span class="hljs-doctag">@GeneratedValue</span>(strategy="AUTO") */</span></code><code class="line language-php">    <span class="hljs-keyword">public</span> $ID;</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Column</span>(type="string") */</span></code><code class="line language-php">    <span class="hljs-keyword">public</span> $Title;</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Column</span>(type="string") */</span></code><code class="line language-php">    <span class="hljs-keyword">public</span> $Description;</code><code class="line language-php">}</code><code class="line language-php"></code><code class="line language-php">$classLoader = <span class="hljs-keyword">new</span> \Doctrine\Common\IsolatedClassLoader(<span class="hljs-string">'Doctrine'</span>);</code><code class="line language-php">$classLoader-&gt;setBasePath(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/doctrine'</span>);</code><code class="line language-php">$classLoader-&gt;register();</code><code class="line language-php"></code><code class="line language-php">$config = <span class="hljs-keyword">new</span> \Doctrine\ORM\Configuration;</code><code class="line language-php"></code><code class="line language-php">$config-&gt;setProxyDir(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/Proxies'</span>);</code><code class="line language-php">$config-&gt;setProxyNamespace(<span class="hljs-string">'Proxies'</span>);</code><code class="line language-php">$connectionOptions = <span class="hljs-keyword">array</span>(</code><code class="line language-php">    <span class="hljs-string">'driver'</span> =&gt; <span class="hljs-string">'pdo_mysql'</span>,</code><code class="line language-php">    <span class="hljs-string">'user'</span> =&gt; $mysqlUsername,</code><code class="line language-php">    <span class="hljs-string">'password'</span> =&gt; $mysqlPassword,</code><code class="line language-php">    <span class="hljs-string">'host'</span> =&gt; <span class="hljs-string">'localhost'</span>,</code><code class="line language-php">    <span class="hljs-string">'dbname'</span> =&gt; <span class="hljs-string">'doctrine2benchmark'</span></code><code class="line language-php">);</code><code class="line language-php"></code><code class="line language-php">$em = \Doctrine\ORM\EntityManager::create($connectionOptions, $config);</code><code class="line language-php"></code><code class="line language-php">$s = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php"><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; <span class="hljs-number">500</span>; ++$i) {</code><code class="line language-php">    $bug = <span class="hljs-keyword">new</span> Bug;</code><code class="line language-php">    $bug-&gt;Title = <span class="hljs-string">'BBug'</span>;</code><code class="line language-php">    $bug-&gt;Description = <span class="hljs-string">'Hello there!'</span>;</code><code class="line language-php"></code><code class="line language-php">    $em-&gt;persist($bug);</code><code class="line language-php">}</code><code class="line language-php">$em-&gt;flush();</code><code class="line language-php"></code><code class="line language-php">$e = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\nInsert:"</span> . ($e - $s) . <span class="hljs-string">"\n"</span>;</code><code class="line language-php"></code><code class="line language-php">$em-&gt;clear();</code><code class="line language-php"></code><code class="line language-php">$s = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php">$bugs = $em-&gt;getRepository(<span class="hljs-string">'Bug'</span>)-&gt;findAll();</code><code class="line language-php">$e = microtime(<span class="hljs-keyword">true</span>);</code><code class="line language-php"></code><code class="line language-php">$em-&gt;clear();</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\nQuery:"</span> . ($e - $s) . <span class="hljs-string">"\n"</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">"\n"</span> . (memory_get_usage() / <span class="hljs-number">1024</span>) . <span class="hljs-string">' KB '</span> . PHP_EOL;</code><code class="line language-php"></code><code class="empty"></code></pre>
                
    <p>Here are my results.</p>

                <h1 class="section-header ">
    <a href="#1st-run">
        1st Run
        <i class="fas fa-link"></i>
    </a>
</h1>
                
    <p>| Measurement | | Outlet | | Doctrine | | ------------ | | ----------------- | | ------------------- | | Insert Time | | 0.23142600059509 | | 0.11601996421814 | | Query Time | | 0.070523977279663 | | 0.025638818740845 | | Used Memory | | 644.5546875 KB | | 1061.83203125 KB |</p>

                
    <p>No, I did not swap the numbers, I promise. You see that the D2 version uses about 400KB more memory but the result of the timings are quite surprising. Being curious I ran both scripts several times which means the query section has to hydrate 500 objects more for each run.</p>

                <h1 class="section-header ">
    <a href="#2nd-run">
        2nd Run
        <i class="fas fa-link"></i>
    </a>
</h1>
                
    <p><strong>1st refresh (1000 objects)</strong></p>

                
    <p>| Measurement | | Outlet | | Doctrine | | ------------ | | ----------------- | | ------------------- | | Insert Time | | 0.26595592498779 | | 0.11661005020142 | | Query Time | | 0.14437794685364 | | 0.052286863327026 | | Used Memory | | 875.0703125 KB | | 1313.15625 KB |</p>

                <h1 class="section-header ">
    <a href="#3rd-run">
        3rd Run
        <i class="fas fa-link"></i>
    </a>
</h1>
                
    <p><strong>2nd refresh (1500 objects)</strong></p>

                
    <p>| Measurement | | Outlet | | Doctrine | | ------------ | | ----------------- | | ------------------- | | Insert Time | | 0.2314441204071 | | 0.11621117591858 | | Query Time | | 0.21359491348267 | | 0.079329013824463 | | Used Memory | | 1139.5859375 KB | | 1541.59375 KB |</p>

                
    <p>Did you expect these results? After all Doctrine is so bloated, right? (Doctrine 2 full package ~250 classes) and Outlet is so lightweight (~9 classes)?</p>

                
    <p>Bottom line:</p>

                

<ul>
    <li class="dash">The number of classes barely means anything. (Its probably a good criterion if you&#039;re short on disk space).</li>
    <li class="dash">&quot;Lightweight&quot; is a buzzword and meaningless without a reference point.</li>
    <li class="dash">Don&#039;t judge a library by its size and certainly dont try to draw conclusions from the size to the performance, or worse to the scalability. It just doesnt work.</li>
    <li class="dash"><em>Artificial benchmarks suck.</em></li>
    <li class="dash">To all the folks hunting for everything lightweight and micro-benchmarking all day long: You&#039;re wasting your time (Just like I did with this stupid benchmark...).</li>
    <li class="dash">Don&#039;t trust artificial benchmarks (Not even this one).</li>
</ul>

                
    <p>PS: This is no post against Outlet, so if any Outlet guys or fans are reading this, please don&#039;t feel offended. Since I dont know Outlet well I&#039;m sure I did a lot of things wrong but thats really not important here. I am just making a stance against all the ridiculously stupid artificial benchmarks out there that try to make people believe Doctrine is slow and bloated. This post shows I can make it look the other way around easily. That just shows how meaningless these comparisons are.</p>

                <blockquote>
    <p><strong>NOTE</strong> All the code used to run these benchmarks can be downloaded from <a href="https://www.doctrine-project.org/downloads/doctrine2outletbenchmark.zip">here</a>. It is a zip archive containing all the code you need to run the benchmarks yourself.</p>
</blockquote>
        
    
        </div>
    </article>
    </main>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?1546fc"
                            integrity="sha384-ix9eb2EZyp9uayYpxmCQoylbz8msHl5wOg/aqZnD/3cxszNUGePN656MRg5GEgbm"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            <script
            src="https://www.doctrine-project.org/frontend/js/prismjs.js?8aa1bb"
                            integrity="sha384-3EhgfeqnppOxFBVU40g8gS+IVvmh5+wGpe4mG2otPyExrkK9t4aq8uCUy2IDLKkR"
                        crossorigin="anonymous">
    </script>
    </body>
</html>
