<!DOCTYPE html>
<html>
    <head>
        <title>Blog - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://www.doctrine-project.org/css/style.css?369e38" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://www.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
            </head>
    <body>
                    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://www.doctrine-project.org/"><img src="https://www.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://www.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/lexer/">Lexer</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://www.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://www.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="search-results rounded">
                    <div id="hits">
                        <!-- Hits widget will appear here -->
                    </div>

                    <a href="https://www.algolia.com" target="_blank"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
                </div>
            </nav>
        
            <main role="main" class="container-wrapper container">
                        <article>
        <header>
            <h2><a href="https://www.doctrine-project.org/2009/05/28/doctrine-database-abstraction-layer.html">Doctrine Database Abstraction Layer</a></h2>
        </header>

        <p class="lead">
            Posted on 2009-05-28
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            <p>One of the greatest advantages to using Doctrine is what is under
the hood that powers it. That is the database abstraction layer.
This powerful layer is based off of a lot of different code from
various popular PHP projects such as PEAR MDB2 and Zend\_Db. It
provides you a nice intuitive interface for retrieving information
about your database schema as well as issuing DDL statements to
change it.</p>
<a id="title.1"></a><h1>Public Method Index</h1>
<p>The database abstraction layer features the following methods in
1.x and some new methods added in 2.0.</p>
<a id="title.1.1"></a><h2>1.x Methods</h2>
<ul><li class="dash"> listDatabases()</li>
<li class="dash"> listFunctions()</li>
<li class="dash"> listTriggers()</li>
<li class="dash"> listSequences()</li>
<li class="dash"> listTableConstraints()</li>
<li class="dash"> listTableColumns()</li>
<li class="dash"> listTableIndexes()</li>
<li class="dash"> listTables()</li>
<li class="dash"> listUsers()</li>
<li class="dash"> listViews()</li>
<li class="dash"> dropDatabase()</li>
<li class="dash"> dropTable()</li>
<li class="dash"> dropIndex()</li>
<li class="dash"> dropConstraint()</li>
<li class="dash"> dropForeignKey()</li>
<li class="dash"> dropSequence()</li>
<li class="dash"> createDatabase()</li>
<li class="dash"> createTable()</li>
<li class="dash"> createSequence()</li>
<li class="dash"> createConstraint()</li>
<li class="dash"> createIndex()</li>
<li class="dash"> createForeignKey()</li>
<li class="dash"> alterTable()</li>
</ul>

<a id="title.1.2"></a><h2>New Methods in 2.0</h2>
<ul><li class="dash"> renameTable()</li>
<li class="dash"> addTableColumn()</li>
<li class="dash"> removeTableColumn()</li>
<li class="dash"> changeTableColumn()</li>
<li class="dash"> renameTableColumn()</li>
<li class="dash"> dropView()</li>
<li class="dash"> createView()</li>
</ul>

<a id="title.2"></a><h1>Some 2.0 Examples</h1>
<p>Here are some code examples using the Doctrine 2.0 Database
Abstraction Layer. We'll show you how you can execute these
examples yourself by checking out Doctrine 2.0 from SVN and setting
up a PHP script to test with.</p>
<blockquote><p><strong>TIP</strong> The database abstraction layer can be used standalone so if
you just want a nice standard layer for communicating with your
database then Doctrine works for you too.</p>
</blockquote>
<a id="title.2.1"></a><h2>Checkout Doctrine</h2>

<pre><code class="">$ svn co http://svn.doctrine-project.org/trunk doctrine2
$ cd doctrine2
</code></pre>
<a id="title.2.2"></a><h2>Create Test Script</h2>
<p>Create a new PHP script anywhere on your server and name it
<code>test.php</code>. Now lets initialize Doctrine so we can work with it.
First we need to set our <code>ClassLoader</code>.</p>
<pre><code class="php">&lt;?php
// test.php

require 'lib/Doctrine/Common/ClassLoader.php';

$classLoader = new \Doctrine\Common\ClassLoader();
$classLoader-&gt;setBasePath('Doctrine', __DIR__ . '/lib');
</code></pre>
<a id="title.2.3"></a><h2>Create Connection</h2>
<p>Now we need to create our <code>Connection</code> instance.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$connectionOptions = array(
    'driver' =&gt; 'pdo_mysql',
    'dbname' =&gt; 'mysql',
    'user' =&gt; 'root',
    'password' =&gt; ''
);
$driver = new \Doctrine\DBAL\Driver\PDOMySql\Driver;
$conn = new \Doctrine\DBAL\Connection($connectionOptions, $driver);

**NOTE** Notice how we are temporarily connecting to the special
database for MySQL named ``mysql``. We'll use this database to
connect to so we can create our test database.

</code></pre>
<p>Now we can simply retrieve the <code>SchemaManager</code> instance from the
<code>Connection</code> driver and begin to execute some of the methods we
listed above.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$sm = $conn-&gt;getSchemaManager();
</code></pre>
<p>The first thing we could do is create the database by calling the
<code>createDatabase()</code> method on the <code>$sm</code> instance.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$sm-&gt;createDatabase('doctrine2test');
</code></pre>
<p>Now that we have the database created, change your
<code>$connectionOptions</code> key <code>dbname</code> to specify <code>doctrine2test</code>
so that we connect to the new database that we just created.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$connectionOptions = array(
    'driver' =&gt; 'pdo_mysql',
    'dbname' =&gt; 'doctrine2test',
    'user' =&gt; 'root',
    'password' =&gt; ''
);

// ...
</code></pre>
<p>Now we can begin adding things to the new database. For example we
could issue a command to create a new table.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$columns = array(
    'id' =&gt; array(
        'type' =&gt; \Doctrine\DBAL\Type::getType('integer'),
        'autoincrement' =&gt; true,
        'primary' =&gt; true,
        'notnull' =&gt; true
    ),
    'test' =&gt; array(
        'type' =&gt;  \Doctrine\DBAL\Type::getType('string'),
        'length' =&gt; 255
    )
);

$options = array();

$sm-&gt;createTable('new_table', $columns, $options);
</code></pre>
<p>Then after creating the table I can later add a new column to it.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$column = array(
    'type' =&gt;  \Doctrine\DBAL\Type::getType('string'),
    'length' =&gt; 255
);

$sm-&gt;addTableColumn('new_table', 'new_column', $column);
</code></pre>
<p>Or I could even drop the table completely.</p>
<pre><code class="php">&lt;?php
// test.php

// ...

$sm-&gt;dropTable('new_table');

**NOTE** Not all of the above listed methods are supported by every
single DBMS. If your DBMS does not support the functionality then
Doctrine will throw exceptions accordingly.

</code></pre>
<p>All the above example are very simple schema changes but Doctrine
is capable of manipulating very complex schemas from a standardized
programmatic interface. The Doctrine Migrations extension makes use
of this layer heavily to do all the operations for changing your
database schemas.</p>

        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://www.doctrine-project.org/2009/05/27/want-to-contribute-to-doctrine.html">Want to contribute to Doctrine?</a></h2>
        </header>

        <p class="lead">
            Posted on 2009-05-27
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            <a id="title.1"></a><h1>Looking for Developers</h1>
<p>We've been on the hunt for more Doctrine contributors. As the
number of users of Doctrine grew we expected the number of
commiters to rise with it but this has not been the case. We do get
a lot of small patches here and there, but we are hoping for some
of them to grow in to full-time core developers that are involved
with all the decisions made about Doctrine.</p>
<a id="title.2"></a><h1>Call to the community</h1>
<p>You can see Roman made a call to the Doctrine developers mailing
list
<a href="http://groups.google.com/group/doctrine-dev/browse_thread/thread/c6e4c74e1a392909">here</a>
about the issue. We are taking all the feedback in to consideration
and we have started by creating a
<a href="http://www.doctrine-project.org/contribute">contribute</a> page
that is linked from the primary menu of the website. We hope that
this will help with new users finding information faster about how
they can get started contributing.</p>
<a id="title.3"></a><h1>Other Ideas</h1>
<p>If you have any additional ideas about how we can promote
contributing to Doctrine you can discuss them in the comments or on
the
<a href="http://groups.google.com/group/doctrine-dev/browse_thread/thread/c6e4c74e1a392909">mailing list thread</a>.</p>

        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://www.doctrine-project.org/2009/05/22/glimpse-of-doctrine-2-0.html">Glimpse of Doctrine 2.0</a></h2>
        </header>

        <p class="lead">
            Posted on 2009-05-22
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            <p>As you all probably already know, we have been working on Doctrine
2.0 pretty much since before we released Doctrine 1.0. This effort
has been primarily led by Roman and he has done an excellent job
with things so first a big thanks goes to him.</p>
<a id="title.1"></a><h1>A few quick facts</h1>
<ul><li class="dash"> Doctrine 2.0 will require PHP 5.3</li>
<li class="dash"> Doctrine 2.0 is FAST</li>
<li class="dash"> We will extend the support life of 1.x</li>
</ul>

<p>We have decided to move forward with Doctrine 2.0 requiring PHP
5.3. This release is a significant one, both for PHP and Doctrine,
so we decided to continue support for the 1.x series of Doctrine to
give the adoption of PHP 5.3 and Doctrine 2.0 more time.</p>
<a id="title.2"></a><h1>Hydration Performance</h1>
<p>In Doctrine 2.0 the performance when hydrating data is greatly
improved. The difference in speed is a combination of code changes
and the performance increase from using PHP 5.3.</p>
<p>\ Seconds \ \ ------------
\ \ 4.3435637950897 \ \
1.4314442552312 \ \ 3.4690098762512 \</p>
<a id="title.3"></a><h1>A few code snippets</h1>
<a id="title.4"></a><h1>Schema Metadata and Models</h1>
<p>In Doctrine 1.1 a <code>Doctrine_Record</code> might look something like the
following.</p>
<pre><code class="php">&lt;?php
class User extends Doctrine_Record
{
    public function setTableDefinition()
    {
        $this-&gt;hasColumn('id', 'integer', null, array(
          'primary' =&gt; true,
          'auto_increment' =&gt; true
        ));
        $this-&gt;hasColumn('username', 'string', 255);
    }
}

**NOTE** Notice how you have to extend the base class and
everything is a public instance. As you probably know this has lots
of negative effects as it imposes properties and methods on your
models.

</code></pre>
<p>In Doctrine 2.0 this limitation was removed and you no longer need
to extend a base class.</p>
<pre><code class="php">&lt;?php
/**
 * @DoctrineEntity
 * @DoctrineTable(name=&quot;user&quot;)
 */
class User
{
    /**
     * @DoctrineId
     * @DoctrineColumn(type=&quot;integer&quot;)
     * @DoctrineGeneratedValue(strategy=&quot;auto&quot;)
     */
    public $id;
    /**
     * @DoctrineColumn(type=&quot;varchar&quot;, length=255)
     */
    public $username;
}
</code></pre>
<a id="title.5"></a><h1>Custom Data Types</h1>
<p>In Doctrine 2.0 you can write your own custom data types. Here is
an example of what the custom datatype class might look like.</p>
<a id="title.5.1"></a><h2>Type Declaration</h2>
<pre><code class="php">&lt;?php
namespace My\Project\Types;

use Doctrine\DBAL\Types\Type;
use Doctrine\DBAL\Platforms\AbstractPlatform;

/**
 * My custom datatype.
 */
class MyType extends Type
{
    public function getSqlDeclaration(array $fieldDeclaration, AbstractPlatform $platform)
    {
        // return the SQL used to create your column type. To create a portable column type, use the $platform.
    }

    public function convertToPHPValue($value)
    {
        // This is executed when the value is read from the database. Make your conversions here.
    }

    public function convertToDatabaseValue($value, AbstractPlatform $platform)
    {
        // This is executed when the value is written to the database. Make your conversions here, optionally using the $platform.
    }
}
</code></pre>
<a id="title.5.2"></a><h2>Adding Custom Type</h2>
<p>You can easily register your custom type with Doctrine like this.</p>
<pre><code class="php">&lt;?php
// in bootstrapping code

...

use Doctrine\DBAL\Types\Type;

...

// Register my type
Type::addCustomType('mytype', 'My\Project\Types\MyType');
</code></pre>
<a id="title.5.3"></a><h2>Using Custom Type</h2>
<p>Now in your model definition you can do something like the
following.</p>
<pre><code class="php">&lt;?php
namespace My\Project\Model;

/**
 * @DoctrineEntity
 * ...
 */
class MyEntity
{
    /**
     * @DoctrineColumn(type=&quot;mytype&quot;)
     */
    private $data;

    // ... other properties and code
}
</code></pre>
<p>This is only a small glimpse of what is possible in Doctrine 2.0.
You will start to see more posts on the blog related to Doctrine
2.0 in the next several months so stay tuned.</p>

        </div>

            </article>

    <nav class="mt-4">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="https://www.doctrine-project.org/blog/page/67.html">Newer Posts</a></li><br />
            <li class="page-item"><a class="page-link" href="https://www.doctrine-project.org/blog/page/69.html">Older Posts</a></li>        </ul>
    </nav>
            </main>

        
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://www.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://www.doctrine-project.org/js/main.js?f32c09"></script>
        <script src="https://www.doctrine-project.org/js/search.js?36322d"></script>

        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            new Main();

            new Search(projectSlug, versionSlug);
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
        
            </body>
</html>
