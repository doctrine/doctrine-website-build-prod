<!DOCTYPE html>
<html>
    <head>
        <title>Transactions - Doctrine Database Abstraction Layer (DBAL)</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Database Abstraction Layer Documentation: Transactions ">

        <meta name="keywords" content="abstraction,database,dbal,db2,mariadb,mssql,mysql,pgsql,postgresql,oci8,oracle,pdo,queryobject,sasql,sql,sqlite,sqlserver,sqlsrv,documentation,transactions">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-dbal/en/current/reference/transactions.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?15a855"
                        integrity="sha384-IVdylBzDQpFJ+EmdH6hsr98Htg0t1rrKj99U9d2vkDI1YrWNS7+OZ+Ti5KHXx+3r"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-dbal/en/2.4/reference/transactions.html" />
        <meta property="og:title" content="Transactions - Doctrine Database Abstraction Layer (DBAL)" />
        <meta property="og:description" content="Doctrine Database Abstraction Layer Documentation: Transactions " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Database Abstraction Layer",
            "description": "Transactions",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar stop-war-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                 <a href="/stop-war.html">ðŸ‡ºðŸ‡¦ UKRAINE NEEDS YOUR HELP NOW!</a>
            </nav>

            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/dbal/edit//docs/en/reference/transactions.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc"><ul><li id="index-html-welcome-to-doctrine-dbal-s-documentation" class="toc-item"><a href="../index.html#welcome-to-doctrine-dbal-s-documentation">Welcome to Doctrine DBAL's documentation!</a></li><li id="index-html-indices-and-tables" class="toc-item"><a href="../index.html#indices-and-tables">Indices and tables</a></li><li id="transactions-html-transactions" class="toc-item"><a href="transactions.html#transactions">Transactions</a><ul><li id="transactions-html-transaction-nesting" class="toc-item"><a href="transactions.html#transaction-nesting">Transaction Nesting</a></li></ul></li><li id="types-html-types" class="toc-item"><a href="types.html#types">Types</a><ul><li id="types-html-detection-of-database-types" class="toc-item"><a href="types.html#detection-of-database-types">Detection of Database Types</a></li><li id="types-html-custom-mapping-types" class="toc-item"><a href="types.html#custom-mapping-types">Custom Mapping Types</a></li></ul></li><li id="portability-html-portability" class="toc-item"><a href="portability.html#portability">Portability</a><ul><li id="portability-html-connection-wrapper" class="toc-item"><a href="portability.html#connection-wrapper">Connection Wrapper</a></li><li id="portability-html-database-platform" class="toc-item"><a href="portability.html#database-platform">Database Platform</a></li><li id="portability-html-keyword-lists" class="toc-item"><a href="portability.html#keyword-lists">Keyword Lists</a></li></ul></li><li id="events-html-events" class="toc-item"><a href="events.html#events">Events</a><ul><li id="events-html-postconnect-event" class="toc-item"><a href="events.html#postconnect-event">PostConnect Event</a></li></ul></li><li id="known-vendor-issues-html-known-vendor-issues" class="toc-item"><a href="known-vendor-issues.html#known-vendor-issues">Known Vendor Issues</a><ul><li id="known-vendor-issues-html-postgresql" class="toc-item"><a href="known-vendor-issues.html#postgresql">PostgreSQL</a><ul><li id="known-vendor-issues-html-datetime-datetimetz-and-time-types" class="toc-item"><a href="known-vendor-issues.html#datetime-datetimetz-and-time-types">DateTime, DateTimeTz and Time Types</a></li><li id="known-vendor-issues-html-timezones-and-datetimetz" class="toc-item"><a href="known-vendor-issues.html#timezones-and-datetimetz">Timezones and DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-mysql" class="toc-item"><a href="known-vendor-issues.html#mysql">MySQL</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-sqlite" class="toc-item"><a href="known-vendor-issues.html#sqlite">Sqlite</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-ibm-db2" class="toc-item"><a href="known-vendor-issues.html#ibm-db2">IBM DB2</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-oracle" class="toc-item"><a href="known-vendor-issues.html#oracle">Oracle</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li><li id="known-vendor-issues-html-oci8-sql-queries-with-question-marks" class="toc-item"><a href="known-vendor-issues.html#oci8-sql-queries-with-question-marks">OCI8: SQL Queries with Question Marks</a></li><li id="known-vendor-issues-html-oci-lob-instances" class="toc-item"><a href="known-vendor-issues.html#oci-lob-instances">OCI-LOB instances</a></li></ul></li><li id="known-vendor-issues-html-microsoft-sql-server" class="toc-item"><a href="known-vendor-issues.html#microsoft-sql-server">Microsoft SQL Server</a><ul><li id="known-vendor-issues-html-unique-and-null" class="toc-item"><a href="known-vendor-issues.html#unique-and-null">Unique and NULL</a></li><li id="known-vendor-issues-html-datetime-datetimetz-and-time-types" class="toc-item"><a href="known-vendor-issues.html#datetime-datetimetz-and-time-types">DateTime, DateTimeTz and Time Types</a></li></ul></li></ul></li><li id="sharding-azure-tutorial-html-sqlazure-sharding-tutorial" class="toc-item"><a href="sharding_azure_tutorial.html#sqlazure-sharding-tutorial">SQLAzure Sharding Tutorial</a><ul><li id="sharding-azure-tutorial-html-install-doctrine" class="toc-item"><a href="sharding_azure_tutorial.html#install-doctrine">Install Doctrine</a></li><li id="sharding-azure-tutorial-html-setup-connection" class="toc-item"><a href="sharding_azure_tutorial.html#setup-connection">Setup Connection</a></li><li id="sharding-azure-tutorial-html-create-database" class="toc-item"><a href="sharding_azure_tutorial.html#create-database">Create Database</a></li><li id="sharding-azure-tutorial-html-create-schema" class="toc-item"><a href="sharding_azure_tutorial.html#create-schema">Create Schema</a></li><li id="sharding-azure-tutorial-html-view-federation-members" class="toc-item"><a href="sharding_azure_tutorial.html#view-federation-members">View Federation Members</a></li><li id="sharding-azure-tutorial-html-insert-data" class="toc-item"><a href="sharding_azure_tutorial.html#insert-data">Insert Data</a></li><li id="sharding-azure-tutorial-html-split-federation" class="toc-item"><a href="sharding_azure_tutorial.html#split-federation">Split Federation</a></li><li id="sharding-azure-tutorial-html-inserting-data-after-split" class="toc-item"><a href="sharding_azure_tutorial.html#inserting-data-after-split">Inserting Data after Split</a></li><li id="sharding-azure-tutorial-html-querying-data-with-filtering-off" class="toc-item"><a href="sharding_azure_tutorial.html#querying-data-with-filtering-off">Querying data with filtering off</a></li><li id="sharding-azure-tutorial-html-querying-data-with-filtering-on" class="toc-item"><a href="sharding_azure_tutorial.html#querying-data-with-filtering-on">Querying data with filtering on</a></li></ul></li><li id="security-html-security" class="toc-item"><a href="security.html#security">Security</a><ul><li id="security-html-user-input-in-your-queries" class="toc-item"><a href="security.html#user-input-in-your-queries">User input in your queries</a><ul><li id="security-html-wrong-string-concatenation" class="toc-item"><a href="security.html#wrong-string-concatenation">Wrong: String Concatenation</a></li><li id="security-html-right-prepared-statements" class="toc-item"><a href="security.html#right-prepared-statements">Right: Prepared Statements</a></li><li id="security-html-right-quoting-escaping-values" class="toc-item"><a href="security.html#right-quoting-escaping-values">Right: Quoting/Escaping values</a></li></ul></li><li id="security-html-non-ascii-compatible-charsets-in-mysql" class="toc-item"><a href="security.html#non-ascii-compatible-charsets-in-mysql">Non-ASCII compatible Charsets in MySQL</a></li></ul></li><li id="query-builder-html-sql-query-builder" class="toc-item"><a href="query-builder.html#sql-query-builder">SQL Query Builder</a></li><li id="schema-manager-html-schema-manager" class="toc-item"><a href="schema-manager.html#schema-manager">Schema-Manager</a><ul><li id="schema-manager-html-listdatabases" class="toc-item"><a href="schema-manager.html#listdatabases">listDatabases()</a></li><li id="schema-manager-html-listsequences" class="toc-item"><a href="schema-manager.html#listsequences">listSequences()</a></li><li id="schema-manager-html-listtablecolumns" class="toc-item"><a href="schema-manager.html#listtablecolumns">listTableColumns()</a></li><li id="schema-manager-html-listtabledetails" class="toc-item"><a href="schema-manager.html#listtabledetails">listTableDetails()</a></li><li id="schema-manager-html-listtableforeignkeys" class="toc-item"><a href="schema-manager.html#listtableforeignkeys">listTableForeignKeys()</a></li><li id="schema-manager-html-listtableindexes" class="toc-item"><a href="schema-manager.html#listtableindexes">listTableIndexes()</a></li><li id="schema-manager-html-listtables" class="toc-item"><a href="schema-manager.html#listtables">listTables()</a></li><li id="schema-manager-html-listviews" class="toc-item"><a href="schema-manager.html#listviews">listViews()</a></li><li id="schema-manager-html-createschema" class="toc-item"><a href="schema-manager.html#createschema">createSchema()</a></li></ul></li><li id="configuration-html-configuration" class="toc-item"><a href="configuration.html#configuration">Configuration</a><ul><li id="configuration-html-getting-a-connection" class="toc-item"><a href="configuration.html#getting-a-connection">Getting a Connection</a><ul><li id="configuration-html-driver" class="toc-item"><a href="configuration.html#driver">Driver</a></li><li id="configuration-html-wrapper-class" class="toc-item"><a href="configuration.html#wrapper-class">Wrapper Class</a></li><li id="configuration-html-connection-details" class="toc-item"><a href="configuration.html#connection-details">Connection Details</a></li><li id="configuration-html-custom-platform" class="toc-item"><a href="configuration.html#custom-platform">Custom Platform</a></li><li id="configuration-html-custom-driver-options" class="toc-item"><a href="configuration.html#custom-driver-options">Custom Driver Options</a></li></ul></li></ul></li><li id="data-retrieval-and-manipulation-html-data-retrieval-and-manipulation" class="toc-item"><a href="data-retrieval-and-manipulation.html#data-retrieval-and-manipulation">Data Retrieval And Manipulation</a><ul><li id="data-retrieval-and-manipulation-html-data-retrieval" class="toc-item"><a href="data-retrieval-and-manipulation.html#data-retrieval">Data Retrieval</a><ul><li id="data-retrieval-and-manipulation-html-dynamic-parameters-and-prepared-statements" class="toc-item"><a href="data-retrieval-and-manipulation.html#dynamic-parameters-and-prepared-statements">Dynamic Parameters and Prepared Statements</a></li><li id="data-retrieval-and-manipulation-html-using-prepared-statements" class="toc-item"><a href="data-retrieval-and-manipulation.html#using-prepared-statements">Using Prepared Statements</a></li></ul></li><li id="data-retrieval-and-manipulation-html-binding-types" class="toc-item"><a href="data-retrieval-and-manipulation.html#binding-types">Binding Types</a><ul><li id="data-retrieval-and-manipulation-html-doctrine-dbal-types-conversion" class="toc-item"><a href="data-retrieval-and-manipulation.html#doctrine-dbal-types-conversion">Doctrine\DBAL\Types Conversion</a></li><li id="data-retrieval-and-manipulation-html-list-of-parameters-conversion" class="toc-item"><a href="data-retrieval-and-manipulation.html#list-of-parameters-conversion">List of Parameters Conversion</a></li></ul></li><li id="data-retrieval-and-manipulation-html-api" class="toc-item"><a href="data-retrieval-and-manipulation.html#api">API</a><ul><li id="data-retrieval-and-manipulation-html-prepare" class="toc-item"><a href="data-retrieval-and-manipulation.html#prepare">prepare()</a></li><li id="data-retrieval-and-manipulation-html-executeupdate" class="toc-item"><a href="data-retrieval-and-manipulation.html#executeupdate">executeUpdate()</a></li><li id="data-retrieval-and-manipulation-html-executequery" class="toc-item"><a href="data-retrieval-and-manipulation.html#executequery">executeQuery()</a></li><li id="data-retrieval-and-manipulation-html-fetchall" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchall">fetchAll()</a></li><li id="data-retrieval-and-manipulation-html-fetcharray" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetcharray">fetchArray()</a></li><li id="data-retrieval-and-manipulation-html-fetchcolumn" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchcolumn">fetchColumn()</a></li><li id="data-retrieval-and-manipulation-html-fetchassoc" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchassoc">fetchAssoc()</a></li><li id="data-retrieval-and-manipulation-html-delete" class="toc-item"><a href="data-retrieval-and-manipulation.html#delete">delete()</a></li><li id="data-retrieval-and-manipulation-html-insert" class="toc-item"><a href="data-retrieval-and-manipulation.html#insert">insert()</a></li><li id="data-retrieval-and-manipulation-html-update" class="toc-item"><a href="data-retrieval-and-manipulation.html#update">update()</a></li><li id="data-retrieval-and-manipulation-html-quote" class="toc-item"><a href="data-retrieval-and-manipulation.html#quote">quote()</a></li><li id="data-retrieval-and-manipulation-html-quoteidentifier" class="toc-item"><a href="data-retrieval-and-manipulation.html#quoteidentifier">quoteIdentifier()</a></li></ul></li></ul></li><li id="architecture-html-architecture" class="toc-item"><a href="architecture.html#architecture">Architecture</a><ul><li id="architecture-html-drivers" class="toc-item"><a href="architecture.html#drivers">Drivers</a></li><li id="architecture-html-platforms" class="toc-item"><a href="architecture.html#platforms">Platforms</a></li><li id="architecture-html-logging" class="toc-item"><a href="architecture.html#logging">Logging</a></li><li id="architecture-html-schema" class="toc-item"><a href="architecture.html#schema">Schema</a></li><li id="architecture-html-types" class="toc-item"><a href="architecture.html#types">Types</a></li></ul></li><li id="sharding-html-sharding" class="toc-item"><a href="sharding.html#sharding">Sharding</a><ul><li id="sharding-html-id-generation" class="toc-item"><a href="sharding.html#id-generation">ID Generation</a><ul><li id="sharding-html-use-guid-uuids" class="toc-item"><a href="sharding.html#use-guid-uuids">Use GUID/UUIDs</a></li><li id="sharding-html-table-generator" class="toc-item"><a href="sharding.html#table-generator">Table Generator</a></li><li id="sharding-html-natural-identifiers" class="toc-item"><a href="sharding.html#natural-identifiers">Natural Identifiers</a></li></ul></li><li id="sharding-html-transactions" class="toc-item"><a href="sharding.html#transactions">Transactions</a></li><li id="sharding-html-foreign-keys" class="toc-item"><a href="sharding.html#foreign-keys">Foreign Keys</a></li><li id="sharding-html-complex-queries" class="toc-item"><a href="sharding.html#complex-queries">Complex Queries</a></li><li id="sharding-html-shardmanager-interface" class="toc-item"><a href="sharding.html#shardmanager-interface">ShardManager Interface</a></li><li id="sharding-html-schema-operations-schemasynchronizer-interface" class="toc-item"><a href="sharding.html#schema-operations-schemasynchronizer-interface">Schema Operations: SchemaSynchronizer Interface</a></li><li id="sharding-html-sql-azure-federations" class="toc-item"><a href="sharding.html#sql-azure-federations">SQL Azure Federations</a><ul><li id="sharding-html-schema-operations" class="toc-item"><a href="sharding.html#schema-operations">Schema Operations</a></li><li id="sharding-html-sqlazure-filtering" class="toc-item"><a href="sharding.html#sqlazure-filtering">SQLAzure Filtering</a></li></ul></li><li id="sharding-html-generic-sql-sharding-support" class="toc-item"><a href="sharding.html#generic-sql-sharding-support">Generic SQL Sharding Support</a></li></ul></li><li id="platforms-html-platforms" class="toc-item"><a href="platforms.html#platforms">Platforms</a></li><li id="schema-representation-html-schema-representation" class="toc-item"><a href="schema-representation.html#schema-representation">Schema-Representation</a></li><li id="introduction-html-introduction" class="toc-item"><a href="introduction.html#introduction">Introduction</a></li><li id="supporting-other-databases-html-supporting-other-databases" class="toc-item"><a href="supporting-other-databases.html#supporting-other-databases">Supporting Other Databases</a><ul><li id="supporting-other-databases-html-implementation-steps-in-detail" class="toc-item"><a href="supporting-other-databases.html#implementation-steps-in-detail">Implementation Steps in Detail</a></li></ul></li><li id="caching-html-caching" class="toc-item"><a href="caching.html#caching">Caching</a></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "DBAL",
            "item": "https://www.doctrine-project.org/projects/dbal.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-dbal/en/2.4/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Transactions",
            "item": "https://www.doctrine-project.org/projects/doctrine-dbal/en/2.4/reference/transactions.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/dbal.html">DBAL</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-dbal/en/2.4/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Transactions</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-dbal/en/2.4/reference/transactions.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        2.4.5
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/latest/reference/transactions.html">
                                                    4.0.0-BETA2

                                                    
                                                                                                            (upcoming)
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/3.7/reference/transactions.html">
                                                    3.7

                                                    
                                                                                                            (upcoming)
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/current/reference/transactions.html">
                                                    3.6.1

                                                                                                            (current)
                                                    
                                                                                                    </a>
                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.5/reference/transactions.html">3.5</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.4/reference/transactions.html">3.4</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.3/reference/transactions.html">3.3</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.2/reference/transactions.html">3.2</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.1/reference/transactions.html">3.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.0/reference/transactions.html">3.0</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.13/reference/transactions.html">2.13</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.12/reference/transactions.html">2.12</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.11/reference/transactions.html">2.11</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.10/reference/transactions.html">2.10</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.9/reference/transactions.html">2.9</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.8/reference/transactions.html">2.8</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.7/reference/transactions.html">2.7</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.6/reference/transactions.html">2.6</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-dbal/en/2.5/reference/transactions.html">2.5</a>
                                                                                            
                                                <a class="dropdown-item active" href="/projects/doctrine-dbal/en/2.4/reference/transactions.html">2.4</a>
                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="transactions" name="transactions"></a><h1 class="section-header"><a href="#transactions">Transactions<i class="fas fa-link"></i></a></h1>
<p>A <code>Doctrine\DBAL\Connection</code> provides a PDO-like API for
transaction management, with the methods
<code>Connection#beginTransaction()</code>, <code>Connection#commit()</code> and
<code>Connection#rollback()</code>.</p>
<p>Transaction demarcation with the Doctrine DBAL looks as follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a269aa488e5747c832c8ca1ec0404e3a8d758e4a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a269aa488e5747c832c8ca1ec0404e3a8d758e4a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-1" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-meta">&lt;?php</span>
$conn-&gt;beginTransaction();
<span class="hljs-keyword">try</span>{
    <span class="hljs-comment">// do stuff</span>
    $conn-&gt;commit();
} <span class="hljs-keyword">catch</span>(<span class="hljs-keyword">Exception</span> $e) {
    $conn-&gt;rollback();
    <span class="hljs-keyword">throw</span> $e;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-2" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-3" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-4" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-5" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-6" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-7" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-8" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-9" class="line-number-anchor" /><a href="#line-number-a269aa488e5747c832c8ca1ec0404e3a8d758e4a-9">9</a></td></tr></table></div></code></pre>
<p>Alternatively, the control abstraction
<code>Connection#transactional($func)</code> can be used to make the code
more concise and to make sure you never forget to rollback the
transaction in the case of an exception. The following code snippet
is functionally equivalent to the previous one:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="0450a0f4e1e945871f7dded286df12ad582b7f63"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="0450a0f4e1e945871f7dded286df12ad582b7f63"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-1" class="line-number-anchor" /><a href="#line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>
$conn-&gt;transactional(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($conn)</span> </span>{
    <span class="hljs-comment">// do stuff</span>
});</td></tr>
<tr><td class="line-number noselect"><a name="line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-2" class="line-number-anchor" /><a href="#line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-3" class="line-number-anchor" /><a href="#line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-4" class="line-number-anchor" /><a href="#line-number-0450a0f4e1e945871f7dded286df12ad582b7f63-4">4</a></td></tr></table></div></code></pre>
<p>The <code>Doctrine\DBAL\Connection</code> also has methods to control the
transaction isolation level as supported by the underlying
database. <code>Connection#setTransactionIsolation($level)</code> and
<code>Connection#getTransactionIsolation()</code> can be used for that purpose.
The possible isolation levels are represented by the following
constants:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="95227b59d715a1f437aac83950916da9cdca5824"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="95227b59d715a1f437aac83950916da9cdca5824"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-95227b59d715a1f437aac83950916da9cdca5824-1" class="line-number-anchor" /><a href="#line-number-95227b59d715a1f437aac83950916da9cdca5824-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>
Connection::TRANSACTION_READ_UNCOMMITTED
Connection::TRANSACTION_READ_COMMITTED
Connection::TRANSACTION_REPEATABLE_READ
Connection::TRANSACTION_SERIALIZABLE</td></tr>
<tr><td class="line-number noselect"><a name="line-number-95227b59d715a1f437aac83950916da9cdca5824-2" class="line-number-anchor" /><a href="#line-number-95227b59d715a1f437aac83950916da9cdca5824-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-95227b59d715a1f437aac83950916da9cdca5824-3" class="line-number-anchor" /><a href="#line-number-95227b59d715a1f437aac83950916da9cdca5824-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-95227b59d715a1f437aac83950916da9cdca5824-4" class="line-number-anchor" /><a href="#line-number-95227b59d715a1f437aac83950916da9cdca5824-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-95227b59d715a1f437aac83950916da9cdca5824-5" class="line-number-anchor" /><a href="#line-number-95227b59d715a1f437aac83950916da9cdca5824-5">5</a></td></tr></table></div></code></pre>
<p>The default transaction isolation level of a
<code>Doctrine\DBAL\Connection</code> is chosen by the underlying platform
but it is always at least READ\_COMMITTED.</p>
<div class="section"><a class="section-anchor" id="transaction-nesting" name="transaction-nesting"></a><h2 class="section-header"><a href="#transaction-nesting">Transaction Nesting<i class="fas fa-link"></i></a></h2>
<p>A <code>Doctrine\DBAL\Connection</code> also adds support for nesting
transactions, or rather propagating transaction control up the call
stack. For that purpose, the <code>Connection</code> class keeps an internal
counter that represents the nesting level and is
increased/decreased as <code>beginTransaction()</code>, <code>commit()</code> and
 <code>rollback()</code> are invoked. <code>beginTransaction()</code> increases the
nesting level whilst
 <code>commit()</code> and <code>rollback()</code> decrease the nesting level. The nesting level starts at 0. Whenever the nesting level transitions from 0 to 1, <code>beginTransaction()</code> is invoked on the underlying driver connection and whenever the nesting level transitions from 1 to 0, <code>commit()</code> or <code>rollback()</code> is invoked on the underlying driver, depending on whether the transition was caused by <code>Connection#commit()</code> or <code>Connection#rollback()</code>.</p>
<p>What this means is that transaction control is basically passed to
code higher up in the call stack and the inner transaction block is
ignored, with one important exception that is described further
below. Do not confuse this with real nested transactions or
savepoints. These are not supported by Doctrine. There is always
only a single, real database transaction.</p>
<p>To visualize what this means in practice, consider the following
example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="512d4fe1e55edb7ea8d092a4377209d7f93a6cf3"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="512d4fe1e55edb7ea8d092a4377209d7f93a6cf3"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-1" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-1">1</a></td><td class="code-line" rowspan="26"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// $conn instanceof Doctrine\DBAL\Connection</span>
$conn-&gt;beginTransaction(); <span class="hljs-comment">// 0 =&gt; 1, "real" transaction started</span>
<span class="hljs-keyword">try</span> {

    ...

    <span class="hljs-comment">// nested transaction block, this might be in some other API/library code that is</span>
    <span class="hljs-comment">// unaware of the outer transaction.</span>
    $conn-&gt;beginTransaction(); <span class="hljs-comment">// 1 =&gt; 2</span>
    <span class="hljs-keyword">try</span> {
        ...

        $conn-&gt;commit(); <span class="hljs-comment">// 2 =&gt; 1</span>
    } <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">Exception</span> $e) {
        $conn-&gt;rollback(); <span class="hljs-comment">// 2 =&gt; 1, transaction marked for rollback only</span>
        <span class="hljs-keyword">throw</span> $e;
    }

    ...

    $conn-&gt;commit(); <span class="hljs-comment">// 1 =&gt; 0, "real" transaction committed</span>
} <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">Exception</span> $e) {
    $conn-&gt;rollback(); <span class="hljs-comment">// 1 =&gt; 0, "real" transaction rollback</span>
    <span class="hljs-keyword">throw</span> $e;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-2" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-3" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-4" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-5" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-6" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-7" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-8" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-9" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-10" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-11" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-12" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-13" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-14" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-15" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-16" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-17" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-18" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-18">18</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-19" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-19">19</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-20" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-20">20</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-21" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-21">21</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-22" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-22">22</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-23" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-23">23</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-24" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-24">24</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-25" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-25">25</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-26" class="line-number-anchor" /><a href="#line-number-512d4fe1e55edb7ea8d092a4377209d7f93a6cf3-26">26</a></td></tr></table></div></code></pre>
<p>However,
<strong>a rollback in a nested transaction block will always mark the current transaction so that the only possible outcome of the transaction is to be rolled back</strong>.
That means in the above example, the rollback in the inner
transaction block marks the whole transaction for rollback only.
Even if the nested transaction block would not rethrow the
exception, the transaction is marked for rollback only and the
commit of the outer transaction would trigger an exception, leading
to the final rollback. This also means that you can not
successfully commit some changes in an outer transaction if an
inner transaction block fails and issues a rollback, even if this
would be the desired behavior (i.e. because the nested operation is
optional for the purpose of the outer transaction block). To
achieve that, you need to restructure your application logic so as
to avoid nesting transaction blocks. If this is not possible
because the nested transaction blocks are in a third-party API
you're out of luck.</p>
<p>All that is guaruanteed to the inner transaction is that it still
happens atomically, all or nothing, the transaction just gets a
wider scope and the control is handed to the outer scope.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The transaction nesting described here is a debated
feature that has its critics. Form your own opinion. We recommend
avoiding nesting transaction blocks when possible, and most of the
time, it is possible. Transaction control should mostly be left to
a service layer and not be handled in data access objects or
similar.</p>
</td></tr></table></div>
<div class="alert warning-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-circle text-warning mr-2"></i></td><td><p>Directly invoking <code>PDO#beginTransaction()</code>,
<code>PDO#commit()</code> or <code>PDO#rollback()</code> or the corresponding methods
on the particular <code>Doctrine\DBAL\Driver\Connection</code> instance in
use bypasses the transparent transaction nesting that is provided
by <code>Doctrine\DBAL\Connection</code> and can therefore corrupt the
nesting level, causing errors with broken transaction boundaries
that may be hard to debug.</p>
</td></tr></table></div>

</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?161e55"
                            integrity="sha384-ZQ6qlvTBtfiU76YxxALyPv3/HvMipQbIgpk6risK+vIGd/IMwfA2/e+ztgwPiLOj"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'dbal';
            var versionSlug = '2.4';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search DBAL 2.4'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
