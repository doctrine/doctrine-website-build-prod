<!DOCTYPE html>
<html>
    <head>
        <title>        Testing Guidelines - Doctrine Database Abstraction Layer (DBAL)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Database Abstraction Layer Documentation: Testing Guidelines ">

        <meta name="keywords" content="                    abstraction,database,dbal,db2,mariadb,mssql,mysql,pgsql,postgresql,oci8,oracle,pdo,queryobject,sasql,sql,sqlite,sqlserver,sqlsrv,documentation,testing,guidelines
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-dbal/en/4.1/reference/testing.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?7ed5f2"
                        integrity="sha384-5tK8pAp+O7PVIamh2Zw0CvUiN8GqArCP7G+3+6DICtPdywmEVZnXjUOL5pJhstda"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-dbal/en/4.2/reference/testing.html" />
        <meta property="og:title" content="        Testing Guidelines - Doctrine Database Abstraction Layer (DBAL)
    " />
        <meta property="og:description" content="Doctrine Database Abstraction Layer Documentation: Testing Guidelines " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Database Abstraction Layer",
            "description": "Testing Guidelines",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/dbal/edit/4.2.x/docs/en/reference/testing.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc-section"><h2 class="toc-header">Reference</h2>
<div class="toc"><ul><li id="introduction-html" class="toc-item"><a href="introduction.html">Introduction</a></li><li id="architecture-html" class="toc-item"><a href="architecture.html">Architecture</a><ul><li id="architecture-html-drivers" class="toc-item"><a href="architecture.html#drivers">Drivers</a></li><li id="architecture-html-middlewares" class="toc-item"><a href="architecture.html#middlewares">Middlewares</a></li><li id="architecture-html-platforms" class="toc-item"><a href="architecture.html#platforms">Platforms</a></li><li id="architecture-html-logging" class="toc-item"><a href="architecture.html#logging">Logging</a></li><li id="architecture-html-schema" class="toc-item"><a href="architecture.html#schema">Schema</a></li><li id="architecture-html-types" class="toc-item"><a href="architecture.html#types">Types</a></li></ul></li><li id="configuration-html" class="toc-item"><a href="configuration.html">Configuration</a><ul><li id="configuration-html-getting-a-connection" class="toc-item"><a href="configuration.html#getting-a-connection">Getting a Connection</a><ul><li id="configuration-html-connecting-using-a-url" class="toc-item"><a href="configuration.html#connecting-using-a-url">Connecting using a URL</a></li><li id="configuration-html-driver" class="toc-item"><a href="configuration.html#driver">Driver</a></li><li id="configuration-html-wrapper-class" class="toc-item"><a href="configuration.html#wrapper-class">Wrapper Class</a></li><li id="configuration-html-connection-details" class="toc-item"><a href="configuration.html#connection-details">Connection Details</a></li><li id="configuration-html-automatic-platform-version-detection" class="toc-item"><a href="configuration.html#automatic-platform-version-detection">Automatic platform version detection</a></li><li id="configuration-html-custom-driver-options" class="toc-item"><a href="configuration.html#custom-driver-options">Custom Driver Options</a></li></ul></li></ul></li><li id="data-retrieval-and-manipulation-html" class="toc-item"><a href="data-retrieval-and-manipulation.html">Data Retrieval And Manipulation</a><ul><li id="data-retrieval-and-manipulation-html-data-retrieval" class="toc-item"><a href="data-retrieval-and-manipulation.html#data-retrieval">Data Retrieval</a><ul><li id="data-retrieval-and-manipulation-html-dynamic-parameters-and-prepared-statements" class="toc-item"><a href="data-retrieval-and-manipulation.html#dynamic-parameters-and-prepared-statements">Dynamic Parameters and Prepared Statements</a></li><li id="data-retrieval-and-manipulation-html-using-prepared-statements" class="toc-item"><a href="data-retrieval-and-manipulation.html#using-prepared-statements">Using Prepared Statements</a></li></ul></li><li id="data-retrieval-and-manipulation-html-binding-types" class="toc-item"><a href="data-retrieval-and-manipulation.html#binding-types">Binding Types</a><ul><li id="data-retrieval-and-manipulation-html-doctrinedbaltypes-conversion" class="toc-item"><a href="data-retrieval-and-manipulation.html#doctrinedbaltypes-conversion">DoctrineDBALTypes Conversion</a></li><li id="data-retrieval-and-manipulation-html-list-of-parameters-conversion" class="toc-item"><a href="data-retrieval-and-manipulation.html#list-of-parameters-conversion">List of Parameters Conversion</a></li></ul></li><li id="data-retrieval-and-manipulation-html-api" class="toc-item"><a href="data-retrieval-and-manipulation.html#api">API</a><ul><li id="data-retrieval-and-manipulation-html-prepare" class="toc-item"><a href="data-retrieval-and-manipulation.html#prepare">prepare()</a></li><li id="data-retrieval-and-manipulation-html-executestatement" class="toc-item"><a href="data-retrieval-and-manipulation.html#executestatement">executeStatement()</a></li><li id="data-retrieval-and-manipulation-html-executequery" class="toc-item"><a href="data-retrieval-and-manipulation.html#executequery">executeQuery()</a></li><li id="data-retrieval-and-manipulation-html-fetchallassociative" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchallassociative">fetchAllAssociative()</a></li><li id="data-retrieval-and-manipulation-html-fetchallkeyvalue" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchallkeyvalue">fetchAllKeyValue()</a></li><li id="data-retrieval-and-manipulation-html-fetchallassociativeindexed" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchallassociativeindexed">fetchAllAssociativeIndexed()</a></li><li id="data-retrieval-and-manipulation-html-fetchnumeric" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchnumeric">fetchNumeric()</a></li><li id="data-retrieval-and-manipulation-html-fetchone" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchone">fetchOne()</a></li><li id="data-retrieval-and-manipulation-html-fetchassociative" class="toc-item"><a href="data-retrieval-and-manipulation.html#fetchassociative">fetchAssociative()</a></li><li id="data-retrieval-and-manipulation-html-iteratekeyvalue" class="toc-item"><a href="data-retrieval-and-manipulation.html#iteratekeyvalue">iterateKeyValue()</a></li><li id="data-retrieval-and-manipulation-html-iterateassociativeindexed" class="toc-item"><a href="data-retrieval-and-manipulation.html#iterateassociativeindexed">iterateAssociativeIndexed()</a></li><li id="data-retrieval-and-manipulation-html-delete" class="toc-item"><a href="data-retrieval-and-manipulation.html#delete">delete()</a></li><li id="data-retrieval-and-manipulation-html-insert" class="toc-item"><a href="data-retrieval-and-manipulation.html#insert">insert()</a></li><li id="data-retrieval-and-manipulation-html-update" class="toc-item"><a href="data-retrieval-and-manipulation.html#update">update()</a></li></ul></li></ul></li><li id="query-builder-html" class="toc-item"><a href="query-builder.html">SQL Query Builder</a><ul><li id="query-builder-html-security-safely-preventing-sql-injection" class="toc-item"><a href="query-builder.html#security-safely-preventing-sql-injection">Security: Safely preventing SQL Injection</a></li><li id="query-builder-html-building-a-query" class="toc-item"><a href="query-builder.html#building-a-query">Building a Query</a><ul><li id="query-builder-html-distinct-clause" class="toc-item"><a href="query-builder.html#distinct-clause">DISTINCT-Clause</a></li><li id="query-builder-html-where-clause" class="toc-item"><a href="query-builder.html#where-clause">WHERE-Clause</a></li><li id="query-builder-html-table-alias" class="toc-item"><a href="query-builder.html#table-alias">Table alias</a></li><li id="query-builder-html-group-by-and-having-clause" class="toc-item"><a href="query-builder.html#group-by-and-having-clause">GROUP BY and HAVING Clause</a></li><li id="query-builder-html-join-clauses" class="toc-item"><a href="query-builder.html#join-clauses">Join Clauses</a></li><li id="query-builder-html-order-by-clause" class="toc-item"><a href="query-builder.html#order-by-clause">Order-By Clause</a></li><li id="query-builder-html-limit-clause" class="toc-item"><a href="query-builder.html#limit-clause">Limit Clause</a></li><li id="query-builder-html-values-clause" class="toc-item"><a href="query-builder.html#values-clause">VALUES Clause</a></li><li id="query-builder-html-set-clause" class="toc-item"><a href="query-builder.html#set-clause">Set Clause</a></li><li id="query-builder-html-union-clause" class="toc-item"><a href="query-builder.html#union-clause">UNION-Clause</a></li></ul></li><li id="query-builder-html-building-expressions" class="toc-item"><a href="query-builder.html#building-expressions">Building Expressions</a></li><li id="query-builder-html-binding-parameters-to-placeholders" class="toc-item"><a href="query-builder.html#binding-parameters-to-placeholders">Binding Parameters to Placeholders</a></li><li id="query-builder-html-caching" class="toc-item"><a href="query-builder.html#caching">Caching</a></li></ul></li><li id="transactions-html" class="toc-item"><a href="transactions.html">Transactions</a><ul><li id="transactions-html-transaction-nesting" class="toc-item"><a href="transactions.html#transaction-nesting">Transaction Nesting</a></li><li id="transactions-html-auto-commit-mode" class="toc-item"><a href="transactions.html#auto-commit-mode">Auto-commit mode</a></li><li id="transactions-html-error-handling" class="toc-item"><a href="transactions.html#error-handling">Error handling</a></li></ul></li><li id="platforms-html" class="toc-item"><a href="platforms.html">Platforms</a><ul><li id="platforms-html-mysql" class="toc-item"><a href="platforms.html#mysql">MySQL</a></li><li id="platforms-html-mariadb" class="toc-item"><a href="platforms.html#mariadb">MariaDB</a></li><li id="platforms-html-oracle" class="toc-item"><a href="platforms.html#oracle">Oracle</a></li><li id="platforms-html-microsoft-sql-server" class="toc-item"><a href="platforms.html#microsoft-sql-server">Microsoft SQL Server</a></li><li id="platforms-html-postgresql" class="toc-item"><a href="platforms.html#postgresql">PostgreSQL</a></li><li id="platforms-html-ibm-db2" class="toc-item"><a href="platforms.html#ibm-db2">IBM DB2</a></li><li id="platforms-html-sqlite" class="toc-item"><a href="platforms.html#sqlite">SQLite</a></li></ul></li><li id="types-html" class="toc-item"><a href="types.html">Types</a><ul><li id="types-html-reference" class="toc-item"><a href="types.html#reference">Reference</a><ul><li id="types-html-numeric-types" class="toc-item"><a href="types.html#numeric-types">Numeric types</a></li><li id="types-html-string-types" class="toc-item"><a href="types.html#string-types">String types</a></li><li id="types-html-bit-types" class="toc-item"><a href="types.html#bit-types">Bit types</a></li><li id="types-html-date-and-time-types" class="toc-item"><a href="types.html#date-and-time-types">Date and time types</a></li><li id="types-html-array-types" class="toc-item"><a href="types.html#array-types">Array types</a></li><li id="types-html-object-types" class="toc-item"><a href="types.html#object-types">Object types</a></li></ul></li><li id="types-html-mapping-matrix" class="toc-item"><a href="types.html#mapping-matrix">Mapping Matrix</a></li><li id="types-html-detection-of-database-types" class="toc-item"><a href="types.html#detection-of-database-types">Detection of Database Types</a></li><li id="types-html-custom-mapping-types" class="toc-item"><a href="types.html#custom-mapping-types">Custom Mapping Types</a></li></ul></li><li id="schema-manager-html" class="toc-item"><a href="schema-manager.html">Schema-Manager</a><ul><li id="schema-manager-html-listdatabases" class="toc-item"><a href="schema-manager.html#listdatabases">listDatabases()</a></li><li id="schema-manager-html-listsequences" class="toc-item"><a href="schema-manager.html#listsequences">listSequences()</a></li><li id="schema-manager-html-listtablecolumns" class="toc-item"><a href="schema-manager.html#listtablecolumns">listTableColumns()</a></li><li id="schema-manager-html-introspecttable" class="toc-item"><a href="schema-manager.html#introspecttable">introspectTable()</a></li><li id="schema-manager-html-listtableforeignkeys" class="toc-item"><a href="schema-manager.html#listtableforeignkeys">listTableForeignKeys()</a></li><li id="schema-manager-html-listtableindexes" class="toc-item"><a href="schema-manager.html#listtableindexes">listTableIndexes()</a></li><li id="schema-manager-html-listtables" class="toc-item"><a href="schema-manager.html#listtables">listTables()</a></li><li id="schema-manager-html-listviews" class="toc-item"><a href="schema-manager.html#listviews">listViews()</a></li><li id="schema-manager-html-introspectschema" class="toc-item"><a href="schema-manager.html#introspectschema">introspectSchema()</a></li><li id="schema-manager-html-overriding-the-schema-manager" class="toc-item"><a href="schema-manager.html#overriding-the-schema-manager">Overriding the schema manager</a></li></ul></li><li id="schema-representation-html" class="toc-item"><a href="schema-representation.html">Schema-Representation</a><ul><li id="schema-representation-html-schema-assets" class="toc-item"><a href="schema-representation.html#schema-assets">Schema Assets</a><ul><li id="schema-representation-html-table" class="toc-item"><a href="schema-representation.html#table">Table</a></li><li id="schema-representation-html-column" class="toc-item"><a href="schema-representation.html#column">Column</a></li></ul></li></ul></li><li id="security-html" class="toc-item"><a href="security.html">Security</a><ul><li id="security-html-sql-injection-safe-and-unsafe-apis-for-user-input" class="toc-item"><a href="security.html#sql-injection-safe-and-unsafe-apis-for-user-input">SQL Injection: Safe and Unsafe APIs for User Input</a></li><li id="security-html-user-input-in-your-queries" class="toc-item"><a href="security.html#user-input-in-your-queries">User input in your queries</a><ul><li id="security-html-wrong-string-concatenation" class="toc-item"><a href="security.html#wrong-string-concatenation">Wrong: String Concatenation</a></li><li id="security-html-right-prepared-statements" class="toc-item"><a href="security.html#right-prepared-statements">Right: Prepared Statements</a></li><li id="security-html-discouraged-quoting-escaping-values" class="toc-item"><a href="security.html#discouraged-quoting-escaping-values">Discouraged: Quoting/Escaping values</a></li></ul></li></ul></li><li id="supporting-other-databases-html" class="toc-item"><a href="supporting-other-databases.html">Supporting Other Databases</a><ul><li id="supporting-other-databases-html-implementation-steps-in-detail" class="toc-item"><a href="supporting-other-databases.html#implementation-steps-in-detail">Implementation Steps in Detail</a></li></ul></li><li id="portability-html" class="toc-item"><a href="portability.html">Portability</a><ul><li id="portability-html-connection-wrapper" class="toc-item"><a href="portability.html#connection-wrapper">Connection Wrapper</a></li><li id="portability-html-database-platform" class="toc-item"><a href="portability.html#database-platform">Database Platform</a></li><li id="portability-html-keyword-lists" class="toc-item"><a href="portability.html#keyword-lists">Keyword Lists</a></li></ul></li><li id="caching-html" class="toc-item"><a href="caching.html">Caching</a><ul><li id="caching-html-configuring-the-result-cache" class="toc-item"><a href="caching.html#configuring-the-result-cache">Configuring the result cache</a></li><li id="caching-html-providing-a-cache-profile" class="toc-item"><a href="caching.html#providing-a-cache-profile">Providing a cache profile</a></li></ul></li><li id="known-vendor-issues-html" class="toc-item"><a href="known-vendor-issues.html">Known Vendor Issues</a><ul><li id="known-vendor-issues-html-postgresql" class="toc-item"><a href="known-vendor-issues.html#postgresql">PostgreSQL</a><ul><li id="known-vendor-issues-html-datetime-datetimetz-and-time-types" class="toc-item"><a href="known-vendor-issues.html#datetime-datetimetz-and-time-types">DateTime, DateTimeTz and Time Types</a></li><li id="known-vendor-issues-html-timezones-and-datetimetz" class="toc-item"><a href="known-vendor-issues.html#timezones-and-datetimetz">Timezones and DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-mysql" class="toc-item"><a href="known-vendor-issues.html#mysql">MySQL</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-mariadb" class="toc-item"><a href="known-vendor-issues.html#mariadb">MariaDB</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-sqlite" class="toc-item"><a href="known-vendor-issues.html#sqlite">Sqlite</a><ul><li id="known-vendor-issues-html-buffered-queries-and-isolation" class="toc-item"><a href="known-vendor-issues.html#buffered-queries-and-isolation">Buffered Queries and Isolation</a></li><li id="known-vendor-issues-html-datetime" class="toc-item"><a href="known-vendor-issues.html#datetime">DateTime</a></li><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li><li id="known-vendor-issues-html-reverse-engineering-primary-key-order" class="toc-item"><a href="known-vendor-issues.html#reverse-engineering-primary-key-order">Reverse engineering primary key order</a></li></ul></li><li id="known-vendor-issues-html-ibm-db2" class="toc-item"><a href="known-vendor-issues.html#ibm-db2">IBM DB2</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li></ul></li><li id="known-vendor-issues-html-oracle" class="toc-item"><a href="known-vendor-issues.html#oracle">Oracle</a><ul><li id="known-vendor-issues-html-datetimetz" class="toc-item"><a href="known-vendor-issues.html#datetimetz">DateTimeTz</a></li><li id="known-vendor-issues-html-oci-lob-instances" class="toc-item"><a href="known-vendor-issues.html#oci-lob-instances">OCI-LOB instances</a></li></ul></li><li id="known-vendor-issues-html-microsoft-sql-server" class="toc-item"><a href="known-vendor-issues.html#microsoft-sql-server">Microsoft SQL Server</a><ul><li id="known-vendor-issues-html-unique-and-null" class="toc-item"><a href="known-vendor-issues.html#unique-and-null">Unique and NULL</a></li><li id="known-vendor-issues-html-datetime-datetimetz-and-time-types" class="toc-item"><a href="known-vendor-issues.html#datetime-datetimetz-and-time-types">DateTime, DateTimeTz and Time Types</a></li></ul></li></ul></li><li id="testing-html-testing-guidelines" class="toc-item"><a href="testing.html#testing-guidelines">Testing Guidelines</a><ul><li id="testing-html-requirements" class="toc-item"><a href="testing.html#requirements">Requirements</a></li><li id="testing-html-types-of-tests" class="toc-item"><a href="testing.html#types-of-tests">Types of Tests</a><ul><li id="testing-html-unit-tests" class="toc-item"><a href="testing.html#unit-tests">Unit Tests</a></li><li id="testing-html-integration-tests" class="toc-item"><a href="testing.html#integration-tests">Integration Tests</a></li><li id="testing-html-recommendations-on-writing-tests" class="toc-item"><a href="testing.html#recommendations-on-writing-tests">Recommendations on Writing Tests</a></li></ul></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Explanation</h2>
<div class="toc"><ul><li id="explanation-implicit-indexes-html" class="toc-item"><a href="../explanation/implicit-indexes.html">Implicit indexes</a></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">How To</h2>
<div class="toc"><ul><li id="how-to-postgresql-identity-migration-html" class="toc-item"><a href="../how-to/postgresql-identity-migration.html">Migration to identity columns on PostgreSQL</a></li></ul></div>
</div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "DBAL",
            "item": "https://www.doctrine-project.org/projects/dbal.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-dbal/en/4.2/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Testing Guidelines",
            "item": "https://www.doctrine-project.org/projects/doctrine-dbal/en/4.2/reference/testing.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/dbal.html">DBAL</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-dbal/en/4.2/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Testing Guidelines</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that has not yet been released.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-dbal/en/4.2/reference/testing.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        4.2
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/latest/reference/testing.html">
                                                        5.0

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-dbal/en/4.2/reference/testing.html">
                                                        4.2

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/4.1/reference/testing.html">
                                                        4.1.0

                                                                                                                    (current)
                                                        
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-dbal/en/3.9/reference/testing.html">
                                                        3.9.0

                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/4.0/reference/testing.html">4.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.8/reference/testing.html">3.8</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.7/reference/testing.html">3.7</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.6/reference/testing.html">3.6</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.5/reference/testing.html">3.5</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.4/reference/testing.html">3.4</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.3/reference/testing.html">3.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.2/reference/testing.html">3.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.1/reference/testing.html">3.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-dbal/en/3.0/reference/testing.html">3.0</a>
                                                                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="testing-guidelines" name="testing-guidelines"></a><h1 class="section-header"><a href="#testing-guidelines">Testing Guidelines<i class="fas fa-link"></i></a></h1>
<p>To ensure high quality, all components of the Doctrine DBAL library are extensively covered with tests.</p>
<p>Having the code covered with tests and running all tests against each individual code change helps prevent
breakages of the library logic when its code changes.</p>
<p>Additionally, when code changes are accompanied by new tests, the tests:</p>
<ol class="arabic">
    <li>Help understand what problem the given code change is trying to solve.</li>
<li>Make sure that the problem being solved needs to be solved in the DBAL.</li>
<li>Document the proper usage of the DBAL APIs.</li>
</ol>
<div class="section"><a class="section-anchor" id="requirements" name="requirements"></a><h2 class="section-header"><a href="#requirements">Requirements<i class="fas fa-link"></i></a></h2>
<ol class="arabic">
    <li><p>Each pull request that adds new or changes the existing logic must have tests.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Modifications to the keyword lists under the <code>Doctrine\DBAL\Platforms\Keywords</code> namespace
don't have to be covered with tests.</p>
</td></tr></table></div></li>
<li>The test that covers certain logic must fail without this logic implemented.</li>
</ol>
</div>
<div class="section"><a class="section-anchor" id="types-of-tests" name="types-of-tests"></a><h2 class="section-header"><a href="#types-of-tests">Types of Tests<i class="fas fa-link"></i></a></h2>
<p>Doctrine DBAL primarily uses unit and integration tests.</p>
<div class="section"><a class="section-anchor" id="unit-tests" name="unit-tests"></a><h3 class="section-header"><a href="#unit-tests">Unit Tests<i class="fas fa-link"></i></a></h3>
<p>Unit tests are meant to cover the logic of a given unit (e.g. a class or a method) including the logic
of its interaction with other units. In this case, the other units could be mocked.</p>
<p>Unit tests are most welcomed for testing the logic that the DBAL itself defines (e.g. logging, caching, data types).</p>
<p>In this case, the DBAL is the source of truth about what this logic is and the test plays the role of its description.</p>
</div>
<div class="section"><a class="section-anchor" id="integration-tests" name="integration-tests"></a><h3 class="section-header"><a href="#integration-tests">Integration Tests<i class="fas fa-link"></i></a></h3>
<p>Integration (a.k.a. functional) tests are required when the behavior under test is dictated by the logic
defined outside of the DBAL. It could be:</p>
<ul>
    <li class="dash">The underlying database platform.</li>
<li class="dash">The underlying database driver.</li>
<li class="dash">SQL syntax and the standard as such.</li>
</ul>
<p>It is important to have integration tests for the cases above. Unlike unit tests, they make the external components
the source of truth and help make sure that the logic implemented in the DBAL is correct even if the external components
change (e.g. a new version of a database platform is supported).</p>
<div class="section"><a class="section-anchor" id="when-are-integration-tests-not-required" name="when-are-integration-tests-not-required"></a><h4 class="section-header"><a href="#when-are-integration-tests-not-required">When are Integration Tests not Required?<i class="fas fa-link"></i></a></h4>
<p>Some cases cannot be reproduced with the existing integration testing suite. It could be the scenarios that involve
multiple concurrent database connections, transactions, locking, performance-related issues, etc.</p>
<p>In such cases, it is still important that a pull request fixing the issues is accompanied by a free-form reproducer
that demonstrates the issue being fixed.</p>
</div>
<div class="section"><a class="section-anchor" id="running-integration-tests-locally" name="running-integration-tests-locally"></a><h4 class="section-header"><a href="#running-integration-tests-locally">Running Integration Tests locally<i class="fas fa-link"></i></a></h4>
<p>The default <code>phpunit.xml.dist</code> configuration file is set up to run the
integration tests against SQLite, but you need to enable the extension
<code>pdo_sqlite</code> in your PHP configuration.</p>
<p>To run the integration tests against another platform, you can use one
of the configuration files used in our continuous integration setup.
Those are stored under <code>ci/github/</code>.</p>
<p>For instance, to run tests against MySQL using the PDO driver, you
should spin up a MySQL server, enable the <code>pdo_mysql</code> extension, and
then run the following command:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>phpunit -c ci/github/pdo_mysql.xml</code></pre></div>
<p>We do not currently have specific instructions on how to run a Database
server, but we do recommend Docker as a convenient way to do so.
We do not recommend running against a particular version of the chosen
RDBMS either, as long as you pick one of the
<a href="platforms.html">officially supported versions</a>.</p>
</div>
</div>
<div class="section"><a class="section-anchor" id="recommendations-on-writing-tests" name="recommendations-on-writing-tests"></a><h3 class="section-header"><a href="#recommendations-on-writing-tests">Recommendations on Writing Tests<i class="fas fa-link"></i></a></h3>
<p>Tests in Doctrine DBAL are located under the <code>tests</code> directory and implemented on top of PHPUnit. Use its
<a href="https://phpunit.de/documentation.html">documentation</a> to get started.</p>
<div class="section"><a class="section-anchor" id="writing-integration-tests" name="writing-integration-tests"></a><h4 class="section-header"><a href="#writing-integration-tests">Writing Integration Tests<i class="fas fa-link"></i></a></h4>
<p>Integration tests are located under the <code>tests/Doctrine/Tests/DBAL/Functional</code> directory. Unlike unit tests,
they require a real database connection to test their logic against.</p>
<p>It is recommended to use <code>Doctrine\DBAL\Tests\FunctionalTestCase</code> as the base class for integration tests.
Based on the configuration, it will automatically create and connect to the test database.</p>
<div class="section"><a class="section-anchor" id="data-fixtures-in-integration-tests" name="data-fixtures-in-integration-tests"></a><h5 class="section-header"><a href="#data-fixtures-in-integration-tests">Data Fixtures in Integration Tests<i class="fas fa-link"></i></a></h5>
<p>To test selecting and fetching data from the database, the test may create the necessary schema and populate it
with the test data. To create database tables, instead of checking if the table exists and reusing it,
it is recommended to use <code>FunctionalTestCase::dropAndCreateTable()</code>. This way, the table will be dropped and created every time
providing better isolation between the test runs.</p>
</div>
</div>
<div class="section"><a class="section-anchor" id="testing-different-database-platforms" name="testing-different-database-platforms"></a><h4 class="section-header"><a href="#testing-different-database-platforms">Testing Different Database Platforms<i class="fas fa-link"></i></a></h4>
<p>Although most of the issues are originally discovered on a specific database platform,
the integration tests for all issues should be implemented by default at the database abstraction level
and run against all the platforms that support the API being tested.</p>
<p>This allows us to ensure that the same scenario that was found failing on one platform also works on others. Or otherwise,
the same issue could be reproduced on the platforms where it wasn't originally tested.</p>
<p>If the newly added test fails on other platforms, and fixing it is out of the scope, the test can be explicitly marked
as incomplete which will identify the issue.</p>
<p>Examples of such tests could be found under the <code>Doctrine\DBAL\Tests\Functional\Platform</code> namespace.</p>
</div>
<div class="section"><a class="section-anchor" id="using-unit-and-integration-tests-together" name="using-unit-and-integration-tests-together"></a><h4 class="section-header"><a href="#using-unit-and-integration-tests-together">Using Unit and Integration Tests Together<i class="fas fa-link"></i></a></h4>
<p>For example, the <code>AbstractPlatform::modifyLimitQuery()</code> method has both unit and integration tests.</p>
<ol class="arabic">
    <li>Unit test cases for each platform (<code>Doctrine\DBAL\Tests\Platforms\*PlatformTest</code>) have a test that calls
<code>$platform-&gt;modifyLimitQuery()</code> and asserts that the resulting SQL looks as expected.
These tests cannot guarantee that the generated SQL is valid syntactically and semantically but they guarantee
that the code works as designed. They provide fast feedback because they don't require a database connection
and can test all platforms in a single test suite run.</li>
<li>There is an integration test <code>Doctrine\DBAL\Tests\Functional\ModifyLimitQueryTest</code> which calls
<code>$platform-&gt;modifyLimitQuery()</code> and executes the generated queries on a real database to which the test suite
is connected. This test guarantees that the generated queries are valid but it's much slower and works
only with one database at a time.</li>
</ol>
<p>As you can see, both approaches have their strengths and weaknesses and can complement each other.</p>
<div class="alert warning-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-circle text-warning mr-2"></i></td><td><p>Do not mix the unit and the integration approaches in one test. Each of the approaches has its area of application
and purpose. Mixing them makes it harder to identify the reason and the impact of a failing mixed-type test.</p>
</td></tr></table></div>

</div>
</div>
</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?5364f3"
                            integrity="sha384-yT1xut8dmITuccyh+MOljcF0MzMJFhaP227UZREURvpogyieLsqm9J/duGcSbb6q"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'dbal';
            var versionSlug = '4.2';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search DBAL 4.2'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
