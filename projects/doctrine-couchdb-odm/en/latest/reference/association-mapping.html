<!DOCTYPE html>
<html>
    <head>
        <title>        Association Mapping - Doctrine CouchDB Object Document Mapper (CouchDB ODM)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine CouchDB Object Document Mapper Documentation: Association Mapping ">

        <meta name="keywords" content="                    persistence,couchdb,odm,data,mapper,mapping,object,documentation,association,mapping
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/association-mapping.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?e935b6"
                        integrity="sha384-0+XwQ7PUNkbj10v4XDjjp7VJzfahtyhEtNyFDNmWQaR7ohGXNow7qYgClWx6rQoS"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/association-mapping.html" />
        <meta property="og:title" content="        Association Mapping - Doctrine CouchDB Object Document Mapper (CouchDB ODM)
    " />
        <meta property="og:description" content="Doctrine CouchDB Object Document Mapper Documentation: Association Mapping " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine CouchDB Object Document Mapper",
            "description": "Association Mapping",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/couchdb-odm/edit/master/docs/en/reference/association-mapping.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        

            <div class="toc">
    <ul class="menu-level">
    <li class="toc-item opened">
    <a href="#association-mapping">Association Mapping</a>

        <ul class="section-level-1 opened-ul ">
            <li class="toc-item">
    <a href="#graph-traversal-and-identity-map">Graph Traversal and Identity Map</a>


</li>
            <li class="toc-item">
    <a href="#different-association-mappings">Different Association Mappings</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="#referenceone">ReferenceOne</a>


</li>
            <li class="toc-item">
    <a href="#referencemany">ReferenceMany</a>


</li>
            <li class="toc-item">
    <a href="#inverse-referencemany">Inverse ReferenceMany</a>


</li>
            <li class="toc-item">
    <a href="#embedone">EmbedOne</a>


</li>
            <li class="toc-item">
    <a href="#embedmany">EmbedMany</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="attachments.html#attachments">Attachments</a>


</li>
    <li class="toc-item">
    <a href="basic-mapping.html#basic-mapping">Basic Mapping</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="basic-mapping.html#introduction-to-docblock-annotations">Introduction to Docblock Annotations</a>


</li>
            <li class="toc-item">
    <a href="basic-mapping.html#persistent-classes">Persistent classes</a>


</li>
            <li class="toc-item">
    <a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a>


</li>
            <li class="toc-item">
    <a href="basic-mapping.html#field-mapping">Field Mapping</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="basic-mapping.html#indexing-fields">Indexing Fields</a>


</li>
            <li class="toc-item">
    <a href="basic-mapping.html#json-names">Json Names</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="basic-mapping.html#id-mapping">Id Mapping</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="basic-mapping.html#id-generation-strategies">Id Generation Strategies</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="basic-mapping.html#attachments">Attachments</a>


</li>
            <li class="toc-item">
    <a href="basic-mapping.html#document-repositories">Document Repositories</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="configuration.html#configuration">Configuration</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="configuration.html#obtaining-the-documentmanager">Obtaining the DocumentManager</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#couchdbclient">CouchDBClient</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#http-client-required">HTTP Client (*REQUIRED*)</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="configuration.html#configuration-options">Configuration Options</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#proxy-directory-required">Proxy Directory (*REQUIRED*)</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#proxy-namespace-optional">Proxy Namespace (*OPTIONAL*)</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#metadata-driver-required">Metadata Driver (*REQUIRED*)</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#metadata-cache-recommended">Metadata Cache (*RECOMMENDED*)</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#lucene-handler-name-optional">Lucene Handler Name (*OPTIONAL*)</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="configuration.html#proxy-objects">Proxy Objects</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#reference-proxies">Reference Proxies</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#association-proxies">Association proxies</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="inheritance-mapping.html#inheritance-mapping">Inheritance Mapping</a>


</li>
    <li class="toc-item">
    <a href="installation.html#installation">Installation</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="installation.html#pear">PEAR</a>


</li>
            <li class="toc-item">
    <a href="installation.html#download">Download</a>


</li>
            <li class="toc-item">
    <a href="installation.html#git-github">Git/Github</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="introduction.html#introduction">Introduction</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="introduction.html#features">Features</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#architecture">Architecture</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="introduction.html#write-behind">Write-Behind</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#querying">Querying</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#object-graph-traversal">Object-Graph Traversal</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="introduction.html#why-nosql">Why NoSQL?</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#couchdb-document-structure">CouchDB Document Structure</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="introduction.html#document-type">Document Type</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#associations">Associations</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#indexes">Indexes</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="lucene-queries.html#couchdb-lucene-queries">CouchDB Lucene Queries</a>


</li>
    <li class="toc-item">
    <a href="map-reduce-queries.html#views-and-map-reduce-queries">Views and Map-Reduce Queries</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="map-reduce-queries.html#creating-and-managing-views">Creating and Managing Views</a>


</li>
            <li class="toc-item">
    <a href="map-reduce-queries.html#querying-views">Querying Views</a>


</li>
            <li class="toc-item">
    <a href="map-reduce-queries.html#view-results">View Results</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="tools.html#tools-and-maintenance">Tools and Maintenance</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="tools.html#couchdb-migrate">couchdb:migrate</a>


</li>
            <li class="toc-item">
    <a href="tools.html#couchdb-maintenance-compact-database">couchdb:maintenance:compact-database</a>


</li>
            <li class="toc-item">
    <a href="tools.html#couchdb-maintenance-compact-view">couchdb:maintenance:compact-view</a>


</li>
            <li class="toc-item">
    <a href="tools.html#couchdb-maintenance-view-cleanup">couchdb:maintenance:view-cleanup</a>


</li>
            <li class="toc-item">
    <a href="tools.html#couchdb-odm-update-design-doc">couchdb:odm:update-design-doc</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="working-with-objects.html#working-with-objects">Working with Objects</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="working-with-objects.html#understanding">Understanding</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#the-cost-of-flush">The cost of flush()</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="working-with-objects.html#persisting-documents">Persisting documents</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#removing-documents">Removing documents</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#detaching-documents">Detaching documents</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#merging-documents">Merging documents</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#references">References</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#establishing-references">Establishing References</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#removing-references">Removing References</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#transitive-persistence">Transitive persistence</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#querying">Querying</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="working-with-objects.html#by-primary-key">By Primary Key</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#by-query-objects">By Query Objects</a>


</li>
            <li class="toc-item">
    <a href="working-with-objects.html#custom-repositories">Custom Repositories</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    </ul>
</div>
    

                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "CouchDB ODM",
            "item": "https://www.doctrine-project.org/projects/couchdb-odm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Association Mapping",
            "item": "https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/association-mapping.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/couchdb-odm.html">CouchDB ODM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Association Mapping</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>This project is not being actively maintained. If you are interested in helping to maintain this project, take a look at the open issues on <a href="https://github.com/doctrine/couchdb-odm/" target="_blank" rel="noopener noreferrer">GitHub</a> and submit pull requests.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-couchdb-odm/en/latest/reference/association-mapping.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        master
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-couchdb-odm/en/latest/reference/association-mapping.html">
                                                        master

                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                                                                                    </div>
                                </div>
                            
                            

            <div class="section" id="association-mapping">
            <h1 class="section-header ">
    <a href="#association-mapping">
        Association Mapping
        <i class="fas fa-link"></i>
    </a>
</h1>
            <div class="section" id="graph-traversal-and-identity-map">
            <h2 class="section-header ">
    <a href="#graph-traversal-and-identity-map">
        Graph Traversal and Identity Map
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>Doctrine CouchDB offers you a fluent experience with your CouchDB documents. All relationships are fully
traversable through lazy loading. You essentially need to query only one document explicitly and can
then access all the others that are related by traversing the references in the objects.</p>

            
    <p>A document manager contains an identity map, it will never return you different instances of PHP objects
for the document with the same ID.</p>

    </div>
            <div class="section" id="different-association-mappings">
            <h2 class="section-header ">
    <a href="#different-association-mappings">
        Different Association Mappings
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>Doctrine CouchDB offers several different mechanisms to manage relations between documents:</p>

            

<ul>
    <li class="dash">Reference one document through its document-id</li>
    <li class="dash">Reference many documents by saving all the document-ids in an array</li>
    <li class="dash">Finding all documents that have a reference many relationship to the current document (inverse reference many/one)</li>
    <li class="dash">Embedding a single document</li>
    <li class="dash">Embedding an array of documents</li>
</ul>

            <div class="section" id="referenceone">
            <h3 class="section-header ">
    <a href="#referenceone">
        ReferenceOne
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>You can have a reference between two documents by a reference one relationship in the following way:</p>

                <pre class="code-block-table" id="2854885b49c8e4010e0138a02d45ae8bd269962d"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="2854885b49c8e4010e0138a02d45ae8bd269962d"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span></code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Article</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $id;</code><code class="line language-php"></code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@ReferenceOne</span>(targetDocument="User") */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $author;</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>This mapping definition would save the author id or null in the CouchDB document but let
you work with a Author object in PHP.</p>

            
    <p>In CouchDB two documents with this relationship will look like:</p>

                <pre class="code-block-table" id="0e7385921b05780211a2754ae129d152bbcfd3cd"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="0e7385921b05780211a2754ae129d152bbcfd3cd"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"1234"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"doctrine_metadata"</span>:</code><code class="line language-javascript">    {</code><code class="line language-javascript">        <span class="hljs-string">"associations"</span>:</code><code class="line language-javascript">        {</code><code class="line language-javascript">            <span class="hljs-string">"author"</span>: <span class="hljs-string">"54321"</span></code><code class="line language-javascript">        }</code><code class="line language-javascript">    },</code><code class="line language-javascript">    <span class="hljs-string">"title"</span>: <span class="hljs-string">"An article"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Article"</span></code><code class="line language-javascript">}</code><code class="line language-javascript"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"54321"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Benjamin"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"User"</span></code><code class="line language-javascript">}</code><code class="empty"></code></pre>
    </div>
            <div class="section" id="referencemany">
            <h3 class="section-header ">
    <a href="#referencemany">
        ReferenceMany
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>You can have a reference between a document and a set of related documents in the following way</p>

                <pre class="code-block-table" id="01b52391819433002b4c81c49175d270d6d91023"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="01b52391819433002b4c81c49175d270d6d91023"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-comment">/**</span></code><code class="line language-php"> * @Document</code><code class="line language-php"> */</code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Article</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $id;</code><code class="line language-php"></code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@ReferenceMany</span>(targetDocument="Comment") */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $comments;</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>This mapping definition will save an array of comment ids in every article document and
will present you with a <code>Doctrine\Common\Collections\Collection</code> containing Comment instances
in PHP.</p>

            
    <p>In CouchDB documents with this relationship will look like:</p>

                <pre class="code-block-table" id="0c4f86f62257789fc2233099487a0670e7df804c"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="0c4f86f62257789fc2233099487a0670e7df804c"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"1234"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"comments"</span>: [<span class="hljs-string">"55555"</span>, <span class="hljs-string">"44444"</span>],</code><code class="line language-javascript">    <span class="hljs-string">"doctrine_metadata"</span>:</code><code class="line language-javascript">    {</code><code class="line language-javascript">        <span class="hljs-string">"associations"</span>: [<span class="hljs-string">"comments"</span>]</code><code class="line language-javascript">    },</code><code class="line language-javascript">    <span class="hljs-string">"title"</span>: <span class="hljs-string">"An article"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Article"</span></code><code class="line language-javascript">}</code><code class="line language-javascript"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"55555"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"text"</span>: <span class="hljs-string">"Thank you!"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Comment"</span></code><code class="line language-javascript">}</code><code class="line language-javascript"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"44444"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"text"</span>: <span class="hljs-string">"Very informative!"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Comment"</span></code><code class="line language-javascript">}</code><code class="empty"></code></pre>
    </div>
            <div class="section" id="inverse-referencemany">
            <h3 class="section-header ">
    <a href="#inverse-referencemany">
        Inverse ReferenceMany
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>You can define the inverse side of a reference one or reference many association, which will
use a view to access which owning side documents point to the current document by holding
a reference to their id:</p>

                <pre class="code-block-table" id="aa5450640959a41732a194a307d58b086a36064f"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="aa5450640959a41732a194a307d58b086a36064f"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span></code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $id;</code><code class="line language-php"></code><code class="line language-php">    <span class="hljs-comment">/**</span></code><code class="line language-php">     * @ReferenceMany(targetDocument=<span class="hljs-string">"Article"</span>, mappedBy=<span class="hljs-string">"author"</span>)</code><code class="line language-php">     */</code><code class="line language-php">    <span class="hljs-keyword">private</span> $articles;</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>See the difference between the previous reference many definition by using the mappedBy attribute.
This specifies which association on the target document contains the id reference.</p>

            
    <p>In CouchDB documents with this relationship will look like:</p>

                <pre class="code-block-table" id="68560204a01d10b2300e015f2b4f85bc51f543c5"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="68560204a01d10b2300e015f2b4f85bc51f543c5"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"54321"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Benjamin"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"User"</span></code><code class="line language-javascript">}</code><code class="empty"></code></pre>
            
    <p>A view is used to lookup the related articles. The view emits type, all
associations and their ids.</p>

    </div>
            <div class="section" id="embedone">
            <h3 class="section-header ">
    <a href="#embedone">
        EmbedOne
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>You can embed a class into a document. Both will be saved in the same CouchDB document:</p>

                <pre class="code-block-table" id="65c8bff759ec8acb9bf5cee10fad1e8a5d4186ea"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="65c8bff759ec8acb9bf5cee10fad1e8a5d4186ea"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span></code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $id;</code><code class="line language-php"></code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@EmbedOne</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $address;</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>The embed one mapping definition does not necessarily need a &quot;targetDocument&quot; attribute,
it can detect and save this automatically.</p>

            
    <p>In CouchDB documents with this relationship will look like:</p>

                <pre class="code-block-table" id="2f80778fa90a1c757fcc9bff3b88fde89e7a3d68"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="2f80778fa90a1c757fcc9bff3b88fde89e7a3d68"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"1234"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"address"</span>:</code><code class="line language-javascript">    {</code><code class="line language-javascript">        <span class="hljs-string">"zipcode"</span>: <span class="hljs-string">"12345"</span>,</code><code class="line language-javascript">        <span class="hljs-string">"city"</span>: <span class="hljs-string">"Berlin"</span></code><code class="line language-javascript">    }</code><code class="line language-javascript">}</code><code class="empty"></code></pre>
    </div>
            <div class="section" id="embedmany">
            <h3 class="section-header ">
    <a href="#embedmany">
        EmbedMany
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>You can embed an array of classes into a document.</p>

                <pre class="code-block-table" id="675da9fe281a57a40e1ec7e42d45176d35c061d6"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="675da9fe281a57a40e1ec7e42d45176d35c061d6"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"><span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span></code><code class="line language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $id;</code><code class="line language-php"></code><code class="line language-php">    <span class="hljs-comment">/** <span class="hljs-doctag">@EmbedMany</span> */</span></code><code class="line language-php">    <span class="hljs-keyword">private</span> $phonenumbers;</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>In CouchDB documents with this relationship will look like:</p>

                <pre class="code-block-table" id="e9dd12a4d2b5736fcab2943d12f426cd238680bf"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="e9dd12a4d2b5736fcab2943d12f426cd238680bf"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-javascript">{</code><code class="line language-javascript">    <span class="hljs-string">"_id"</span>: <span class="hljs-string">"1234"</span>,</code><code class="line language-javascript">    <span class="hljs-string">"phonenumbers"</span>:</code><code class="line language-javascript">    [</code><code class="line language-javascript">        {<span class="hljs-string">"number"</span>: <span class="hljs-string">"+1234567890"</span>},</code><code class="line language-javascript">        {<span class="hljs-string">"number"</span>: <span class="hljs-string">"+1234567891"</span>}</code><code class="line language-javascript">    ]</code><code class="line language-javascript">}</code><code class="empty"></code></pre>
    </div>
    </div>
    </div>
        

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?4a831b"
                            integrity="sha384-ygNM6vWkqMgvV0Lrk5BeKUupSk4CidmuzVPL3OkdAxEVjZQDo9cgbfC+FXAfoAse"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'couchdb-odm';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search CouchDB ODM master'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
