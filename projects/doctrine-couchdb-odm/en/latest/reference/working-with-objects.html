<!DOCTYPE html>
<html>
    <head>
        <title>Working with Objects - Doctrine CouchDB Object Document Mapper (CouchDB ODM)</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine CouchDB Object Document Mapper Documentation: Working with Objects ">

        <meta name="keywords" content="persistence,couchdb,odm,data,mapper,mapping,object,documentation,working,with,objects">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/working-with-objects.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?c1efb2"
                        integrity="sha384-Zc/W6EUYrfpNOrWDVlBgNIkUNbFFUczRwdu72czwaAnyDn1alk6zqQO1PnwimsNN"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/working-with-objects.html" />
        <meta property="og:title" content="Working with Objects - Doctrine CouchDB Object Document Mapper (CouchDB ODM)" />
        <meta property="og:description" content="Doctrine CouchDB Object Document Mapper Documentation: Working with Objects " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/images/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine CouchDB Object Document Mapper",
            "description": "Working with Objects",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/images/doctrine-logo.svg?c1fd47" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/mongodb.html">MongoDB</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/couchdb-odm/edit/master/docs/en/reference/working-with-objects.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc"><ul><li id="lucene-queries-html-couchdb-lucene-queries" class="toc-item"><a href="lucene-queries.html#couchdb-lucene-queries">CouchDB Lucene Queries</a></li><li id="tools-html-tools-and-maintenance" class="toc-item"><a href="tools.html#tools-and-maintenance">Tools and Maintenance</a><ul><li id="tools-html-65a5ac920c52f9d47c397bfdd231a479c6bc3751" class="toc-item"><a href="tools.html#65a5ac920c52f9d47c397bfdd231a479c6bc3751">65a5ac920c52f9d47c397bfdd231a479c6bc3751</a></li><li id="tools-html-8f5a9dcbcf2f4140b3d822439c865fef8fa6f5f1" class="toc-item"><a href="tools.html#8f5a9dcbcf2f4140b3d822439c865fef8fa6f5f1">8f5a9dcbcf2f4140b3d822439c865fef8fa6f5f1</a></li><li id="tools-html-d219e8e7d6520a44e277e7dd8b3cef661557e00c" class="toc-item"><a href="tools.html#d219e8e7d6520a44e277e7dd8b3cef661557e00c">d219e8e7d6520a44e277e7dd8b3cef661557e00c</a></li><li id="tools-html-db18889d1cb6590d1e8972dd362b52f362e9bc00" class="toc-item"><a href="tools.html#db18889d1cb6590d1e8972dd362b52f362e9bc00">db18889d1cb6590d1e8972dd362b52f362e9bc00</a></li><li id="tools-html-8e90c73c35fb8387a7c030994e8b9896b20efe9d" class="toc-item"><a href="tools.html#8e90c73c35fb8387a7c030994e8b9896b20efe9d">8e90c73c35fb8387a7c030994e8b9896b20efe9d</a></li></ul></li><li id="attachments-html-attachments" class="toc-item"><a href="attachments.html#attachments">Attachments</a></li><li id="association-mapping-html-association-mapping" class="toc-item"><a href="association-mapping.html#association-mapping">Association Mapping</a><ul><li id="association-mapping-html-graph-traversal-and-identity-map" class="toc-item"><a href="association-mapping.html#graph-traversal-and-identity-map">Graph Traversal and Identity Map</a></li><li id="association-mapping-html-different-association-mappings" class="toc-item"><a href="association-mapping.html#different-association-mappings">Different Association Mappings</a><ul><li id="association-mapping-html-referenceone" class="toc-item"><a href="association-mapping.html#referenceone">ReferenceOne</a></li><li id="association-mapping-html-referencemany" class="toc-item"><a href="association-mapping.html#referencemany">ReferenceMany</a></li><li id="association-mapping-html-inverse-referencemany" class="toc-item"><a href="association-mapping.html#inverse-referencemany">Inverse ReferenceMany</a></li><li id="association-mapping-html-embedone" class="toc-item"><a href="association-mapping.html#embedone">EmbedOne</a></li><li id="association-mapping-html-embedmany" class="toc-item"><a href="association-mapping.html#embedmany">EmbedMany</a></li></ul></li></ul></li><li id="installation-html-installation" class="toc-item"><a href="installation.html#installation">Installation</a><ul><li id="installation-html-pear" class="toc-item"><a href="installation.html#pear">PEAR</a></li><li id="installation-html-download" class="toc-item"><a href="installation.html#download">Download</a></li><li id="installation-html-git-github" class="toc-item"><a href="installation.html#git-github">Git/Github</a></li></ul></li><li id="map-reduce-queries-html-views-and-map-reduce-queries" class="toc-item"><a href="map-reduce-queries.html#views-and-map-reduce-queries">Views and Map-Reduce Queries</a><ul><li id="map-reduce-queries-html-creating-and-managing-views" class="toc-item"><a href="map-reduce-queries.html#creating-and-managing-views">Creating and Managing Views</a></li><li id="map-reduce-queries-html-querying-views" class="toc-item"><a href="map-reduce-queries.html#querying-views">Querying Views</a></li><li id="map-reduce-queries-html-view-results" class="toc-item"><a href="map-reduce-queries.html#view-results">View Results</a></li></ul></li><li id="inheritance-mapping-html-inheritance-mapping" class="toc-item"><a href="inheritance-mapping.html#inheritance-mapping">Inheritance Mapping</a></li><li id="configuration-html-configuration" class="toc-item"><a href="configuration.html#configuration">Configuration</a><ul><li id="configuration-html-obtaining-the-documentmanager" class="toc-item"><a href="configuration.html#obtaining-the-documentmanager">Obtaining the DocumentManager</a></li><li id="configuration-html-couchdbclient" class="toc-item"><a href="configuration.html#couchdbclient">CouchDBClient</a><ul><li id="configuration-html-http-client-required" class="toc-item"><a href="configuration.html#http-client-required">HTTP Client (***REQUIRED***)</a></li></ul></li><li id="configuration-html-configuration-options" class="toc-item"><a href="configuration.html#configuration-options">Configuration Options</a><ul><li id="configuration-html-proxy-directory-required" class="toc-item"><a href="configuration.html#proxy-directory-required">Proxy Directory (***REQUIRED***)</a></li><li id="configuration-html-proxy-namespace-optional" class="toc-item"><a href="configuration.html#proxy-namespace-optional">Proxy Namespace (***OPTIONAL***)</a></li><li id="configuration-html-metadata-driver-required" class="toc-item"><a href="configuration.html#metadata-driver-required">Metadata Driver (***REQUIRED***)</a></li><li id="configuration-html-metadata-cache-recommended" class="toc-item"><a href="configuration.html#metadata-cache-recommended">Metadata Cache (***RECOMMENDED***)</a></li><li id="configuration-html-lucene-handler-name-optional" class="toc-item"><a href="configuration.html#lucene-handler-name-optional">Lucene Handler Name (***OPTIONAL***)</a></li></ul></li><li id="configuration-html-proxy-objects" class="toc-item"><a href="configuration.html#proxy-objects">Proxy Objects</a><ul><li id="configuration-html-reference-proxies" class="toc-item"><a href="configuration.html#reference-proxies">Reference Proxies</a></li><li id="configuration-html-association-proxies" class="toc-item"><a href="configuration.html#association-proxies">Association proxies</a></li></ul></li></ul></li><li id="working-with-objects-html-working-with-objects" class="toc-item"><a href="working-with-objects.html#working-with-objects">Working with Objects</a><ul><li id="working-with-objects-html-understanding" class="toc-item"><a href="working-with-objects.html#understanding">Understanding</a><ul><li id="working-with-objects-html-the-size-of-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a></li><li id="working-with-objects-html-the-cost-of-flush" class="toc-item"><a href="working-with-objects.html#the-cost-of-flush">The cost of flush()</a></li><li id="working-with-objects-html-direct-access-to-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a></li></ul></li><li id="working-with-objects-html-persisting-documents" class="toc-item"><a href="working-with-objects.html#persisting-documents">Persisting documents</a></li><li id="working-with-objects-html-removing-documents" class="toc-item"><a href="working-with-objects.html#removing-documents">Removing documents</a></li><li id="working-with-objects-html-detaching-documents" class="toc-item"><a href="working-with-objects.html#detaching-documents">Detaching documents</a></li><li id="working-with-objects-html-merging-documents" class="toc-item"><a href="working-with-objects.html#merging-documents">Merging documents</a></li><li id="working-with-objects-html-references" class="toc-item"><a href="working-with-objects.html#references">References</a></li><li id="working-with-objects-html-establishing-references" class="toc-item"><a href="working-with-objects.html#establishing-references">Establishing References</a></li><li id="working-with-objects-html-removing-references" class="toc-item"><a href="working-with-objects.html#removing-references">Removing References</a></li><li id="working-with-objects-html-transitive-persistence" class="toc-item"><a href="working-with-objects.html#transitive-persistence">Transitive persistence</a></li><li id="working-with-objects-html-querying" class="toc-item"><a href="working-with-objects.html#querying">Querying</a><ul><li id="working-with-objects-html-by-primary-key" class="toc-item"><a href="working-with-objects.html#by-primary-key">By Primary Key</a></li><li id="working-with-objects-html-by-simple-conditions" class="toc-item"><a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a></li><li id="working-with-objects-html-by-lazy-loading" class="toc-item"><a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a></li><li id="working-with-objects-html-by-query-objects" class="toc-item"><a href="working-with-objects.html#by-query-objects">By Query Objects</a></li><li id="working-with-objects-html-custom-repositories" class="toc-item"><a href="working-with-objects.html#custom-repositories">Custom Repositories</a></li></ul></li></ul></li><li id="basic-mapping-html-basic-mapping" class="toc-item"><a href="basic-mapping.html#basic-mapping">Basic Mapping</a><ul><li id="basic-mapping-html-introduction-to-docblock-annotations" class="toc-item"><a href="basic-mapping.html#introduction-to-docblock-annotations">Introduction to Docblock Annotations</a></li><li id="basic-mapping-html-persistent-classes" class="toc-item"><a href="basic-mapping.html#persistent-classes">Persistent classes</a></li><li id="basic-mapping-html-doctrine-mapping-types" class="toc-item"><a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a></li><li id="basic-mapping-html-field-mapping" class="toc-item"><a href="basic-mapping.html#field-mapping">Field Mapping</a><ul><li id="basic-mapping-html-indexing-fields" class="toc-item"><a href="basic-mapping.html#indexing-fields">Indexing Fields</a></li><li id="basic-mapping-html-json-names" class="toc-item"><a href="basic-mapping.html#json-names">Json Names</a></li></ul></li><li id="basic-mapping-html-id-mapping" class="toc-item"><a href="basic-mapping.html#id-mapping">Id Mapping</a><ul><li id="basic-mapping-html-id-generation-strategies" class="toc-item"><a href="basic-mapping.html#id-generation-strategies">Id Generation Strategies</a></li></ul></li><li id="basic-mapping-html-attachments" class="toc-item"><a href="basic-mapping.html#attachments">Attachments</a></li><li id="basic-mapping-html-document-repositories" class="toc-item"><a href="basic-mapping.html#document-repositories">Document Repositories</a></li></ul></li><li id="introduction-html-introduction" class="toc-item"><a href="introduction.html#introduction">Introduction</a><ul><li id="introduction-html-features" class="toc-item"><a href="introduction.html#features">Features</a></li><li id="introduction-html-architecture" class="toc-item"><a href="introduction.html#architecture">Architecture</a><ul><li id="introduction-html-write-behind" class="toc-item"><a href="introduction.html#write-behind">Write-Behind</a></li><li id="introduction-html-querying" class="toc-item"><a href="introduction.html#querying">Querying</a></li><li id="introduction-html-object-graph-traversal" class="toc-item"><a href="introduction.html#object-graph-traversal">Object-Graph Traversal</a></li></ul></li><li id="introduction-html-why-nosql" class="toc-item"><a href="introduction.html#why-nosql">Why NoSQL?</a></li><li id="introduction-html-couchdb-document-structure" class="toc-item"><a href="introduction.html#couchdb-document-structure">CouchDB Document Structure</a><ul><li id="introduction-html-document-type" class="toc-item"><a href="introduction.html#document-type">Document Type</a></li><li id="introduction-html-associations" class="toc-item"><a href="introduction.html#associations">Associations</a></li><li id="introduction-html-indexes" class="toc-item"><a href="introduction.html#indexes">Indexes</a></li></ul></li></ul></li><li id="index-html-welcome-to-doctrine-couchdb-documentation" class="toc-item"><a href="../index.html#welcome-to-doctrine-couchdb-documentation">Welcome to Doctrine CouchDB documentation</a></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "CouchDB ODM",
            "item": "https://www.doctrine-project.org/projects/couchdb-odm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Working with Objects",
            "item": "https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/reference/working-with-objects.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/couchdb-odm.html">CouchDB ODM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-couchdb-odm/en/latest/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Working with Objects</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>This project is not being actively maintained. If you are interested in helping to maintain this project, take a look at the open issues on <a href="https://github.com/doctrine/{{ project.repositoryName }}/" target="_blank" rel="noopener noreferrer">GitHub</a> and submit pull requests.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-couchdb-odm/en/latest/reference/working-with-objects.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        master
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-couchdb-odm/en/latest/reference/working-with-objects.html">
                                                    master

                                                    
                                                                                                    </a>
                                                                                    
                                                                            </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="working-with-objects" name="working-with-objects"></a><h1 class="section-header"><a href="#working-with-objects">Working with Objects<i class="fas fa-link"></i></a></h1>
<div class="section"><a class="section-anchor" id="understanding" name="understanding"></a><h2 class="section-header"><a href="#understanding">Understanding<i class="fas fa-link"></i></a></h2>
<p>In this chapter we will help you understand the <code>DocumentManager</code>
and the <code>UnitOfWork</code>. A Unit of Work is similar to an
object-level transaction. A new Unit of Work is implicitly started
when an DocumentManager is initially created or after
<code>DocumentManager#flush()</code> has been invoked. A Unit of Work is
committed (and a new one started) by invoking
<code>DocumentManager#flush()</code>.</p>
<p>A Unit of Work can be manually closed by calling
<code>DocumentManager#close()</code>. Any changes to objects within this
Unit of Work that have not yet been persisted are lost.</p>
<div class="section"><a class="section-anchor" id="the-size-of-a-unit-of-work" name="the-size-of-a-unit-of-work"></a><h3 class="section-header"><a href="#the-size-of-a-unit-of-work">The size of a Unit of Work<i class="fas fa-link"></i></a></h3>
<p>The size of a Unit of Work mainly refers to the number of managed
documents at a particular point in time.</p>
</div>
<div class="section"><a class="section-anchor" id="the-cost-of-flush" name="the-cost-of-flush"></a><h3 class="section-header"><a href="#the-cost-of-flush">The cost of flush()<i class="fas fa-link"></i></a></h3>
<p>How costly a flush operation is in terms of performance mainly
depends on the size. You can get the size of your Unit of Work as
follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="13a969684316248876a5148a4dcd1549caeff8c8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="13a969684316248876a5148a4dcd1549caeff8c8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-1" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$uowSize = $dm-&gt;getUnitOfWork()-&gt;size();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-2" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-3" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-3">3</a></td></tr></table></div></code></pre>
<p>The size represents the number of managed documents in the Unit of
Work. This size affects the performance of flush() operations due
to change tracking and, of course, memory consumption, so you may
want to check it from time to time during development.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Do not invoke <code>flush</code> after every change to a
document or every single invocation of persist/remove/merge/...
This is an anti-pattern and unnecessarily reduces the performance
of your application. Instead, form units of work that operate on
your objects and call <code>flush</code> when you are done. While serving a
single HTTP request there should be usually no need for invoking
<code>flush</code> more than 0-2 times.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="direct-access-to-a-unit-of-work" name="direct-access-to-a-unit-of-work"></a><h3 class="section-header"><a href="#direct-access-to-a-unit-of-work">Direct access to a Unit of Work<i class="fas fa-link"></i></a></h3>
<p>You can get direct access to the Unit of Work by calling
<code>DocumentManager#getUnitOfWork()</code>. This will return the
UnitOfWork instance the DocumentManager is currently using.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="445e14effe022a571257bd61d6a4e865dc062559"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="445e14effe022a571257bd61d6a4e865dc062559"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-1" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$uow = $dm-&gt;getUnitOfWork();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-2" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-3" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-3">3</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Directly manipulating a UnitOfWork is not recommended.
When working directly with the UnitOfWork API, respect methods
marked as INTERNAL by not using them and carefully read the API
documentation.</p>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="persisting-documents" name="persisting-documents"></a><h2 class="section-header"><a href="#persisting-documents">Persisting documents<i class="fas fa-link"></i></a></h2>
<p>A document can be made persistent by passing it to the
<code>DocumentManager#persist($document)</code> method. By applying the
persist operation on some document, that document becomes MANAGED,
which means that its persistence is from now on managed by an
DocumentManager. As a result the persistent state of such a
document will subsequently be properly synchronized with the
database when <code>DocumentManager#flush()</code> is invoked.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Invoking the <code>persist</code> method on a document does NOT
cause an immediate insert to be issued on the database. Doctrine
applies a strategy called transactional write-behind, which means
that it will delay most operations until
<code>DocumentManager#flush()</code> is invoked which will then issue all
necessary queries to synchronize your objects with the database in
the most efficient way.</p>
</td></tr></table></div>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a2095c404ddd4c034ee8910c78bf8bc08d1af17e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a2095c404ddd4c034ee8910c78bf8bc08d1af17e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-1" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$user = <span class="hljs-keyword">new</span> User();
$user-&gt;setUsername(<span class="hljs-string">'jwage'</span>);
$user-&gt;setPassword(<span class="hljs-string">'changeme'</span>);
$dm-&gt;persist($user);
$dm-&gt;flush();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-2" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-3" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-4" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-5" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-6" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-7" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-7">7</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The \_id of a document is available directly after persist
when using the UUID strategy (which is default).</p>
</td></tr></table></div>
<p>The semantics of the persist operation, applied on a document X,
are as follows:</p>
<ul><li class="dash">   If X is a new document, it becomes managed. The document X will be
   entered into the database as a result of the flush operation.</li>
<li class="dash">   If X is a pre-existing managed document, it is ignored by the
   persist operation. However, the persist operation is cascaded to
   documents referenced by X, if the relationships from X to these
   other documents are mapped with cascade=PERSIST or cascade=ALL.</li>
<li class="dash"> If X is a removed document, it becomes managed.</li>
<li class="dash"> If X is a detached document, the behavior is undefined.</li>
</ul>

<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Do not pass detached documents to the persist operation.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="removing-documents" name="removing-documents"></a><h2 class="section-header"><a href="#removing-documents">Removing documents<i class="fas fa-link"></i></a></h2>
<p>A document can be removed from persistent storage by passing it to
the <code>DocumentManager#remove($document)</code> method. By applying the
<code>remove</code> operation on some document, that document becomes
REMOVED, which means that its persistent state will be deleted once
<code>DocumentManager#flush()</code> is invoked. The in-memory state of a
document is unaffected by the <code>remove</code> operation.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Just like <code>persist</code>, invoking <code>remove</code> on a
document does NOT cause an immediate query to be issued on the
database. The document will be removed on the next invocation of
<code>DocumentManager#flush()</code> that involves that document.</p>
</td></tr></table></div>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="0b3659c87a57d98d6eb101657eb2f8e0a12ede9e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="0b3659c87a57d98d6eb101657eb2f8e0a12ede9e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-1" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;remove($user);
$dm-&gt;flush();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-2" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-3" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-4" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-4">4</a></td></tr></table></div></code></pre>
<p>The semantics of the remove operation, applied to a document X are
as follows:</p>
<ul><li class="dash">   If X is a new document, it is ignored by the remove operation.
   However, the remove operation is cascaded to documents referenced
   by X, if the relationship from X to these other documents is mapped
   with cascade=REMOVE or cascade=ALL.</li>
<li class="dash">   If X is a managed document, the remove operation causes it to
   become removed. The remove operation is cascaded to documents
   referenced by X, if the relationships from X to these other
   documents is mapped with cascade=REMOVE or cascade=ALL.</li>
<li class="dash">   If X is a detached document, an InvalidArgumentException will be
   thrown.</li>
<li class="dash">   If X is a removed document, it is ignored by the remove operation.</li>
<li class="dash">   A removed document X will be removed from the database as a result
   of the flush operation.</li>
</ul>

</div>
<div class="section"><a class="section-anchor" id="detaching-documents" name="detaching-documents"></a><h2 class="section-header"><a href="#detaching-documents">Detaching documents<i class="fas fa-link"></i></a></h2>
<p>A document is detached from an DocumentManager and thus no longer
managed by invoking the <code>DocumentManager#detach($document)</code>
method on it or by cascading the detach operation to it. Changes
made to the detached document, if any (including removal of the
document), will not be synchronized to the database after the
document has been detached.</p>
<p>Doctrine will not hold on to any references to a detached
document.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-1" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;detach($document);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-2" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-3" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-3">3</a></td></tr></table></div></code></pre>
<p>The semantics of the detach operation, applied to a document X are
as follows:</p>
<ul><li class="dash">   If X is a managed document, the detach operation causes it to
   become detached. The detach operation is cascaded to documents
   referenced by X, if the relationships from X to these other
   documents is mapped with cascade=DETACH or cascade=ALL. Documents
   which previously referenced X will continue to reference X.</li>
<li class="dash">   If X is a new or detached document, it is ignored by the detach
   operation.</li>
<li class="dash">   If X is a removed document, the detach operation is cascaded to
   documents referenced by X, if the relationships from X to these
   other documents is mapped with cascade=DETACH or
   cascade=ALL/Documents which previously referenced X will continue
   to reference X.</li>
</ul>

<p>There are several situations in which a document is detached
automatically without invoking the <code>detach</code> method:</p>
<ul><li class="dash">   When <code>DocumentManager#clear()</code> is invoked, all documents that are
   currently managed by the DocumentManager instance become detached.</li>
<li class="dash">   When serializing a document. The document retrieved upon subsequent
   unserialization will be detached (This is the case for all
   documents that are serialized and stored in some cache).</li>
</ul>

<p>The <code>detach</code> operation is usually not as frequently needed and
used as <code>persist</code> and <code>remove</code>.</p>
</div>
<div class="section"><a class="section-anchor" id="merging-documents" name="merging-documents"></a><h2 class="section-header"><a href="#merging-documents">Merging documents<i class="fas fa-link"></i></a></h2>
<p>Merging documents refers to the merging of (usually detached)
documents into the context of an DocumentManager so that they
become managed again. To merge the state of a document into an
DocumentManager use the <code>DocumentManager#merge($document)</code>
method. The state of the passed document will be merged into a
managed copy of this document and this copy will subsequently be
returned.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="baa8b57aa44118f3aa9631d7efbeac10c82b98d5"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="baa8b57aa44118f3aa9631d7efbeac10c82b98d5"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-1" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$detachedDocument = unserialize($serializedDocument); <span class="hljs-comment">// some detached document</span>
$document = $dm-&gt;merge($detachedDocument);
<span class="hljs-comment">// $document now refers to the fully managed copy returned by the merge operation.</span>
<span class="hljs-comment">// The DocumentManager $dm now manages the persistence of $document as usual.</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-2" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-3" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-4" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-5" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-6" class="line-number-anchor" /><a href="#line-number-baa8b57aa44118f3aa9631d7efbeac10c82b98d5-6">6</a></td></tr></table></div></code></pre>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>When you want to serialize/unserialize documents you
have to make all document properties protected, never private. The
reason for this is, if you serialize a class that was a proxy
instance before, the private variables won't be serialized and a
PHP Notice is thrown.</p>
<p>The semantics of the merge operation, applied to a document X, are
as follows:</p>
</td></tr></table></div>
<ul><li class="dash">   If X is a detached document, the state of X is copied onto a
   pre-existing managed document instance X' of the same iddocument or
   a new managed copy X' of X is created.</li>
<li class="dash">   If X is a new document instance, an InvalidArgumentException will
   be thrown.</li>
<li class="dash">   If X is a removed document instance, an InvalidArgumentException
   will be thrown.</li>
<li class="dash">   If X is a managed document, it is ignored by the merge operation,
   however, the merge operation is cascaded to documents referenced by
   relationships from X if these relationships have been mapped with
   the cascade element value MERGE or ALL.</li>
<li class="dash">   For all documents Y referenced by relationships from X having the
   cascade element value MERGE or ALL, Y is merged recursively as Y'.
   For all such Y referenced by X, X' is set to reference Y'. (Note
   that if X is managed then X is the same object as X'.)</li>
<li class="dash">   If X is a document merged to X', with a reference to another
   document Y, where cascade=MERGE or cascade=ALL is not specified,
   then navigation of the same association from X' yields a reference
   to a managed object Y' with the same persistent iddocument as Y.</li>
</ul>

<p>The <code>merge</code> operation is usually not as frequently needed and
used as <code>persist</code> and <code>remove</code>. The most common scenario for
the <code>merge</code> operation is to re-attach documents to an
DocumentManager that come from some cache (and are therefore
detached) and you want to modify and persist such a document.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>If you load some detached documents from a cache and you
do not need to persist or delete them or otherwise make use of them
without the need for persistence services there is no need to use
<code>merge</code>. I.e. you can simply pass detached objects from a cache
directly to the view.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="references" name="references"></a><h2 class="section-header"><a href="#references">References<i class="fas fa-link"></i></a></h2>
<p>References between documents and embedded documents are represented
just like in regular object-oriented PHP, with references to other
objects or collections of objects.</p>
</div>
<div class="section"><a class="section-anchor" id="establishing-references" name="establishing-references"></a><h2 class="section-header"><a href="#establishing-references">Establishing References<i class="fas fa-link"></i></a></h2>
<p>Establishing a reference to another document is straight forward. Here
is an example where we add a new comment to an article:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="62afebf20e4be23565228ab8aaa187d2afc91860"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="62afebf20e4be23565228ab8aaa187d2afc91860"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-1" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$comment = <span class="hljs-keyword">new</span> Comment();
<span class="hljs-comment">// ...</span>

$article-&gt;getComments()-&gt;add($comment);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-2" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-3" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-4" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-5" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-6" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-6">6</a></td></tr></table></div></code></pre>
<p>Or you can set a single reference:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="db86d55d7bbeb273582b8d184b60d04d7bbceae2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="db86d55d7bbeb273582b8d184b60d04d7bbceae2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-1" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$address = <span class="hljs-keyword">new</span> Address();
<span class="hljs-comment">// ...</span>

$user-&gt;setAddress($address);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-2" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-3" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-4" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-5" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-6" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-6">6</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="removing-references" name="removing-references"></a><h2 class="section-header"><a href="#removing-references">Removing References<i class="fas fa-link"></i></a></h2>
<p>Removing an association between two documents is similarly
straight-forward. There are two strategies to do so, by key and by
element. Here are some examples:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9ca3d5ad3b862285d3365a3768ec7e2031d1382a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9ca3d5ad3b862285d3365a3768ec7e2031d1382a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-1" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$article-&gt;getComments()-&gt;removeElement($comment);
$article-&gt;getComments()-&gt;remove($ithComment);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-2" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-3" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-4" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-4">4</a></td></tr></table></div></code></pre>
<p>Or you can remove a single reference:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7108609d2f8c8f71f3b1769d7977624894b7f27f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7108609d2f8c8f71f3b1769d7977624894b7f27f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-1" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user-&gt;setAddress(<span class="hljs-keyword">null</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-2" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-3" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-3">3</a></td></tr></table></div></code></pre>
<p>When working with collections, keep in mind that a Collection is
essentially an ordered map (just like a PHP array). That is why the
<code>remove</code> operation accepts an index/key. <code>removeElement</code> is a
separate method that has O(n) complexity, where n is the size of
the map.</p>
</div>
<div class="section"><a class="section-anchor" id="transitive-persistence" name="transitive-persistence"></a><h2 class="section-header"><a href="#transitive-persistence">Transitive persistence<i class="fas fa-link"></i></a></h2>
<p>Persisting, removing, detaching and merging individual documents
can become pretty cumbersome, especially when a larger object graph
with collections is involved. Therefore Doctrine provides a
mechanism for transitive persistence through cascading of these
operations. Each reference to another document or a collection of
documents can be configured to automatically cascade certain
operations. By default, no operations are cascaded.</p>
<p>The following cascade options exist:</p>
<ul><li class="dash">   persist : Cascades persist operations to the associated documents.</li>
<li class="dash"> remove : Cascades remove operations to the associated documents.</li>
<li class="dash"> merge : Cascades merge operations to the associated documents.</li>
<li class="dash"> detach : Cascades detach operations to the associated documents.</li>
<li class="dash">   all : Cascades persist, remove, merge and detach operations to
   associated documents.</li>
</ul>

<p>The following example shows an association to a number of
addresses. If persist() or remove() is invoked on any User
document, it will be cascaded to all associated Address documents
in the $addresses collection.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="df0324ad24d3cc681931ae52a3b98805e6ee0e55"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="df0324ad24d3cc681931ae52a3b98805e6ee0e55"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-1" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> 
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@ReferenceMany</span>(targetDocument="Address", cascade={"persist", "remove"}) */</span>
    <span class="hljs-keyword">private</span> $addresses;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-2" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-3" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-4" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-5" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-6" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-7" class="line-number-anchor" /><a href="#line-number-df0324ad24d3cc681931ae52a3b98805e6ee0e55-7">7</a></td></tr></table></div></code></pre>
<p>Even though automatic cascading is convenient it should be used
with care. Do not blindly apply cascade=all to all associations as
it will unnecessarily degrade the performance of your application.</p>
</div>
<div class="section"><a class="section-anchor" id="querying" name="querying"></a><h2 class="section-header"><a href="#querying">Querying<i class="fas fa-link"></i></a></h2>
<p>Doctrine provides the following ways, in increasing level of power
and flexibility, to query for persistent objects. You should always
start with the simplest one that suits your needs.</p>
<div class="section"><a class="section-anchor" id="by-primary-key" name="by-primary-key"></a><h3 class="section-header"><a href="#by-primary-key">By Primary Key<i class="fas fa-link"></i></a></h3>
<p>The most basic way to query for a persistent object is by its
identifier / primary key using the
<code>DocumentManager#find($documentName, $id)</code> method. Here is an
example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5e53a14901c39d7044f80ad9ebb901b4ca98ac28"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5e53a14901c39d7044f80ad9ebb901b4ca98ac28"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-1" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;find(<span class="hljs-string">'User'</span>, $id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-2" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-3" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-3">3</a></td></tr></table></div></code></pre>
<p>The return value is either the found document instance or null if
no instance could be found with the given identifier.</p>
<p>Essentially, <code>DocumentManager#find()</code> is just a shortcut for the
following:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="108dbc3b6599dec9edd7b1451c8a767dc046a4fd"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="108dbc3b6599dec9edd7b1451c8a767dc046a4fd"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-1" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;find($id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-2" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-3" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-3">3</a></td></tr></table></div></code></pre>
<p><code>DocumentManager#getRepository($documentName)</code> returns a
repository object which provides many ways to retrieve documents of
the specified type. By default, the repository instance is of type
<code>Doctrine\ODM\CouchDB\DocumentRepository</code>. You can also use
custom repository classes.</p>
</div>
<div class="section"><a class="section-anchor" id="by-simple-conditions" name="by-simple-conditions"></a><h3 class="section-header"><a href="#by-simple-conditions">By Simple Conditions<i class="fas fa-link"></i></a></h3>
<p>To query for one or more documents based on several conditions that
form a logical conjunction, use the <code>findBy</code> and <code>findOneBy</code>
methods on a repository as follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5613c027a5e95ae3438dc7911e776e50f1e2871e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5613c027a5e95ae3438dc7911e776e50f1e2871e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-1" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-1">1</a></td><td class="code-line" rowspan="10"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// All users that are 20 years old</span>
$users = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'age'</span> =&gt; <span class="hljs-number">20</span>));

<span class="hljs-comment">// All users that are 20 years old and have a surname of 'Miller'</span>
$users = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'age'</span> =&gt; <span class="hljs-number">20</span>, <span class="hljs-string">'surname'</span> =&gt; <span class="hljs-string">'Miller'</span>));

<span class="hljs-comment">// A single user by its nickname</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'nickname'</span> =&gt; <span class="hljs-string">'romanb'</span>));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-2" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-3" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-4" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-5" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-6" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-7" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-8" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-9" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-10" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-10">10</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Querying by simple conditions only works for documents with indexed fields.</p>
</td></tr></table></div>
<p>An DocumentRepository also provides a mechanism for more concise
calls through its use of <code>__call</code>. Thus, the following two
examples are equivalent:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="328adaffb5e2c4ab95e6b3990026a0f5f465ec8f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="328adaffb5e2c4ab95e6b3990026a0f5f465ec8f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-1" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// A single user by its nickname</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'nickname'</span> =&gt; <span class="hljs-string">'romanb'</span>));

<span class="hljs-comment">// A single user by its nickname (__call magic)</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneByNickname(<span class="hljs-string">'romanb'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-2" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-3" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-4" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-5" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-6" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-7" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-7">7</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="by-lazy-loading" name="by-lazy-loading"></a><h3 class="section-header"><a href="#by-lazy-loading">By Lazy Loading<i class="fas fa-link"></i></a></h3>
<p>Whenever you have a managed document instance at hand, you can
traverse and use any associations of that document as if they were
in-memory already. Doctrine will automatically load the associated
objects on demand through the concept of lazy-loading.</p>
</div>
<div class="section"><a class="section-anchor" id="by-query-objects" name="by-query-objects"></a><h3 class="section-header"><a href="#by-query-objects">By Query Objects<i class="fas fa-link"></i></a></h3>
<p>The most powerful and flexible method to query for persistent
objects is the Query object. The Query object enables you to query
for persistent objects through CouchDB views or the CouchDB Lucene Bridge.</p>
</div>
<div class="section"><a class="section-anchor" id="custom-repositories" name="custom-repositories"></a><h3 class="section-header"><a href="#custom-repositories">Custom Repositories<i class="fas fa-link"></i></a></h3>
<p>By default the DocumentManager returns a default implementation of
<code>Doctrine\ODM\CouchDB\DocumentRepository</code> when you call
<code>DocumentManager#getRepository($documentClass)</code>. You can override
this behavior by specifying the class name of your own Document
Repository in the Annotation, XML or YAML metadata. In large
applications that require lots of specialized DQL queries using a
custom repository is one recommended way of grouping these queries
in a central location.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="37b8faeb75be8876b31669488f0f0160f38b027e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="37b8faeb75be8876b31669488f0f0160f38b027e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-1" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-1">1</a></td><td class="code-line" rowspan="18"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ODM</span>\<span class="hljs-title">CouchDB</span>\<span class="hljs-title">DocumentRepository</span>;

<span class="hljs-comment">/** <span class="hljs-doctag">@Document</span>(repositoryClass="UserRepository") */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{

}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DocumentRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAllAdminUsers</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// do stuff</span>
        <span class="hljs-keyword">return</span> $admins;
    }
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-2" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-3" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-4" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-5" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-6" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-7" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-8" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-9" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-10" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-11" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-12" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-13" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-14" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-15" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-16" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-17" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-37b8faeb75be8876b31669488f0f0160f38b027e-18" class="line-number-anchor" /><a href="#line-number-37b8faeb75be8876b31669488f0f0160f38b027e-18">18</a></td></tr></table></div></code></pre>
<p>You can access your repository now by calling:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-1" class="line-number-anchor" /><a href="#line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$admins = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;getAllAdminUsers();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-2" class="line-number-anchor" /><a href="#line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-3" class="line-number-anchor" /><a href="#line-number-4d1c5802b3ae4fdb9d65a0c086acc8f825f79e19-3">3</a></td></tr></table></div></code></pre>

</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?8325dc"
                            integrity="sha384-N4iB8uuyA7tob2BupWHocizx3ZEw2scumdnfVnZFWIeNVlKULTHzFxbz5xOxnwU5"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'couchdb-odm';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search CouchDB ODM master'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
