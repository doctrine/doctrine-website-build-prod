<!DOCTYPE html>
<html>
    <head>
        <title>        DoctrineMigrationsBundle - Doctrine Doctrine Migrations Bundle (DoctrineMigrationsBundle)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Doctrine Migrations Bundle Documentation: DoctrineMigrationsBundle ">

        <meta name="keywords" content="                    DBAL,Migrations,Schema,documentation,doctrinemigrationsbundle
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-migrations-bundle/en/3.2/index.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?54f9c4"
                        integrity="sha384-57fVtvohIWBOpuOcDXqoT+3Fl8pRTVz6rOnFpf+vxohYDQ7/J/Xpt5VDo9suF4h6"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-migrations-bundle/en/1.1/index.html" />
        <meta property="og:title" content="        DoctrineMigrationsBundle - Doctrine Doctrine Migrations Bundle (DoctrineMigrationsBundle)
    " />
        <meta property="og:description" content="Doctrine Doctrine Migrations Bundle Documentation: DoctrineMigrationsBundle " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Doctrine Migrations Bundle",
            "description": "DoctrineMigrationsBundle",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar stop-war-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                 <a href="/stop-war.html">ðŸ‡ºðŸ‡¦ UKRAINE NEEDS YOUR HELP NOW!</a>
            </nav>

            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/DoctrineMigrationsBundle/edit/1.1/Resources/doc/index.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc"><ul><li id="index-html-doctrinemigrationsbundle" class="toc-item"><a href="index.html#doctrinemigrationsbundle">DoctrineMigrationsBundle</a><ul><li id="index-html-installation" class="toc-item"><a href="index.html#installation">Installation</a></li><li id="index-html-configuration" class="toc-item"><a href="index.html#configuration">Configuration</a></li><li id="index-html-usage" class="toc-item"><a href="index.html#usage">Usage</a><ul><li id="index-html-running-migrations-during-deployment" class="toc-item"><a href="index.html#running-migrations-during-deployment">Running Migrations during Deployment</a></li></ul></li><li id="index-html-generating-migrations-automatically" class="toc-item"><a href="index.html#generating-migrations-automatically">Generating Migrations Automatically</a></li><li id="index-html-container-aware-migrations" class="toc-item"><a href="index.html#container-aware-migrations">Container Aware Migrations</a></li><li id="index-html-manual-tables" class="toc-item"><a href="index.html#manual-tables">Manual Tables</a></li></ul></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "DoctrineMigrationsBundle",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations-bundle.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations-bundle/en/1.1/index.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-migrations-bundle.html">DoctrineMigrationsBundle</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Documentation</li>
                        </ol>
</nav>
                    
                                                        </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-migrations-bundle/en/1.1/index.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        1.1.1
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations-bundle/en/latest/index.html">
                                                    3.3

                                                    
                                                                                                            (upcoming)
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations-bundle/en/3.2/index.html">
                                                    3.2.4

                                                                                                            (current)
                                                    
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations-bundle/en/2.2/index.html">
                                                    2.2.3

                                                    
                                                                                                    </a>
                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/3.1/index.html">3.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/3.0/index.html">3.0</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/2.1/index.html">2.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/2.0/index.html">2.0</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/1.3/index.html">1.3</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/1.2/index.html">1.2</a>
                                                                                            
                                                <a class="dropdown-item active" href="/projects/doctrine-migrations-bundle/en/1.1/index.html">1.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-migrations-bundle/en/1.0/index.html">1.0</a>
                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="doctrinemigrationsbundle" name="doctrinemigrationsbundle"></a><h1 class="section-header"><a href="#doctrinemigrationsbundle">DoctrineMigrationsBundle<i class="fas fa-link"></i></a></h1>
<p>The database migrations feature is an extension of the database abstraction
layer and offers you the ability to programmatically deploy new versions of
your database schema in a safe, easy and standardized way.</p>
<div class="alert tip-admonition bg-success text-light border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-question-circle mr-2"></i></td><td><p>You can read more about the Doctrine Database Migrations on the project's
<a href="http://docs.doctrine-project.org/projects/doctrine-migrations/en/latest/index.html">documentation</a>.</p>
</td></tr></table></div>
<div class="section"><a class="section-anchor" id="installation" name="installation"></a><h2 class="section-header"><a href="#installation">Installation<i class="fas fa-link"></i></a></h2>
<p>Doctrine migrations for Symfony are maintained in the <a href="https://github.com/doctrine/DoctrineMigrationsBundle">DoctrineMigrationsBundle</a>.
The bundle uses external <a href="https://github.com/doctrine/migrations">Doctrine Database Migrations</a> library.</p>
<p>First, install the bundle with composer:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>composer require doctrine/doctrine-migrations-bundle "^1.0"</code></pre></div>
<p>If everything worked, the <code>DoctrineMigrationsBundle</code> can now be found
at <code>vendor/doctrine/doctrine-migrations-bundle</code>.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p><code>DoctrineMigrationsBundle</code> installs
<a href="https://github.com/doctrine/migrations">Doctrine Database Migrations</a> library. The library can be found
at <code>vendor/doctrine/migrations</code>.</p>
</td></tr></table></div>
<p>Finally, be sure to enable the bundle in <code>AppKernel.php</code> by including the
following:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="839ed58182cff867a83080ec5dc17ec1e0d0ef6b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="839ed58182cff867a83080ec5dc17ec1e0d0ef6b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-1" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-comment">// app/AppKernel.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerBundles</span><span class="hljs-params">()</span>
</span>{
    $bundles = <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">//...</span>
        <span class="hljs-keyword">new</span> Doctrine\Bundle\MigrationsBundle\DoctrineMigrationsBundle(),
    );
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-2" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-3" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-4" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-5" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-6" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-7" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-8" class="line-number-anchor" /><a href="#line-number-839ed58182cff867a83080ec5dc17ec1e0d0ef6b-8">8</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="configuration" name="configuration"></a><h2 class="section-header"><a href="#configuration">Configuration<i class="fas fa-link"></i></a></h2>
<p>You can configure the path, namespace, table_name and name in your <code>config.yml</code>. The examples below are the default values.</p>
<pre class="code-block-table"><code class="yaml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="79e507fd59c401e454c61e33671316ef232f18c2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="79e507fd59c401e454c61e33671316ef232f18c2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-1" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-comment"># app/config/config.yml</span>
<span class="hljs-attr">doctrine_migrations:</span>
    <span class="hljs-attr">dir_name:</span> <span class="hljs-string">"%kernel.root_dir%/DoctrineMigrations"</span>
    <span class="hljs-attr">namespace:</span> <span class="hljs-string">Application\Migrations</span>
    <span class="hljs-attr">table_name:</span> <span class="hljs-string">migration_versions</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Application</span> <span class="hljs-string">Migrations</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-2" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-3" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-4" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-5" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-79e507fd59c401e454c61e33671316ef232f18c2-6" class="line-number-anchor" /><a href="#line-number-79e507fd59c401e454c61e33671316ef232f18c2-6">6</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="usage" name="usage"></a><h2 class="section-header"><a href="#usage">Usage<i class="fas fa-link"></i></a></h2>
<p>All of the migrations functionality is contained in a few console commands:</p>
<div class="console"><pre><code class="console">doctrine:migrations
  :diff     Generate a migration by comparing your current database to your mapping information.
  :execute  Execute a single migration version up or down manually.
  :generate Generate a blank migration class.
  :migrate  Execute a migration to a specified version or the latest available version.
  :status   View the status of a set of migrations.
  :version  Manually add and delete migration versions from the version table.</code></pre></div>
<p>Start by getting the status of migrations in your application by running
the <code>status</code> command:</p>
<div class="console"><pre><code class="console">php app/console doctrine:migrations:status

 == Configuration

    >> Name:                                               Application Migrations
    >> Configuration Source:                               manually configured
    >> Version Table Name:                                 migration_versions
    >> Migrations Namespace:                               Application\Migrations
    >> Migrations Directory:                               /path/to/project/app/DoctrineMigrations
    >> Current Version:                                    0
    >> Latest Version:                                     0
    >> Executed Migrations:                                0
    >> Available Migrations:                               0
    >> New Migrations:                                     0</code></pre></div>
<p>Now, you can start working with migrations by generating a new blank migration
class. Later, you'll learn how Doctrine can generate migrations automatically
for you.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php app/console doctrine:migrations:generate
Generated new migration class to "/path/to/project/app/DoctrineMigrations/Version20100621140655.php"</code></pre></div>
<p>Have a look at the newly generated migration class and you will see something
like the following:</p>
<pre><code class="">namespace Application\Migrations;

use Doctrine\DBAL\Migrations\AbstractMigration,
    Doctrine\DBAL\Schema\Schema;

class Version20100621140655 extends AbstractMigration
{
    public function up(Schema $schema)
    {

    }

    public function down(Schema $schema)
    {

    }
}
</code></pre>
<p>If you run the <code>status</code> command it will now show that you have one new
migration to execute:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php app/console doctrine:migrations:status --show-versions

 == Configuration

   >> Name:                                               Application Migrations
   >> Configuration Source:                               manually configured
   >> Version Table Name:                                 migration_versions
   >> Migrations Namespace:                               Application\Migrations
   >> Migrations Directory:                               /path/to/project/app/DoctrineMigrations
   >> Current Version:                                    0
   >> Latest Version:                                     2010-06-21 14:06:55 (20100621140655)
   >> Executed Migrations:                                0
   >> Available Migrations:                               1
   >> New Migrations:                                     1

== Migration Versions

   >> 2010-06-21 14:06:55 (20100621140655)                not migrated</code></pre></div>
<p>Now you can add some migration code to the <code>up()</code> and <code>down()</code> methods and
finally migrate when you're ready:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php app/console doctrine:migrations:migrate 20100621140655</code></pre></div>
<p>For more information on how to write the migrations themselves (i.e. how to
fill in the <code>up()</code> and <code>down()</code> methods), see the official Doctrine Migrations
<a href="http://docs.doctrine-project.org/projects/doctrine-migrations/en/latest/index.html">documentation</a>.</p>
<div class="section"><a class="section-anchor" id="running-migrations-during-deployment" name="running-migrations-during-deployment"></a><h3 class="section-header"><a href="#running-migrations-during-deployment">Running Migrations during Deployment<i class="fas fa-link"></i></a></h3>
<p>Of course, the end goal of writing migrations is to be able to use them to
reliably update your database structure when you deploy your application.
By running the migrations locally (or on a beta server), you can ensure that
the migrations work as you expect.</p>
<p>When you do finally deploy your application, you just need to remember to run
the <code>doctrine:migrations:migrate</code> command. Internally, Doctrine creates
a <code>migration_versions</code> table inside your database and tracks which migrations
have been executed there. So, no matter how many migrations you've created
and executed locally, when you run the command during deployment, Doctrine
will know exactly which migrations it hasn't run yet by looking at the <code>migration_versions</code>
table of your production database. Regardless of what server you're on, you
can always safely run this command to execute only the migrations that haven't
been run yet on <em>that</em> particular database.</p>
</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="generating-migrations-automatically" name="generating-migrations-automatically"></a><h2 class="section-header"><a href="#generating-migrations-automatically">Generating Migrations Automatically<i class="fas fa-link"></i></a></h2>
<p>In reality, you should rarely need to write migrations manually, as the migrations
library can generate migration classes automatically by comparing your Doctrine
mapping information (i.e. what your database <em>should</em> look like) with your
actual current database structure.</p>
<p>For example, suppose you create a new <code>User</code> entity and add mapping information
for Doctrine's ORM:</p>
<div class="configuration-block jsactive clearfix"><ul class="simple"><li><em>PHP</em><div class="highlight-php"><pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-1" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-1">1</a></td><td class="code-line" rowspan="23"><span class="hljs-comment">// src/Acme/HelloBundle/Entity/User.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Acme</span>\<span class="hljs-title">HelloBundle</span>\<span class="hljs-title">Entity</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ORM</span>\Entity
 * <span class="hljs-doctag">@ORM</span>\Table(name="hello_user")
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Id
     * <span class="hljs-doctag">@ORM</span>\Column(type="integer")
     * <span class="hljs-doctag">@ORM</span>\GeneratedValue(strategy="AUTO")
     */</span>
    <span class="hljs-keyword">protected</span> $id;

    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Column(type="string", length=255)
     */</span>
    <span class="hljs-keyword">protected</span> $name;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-2" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-3" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-4" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-5" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-6" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-7" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-8" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-9" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-10" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-11" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-12" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-13" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-14" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-15" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-16" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-17" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-18" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-18">18</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-19" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-19">19</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-20" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-20">20</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-21" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-21">21</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-22" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-22">22</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-23" class="line-number-anchor" /><a href="#line-number-9fb1d957fa7067a459ca6a4f1f004fbb8a0e372a-23">23</a></td></tr></table></div></code></pre></div></li><li><em>YAML</em><div class="highlight-yaml"><pre class="code-block-table"><code class="yaml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="c7d566e6f96c80892561c141e1e727fd2c3e8a5f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="c7d566e6f96c80892561c141e1e727fd2c3e8a5f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-1" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-1">1</a></td><td class="code-line" rowspan="13"><span class="hljs-comment"># src/Acme/HelloBundle/Resources/config/doctrine/User.orm.yml</span>
<span class="hljs-string">Acme\HelloBundle\Entity\User:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">entity</span>
    <span class="hljs-attr">table:</span> <span class="hljs-string">hello_user</span>
    <span class="hljs-attr">id:</span>
        <span class="hljs-attr">id:</span>
            <span class="hljs-attr">type:</span> <span class="hljs-string">integer</span>
            <span class="hljs-attr">generator:</span>
                <span class="hljs-attr">strategy:</span> <span class="hljs-string">AUTO</span>
    <span class="hljs-attr">fields:</span>
        <span class="hljs-attr">name:</span>
            <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
            <span class="hljs-attr">length:</span> <span class="hljs-number">255</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-2" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-3" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-4" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-5" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-6" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-7" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-8" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-9" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-10" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-11" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-12" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-13" class="line-number-anchor" /><a href="#line-number-c7d566e6f96c80892561c141e1e727fd2c3e8a5f-13">13</a></td></tr></table></div></code></pre></div></li><li><em>XML</em><div class="highlight-xml"><pre class="code-block-table"><code class="xml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="eb099da7910431d045b478611919ac35152ab7e5"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="eb099da7910431d045b478611919ac35152ab7e5"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-1" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-1">1</a></td><td class="code-line" rowspan="14"><span class="hljs-comment">&lt;!-- src/Acme/HelloBundle/Resources/config/doctrine/User.orm.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">doctrine-mapping</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping"</span>
      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://doctrine-project.org/schemas/orm/doctrine-mapping
                    http://doctrine-project.org/schemas/orm/doctrine-mapping.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Acme\HelloBundle\Entity\User"</span> <span class="hljs-attr">table</span>=<span class="hljs-string">"hello_user"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"integer"</span> <span class="hljs-attr">column</span>=<span class="hljs-string">"id"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">generator</span> <span class="hljs-attr">strategy</span>=<span class="hljs-string">"AUTO"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">column</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">length</span>=<span class="hljs-string">"255"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">doctrine-mapping</span>&gt;</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-2" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-3" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-4" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-5" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-6" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-7" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-8" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-9" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-10" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-11" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-12" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-13" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-eb099da7910431d045b478611919ac35152ab7e5-14" class="line-number-anchor" /><a href="#line-number-eb099da7910431d045b478611919ac35152ab7e5-14">14</a></td></tr></table></div></code></pre></div></li></ul></div>
<p>With this information, Doctrine is now ready to help you persist your new
<code>User</code> object to and from the <code>hello_user</code> table. Of course, this table
doesn't exist yet! Generate a new migration for this table automatically by
running the following command:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php app/console doctrine:migrations:diff</code></pre></div>
<p>You should see a message that a new migration class was generated based on
the schema differences. If you open this file, you'll find that it has the
SQL code needed to create the <code>hello_user</code> table. Next, run the migration
to add the table to your database:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php app/console doctrine:migrations:migrate</code></pre></div>
<p>The moral of the story is this: after each change you make to your Doctrine
mapping information, run the <code>doctrine:migrations:diff</code> command to automatically
generate your migration classes.</p>
<p>If you do this from the very beginning of your project (i.e. so that even
the first tables were loaded via a migration class), you'll always be able
to create a fresh database and run your migrations in order to get your database
schema fully up to date. In fact, this is an easy and dependable workflow
for your project.</p>
</div>
<div class="section"><a class="section-anchor" id="container-aware-migrations" name="container-aware-migrations"></a><h2 class="section-header"><a href="#container-aware-migrations">Container Aware Migrations<i class="fas fa-link"></i></a></h2>
<p>In some cases you might need access to the container to ensure the proper update of
your data structure. This could be necessary to update relations with some specific
logic or to create new entities.</p>
<p>Therefore you can just implement the ContainerAwareInterface with its needed methods
to get full access to the container.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-1" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-1">1</a></td><td class="code-line" rowspan="25"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">ContainerAwareInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">DependencyInjection</span>\<span class="hljs-title">ContainerInterface</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Version20130326212938</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMigration</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContainerAwareInterface</span>
</span>{

    <span class="hljs-keyword">private</span> $container;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setContainer</span><span class="hljs-params">(ContainerInterface $container = null)</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;container = $container;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">(Schema $schema)</span>
    </span>{
        <span class="hljs-comment">// ... migration content</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postUp</span><span class="hljs-params">(Schema $schema)</span>
    </span>{
        $converter = <span class="hljs-keyword">$this</span>-&gt;container-&gt;get(<span class="hljs-string">'my_service.convert_data_to'</span>);
        <span class="hljs-comment">// ... convert the data from markdown to html for instance</span>
    }
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-2" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-3" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-4" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-5" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-6" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-7" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-8" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-9" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-10" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-11" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-12" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-13" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-14" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-15" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-16" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-17" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-18" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-18">18</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-19" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-19">19</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-20" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-20">20</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-21" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-21">21</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-22" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-22">22</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-23" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-23">23</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-24" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-24">24</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-25" class="line-number-anchor" /><a href="#line-number-ad0dc23769f5db316d9e4bd6c8c4f2ad5cb6a057-25">25</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="manual-tables" name="manual-tables"></a><h2 class="section-header"><a href="#manual-tables">Manual Tables<i class="fas fa-link"></i></a></h2>
<p>It is a common use case, that in addition to your generated database structure
based on your doctrine entities you might need custom tables. By default such
tables will be removed by the <a href="doctrine:migrations:diff">doctrine:migrations:diff</a> command.</p>
<p>If you follow a specific scheme you can configure doctrine/dbal to ignore those
tables. Let's say all custom tables will be prefixed by <code>t_</code>. In this case you
just have to add the following configuration option to your doctrine configuration:</p>
<div class="configuration-block jsactive clearfix"><ul class="simple"><li><em>YAML</em><div class="highlight-yaml"><pre class="code-block-table"><code class="yaml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="43e5b6bd8872a95bbad90edd79c473c3201f4b2c"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="43e5b6bd8872a95bbad90edd79c473c3201f4b2c"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-1" class="line-number-anchor" /><a href="#line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-attr">doctrine:</span>
    <span class="hljs-attr">dbal:</span>
        <span class="hljs-attr">schema_filter:</span> <span class="hljs-string">~^(?!t_)~</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-2" class="line-number-anchor" /><a href="#line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-3" class="line-number-anchor" /><a href="#line-number-43e5b6bd8872a95bbad90edd79c473c3201f4b2c-3">3</a></td></tr></table></div></code></pre></div></li><li><em>XML</em><div class="highlight-xml"><pre class="code-block-table"><code class="xml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="2facc0158b78eedfd5e1a0381521f916d30e30e3"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="2facc0158b78eedfd5e1a0381521f916d30e30e3"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-2facc0158b78eedfd5e1a0381521f916d30e30e3-1" class="line-number-anchor" /><a href="#line-number-2facc0158b78eedfd5e1a0381521f916d30e30e3-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-tag">&lt;<span class="hljs-name">doctrine:dbal</span> <span class="hljs-attr">schema-filter</span>=<span class="hljs-string">"~^(?!t_)~"</span> <span class="hljs-attr">...</span> /&gt;</span></td></tr></table></div></code></pre></div></li><li><em>PHP</em><div class="highlight-php"><pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="912d63b22b2fbd38eb8c4172ff67867f990762da"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="912d63b22b2fbd38eb8c4172ff67867f990762da"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-1" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-1">1</a></td><td class="code-line" rowspan="7">$container-&gt;loadFromExtension(<span class="hljs-string">'doctrine'</span>, <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'dbal'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'schema_filter'</span>  =&gt; <span class="hljs-string">'~^(?!t_)~'</span>,
        <span class="hljs-comment">// ...</span>
    ),
    <span class="hljs-comment">// ...</span>
));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-2" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-3" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-4" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-5" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-6" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-7" class="line-number-anchor" /><a href="#line-number-912d63b22b2fbd38eb8c4172ff67867f990762da-7">7</a></td></tr></table></div></code></pre></div></li></ul></div>
<p>This ignores the tables on the DBAL level and they will be ignored by the diff command.</p>
<p>Note that if you have multiple connections configured then the <code>schema_filter</code> configuration
will need to be placed per-connection.</p>

</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?5d0fd0"
                            integrity="sha384-TnaYDKY9cY88DXYXY7rU1IVke3HynvLXOMGgtQIgQ07BiIc7Do6FkF/nvsbUS9Xn"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'doctrine-migrations-bundle';
            var versionSlug = '1.1';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search DoctrineMigrationsBundle 1.1'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
