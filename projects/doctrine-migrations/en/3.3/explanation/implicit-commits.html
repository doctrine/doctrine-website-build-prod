<!DOCTYPE html>
<html>
    <head>
        <title>        Implicit commits - Doctrine Migrations
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Migrations Documentation: Implicit commits ">

        <meta name="keywords" content="                    database,migrations,dbal,documentation,implicit,commits
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.8/explanation/implicit-commits.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?74d1a1"
                        integrity="sha384-dAaEn2ZyD87ZE8ZaTOc39tmNlPuZWU7Tvl3K1W/IXH5rtko68QAI5cdG6HLv97IH"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.3/explanation/implicit-commits.html" />
        <meta property="og:title" content="        Implicit commits - Doctrine Migrations
    " />
        <meta property="og:description" content="Doctrine Migrations Documentation: Implicit commits " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Migrations",
            "description": "Implicit commits",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/migrations/edit/3.3.x/docs/en/explanation/implicit-commits.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        

            <div class="toc">
    <ul class="menu-level">
    <li class="toc-item">
    <a href="../reference/introduction.html#introduction">Introduction</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/introduction.html#installation">Installation</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/introduction.html#composer">Composer</a>


</li>
            <li class="toc-item">
    <a href="../reference/introduction.html#phar">PHAR</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/configuration.html#configuration">Configuration</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/configuration.html#migrations-configuration">Migrations Configuration</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/configuration.html#manually-providing-migrations">Manually Providing Migrations</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="../reference/configuration.html#all-or-nothing-transaction">All or Nothing Transaction</a>


</li>
            <li class="toc-item">
    <a href="../reference/configuration.html#using-or-not-using-transactions">Using or not using transactions</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/configuration.html#from-the-command-line">From the Command Line</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="../reference/configuration.html#connection-configuration">Connection Configuration</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/configuration.html#simple">Simple</a>


</li>
            <li class="toc-item">
    <a href="../reference/configuration.html#advanced">Advanced</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/migration-classes.html#migration-classes">Migration Classes</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/migration-classes.html#methods-to-implement">Methods to Implement</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/migration-classes.html#istransactional">isTransactional</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#getdescription">getDescription</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#preup">preUp</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#postup">postUp</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#predown">preDown</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#postdown">postDown</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#methods-to-call">Methods to Call</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="../reference/migration-classes.html#warnif">warnIf</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#abortif">abortIf</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#skipif">skipIf</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#addsql">addSql</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#write">write</a>


</li>
            <li class="toc-item">
    <a href="../reference/migration-classes.html#throwirreversiblemigrationexception">throwIrreversibleMigrationException</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/managing-migrations.html#managing-migrations">Managing Migrations</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#status">Status</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#dry-run">Dry Run</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#executing-multiple-migrations">Executing Multiple Migrations</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#executing-single-migrations">Executing Single Migrations</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#no-interaction">No Interaction</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#reverting-migrations">Reverting Migrations</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#version-aliases">Version Aliases</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#writing-migration-sql-files">Writing Migration SQL Files</a>


</li>
            <li class="toc-item">
    <a href="../reference/managing-migrations.html#managing-the-version-table">Managing the Version Table</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/generating-migrations.html#generating-migrations">Generating Migrations</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#generating-blank-migrations">Generating Blank Migrations</a>


</li>
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#diffing-using-the-orm">Diffing Using the ORM</a>


</li>
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#diffing-without-the-orm">Diffing Without the ORM</a>


</li>
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#formatted-sql">Formatted SQL</a>


</li>
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#ignoring-custom-tables">Ignoring Custom Tables</a>


</li>
            <li class="toc-item">
    <a href="../reference/generating-migrations.html#merging-historical-migrations">Merging Historical Migrations</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/custom-configuration.html#custom-configuration">Custom Configuration</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="../reference/custom-configuration.html#custom-migration-template">Custom migration template</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="../reference/events.html#migrations-events">Migrations Events</a>


</li>
    <li class="toc-item">
    <a href="../reference/version-numbers.html#version-numbers">Version Numbers</a>


</li>
    <li class="toc-item">
    <a href="../reference/integrations.html#integrations">Integrations</a>


</li>
    <li class="toc-item">
    <a href="../reference/custom-integration.html#custom-integration">Custom Integration</a>


</li>
    </ul>
</div>
    

                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "Migrations",
            "item": "https://www.doctrine-project.org/projects/migrations.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations/en/3.3/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Implicit commits",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations/en/3.3/explanation/implicit-commits.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/migrations.html">Migrations</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.3/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Implicit commits</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-migrations/en/3.3/explanation/implicit-commits.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        3.3.2
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations/en/4.0/explanation/implicit-commits.html">
                                                        4.0

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations/en/3.9/explanation/implicit-commits.html">
                                                        3.9

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations/en/3.8/explanation/implicit-commits.html">
                                                        3.8.2

                                                                                                                    (current)
                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.7/explanation/implicit-commits.html">3.7</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.6/explanation/implicit-commits.html">3.6</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.5/explanation/implicit-commits.html">3.5</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.4/explanation/implicit-commits.html">3.4</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item active" href="/projects/doctrine-migrations/en/3.3/explanation/implicit-commits.html">3.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.2/explanation/implicit-commits.html">3.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">3.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">3.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">2.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">2.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">2.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">2.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">1.8</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">1.7</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                </div>
                            
                            

            <div class="section" id="implicit-commits">
            <h1 class="section-header ">
    <a href="#implicit-commits">
        Implicit commits
        <i class="fas fa-link"></i>
    </a>
</h1>
            
    <p>Since PHP8, if you are using some platforms with some drivers such as
MySQL with PDO, you may get an error that you did not get before when
using this library: <code>There is no active transaction</code>. It comes from
the fact that some platforms like MySQL or Oracle do not support DDL
statements (<code>CREATE TABLE</code>, <code>ALTER TABLE</code>, etc.) in transactions.</p>

            
    <p>The issue existed before PHP 8 but is now made visible by e.g. PDO,
which now produces the above error message when this library attempts to
commit a transaction that has already been commited before.</p>

            
    <p>Consider the following migration.</p>

            <pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="78e9c2db713fb1242c5b9a13b943929a73f7871c"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="78e9c2db713fb1242c5b9a13b943929a73f7871c"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-1" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-1">1</a></td><td class="code-line" rowspan="14"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">(Schema $schema)</span>: <span class="hljs-title">void</span>
</span>{
    $users = [
        [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'mike'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">1</span>],
        [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'jwage'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">2</span>],
        [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'ocramius'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">3</span>],
    ];

    <span class="hljs-keyword">foreach</span> ($users <span class="hljs-keyword">as</span> $user) {
        <span class="hljs-keyword">$this</span>-&gt;addSql(<span class="hljs-string">'UPDATE user SET happy = true WHERE name = :name AND id = :id'</span>, $user);
    }

    <span class="hljs-keyword">$this</span>-&gt;addSql(<span class="hljs-string">'CREATE TABLE example_table (id INT AUTO_INCREMENT NOT NULL, title VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id))'</span>);
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-2" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-3" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-4" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-5" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-6" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-7" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-8" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-9" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-10" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-11" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-12" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-13" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-14" class="line-number-anchor" /><a href="#line-number-78e9c2db713fb1242c5b9a13b943929a73f7871c-14">14</a></td></tr></table></div></code></pre>
            
    <p>When you run that migration, what actually happens with some platforms
is you get the updates inside an implicitly commited transaction, then
the <code>CREATE TABLE</code> happens outside that transaction, and then there is
an attempt to commit an non-existent transaction.</p>

            
    <p>In that sort of situation, if you still wish to get the DML statements
inside a transaction, we recommend you split the migration in 2
migrations, as follows.</p>

            <pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="d0c1c3e0ae13abf702c62ec57218878ec6a77242"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="d0c1c3e0ae13abf702c62ec57218878ec6a77242"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-1" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-1">1</a></td><td class="code-line" rowspan="28"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Version20210401193057</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMigration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">(Schema $schema)</span>: <span class="hljs-title">void</span>
    </span>{
        $users = [
            [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'mike'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">1</span>],
            [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'jwage'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">2</span>],
            [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'ocramius'</span>, <span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">3</span>],
        ];

        <span class="hljs-keyword">foreach</span> ($users <span class="hljs-keyword">as</span> $user) {
            <span class="hljs-keyword">$this</span>-&gt;addSql(<span class="hljs-string">'UPDATE user SET happy = true WHERE name = :name AND id = :id'</span>, $user);
        }
    }
}

<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Version20210401193058</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMigration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">(Schema $schema)</span>: <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;addSql(<span class="hljs-string">'CREATE TABLE example_table (id INT AUTO_INCREMENT NOT NULL, title VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id))'</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTransactional</span><span class="hljs-params">()</span>: <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-2" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-3" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-4" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-5" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-6" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-7" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-8" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-9" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-10" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-11" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-12" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-13" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-14" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-15" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-16" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-17" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-18" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-18">18</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-19" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-19">19</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-20" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-20">20</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-21" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-21">21</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-22" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-22">22</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-23" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-23">23</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-24" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-24">24</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-25" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-25">25</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-26" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-26">26</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-27" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-27">27</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-28" class="line-number-anchor" /><a href="#line-number-d0c1c3e0ae13abf702c62ec57218878ec6a77242-28">28</a></td></tr></table></div></code></pre>
            
    <p>Please refer to the manual of your database platform to know if you need
to do this or not.</p>

            
    <p>At the moment, this library checks if there is an active transaction
before commiting it, which means you should not encouter the error
described above. It will not be the case in the next major version
though, and you should prepare for that.</p>

            
    <p>To help you deal with this issue, the library features a configuration
key called <code>transactional</code>. Setting it to <code>false</code> will cause new
migrations to be generated with the override method above, making new
migrations non-transactional by default.</p>

    </div>
        

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?1546fc"
                            integrity="sha384-ix9eb2EZyp9uayYpxmCQoylbz8msHl5wOg/aqZnD/3cxszNUGePN656MRg5GEgbm"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'migrations';
            var versionSlug = '3.3';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search Migrations 3.3'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
