<!DOCTYPE html>
<html>
    <head>
        <title>        Custom Configuration - Doctrine Migrations
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Migrations Documentation: Custom Configuration ">

        <meta name="keywords" content="                    database,migrations,dbal,documentation,custom,configuration
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.9/reference/custom-configuration.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?6e5d9f"
                        integrity="sha384-1gHMA2pCh3C7C5PdanZqLyU+p0j9aNUSKdqMxyST9hhhoAcooEmUcqk0Rj7owse5"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.1/reference/custom-configuration.html" />
        <meta property="og:title" content="        Custom Configuration - Doctrine Migrations
    " />
        <meta property="og:description" content="Doctrine Migrations Documentation: Custom Configuration " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Migrations",
            "description": "Custom Configuration",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/migrations/edit/3.1.x/docs/en/reference/custom-configuration.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        

            <div class="toc">
    <ul class="menu-level">
    <li class="toc-item">
    <a href="introduction.html#introduction">Introduction</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="introduction.html#installation">Installation</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="introduction.html#composer">Composer</a>


</li>
            <li class="toc-item">
    <a href="introduction.html#phar">PHAR</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="configuration.html#configuration">Configuration</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="configuration.html#migrations-configuration">Migrations Configuration</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#manually-providing-migrations">Manually Providing Migrations</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="configuration.html#all-or-nothing-transaction">All or Nothing Transaction</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#from-the-command-line">From the Command Line</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="configuration.html#connection-configuration">Connection Configuration</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="configuration.html#simple">Simple</a>


</li>
            <li class="toc-item">
    <a href="configuration.html#advanced">Advanced</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="migration-classes.html#migration-classes">Migration Classes</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="migration-classes.html#methods-to-implement">Methods to Implement</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="migration-classes.html#istransactional">isTransactional</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#getdescription">getDescription</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#preup">preUp</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#postup">postUp</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#predown">preDown</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#postdown">postDown</a>


</li>
                    </ul>
</li>
            <li class="toc-item">
    <a href="migration-classes.html#methods-to-call">Methods to Call</a>

        <ul class="section-level-2">
            <li class="toc-item">
    <a href="migration-classes.html#warnif">warnIf</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#abortif">abortIf</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#skipif">skipIf</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#addsql">addSql</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#write">write</a>


</li>
            <li class="toc-item">
    <a href="migration-classes.html#throwirreversiblemigrationexception">throwIrreversibleMigrationException</a>


</li>
                    </ul>
</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="managing-migrations.html#managing-migrations">Managing Migrations</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="managing-migrations.html#status">Status</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#dry-run">Dry Run</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#executing-multiple-migrations">Executing Multiple Migrations</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#executing-single-migrations">Executing Single Migrations</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#no-interaction">No Interaction</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#reverting-migrations">Reverting Migrations</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#version-aliases">Version Aliases</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#writing-migration-sql-files">Writing Migration SQL Files</a>


</li>
            <li class="toc-item">
    <a href="managing-migrations.html#managing-the-version-table">Managing the Version Table</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="generating-migrations.html#generating-migrations">Generating Migrations</a>

        <ul class="section-level-1">
            <li class="toc-item">
    <a href="generating-migrations.html#generating-blank-migrations">Generating Blank Migrations</a>


</li>
            <li class="toc-item">
    <a href="generating-migrations.html#diffing-using-the-orm">Diffing Using the ORM</a>


</li>
            <li class="toc-item">
    <a href="generating-migrations.html#diffing-without-the-orm">Diffing Without the ORM</a>


</li>
            <li class="toc-item">
    <a href="generating-migrations.html#formatted-sql">Formatted SQL</a>


</li>
            <li class="toc-item">
    <a href="generating-migrations.html#ignoring-custom-tables">Ignoring Custom Tables</a>


</li>
            <li class="toc-item">
    <a href="generating-migrations.html#merging-historical-migrations">Merging Historical Migrations</a>


</li>
                    </ul>
</li>
    <li class="toc-item opened">
    <a href="#custom-configuration">Custom Configuration</a>

        <ul class="section-level-1 opened-ul ">
            <li class="toc-item">
    <a href="#custom-migration-template">Custom migration template</a>


</li>
                    </ul>
</li>
    <li class="toc-item">
    <a href="events.html#migrations-events">Migrations Events</a>


</li>
    <li class="toc-item">
    <a href="version-numbers.html#version-numbers">Version Numbers</a>


</li>
    <li class="toc-item">
    <a href="integrations.html#integrations">Integrations</a>


</li>
    <li class="toc-item">
    <a href="custom-integration.html#custom-integration">Custom Integration</a>


</li>
    </ul>
</div>
    

                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "Migrations",
            "item": "https://www.doctrine-project.org/projects/migrations.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations/en/3.1/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Custom Configuration",
            "item": "https://www.doctrine-project.org/projects/doctrine-migrations/en/3.1/reference/custom-configuration.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/migrations.html">Migrations</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-migrations/en/3.1/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Custom Configuration</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-migrations/en/3.1/reference/custom-configuration.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        3.1.5
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations/en/4.0/reference/custom-configuration.html">
                                                        4.0

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-migrations/en/3.10/reference/custom-configuration.html">
                                                        3.10

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-migrations/en/3.9/reference/custom-configuration.html">
                                                        3.9.2

                                                                                                                    (current)
                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.8/reference/custom-configuration.html">3.8</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.7/reference/custom-configuration.html">3.7</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.6/reference/custom-configuration.html">3.6</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.5/reference/custom-configuration.html">3.5</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.4/reference/custom-configuration.html">3.4</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.3/reference/custom-configuration.html">3.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.2/reference/custom-configuration.html">3.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item active" href="/projects/doctrine-migrations/en/3.1/reference/custom-configuration.html">3.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/3.0/reference/custom-configuration.html">3.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/2.3/reference/custom-configuration.html">2.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/2.2/reference/custom-configuration.html">2.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/2.1/reference/custom-configuration.html">2.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-migrations/en/2.0/reference/custom-configuration.html">2.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">1.8</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item disabled" href="">1.7</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                </div>
                            
                            

            <div class="section" id="custom-configuration">
            <h1 class="section-header ">
    <a href="#custom-configuration">
        Custom Configuration
        <i class="fas fa-link"></i>
    </a>
</h1>
            
    <p>It is possible to build a custom configuration where you manually build the <code>Doctrine\Migrations\Configuration\Configuration</code>
instance instead of using YAML, XML, etc. In order to do this, you will need to setup a <a href="custom-integration.html#custom-integration">Custom Integration</a>.</p>

            
    <p>Once you have your custom integration setup, you can modify it to look like the following:</p>

                <pre class="code-block-table" id="8b9c233889cf66cbaa9835b041cebb5e89e6eee5"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="8b9c233889cf66cbaa9835b041cebb5e89e6eee5"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-comment">#!/usr/bin/env php</span></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">require_once</span> <span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">'/vendor/autoload.php'</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">DriverManager</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Configuration</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Connection</span>\<span class="hljs-title">ExistingConnection</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Migration</span>\<span class="hljs-title">ExistingConfiguration</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">DependencyFactory</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Metadata</span>\<span class="hljs-title">Storage</span>\<span class="hljs-title">TableMetadataStorageConfiguration</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Tools</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Command</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Application</span>;</code><code class="line language-php"></code><code class="line language-php">$dbParams = [</code><code class="line language-php">    <span class="hljs-string">'dbname'</span> =&gt; <span class="hljs-string">'migrations_docs_example'</span>,</code><code class="line language-php">    <span class="hljs-string">'user'</span> =&gt; <span class="hljs-string">'root'</span>,</code><code class="line language-php">    <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">''</span>,</code><code class="line language-php">    <span class="hljs-string">'host'</span> =&gt; <span class="hljs-string">'localhost'</span>,</code><code class="line language-php">    <span class="hljs-string">'driver'</span> =&gt; <span class="hljs-string">'pdo_mysql'</span>,</code><code class="line language-php">];</code><code class="line language-php"></code><code class="line language-php">$connection = DriverManager::getConnection($dbParams);</code><code class="line language-php"></code><code class="line language-php">$configuration = <span class="hljs-keyword">new</span> Configuration($connection);</code><code class="line language-php"></code><code class="line language-php">$configuration-&gt;addMigrationsDirectory(<span class="hljs-string">'MyProject\Migrations'</span>, <span class="hljs-string">'/data/doctrine/migrations-docs-example/lib/MyProject/Migrations'</span>);</code><code class="line language-php">$configuration-&gt;setAllOrNothing(<span class="hljs-keyword">true</span>);</code><code class="line language-php">$configuration-&gt;setCheckDatabasePlatform(<span class="hljs-keyword">false</span>);</code><code class="line language-php"></code><code class="line language-php">$storageConfiguration = <span class="hljs-keyword">new</span> TableMetadataStorageConfiguration();</code><code class="line language-php">$storageConfiguration-&gt;setTableName(<span class="hljs-string">'doctrine_migration_versions'</span>);</code><code class="line language-php"></code><code class="line language-php">$configuration-&gt;setMetadataStorageConfiguration($storageConfiguration);</code><code class="line language-php"></code><code class="line language-php">$dependencyFactory = DependencyFactory::fromConnection(</code><code class="line language-php">    <span class="hljs-keyword">new</span> ExistingConfiguration($configuration),</code><code class="line language-php">    <span class="hljs-keyword">new</span> ExistingConnection($connection)</code><code class="line language-php">);</code><code class="line language-php"></code><code class="line language-php">$cli = <span class="hljs-keyword">new</span> Application(<span class="hljs-string">'Doctrine Migrations'</span>);</code><code class="line language-php">$cli-&gt;setCatchExceptions(<span class="hljs-keyword">true</span>);</code><code class="line language-php"></code><code class="line language-php">$cli-&gt;addCommands(<span class="hljs-keyword">array</span>(</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\DumpSchemaCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\ExecuteCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\GenerateCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\LatestCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\ListCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\MigrateCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\RollupCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\StatusCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\SyncMetadataCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\VersionCommand($dependencyFactory),</code><code class="line language-php">));</code><code class="line language-php"></code><code class="line language-php">$cli-&gt;run();</code><code class="empty"></code></pre>
            
    <p>Next Chapter: Migrations Events</p>

            
    <p>It is possible to use multiple entity managers or connections, this is a way to configure your application:</p>

                <pre class="code-block-table" id="bbfcca25d5d0482f44fbfd482c916ad4d6bf9bab"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="bbfcca25d5d0482f44fbfd482c916ad4d6bf9bab"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-comment">#!/usr/bin/env php</span></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">require_once</span> <span class="hljs-keyword">__DIR__</span>.<span class="hljs-string">'/vendor/autoload.php'</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">DriverManager</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Configuration</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">ExistingConfiguration</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Configuration</span>\<span class="hljs-title">Connection</span>\<span class="hljs-title">ConnectionRegistryConnection</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">DependencyFactory</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">Tools</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Command</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Application</span>;</code><code class="line language-php"></code><code class="line language-php">$connection1 = DriverManager::getConnection([...]);</code><code class="line language-php">$connection2 = DriverManager::getConnection([...]);</code><code class="line language-php"></code><code class="line language-php">$connectionRegistry = <span class="hljs-keyword">new</span> <span class="hljs-class"><span class="hljs-keyword">class</span>(</span></code><code class="line language-php">    <span class="hljs-string">'some_registry'</span>,</code><code class="line language-php">    [<span class="hljs-string">'foo'</span> =&gt; $connection1, <span class="hljs-string">'bar'</span> =&gt; $connection2],</code><code class="line language-php">    [], <span class="hljs-comment">// entity managers</span></code><code class="line language-php">    <span class="hljs-string">'foo'</span>, <span class="hljs-comment">// default connection</span></code><code class="line language-php">    <span class="hljs-keyword">null</span>, <span class="hljs-comment">// default entity manager</span></code><code class="line language-php">    <span class="hljs-string">'Doctrine\Persistence\Proxy'</span> <span class="hljs-comment">// proxy class</span></code><code class="line language-php">) extends AbstractManagerRegistry {</code><code class="line language-php">    <span class="hljs-comment">// implement abstract methods here</span></code><code class="line language-php">};</code><code class="line language-php"></code><code class="line language-php">$configuration = <span class="hljs-keyword">new</span> Configuration($connection);</code><code class="line language-php">$configuration-&gt;addMigrationsDirectory(<span class="hljs-string">'MyProject\Migrations'</span>, <span class="hljs-string">'some path'</span>);</code><code class="line language-php">$configurationLoader = <span class="hljs-keyword">new</span> ExistingConfiguration($configuration);</code><code class="line language-php"></code><code class="line language-php">$connectionLoader = ConnectionRegistryConnection::withSimpleDefault($connectionRegistry);</code><code class="line language-php"></code><code class="line language-php">$dependencyFactory = DependencyFactory::fromConnection(</code><code class="line language-php">    $configurationLoader,</code><code class="line language-php">    $connectionLoader</code><code class="line language-php">);</code><code class="line language-php"></code><code class="line language-php">$cli = <span class="hljs-keyword">new</span> Application(<span class="hljs-string">'Doctrine Migrations'</span>);</code><code class="line language-php">$cli-&gt;setCatchExceptions(<span class="hljs-keyword">true</span>);</code><code class="line language-php"></code><code class="line language-php">$cli-&gt;addCommands(<span class="hljs-keyword">array</span>(</code><code class="line language-php">    <span class="hljs-keyword">new</span> Command\MigrateCommand($dependencyFactory),</code><code class="line language-php">    <span class="hljs-comment">// more commands here</span></code><code class="line language-php">));</code><code class="line language-php"></code><code class="line language-php">$cli-&gt;run();</code><code class="empty"></code></pre>
            
    <p>With this configuration you can use the <code>--conn</code> parameter to specify a connection that will be used for running
migrations. If the parameter is not passed, it will fallback to the one passed in the configuration,
and if that is also not provided it will fallback to the default connection name specified when creating
the connection registry.</p>

            <div class="section" id="custom-migration-template">
            <h2 class="section-header ">
    <a href="#custom-migration-template">
        Custom migration template
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>When the default generated migrations do not suit your needs, you may provide a custom migration template that will
be used to generate future migrations.</p>

            
    <p>For example, if you don&#039;t need a <code>down</code> migration your template could look like this:</p>

                <pre class="code-block-table" id="e59c6341a680ec24c625826c52b8c6d46c17b8cc"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="e59c6341a680ec24c625826c52b8c6d46c17b8cc"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php"><span class="hljs-meta">&lt;?php</span></code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">namespace</span> &lt;<span class="hljs-title">namespace</span>&gt;;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">Schema</span>\<span class="hljs-title">Schema</span>;</code><code class="line language-php"><span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Migrations</span>\<span class="hljs-title">AbstractMigration</span>;</code><code class="line language-php"></code><code class="line language-php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;<span class="hljs-title">className</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMigration</span></span></code><code class="line language-php">{</code><code class="line language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">(Schema $schema)</span>: <span class="hljs-title">void</span></span></code><code class="line language-php">    {</code><code class="line language-php">        &lt;up&gt;</code><code class="line language-php">    }</code><code class="line language-php">}</code><code class="empty"></code></pre>
            
    <p>Placeholders (words inside <code>&lt; &gt;</code>) are replaced with correct code upon generation. All possible wildcards are:</p>

            <table>
                <tbody>
    <tr>
            <td>Placeholder</td>
            <td>Description</td>
    </tr>
    <tr>
            <td><code>&lt;namespace&gt;</code></td>
            <td>Namespace of the class, e.g. <code>App\Migrations</code></td>
    </tr>
    <tr>
            <td><code>&lt;className&gt;</code></td>
            <td>Classname, e.g. <code>Version20210212092730</code></td>
    </tr>
    <tr>
            <td><code>&lt;up&gt;</code></td>
            <td>SQL for migrating up</td>
    </tr>
    <tr>
            <td><code>&lt;down&gt;</code></td>
            <td>SQL for migrating down</td>
    </tr>
</tbody>
</table>
            
    <p>The custom template needs to be configured.</p>

                <pre class="code-block-table" id="f1c6acdf3f21adb2c443ab858f8632dbb098b86e"><button
                type="button"
                class="copy-to-clipboard"
                data-copy-element-id="f1c6acdf3f21adb2c443ab858f8632dbb098b86e"
                title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><code class="empty"></code><code class="line language-php">$configuration-&gt;setCustomTemplate(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/custom_template.tpl'</span>);</code><code class="empty"></code></pre>
    </div>
    </div>
        

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?1546fc"
                            integrity="sha384-ix9eb2EZyp9uayYpxmCQoylbz8msHl5wOg/aqZnD/3cxszNUGePN656MRg5GEgbm"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'migrations';
            var versionSlug = '3.1';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search Migrations 3.1'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
