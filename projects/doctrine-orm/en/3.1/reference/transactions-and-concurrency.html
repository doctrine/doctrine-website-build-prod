<!DOCTYPE html>
<html>
    <head>
        <title>        Transactions and Concurrency - Doctrine Object Relational Mapper (ORM)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Object Relational Mapper Documentation: Transactions and Concurrency ">

        <meta name="keywords" content="                    orm,database,documentation,transactions,and,concurrency
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-orm/en/3.0/reference/transactions-and-concurrency.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?d5ed26"
                        integrity="sha384-Dh4F6wmQ1ugK1ivbMlH1rvcAYnrhHcqwtE8Z7tqpnFw9oT3eYTwMxgAgKMnyujap"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-orm/en/3.1/reference/transactions-and-concurrency.html" />
        <meta property="og:title" content="        Transactions and Concurrency - Doctrine Object Relational Mapper (ORM)
    " />
        <meta property="og:description" content="Doctrine Object Relational Mapper Documentation: Transactions and Concurrency " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Object Relational Mapper",
            "description": "Transactions and Concurrency",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/orm/edit/3.1.x/docs/en/reference/transactions-and-concurrency.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc-section"><h2 class="toc-header">Tutorials</h2>
<div class="toc"><ul><li id="tutorials-getting-started-html" class="toc-item"><a href="../tutorials/getting-started.html">Getting Started with Doctrine</a><ul><li id="tutorials-getting-started-html-guide-assumptions" class="toc-item"><a href="../tutorials/getting-started.html#guide-assumptions">Guide Assumptions</a></li><li id="tutorials-getting-started-html-what-is-doctrine" class="toc-item"><a href="../tutorials/getting-started.html#what-is-doctrine">What is Doctrine?</a><ul><li id="tutorials-getting-started-html-what-are-entities" class="toc-item"><a href="../tutorials/getting-started.html#what-are-entities">What are Entities?</a></li></ul></li><li id="tutorials-getting-started-html-an-example-model-bug-tracker" class="toc-item"><a href="../tutorials/getting-started.html#an-example-model-bug-tracker">An Example Model: Bug Tracker</a></li><li id="tutorials-getting-started-html-project-setup" class="toc-item"><a href="../tutorials/getting-started.html#project-setup">Project Setup</a></li><li id="tutorials-getting-started-html-obtaining-the-entitymanager" class="toc-item"><a href="../tutorials/getting-started.html#obtaining-the-entitymanager">Obtaining the EntityManager</a></li><li id="tutorials-getting-started-html-generating-the-database-schema" class="toc-item"><a href="../tutorials/getting-started.html#generating-the-database-schema">Generating the Database Schema</a></li><li id="tutorials-getting-started-html-starting-with-the-product-entity" class="toc-item"><a href="../tutorials/getting-started.html#starting-with-the-product-entity">Starting with the Product Entity</a><ul><li id="tutorials-getting-started-html-adding-behavior-to-entities" class="toc-item"><a href="../tutorials/getting-started.html#adding-behavior-to-entities">Adding behavior to Entities</a></li></ul></li><li id="tutorials-getting-started-html-adding-bug-and-user-entities" class="toc-item"><a href="../tutorials/getting-started.html#adding-bug-and-user-entities">Adding Bug and User Entities</a></li><li id="tutorials-getting-started-html-implementing-more-requirements" class="toc-item"><a href="../tutorials/getting-started.html#implementing-more-requirements">Implementing more Requirements</a></li><li id="tutorials-getting-started-html-queries-for-application-use-cases" class="toc-item"><a href="../tutorials/getting-started.html#queries-for-application-use-cases">Queries for Application Use-Cases</a><ul><li id="tutorials-getting-started-html-list-of-bugs" class="toc-item"><a href="../tutorials/getting-started.html#list-of-bugs">List of Bugs</a></li><li id="tutorials-getting-started-html-array-hydration-of-the-bug-list" class="toc-item"><a href="../tutorials/getting-started.html#array-hydration-of-the-bug-list">Array Hydration of the Bug List</a></li><li id="tutorials-getting-started-html-find-by-primary-key" class="toc-item"><a href="../tutorials/getting-started.html#find-by-primary-key">Find by Primary Key</a></li></ul></li><li id="tutorials-getting-started-html-dashboard-of-the-user" class="toc-item"><a href="../tutorials/getting-started.html#dashboard-of-the-user">Dashboard of the User</a></li><li id="tutorials-getting-started-html-number-of-bugs" class="toc-item"><a href="../tutorials/getting-started.html#number-of-bugs">Number of Bugs</a></li><li id="tutorials-getting-started-html-updating-entities" class="toc-item"><a href="../tutorials/getting-started.html#updating-entities">Updating Entities</a></li><li id="tutorials-getting-started-html-entity-repositories" class="toc-item"><a href="../tutorials/getting-started.html#entity-repositories">Entity Repositories</a></li><li id="tutorials-getting-started-html-conclusion" class="toc-item"><a href="../tutorials/getting-started.html#conclusion">Conclusion</a></li></ul></li><li id="tutorials-getting-started-database-html" class="toc-item"><a href="../tutorials/getting-started-database.html">Getting Started: Database First</a></li><li id="tutorials-getting-started-models-html" class="toc-item"><a href="../tutorials/getting-started-models.html">Getting Started: Model First</a></li><li id="tutorials-working-with-indexed-associations-html" class="toc-item"><a href="../tutorials/working-with-indexed-associations.html">Working with Indexed Associations</a><ul><li id="tutorials-working-with-indexed-associations-html-mapping-indexed-associations" class="toc-item"><a href="../tutorials/working-with-indexed-associations.html#mapping-indexed-associations">Mapping Indexed Associations</a></li><li id="tutorials-working-with-indexed-associations-html-querying-indexed-associations" class="toc-item"><a href="../tutorials/working-with-indexed-associations.html#querying-indexed-associations">Querying indexed associations</a></li><li id="tutorials-working-with-indexed-associations-html-outlook-into-the-future" class="toc-item"><a href="../tutorials/working-with-indexed-associations.html#outlook-into-the-future">Outlook into the Future</a></li></ul></li><li id="tutorials-extra-lazy-associations-html" class="toc-item"><a href="../tutorials/extra-lazy-associations.html">Extra Lazy Associations</a><ul><li id="tutorials-extra-lazy-associations-html-enabling-extra-lazy-associations" class="toc-item"><a href="../tutorials/extra-lazy-associations.html#enabling-extra-lazy-associations">Enabling Extra-Lazy Associations</a></li></ul></li><li id="tutorials-composite-primary-keys-html" class="toc-item"><a href="../tutorials/composite-primary-keys.html">Composite and Foreign Keys as Primary Key</a><ul><li id="tutorials-composite-primary-keys-html-general-considerations" class="toc-item"><a href="../tutorials/composite-primary-keys.html#general-considerations">General Considerations</a></li><li id="tutorials-composite-primary-keys-html-primitive-types-only" class="toc-item"><a href="../tutorials/composite-primary-keys.html#primitive-types-only">Primitive Types only</a></li><li id="tutorials-composite-primary-keys-html-identity-through-foreign-entities" class="toc-item"><a href="../tutorials/composite-primary-keys.html#identity-through-foreign-entities">Identity through foreign Entities</a></li><li id="tutorials-composite-primary-keys-html-use-case-1-dynamic-attributes" class="toc-item"><a href="../tutorials/composite-primary-keys.html#use-case-1-dynamic-attributes">Use-Case 1: Dynamic Attributes</a></li><li id="tutorials-composite-primary-keys-html-use-case-2-simple-derived-identity" class="toc-item"><a href="../tutorials/composite-primary-keys.html#use-case-2-simple-derived-identity">Use-Case 2: Simple Derived Identity</a></li><li id="tutorials-composite-primary-keys-html-use-case-3-join-table-with-metadata" class="toc-item"><a href="../tutorials/composite-primary-keys.html#use-case-3-join-table-with-metadata">Use-Case 3: Join-Table with Metadata</a></li><li id="tutorials-composite-primary-keys-html-performance-considerations" class="toc-item"><a href="../tutorials/composite-primary-keys.html#performance-considerations">Performance Considerations</a></li></ul></li><li id="tutorials-ordered-associations-html" class="toc-item"><a href="../tutorials/ordered-associations.html">Ordering To-Many Associations</a></li><li id="tutorials-override-field-association-mappings-in-subclasses-html" class="toc-item"><a href="../tutorials/override-field-association-mappings-in-subclasses.html">Override Field Association Mappings In Subclasses</a></li><li id="tutorials-pagination-html" class="toc-item"><a href="../tutorials/pagination.html">Pagination</a></li><li id="tutorials-embeddables-html" class="toc-item"><a href="../tutorials/embeddables.html">Separating Concerns using Embeddables</a><ul><li id="tutorials-embeddables-html-initializing-embeddables" class="toc-item"><a href="../tutorials/embeddables.html#initializing-embeddables">Initializing embeddables</a></li><li id="tutorials-embeddables-html-column-prefixing" class="toc-item"><a href="../tutorials/embeddables.html#column-prefixing">Column Prefixing</a></li><li id="tutorials-embeddables-html-dql" class="toc-item"><a href="../tutorials/embeddables.html#dql">DQL</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Reference</h2>
<div class="toc"><ul><li id="architecture-html" class="toc-item"><a href="architecture.html">Architecture</a><ul><li id="architecture-html-using-an-object-relational-mapper" class="toc-item"><a href="architecture.html#using-an-object-relational-mapper">Using an Object-Relational Mapper</a></li><li id="architecture-html-requirements" class="toc-item"><a href="architecture.html#requirements">Requirements</a></li><li id="architecture-html-doctrine-orm-packages" class="toc-item"><a href="architecture.html#doctrine-orm-packages">Doctrine ORM Packages</a><ul><li id="architecture-html-collection-event-manager-and-persistence" class="toc-item"><a href="architecture.html#collection-event-manager-and-persistence">Collection, Event Manager and Persistence</a></li><li id="architecture-html-the-dbal-package" class="toc-item"><a href="architecture.html#the-dbal-package">The DBAL Package</a></li><li id="architecture-html-the-orm-package" class="toc-item"><a href="architecture.html#the-orm-package">The ORM Package</a></li></ul></li><li id="architecture-html-terminology" class="toc-item"><a href="architecture.html#terminology">Terminology</a><ul><li id="architecture-html-entities" class="toc-item"><a href="architecture.html#entities">Entities</a></li><li id="architecture-html-mapped-superclasses" class="toc-item"><a href="architecture.html#mapped-superclasses">Mapped Superclasses</a></li><li id="architecture-html-transient-classes" class="toc-item"><a href="architecture.html#transient-classes">Transient Classes</a></li><li id="architecture-html-entity-states" class="toc-item"><a href="architecture.html#entity-states">Entity states</a></li><li id="architecture-html-persistent-fields" class="toc-item"><a href="architecture.html#persistent-fields">Persistent fields</a></li><li id="architecture-html-serializing-entities" class="toc-item"><a href="architecture.html#serializing-entities">Serializing entities</a></li><li id="architecture-html-the-entitymanager" class="toc-item"><a href="architecture.html#the-entitymanager">The EntityManager</a></li><li id="architecture-html-transactional-write-behind" class="toc-item"><a href="architecture.html#transactional-write-behind">Transactional write-behind</a></li><li id="architecture-html-the-unit-of-work" class="toc-item"><a href="architecture.html#the-unit-of-work">The Unit of Work</a></li></ul></li></ul></li><li id="configuration-html" class="toc-item"><a href="configuration.html">Installation and Configuration</a><ul><li id="configuration-html-class-loading" class="toc-item"><a href="configuration.html#class-loading">Class loading</a></li><li id="configuration-html-obtaining-an-entitymanager" class="toc-item"><a href="configuration.html#obtaining-an-entitymanager">Obtaining an EntityManager</a></li><li id="configuration-html-setting-up-the-commandline-tool" class="toc-item"><a href="configuration.html#setting-up-the-commandline-tool">Setting up the Commandline Tool</a></li></ul></li><li id="faq-html" class="toc-item"><a href="faq.html">Frequently Asked Questions</a><ul><li id="faq-html-database-schema" class="toc-item"><a href="faq.html#database-schema">Database Schema</a><ul><li id="faq-html-how-do-i-set-the-charset-and-collation-for-mysql-tables" class="toc-item"><a href="faq.html#how-do-i-set-the-charset-and-collation-for-mysql-tables">How do I set the charset and collation for MySQL tables?</a></li></ul></li><li id="faq-html-entity-classes" class="toc-item"><a href="faq.html#entity-classes">Entity Classes</a><ul><li id="faq-html-how-can-i-add-default-values-to-a-column" class="toc-item"><a href="faq.html#how-can-i-add-default-values-to-a-column">How can I add default values to a column?</a></li></ul></li><li id="faq-html-mapping" class="toc-item"><a href="faq.html#mapping">Mapping</a><ul><li id="faq-html-why-do-i-get-exceptions-about-unique-constraint-failures-during-em-gt-flush" class="toc-item"><a href="faq.html#why-do-i-get-exceptions-about-unique-constraint-failures-during-em-gt-flush">Why do I get exceptions about unique constraint failures during $em-&gt;flush()?</a></li></ul></li><li id="faq-html-associations" class="toc-item"><a href="faq.html#associations">Associations</a><ul><li id="faq-html-what-is-wrong-when-i-get-an-invalidargumentexception-a-new-entity-was-found-through-the-relationship" class="toc-item"><a href="faq.html#what-is-wrong-when-i-get-an-invalidargumentexception-a-new-entity-was-found-through-the-relationship">What is wrong when I get an InvalidArgumentException "A new entity was found through the relationship.."?</a></li><li id="faq-html-how-can-i-filter-an-association" class="toc-item"><a href="faq.html#how-can-i-filter-an-association">How can I filter an association?</a></li><li id="faq-html-i-call-clear-on-a-one-to-many-collection-but-the-entities-are-not-deleted" class="toc-item"><a href="faq.html#i-call-clear-on-a-one-to-many-collection-but-the-entities-are-not-deleted">I call clear() on a One-To-Many collection but the entities are not deleted</a></li><li id="faq-html-how-can-i-add-columns-to-a-many-to-many-table" class="toc-item"><a href="faq.html#how-can-i-add-columns-to-a-many-to-many-table">How can I add columns to a many-to-many table?</a></li><li id="faq-html-how-can-i-paginate-fetch-joined-collections" class="toc-item"><a href="faq.html#how-can-i-paginate-fetch-joined-collections">How can i paginate fetch-joined collections?</a></li><li id="faq-html-why-does-pagination-not-work-correctly-with-fetch-joins" class="toc-item"><a href="faq.html#why-does-pagination-not-work-correctly-with-fetch-joins">Why does pagination not work correctly with fetch joins?</a></li></ul></li><li id="faq-html-inheritance" class="toc-item"><a href="faq.html#inheritance">Inheritance</a><ul><li id="faq-html-can-i-use-inheritance-with-doctrine-orm" class="toc-item"><a href="faq.html#can-i-use-inheritance-with-doctrine-orm">Can I use Inheritance with Doctrine ORM?</a></li><li id="faq-html-why-does-doctrine-not-create-proxy-objects-for-my-inheritance-hierarchy" class="toc-item"><a href="faq.html#why-does-doctrine-not-create-proxy-objects-for-my-inheritance-hierarchy">Why does Doctrine not create proxy objects for my inheritance hierarchy?</a></li></ul></li><li id="faq-html-entitygenerator" class="toc-item"><a href="faq.html#entitygenerator">EntityGenerator</a><ul><li id="faq-html-why-does-the-entitygenerator-not-do-x" class="toc-item"><a href="faq.html#why-does-the-entitygenerator-not-do-x">Why does the EntityGenerator not do X?</a></li><li id="faq-html-why-does-the-entitygenerator-not-generate-inheritance-correctly" class="toc-item"><a href="faq.html#why-does-the-entitygenerator-not-generate-inheritance-correctly">Why does the EntityGenerator not generate inheritance correctly?</a></li></ul></li><li id="faq-html-performance" class="toc-item"><a href="faq.html#performance">Performance</a><ul><li id="faq-html-why-is-an-extra-sql-query-executed-every-time-i-fetch-an-entity-with-a-one-to-one-relation" class="toc-item"><a href="faq.html#why-is-an-extra-sql-query-executed-every-time-i-fetch-an-entity-with-a-one-to-one-relation">Why is an extra SQL query executed every time I fetch an entity with a one-to-one relation?</a></li></ul></li><li id="faq-html-doctrine-query-language" class="toc-item"><a href="faq.html#doctrine-query-language">Doctrine Query Language</a><ul><li id="faq-html-what-is-dql" class="toc-item"><a href="faq.html#what-is-dql">What is DQL?</a></li><li id="faq-html-can-i-sort-by-a-function-for-example-order-by-rand-in-dql" class="toc-item"><a href="faq.html#can-i-sort-by-a-function-for-example-order-by-rand-in-dql">Can I sort by a function (for example ORDER BY RAND()) in DQL?</a></li><li id="faq-html-is-it-better-to-write-dql-or-to-generate-it-with-the-query-builder" class="toc-item"><a href="faq.html#is-it-better-to-write-dql-or-to-generate-it-with-the-query-builder">Is it better to write DQL or to generate it with the query builder?</a></li></ul></li><li id="faq-html-a-query-fails-how-can-i-debug-it" class="toc-item"><a href="faq.html#a-query-fails-how-can-i-debug-it">A Query fails, how can I debug it?</a></li></ul></li><li id="basic-mapping-html" class="toc-item"><a href="basic-mapping.html">Basic Mapping</a><ul><li id="basic-mapping-html-creating-classes-for-the-database" class="toc-item"><a href="basic-mapping.html#creating-classes-for-the-database">Creating Classes for the Database</a></li><li id="basic-mapping-html-property-mapping" class="toc-item"><a href="basic-mapping.html#property-mapping">Property Mapping</a><ul><li id="basic-mapping-html-php-types-mapping" class="toc-item"><a href="basic-mapping.html#php-types-mapping">PHP Types Mapping</a></li></ul></li><li id="basic-mapping-html-doctrine-mapping-types" class="toc-item"><a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a></li><li id="basic-mapping-html-identifiers-primary-keys" class="toc-item"><a href="basic-mapping.html#identifiers-primary-keys">Identifiers / Primary Keys</a></li><li id="basic-mapping-html-quoting-reserved-words" class="toc-item"><a href="basic-mapping.html#quoting-reserved-words">Quoting Reserved Words</a></li></ul></li><li id="association-mapping-html" class="toc-item"><a href="association-mapping.html">Association Mapping</a><ul><li id="association-mapping-html-many-to-one-unidirectional" class="toc-item"><a href="association-mapping.html#many-to-one-unidirectional">Many-To-One, Unidirectional</a></li><li id="association-mapping-html-one-to-one-unidirectional" class="toc-item"><a href="association-mapping.html#one-to-one-unidirectional">One-To-One, Unidirectional</a></li><li id="association-mapping-html-one-to-one-bidirectional" class="toc-item"><a href="association-mapping.html#one-to-one-bidirectional">One-To-One, Bidirectional</a></li><li id="association-mapping-html-one-to-one-self-referencing" class="toc-item"><a href="association-mapping.html#one-to-one-self-referencing">One-To-One, Self-referencing</a></li><li id="association-mapping-html-one-to-many-bidirectional" class="toc-item"><a href="association-mapping.html#one-to-many-bidirectional">One-To-Many, Bidirectional</a></li><li id="association-mapping-html-one-to-many-unidirectional-with-join-table" class="toc-item"><a href="association-mapping.html#one-to-many-unidirectional-with-join-table">One-To-Many, Unidirectional with Join Table</a></li><li id="association-mapping-html-one-to-many-self-referencing" class="toc-item"><a href="association-mapping.html#one-to-many-self-referencing">One-To-Many, Self-referencing</a></li><li id="association-mapping-html-many-to-many-unidirectional" class="toc-item"><a href="association-mapping.html#many-to-many-unidirectional">Many-To-Many, Unidirectional</a></li><li id="association-mapping-html-many-to-many-bidirectional" class="toc-item"><a href="association-mapping.html#many-to-many-bidirectional">Many-To-Many, Bidirectional</a><ul><li id="association-mapping-html-owning-and-inverse-side-on-a-manytomany-association" class="toc-item"><a href="association-mapping.html#owning-and-inverse-side-on-a-manytomany-association">Owning and Inverse Side on a ManyToMany Association</a></li></ul></li><li id="association-mapping-html-many-to-many-self-referencing" class="toc-item"><a href="association-mapping.html#many-to-many-self-referencing">Many-To-Many, Self-referencing</a></li><li id="association-mapping-html-mapping-defaults" class="toc-item"><a href="association-mapping.html#mapping-defaults">Mapping Defaults</a></li><li id="association-mapping-html-collections" class="toc-item"><a href="association-mapping.html#collections">Collections</a></li><li id="association-mapping-html-initializing-collections" class="toc-item"><a href="association-mapping.html#initializing-collections">Initializing Collections</a></li></ul></li><li id="inheritance-mapping-html" class="toc-item"><a href="inheritance-mapping.html">Inheritance Mapping</a><ul><li id="inheritance-mapping-html-mapped-superclasses" class="toc-item"><a href="inheritance-mapping.html#mapped-superclasses">Mapped Superclasses</a></li><li id="inheritance-mapping-html-entity-inheritance" class="toc-item"><a href="inheritance-mapping.html#entity-inheritance">Entity Inheritance</a><ul><li id="inheritance-mapping-html-performance-impact-on-to-one-associations" class="toc-item"><a href="inheritance-mapping.html#performance-impact-on-to-one-associations">Performance impact on to-one associations</a></li></ul></li><li id="inheritance-mapping-html-single-table-inheritance" class="toc-item"><a href="inheritance-mapping.html#single-table-inheritance">Single Table Inheritance</a><ul><li id="inheritance-mapping-html-design-time-considerations" class="toc-item"><a href="inheritance-mapping.html#design-time-considerations">Design-time considerations</a></li><li id="inheritance-mapping-html-performance-impact" class="toc-item"><a href="inheritance-mapping.html#performance-impact">Performance impact</a></li><li id="inheritance-mapping-html-sql-schema-considerations" class="toc-item"><a href="inheritance-mapping.html#sql-schema-considerations">SQL Schema considerations</a></li></ul></li><li id="inheritance-mapping-html-class-table-inheritance" class="toc-item"><a href="inheritance-mapping.html#class-table-inheritance">Class Table Inheritance</a><ul><li id="inheritance-mapping-html-design-time-considerations" class="toc-item"><a href="inheritance-mapping.html#design-time-considerations">Design-time considerations</a></li><li id="inheritance-mapping-html-performance-impact" class="toc-item"><a href="inheritance-mapping.html#performance-impact">Performance impact</a></li><li id="inheritance-mapping-html-sql-schema-considerations" class="toc-item"><a href="inheritance-mapping.html#sql-schema-considerations">SQL Schema considerations</a></li></ul></li><li id="inheritance-mapping-html-overrides" class="toc-item"><a href="inheritance-mapping.html#overrides">Overrides</a><ul><li id="inheritance-mapping-html-association-override" class="toc-item"><a href="inheritance-mapping.html#association-override">Association Override</a></li><li id="inheritance-mapping-html-attribute-override" class="toc-item"><a href="inheritance-mapping.html#attribute-override">Attribute Override</a></li></ul></li><li id="inheritance-mapping-html-query-the-type" class="toc-item"><a href="inheritance-mapping.html#query-the-type">Query the Type</a></li></ul></li><li id="working-with-objects-html" class="toc-item"><a href="working-with-objects.html">Working with Objects</a><ul><li id="working-with-objects-html-entities-and-the-identity-map" class="toc-item"><a href="working-with-objects.html#entities-and-the-identity-map">Entities and the Identity Map</a></li><li id="working-with-objects-html-entity-object-graph-traversal" class="toc-item"><a href="working-with-objects.html#entity-object-graph-traversal">Entity Object Graph Traversal</a></li><li id="working-with-objects-html-persisting-entities" class="toc-item"><a href="working-with-objects.html#persisting-entities">Persisting entities</a></li><li id="working-with-objects-html-removing-entities" class="toc-item"><a href="working-with-objects.html#removing-entities">Removing entities</a><ul><li id="working-with-objects-html-join-table-management-when-removing-from-many-to-many-collections" class="toc-item"><a href="working-with-objects.html#join-table-management-when-removing-from-many-to-many-collections">Join-table management when removing from many-to-many collections</a></li><li id="working-with-objects-html-performance-of-different-deletion-strategies" class="toc-item"><a href="working-with-objects.html#performance-of-different-deletion-strategies">Performance of different deletion strategies</a></li></ul></li><li id="working-with-objects-html-detaching-entities" class="toc-item"><a href="working-with-objects.html#detaching-entities">Detaching entities</a></li><li id="working-with-objects-html-synchronization-with-the-database" class="toc-item"><a href="working-with-objects.html#synchronization-with-the-database">Synchronization with the Database</a><ul><li id="working-with-objects-html-effects-of-database-and-unitofwork-being-out-of-sync" class="toc-item"><a href="working-with-objects.html#effects-of-database-and-unitofwork-being-out-of-sync">Effects of Database and UnitOfWork being Out-Of-Sync</a></li><li id="working-with-objects-html-synchronizing-new-and-managed-entities" class="toc-item"><a href="working-with-objects.html#synchronizing-new-and-managed-entities">Synchronizing New and Managed Entities</a></li><li id="working-with-objects-html-synchronizing-removed-entities" class="toc-item"><a href="working-with-objects.html#synchronizing-removed-entities">Synchronizing Removed Entities</a></li><li id="working-with-objects-html-the-size-of-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a></li><li id="working-with-objects-html-the-cost-of-flushing" class="toc-item"><a href="working-with-objects.html#the-cost-of-flushing">The cost of flushing</a></li><li id="working-with-objects-html-direct-access-to-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a></li><li id="working-with-objects-html-entity-state" class="toc-item"><a href="working-with-objects.html#entity-state">Entity State</a></li></ul></li><li id="working-with-objects-html-querying" class="toc-item"><a href="working-with-objects.html#querying">Querying</a><ul><li id="working-with-objects-html-by-primary-key" class="toc-item"><a href="working-with-objects.html#by-primary-key">By Primary Key</a></li><li id="working-with-objects-html-by-simple-conditions" class="toc-item"><a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a></li><li id="working-with-objects-html-by-criteria" class="toc-item"><a href="working-with-objects.html#by-criteria">By Criteria</a></li><li id="working-with-objects-html-by-eager-loading" class="toc-item"><a href="working-with-objects.html#by-eager-loading">By Eager Loading</a></li><li id="working-with-objects-html-by-lazy-loading" class="toc-item"><a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a></li><li id="working-with-objects-html-by-dql" class="toc-item"><a href="working-with-objects.html#by-dql">By DQL</a></li><li id="working-with-objects-html-by-native-queries" class="toc-item"><a href="working-with-objects.html#by-native-queries">By Native Queries</a></li><li id="working-with-objects-html-custom-repositories" class="toc-item"><a href="working-with-objects.html#custom-repositories">Custom Repositories</a></li></ul></li></ul></li><li id="working-with-associations-html" class="toc-item"><a href="working-with-associations.html">Working with Associations</a><ul><li id="working-with-associations-html-association-example-entities" class="toc-item"><a href="working-with-associations.html#association-example-entities">Association Example Entities</a></li><li id="working-with-associations-html-establishing-associations" class="toc-item"><a href="working-with-associations.html#establishing-associations">Establishing Associations</a></li><li id="working-with-associations-html-removing-associations" class="toc-item"><a href="working-with-associations.html#removing-associations">Removing Associations</a></li><li id="working-with-associations-html-association-management-methods" class="toc-item"><a href="working-with-associations.html#association-management-methods">Association Management Methods</a></li><li id="working-with-associations-html-synchronizing-bidirectional-collections" class="toc-item"><a href="working-with-associations.html#synchronizing-bidirectional-collections">Synchronizing Bidirectional Collections</a></li><li id="working-with-associations-html-transitive-persistence-cascade-operations" class="toc-item"><a href="working-with-associations.html#transitive-persistence-cascade-operations">Transitive persistence / Cascade Operations</a><ul><li id="working-with-associations-html-persistence-by-reachability-cascade-persist" class="toc-item"><a href="working-with-associations.html#persistence-by-reachability-cascade-persist">Persistence by Reachability: Cascade Persist</a></li></ul></li><li id="working-with-associations-html-orphan-removal" class="toc-item"><a href="working-with-associations.html#orphan-removal">Orphan Removal</a></li><li id="working-with-associations-html-filtering-collections" class="toc-item"><a href="working-with-associations.html#filtering-collections">Filtering Collections</a></li></ul></li><li id="events-html" class="toc-item"><a href="events.html">Events</a><ul><li id="events-html-the-event-system" class="toc-item"><a href="events.html#the-event-system">The Event System</a><ul><li id="events-html-registering-event-handlers" class="toc-item"><a href="events.html#registering-event-handlers">Registering Event Handlers</a></li></ul></li><li id="events-html-events-overview" class="toc-item"><a href="events.html#events-overview">Events Overview</a><ul><li id="events-html-naming-convention" class="toc-item"><a href="events.html#naming-convention">Naming convention</a></li></ul></li><li id="events-html-lifecycle-callbacks" class="toc-item"><a href="events.html#lifecycle-callbacks">Lifecycle Callbacks</a></li><li id="events-html-lifecycle-callbacks-event-argument" class="toc-item"><a href="events.html#lifecycle-callbacks-event-argument">Lifecycle Callbacks Event Argument</a></li><li id="events-html-listening-and-subscribing-to-lifecycle-events" class="toc-item"><a href="events.html#listening-and-subscribing-to-lifecycle-events">Listening and subscribing to Lifecycle Events</a></li><li id="events-html-implementing-event-listeners" class="toc-item"><a href="events.html#implementing-event-listeners">Implementing Event Listeners</a><ul><li id="events-html-prepersist" class="toc-item"><a href="events.html#prepersist">prePersist</a></li><li id="events-html-preremove" class="toc-item"><a href="events.html#preremove">preRemove</a></li><li id="events-html-preflush" class="toc-item"><a href="events.html#preflush">preFlush</a></li><li id="events-html-onflush" class="toc-item"><a href="events.html#onflush">onFlush</a></li><li id="events-html-postflush" class="toc-item"><a href="events.html#postflush">postFlush</a></li><li id="events-html-preupdate" class="toc-item"><a href="events.html#preupdate">preUpdate</a></li><li id="events-html-postupdate-postremove-postpersist" class="toc-item"><a href="events.html#postupdate-postremove-postpersist">postUpdate, postRemove, postPersist</a></li><li id="events-html-postload" class="toc-item"><a href="events.html#postload">postLoad</a></li><li id="events-html-onclear" class="toc-item"><a href="events.html#onclear">onClear</a></li></ul></li><li id="events-html-entity-listeners" class="toc-item"><a href="events.html#entity-listeners">Entity listeners</a><ul><li id="events-html-entity-listeners-class" class="toc-item"><a href="events.html#entity-listeners-class">Entity listeners class</a></li><li id="events-html-entity-listeners-resolver" class="toc-item"><a href="events.html#entity-listeners-resolver">Entity listeners resolver</a></li></ul></li><li id="events-html-load-classmetadata-event" class="toc-item"><a href="events.html#load-classmetadata-event">Load ClassMetadata Event</a></li><li id="events-html-schematool-events" class="toc-item"><a href="events.html#schematool-events">SchemaTool Events</a><ul><li id="events-html-postgenerateschematable" class="toc-item"><a href="events.html#postgenerateschematable">postGenerateSchemaTable</a></li><li id="events-html-postgenerateschema" class="toc-item"><a href="events.html#postgenerateschema">postGenerateSchema</a></li></ul></li></ul></li><li id="unitofwork-html" class="toc-item"><a href="unitofwork.html">Doctrine Internals explained</a><ul><li id="unitofwork-html-how-doctrine-keeps-track-of-objects" class="toc-item"><a href="unitofwork.html#how-doctrine-keeps-track-of-objects">How Doctrine keeps track of Objects</a></li><li id="unitofwork-html-how-doctrine-detects-changes" class="toc-item"><a href="unitofwork.html#how-doctrine-detects-changes">How Doctrine Detects Changes</a></li><li id="unitofwork-html-query-internals" class="toc-item"><a href="unitofwork.html#query-internals">Query Internals</a></li><li id="unitofwork-html-the-different-orm-layers" class="toc-item"><a href="unitofwork.html#the-different-orm-layers">The different ORM Layers</a><ul><li id="unitofwork-html-hydration" class="toc-item"><a href="unitofwork.html#hydration">Hydration</a></li><li id="unitofwork-html-persisters" class="toc-item"><a href="unitofwork.html#persisters">Persisters</a></li><li id="unitofwork-html-unitofwork" class="toc-item"><a href="unitofwork.html#unitofwork">UnitOfWork</a></li><li id="unitofwork-html-resultsetmapping" class="toc-item"><a href="unitofwork.html#resultsetmapping">ResultSetMapping</a></li><li id="unitofwork-html-dql-parser" class="toc-item"><a href="unitofwork.html#dql-parser">DQL Parser</a></li><li id="unitofwork-html-sqlwalker" class="toc-item"><a href="unitofwork.html#sqlwalker">SQLWalker</a></li><li id="unitofwork-html-entitymanager" class="toc-item"><a href="unitofwork.html#entitymanager">EntityManager</a></li><li id="unitofwork-html-classmetadatafactory" class="toc-item"><a href="unitofwork.html#classmetadatafactory">ClassMetadataFactory</a></li></ul></li></ul></li><li id="unitofwork-associations-html" class="toc-item"><a href="unitofwork-associations.html">Association Updates: Owning Side and Inverse Side</a><ul><li id="unitofwork-associations-html-bidirectional-associations" class="toc-item"><a href="unitofwork-associations.html#bidirectional-associations">Bidirectional Associations</a></li><li id="unitofwork-associations-html-important-concepts" class="toc-item"><a href="unitofwork-associations.html#important-concepts">Important concepts</a></li></ul></li><li id="transactions-and-concurrency-html-transactions-and-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#transactions-and-concurrency">Transactions and Concurrency</a><ul><li id="transactions-and-concurrency-html-transaction-demarcation" class="toc-item"><a href="transactions-and-concurrency.html#transaction-demarcation">Transaction Demarcation</a><ul><li id="transactions-and-concurrency-html-approach-1-implicitly" class="toc-item"><a href="transactions-and-concurrency.html#approach-1-implicitly">Approach 1: Implicitly</a></li><li id="transactions-and-concurrency-html-approach-2-explicitly" class="toc-item"><a href="transactions-and-concurrency.html#approach-2-explicitly">Approach 2: Explicitly</a></li><li id="transactions-and-concurrency-html-exception-handling" class="toc-item"><a href="transactions-and-concurrency.html#exception-handling">Exception Handling</a></li></ul></li><li id="transactions-and-concurrency-html-locking-support" class="toc-item"><a href="transactions-and-concurrency.html#locking-support">Locking Support</a><ul><li id="transactions-and-concurrency-html-optimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#optimistic-locking">Optimistic Locking</a></li><li id="transactions-and-concurrency-html-pessimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#pessimistic-locking">Pessimistic Locking</a></li></ul></li></ul></li><li id="batch-processing-html" class="toc-item"><a href="batch-processing.html">Batch Processing</a><ul><li id="batch-processing-html-bulk-inserts" class="toc-item"><a href="batch-processing.html#bulk-inserts">Bulk Inserts</a></li><li id="batch-processing-html-bulk-updates" class="toc-item"><a href="batch-processing.html#bulk-updates">Bulk Updates</a><ul><li id="batch-processing-html-dql-update" class="toc-item"><a href="batch-processing.html#dql-update">DQL UPDATE</a></li><li id="batch-processing-html-iterating-results" class="toc-item"><a href="batch-processing.html#iterating-results">Iterating results</a></li></ul></li><li id="batch-processing-html-bulk-deletes" class="toc-item"><a href="batch-processing.html#bulk-deletes">Bulk Deletes</a><ul><li id="batch-processing-html-dql-delete" class="toc-item"><a href="batch-processing.html#dql-delete">DQL DELETE</a></li><li id="batch-processing-html-iterating-results" class="toc-item"><a href="batch-processing.html#iterating-results">Iterating results</a></li></ul></li><li id="batch-processing-html-iterating-large-results-for-data-processing" class="toc-item"><a href="batch-processing.html#iterating-large-results-for-data-processing">Iterating Large Results for Data-Processing</a></li></ul></li><li id="dql-doctrine-query-language-html" class="toc-item"><a href="dql-doctrine-query-language.html">Doctrine Query Language</a><ul><li id="dql-doctrine-query-language-html-types-of-dql-queries" class="toc-item"><a href="dql-doctrine-query-language.html#types-of-dql-queries">Types of DQL queries</a></li><li id="dql-doctrine-query-language-html-select-queries" class="toc-item"><a href="dql-doctrine-query-language.html#select-queries">SELECT queries</a><ul><li id="dql-doctrine-query-language-html-dql-select-clause" class="toc-item"><a href="dql-doctrine-query-language.html#dql-select-clause">DQL SELECT clause</a></li><li id="dql-doctrine-query-language-html-result-format" class="toc-item"><a href="dql-doctrine-query-language.html#result-format">Result format</a></li><li id="dql-doctrine-query-language-html-joins" class="toc-item"><a href="dql-doctrine-query-language.html#joins">Joins</a></li><li id="dql-doctrine-query-language-html-named-and-positional-parameters" class="toc-item"><a href="dql-doctrine-query-language.html#named-and-positional-parameters">Named and Positional Parameters</a></li><li id="dql-doctrine-query-language-html-dql-select-examples" class="toc-item"><a href="dql-doctrine-query-language.html#dql-select-examples">DQL SELECT Examples</a></li><li id="dql-doctrine-query-language-html-using-index-by" class="toc-item"><a href="dql-doctrine-query-language.html#using-index-by">Using INDEX BY</a></li></ul></li><li id="dql-doctrine-query-language-html-update-queries" class="toc-item"><a href="dql-doctrine-query-language.html#update-queries">UPDATE queries</a></li><li id="dql-doctrine-query-language-html-delete-queries" class="toc-item"><a href="dql-doctrine-query-language.html#delete-queries">DELETE queries</a></li><li id="dql-doctrine-query-language-html-comments-in-queries" class="toc-item"><a href="dql-doctrine-query-language.html#comments-in-queries">Comments in queries</a></li><li id="dql-doctrine-query-language-html-functions-operators-aggregates" class="toc-item"><a href="dql-doctrine-query-language.html#functions-operators-aggregates">Functions, Operators, Aggregates</a><ul><li id="dql-doctrine-query-language-html-dql-functions" class="toc-item"><a href="dql-doctrine-query-language.html#dql-functions">DQL Functions</a></li><li id="dql-doctrine-query-language-html-arithmetic-operators" class="toc-item"><a href="dql-doctrine-query-language.html#arithmetic-operators">Arithmetic operators</a></li><li id="dql-doctrine-query-language-html-aggregate-functions" class="toc-item"><a href="dql-doctrine-query-language.html#aggregate-functions">Aggregate Functions</a></li><li id="dql-doctrine-query-language-html-other-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#other-expressions">Other Expressions</a></li><li id="dql-doctrine-query-language-html-adding-your-own-functions-to-the-dql-language" class="toc-item"><a href="dql-doctrine-query-language.html#adding-your-own-functions-to-the-dql-language">Adding your own functions to the DQL language</a></li></ul></li><li id="dql-doctrine-query-language-html-querying-inherited-classes" class="toc-item"><a href="dql-doctrine-query-language.html#querying-inherited-classes">Querying Inherited Classes</a><ul><li id="dql-doctrine-query-language-html-single-table" class="toc-item"><a href="dql-doctrine-query-language.html#single-table">Single Table</a></li><li id="dql-doctrine-query-language-html-class-table-inheritance" class="toc-item"><a href="dql-doctrine-query-language.html#class-table-inheritance">Class Table Inheritance</a></li></ul></li><li id="dql-doctrine-query-language-html-the-query-class" class="toc-item"><a href="dql-doctrine-query-language.html#the-query-class">The Query class</a><ul><li id="dql-doctrine-query-language-html-query-result-formats" class="toc-item"><a href="dql-doctrine-query-language.html#query-result-formats">Query Result Formats</a></li><li id="dql-doctrine-query-language-html-pure-and-mixed-results" class="toc-item"><a href="dql-doctrine-query-language.html#pure-and-mixed-results">Pure and Mixed Results</a></li><li id="dql-doctrine-query-language-html-fetching-multiple-from-entities" class="toc-item"><a href="dql-doctrine-query-language.html#fetching-multiple-from-entities">Fetching Multiple FROM Entities</a></li><li id="dql-doctrine-query-language-html-hydration-modes" class="toc-item"><a href="dql-doctrine-query-language.html#hydration-modes">Hydration Modes</a></li><li id="dql-doctrine-query-language-html-iterating-large-result-sets" class="toc-item"><a href="dql-doctrine-query-language.html#iterating-large-result-sets">Iterating Large Result Sets</a></li><li id="dql-doctrine-query-language-html-functions" class="toc-item"><a href="dql-doctrine-query-language.html#functions">Functions</a></li></ul></li><li id="dql-doctrine-query-language-html-ebnf" class="toc-item"><a href="dql-doctrine-query-language.html#ebnf">EBNF</a><ul><li id="dql-doctrine-query-language-html-document-syntax" class="toc-item"><a href="dql-doctrine-query-language.html#document-syntax">Document syntax:</a></li><li id="dql-doctrine-query-language-html-terminals" class="toc-item"><a href="dql-doctrine-query-language.html#terminals">Terminals</a></li><li id="dql-doctrine-query-language-html-query-language" class="toc-item"><a href="dql-doctrine-query-language.html#query-language">Query Language</a></li><li id="dql-doctrine-query-language-html-statements" class="toc-item"><a href="dql-doctrine-query-language.html#statements">Statements</a></li><li id="dql-doctrine-query-language-html-identifiers" class="toc-item"><a href="dql-doctrine-query-language.html#identifiers">Identifiers</a></li><li id="dql-doctrine-query-language-html-path-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#path-expressions">Path Expressions</a></li><li id="dql-doctrine-query-language-html-clauses" class="toc-item"><a href="dql-doctrine-query-language.html#clauses">Clauses</a></li><li id="dql-doctrine-query-language-html-items" class="toc-item"><a href="dql-doctrine-query-language.html#items">Items</a></li><li id="dql-doctrine-query-language-html-from-join-and-index-by" class="toc-item"><a href="dql-doctrine-query-language.html#from-join-and-index-by">From, Join and Index by</a></li><li id="dql-doctrine-query-language-html-select-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#select-expressions">Select Expressions</a></li><li id="dql-doctrine-query-language-html-conditional-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#conditional-expressions">Conditional Expressions</a></li><li id="dql-doctrine-query-language-html-collection-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#collection-expressions">Collection Expressions</a></li><li id="dql-doctrine-query-language-html-literal-values" class="toc-item"><a href="dql-doctrine-query-language.html#literal-values">Literal Values</a></li><li id="dql-doctrine-query-language-html-input-parameter" class="toc-item"><a href="dql-doctrine-query-language.html#input-parameter">Input Parameter</a></li><li id="dql-doctrine-query-language-html-arithmetic-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#arithmetic-expressions">Arithmetic Expressions</a></li><li id="dql-doctrine-query-language-html-scalar-and-type-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#scalar-and-type-expressions">Scalar and Type Expressions</a></li><li id="dql-doctrine-query-language-html-aggregate-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#aggregate-expressions">Aggregate Expressions</a></li><li id="dql-doctrine-query-language-html-case-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#case-expressions">Case Expressions</a></li><li id="dql-doctrine-query-language-html-other-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#other-expressions">Other Expressions</a></li><li id="dql-doctrine-query-language-html-functions" class="toc-item"><a href="dql-doctrine-query-language.html#functions">Functions</a></li></ul></li></ul></li><li id="query-builder-html" class="toc-item"><a href="query-builder.html">The QueryBuilder</a><ul><li id="query-builder-html-constructing-a-new-querybuilder-object" class="toc-item"><a href="query-builder.html#constructing-a-new-querybuilder-object">Constructing a new QueryBuilder object</a></li><li id="query-builder-html-working-with-querybuilder" class="toc-item"><a href="query-builder.html#working-with-querybuilder">Working with QueryBuilder</a><ul><li id="query-builder-html-high-level-api-methods" class="toc-item"><a href="query-builder.html#high-level-api-methods">High level API methods</a></li><li id="query-builder-html-binding-parameters-to-your-query" class="toc-item"><a href="query-builder.html#binding-parameters-to-your-query">Binding parameters to your query</a></li><li id="query-builder-html-limiting-the-result" class="toc-item"><a href="query-builder.html#limiting-the-result">Limiting the Result</a></li><li id="query-builder-html-executing-a-query" class="toc-item"><a href="query-builder.html#executing-a-query">Executing a Query</a></li><li id="query-builder-html-the-expr-class" class="toc-item"><a href="query-builder.html#the-expr-class">The Expr class</a></li><li id="query-builder-html-adding-a-criteria-to-a-query" class="toc-item"><a href="query-builder.html#adding-a-criteria-to-a-query">Adding a Criteria to a Query</a></li><li id="query-builder-html-low-level-api" class="toc-item"><a href="query-builder.html#low-level-api">Low Level API</a></li><li id="query-builder-html-expr-classes" class="toc-item"><a href="query-builder.html#expr-classes">Expr* classes</a></li></ul></li></ul></li><li id="native-sql-html" class="toc-item"><a href="native-sql.html">Native SQL</a><ul><li id="native-sql-html-the-nativequery-class" class="toc-item"><a href="native-sql.html#the-nativequery-class">The NativeQuery class</a></li><li id="native-sql-html-resultsetmappingbuilder" class="toc-item"><a href="native-sql.html#resultsetmappingbuilder">ResultSetMappingBuilder</a></li><li id="native-sql-html-the-resultsetmapping" class="toc-item"><a href="native-sql.html#the-resultsetmapping">The ResultSetMapping</a><ul><li id="native-sql-html-entity-results" class="toc-item"><a href="native-sql.html#entity-results">Entity results</a></li><li id="native-sql-html-joined-entity-results" class="toc-item"><a href="native-sql.html#joined-entity-results">Joined entity results</a></li><li id="native-sql-html-field-results" class="toc-item"><a href="native-sql.html#field-results">Field results</a></li><li id="native-sql-html-scalar-results" class="toc-item"><a href="native-sql.html#scalar-results">Scalar results</a></li><li id="native-sql-html-meta-results" class="toc-item"><a href="native-sql.html#meta-results">Meta results</a></li><li id="native-sql-html-discriminator-column" class="toc-item"><a href="native-sql.html#discriminator-column">Discriminator Column</a></li><li id="native-sql-html-examples" class="toc-item"><a href="native-sql.html#examples">Examples</a></li></ul></li></ul></li><li id="change-tracking-policies-html" class="toc-item"><a href="change-tracking-policies.html">Change Tracking Policies</a><ul><li id="change-tracking-policies-html-deferred-implicit" class="toc-item"><a href="change-tracking-policies.html#deferred-implicit">Deferred Implicit</a></li><li id="change-tracking-policies-html-deferred-explicit" class="toc-item"><a href="change-tracking-policies.html#deferred-explicit">Deferred Explicit</a></li></ul></li><li id="attributes-reference-html" class="toc-item"><a href="attributes-reference.html">Attributes Reference</a><ul><li id="attributes-reference-html-index" class="toc-item"><a href="attributes-reference.html#index">Index</a></li><li id="attributes-reference-html-reference" class="toc-item"><a href="attributes-reference.html#reference">Reference</a><ul><li id="attributes-reference-html-associationoverride" class="toc-item"><a href="attributes-reference.html#associationoverride">#[AssociationOverride]</a></li><li id="attributes-reference-html-attributeoverride" class="toc-item"><a href="attributes-reference.html#attributeoverride">#[AttributeOverride]</a></li><li id="attributes-reference-html-column" class="toc-item"><a href="attributes-reference.html#column">#[Column]</a></li><li id="attributes-reference-html-cache" class="toc-item"><a href="attributes-reference.html#cache">#[Cache]</a></li><li id="attributes-reference-html-changetrackingpolicy" class="toc-item"><a href="attributes-reference.html#changetrackingpolicy">#[ChangeTrackingPolicy]</a></li><li id="attributes-reference-html-customidgenerator" class="toc-item"><a href="attributes-reference.html#customidgenerator">#[CustomIdGenerator]</a></li><li id="attributes-reference-html-discriminatorcolumn" class="toc-item"><a href="attributes-reference.html#discriminatorcolumn">#[DiscriminatorColumn]</a></li><li id="attributes-reference-html-discriminatormap" class="toc-item"><a href="attributes-reference.html#discriminatormap">#[DiscriminatorMap]</a></li><li id="attributes-reference-html-embeddable" class="toc-item"><a href="attributes-reference.html#embeddable">#[Embeddable]</a></li><li id="attributes-reference-html-embedded" class="toc-item"><a href="attributes-reference.html#embedded">#[Embedded]</a></li><li id="attributes-reference-html-entity" class="toc-item"><a href="attributes-reference.html#entity">#[Entity]</a></li><li id="attributes-reference-html-generatedvalue" class="toc-item"><a href="attributes-reference.html#generatedvalue">#[GeneratedValue]</a></li><li id="attributes-reference-html-haslifecyclecallbacks" class="toc-item"><a href="attributes-reference.html#haslifecyclecallbacks">#[HasLifecycleCallbacks]</a></li><li id="attributes-reference-html-index" class="toc-item"><a href="attributes-reference.html#index">#[Index]</a></li><li id="attributes-reference-html-id" class="toc-item"><a href="attributes-reference.html#id">#[Id]</a></li><li id="attributes-reference-html-inheritancetype" class="toc-item"><a href="attributes-reference.html#inheritancetype">#[InheritanceType]</a></li><li id="attributes-reference-html-joincolumn-inversejoincolumn" class="toc-item"><a href="attributes-reference.html#joincolumn-inversejoincolumn">#[JoinColumn], #[InverseJoinColumn]</a></li><li id="attributes-reference-html-jointable" class="toc-item"><a href="attributes-reference.html#jointable">#[JoinTable]</a></li><li id="attributes-reference-html-manytoone" class="toc-item"><a href="attributes-reference.html#manytoone">#[ManyToOne]</a></li><li id="attributes-reference-html-manytomany" class="toc-item"><a href="attributes-reference.html#manytomany">#[ManyToMany]</a></li><li id="attributes-reference-html-mappedsuperclass" class="toc-item"><a href="attributes-reference.html#mappedsuperclass">#[MappedSuperclass]</a></li><li id="attributes-reference-html-onetoone" class="toc-item"><a href="attributes-reference.html#onetoone">#[OneToOne]</a></li><li id="attributes-reference-html-onetomany" class="toc-item"><a href="attributes-reference.html#onetomany">#[OneToMany]</a></li><li id="attributes-reference-html-orderby" class="toc-item"><a href="attributes-reference.html#orderby">#[OrderBy]</a></li><li id="attributes-reference-html-postload" class="toc-item"><a href="attributes-reference.html#postload">#[PostLoad]</a></li><li id="attributes-reference-html-postpersist" class="toc-item"><a href="attributes-reference.html#postpersist">#[PostPersist]</a></li><li id="attributes-reference-html-postremove" class="toc-item"><a href="attributes-reference.html#postremove">#[PostRemove]</a></li><li id="attributes-reference-html-postupdate" class="toc-item"><a href="attributes-reference.html#postupdate">#[PostUpdate]</a></li><li id="attributes-reference-html-prepersist" class="toc-item"><a href="attributes-reference.html#prepersist">#[PrePersist]</a></li><li id="attributes-reference-html-preremove" class="toc-item"><a href="attributes-reference.html#preremove">#[PreRemove]</a></li><li id="attributes-reference-html-preupdate" class="toc-item"><a href="attributes-reference.html#preupdate">#[PreUpdate]</a></li><li id="attributes-reference-html-sequencegenerator" class="toc-item"><a href="attributes-reference.html#sequencegenerator">#[SequenceGenerator]</a></li><li id="attributes-reference-html-table" class="toc-item"><a href="attributes-reference.html#table">#[Table]</a></li><li id="attributes-reference-html-uniqueconstraint" class="toc-item"><a href="attributes-reference.html#uniqueconstraint">#[UniqueConstraint]</a></li><li id="attributes-reference-html-version" class="toc-item"><a href="attributes-reference.html#version">#[Version]</a></li></ul></li></ul></li><li id="xml-mapping-html" class="toc-item"><a href="xml-mapping.html">XML Mapping</a><ul><li id="xml-mapping-html-simplified-xml-driver" class="toc-item"><a href="xml-mapping.html#simplified-xml-driver">Simplified XML Driver</a><ul><li id="xml-mapping-html-example" class="toc-item"><a href="xml-mapping.html#example">Example</a></li><li id="xml-mapping-html-xml-element-reference" class="toc-item"><a href="xml-mapping.html#xml-element-reference">XML-Element Reference</a></li></ul></li><li id="xml-mapping-html-defining-an-entity" class="toc-item"><a href="xml-mapping.html#defining-an-entity">Defining an Entity</a></li><li id="xml-mapping-html-defining-fields" class="toc-item"><a href="xml-mapping.html#defining-fields">Defining Fields</a></li><li id="xml-mapping-html-defining-identity-and-generator-strategies" class="toc-item"><a href="xml-mapping.html#defining-identity-and-generator-strategies">Defining Identity and Generator Strategies</a></li><li id="xml-mapping-html-defining-a-mapped-superclass" class="toc-item"><a href="xml-mapping.html#defining-a-mapped-superclass">Defining a Mapped Superclass</a></li><li id="xml-mapping-html-defining-inheritance-mappings" class="toc-item"><a href="xml-mapping.html#defining-inheritance-mappings">Defining Inheritance Mappings</a></li><li id="xml-mapping-html-defining-lifecycle-callbacks" class="toc-item"><a href="xml-mapping.html#defining-lifecycle-callbacks">Defining Lifecycle Callbacks</a></li><li id="xml-mapping-html-defining-one-to-one-relations" class="toc-item"><a href="xml-mapping.html#defining-one-to-one-relations">Defining One-To-One Relations</a></li><li id="xml-mapping-html-defining-many-to-one-associations" class="toc-item"><a href="xml-mapping.html#defining-many-to-one-associations">Defining Many-To-One Associations</a></li><li id="xml-mapping-html-defining-one-to-many-associations" class="toc-item"><a href="xml-mapping.html#defining-one-to-many-associations">Defining One-To-Many Associations</a></li><li id="xml-mapping-html-defining-many-to-many-associations" class="toc-item"><a href="xml-mapping.html#defining-many-to-many-associations">Defining Many-To-Many Associations</a></li><li id="xml-mapping-html-cascade-element" class="toc-item"><a href="xml-mapping.html#cascade-element">Cascade Element</a></li><li id="xml-mapping-html-join-column-element" class="toc-item"><a href="xml-mapping.html#join-column-element">Join Column Element</a></li><li id="xml-mapping-html-defining-order-of-to-many-associations" class="toc-item"><a href="xml-mapping.html#defining-order-of-to-many-associations">Defining Order of To-Many Associations</a></li><li id="xml-mapping-html-defining-indexes-or-unique-constraints" class="toc-item"><a href="xml-mapping.html#defining-indexes-or-unique-constraints">Defining Indexes or Unique Constraints</a></li><li id="xml-mapping-html-derived-entities-id-syntax" class="toc-item"><a href="xml-mapping.html#derived-entities-id-syntax">Derived Entities ID syntax</a></li></ul></li><li id="php-mapping-html" class="toc-item"><a href="php-mapping.html">PHP Mapping</a><ul><li id="php-mapping-html-static-function" class="toc-item"><a href="php-mapping.html#static-function">Static Function</a></li><li id="php-mapping-html-classmetadatabuilder" class="toc-item"><a href="php-mapping.html#classmetadatabuilder">ClassMetadataBuilder</a></li><li id="php-mapping-html-classmetadata-api" class="toc-item"><a href="php-mapping.html#classmetadata-api">ClassMetadata API</a><ul><li id="php-mapping-html-general-setters" class="toc-item"><a href="php-mapping.html#general-setters">General Setters</a></li><li id="php-mapping-html-inheritance-setters" class="toc-item"><a href="php-mapping.html#inheritance-setters">Inheritance Setters</a></li><li id="php-mapping-html-field-mapping-setters" class="toc-item"><a href="php-mapping.html#field-mapping-setters">Field Mapping Setters</a></li><li id="php-mapping-html-lifecycle-callback-setters" class="toc-item"><a href="php-mapping.html#lifecycle-callback-setters">Lifecycle Callback Setters</a></li><li id="php-mapping-html-versioning-setters" class="toc-item"><a href="php-mapping.html#versioning-setters">Versioning Setters</a></li><li id="php-mapping-html-general-getters" class="toc-item"><a href="php-mapping.html#general-getters">General Getters</a></li><li id="php-mapping-html-identifier-getters" class="toc-item"><a href="php-mapping.html#identifier-getters">Identifier Getters</a></li><li id="php-mapping-html-inheritance-getters" class="toc-item"><a href="php-mapping.html#inheritance-getters">Inheritance Getters</a></li><li id="php-mapping-html-change-tracking-getters" class="toc-item"><a href="php-mapping.html#change-tracking-getters">Change Tracking Getters</a></li><li id="php-mapping-html-field-association-getters" class="toc-item"><a href="php-mapping.html#field-association-getters">Field & Association Getters</a></li><li id="php-mapping-html-lifecycle-callback-getters" class="toc-item"><a href="php-mapping.html#lifecycle-callback-getters">Lifecycle Callback Getters</a></li><li id="php-mapping-html-runtime-reflection-methods" class="toc-item"><a href="php-mapping.html#runtime-reflection-methods">Runtime reflection methods</a></li></ul></li></ul></li><li id="caching-html" class="toc-item"><a href="caching.html">Caching</a><ul><li id="caching-html-types-of-caches" class="toc-item"><a href="caching.html#types-of-caches">Types of Caches</a><ul><li id="caching-html-query-cache" class="toc-item"><a href="caching.html#query-cache">Query Cache</a></li><li id="caching-html-result-cache" class="toc-item"><a href="caching.html#result-cache">Result Cache</a></li><li id="caching-html-metadata-cache" class="toc-item"><a href="caching.html#metadata-cache">Metadata Cache</a></li></ul></li><li id="caching-html-clearing-the-cache" class="toc-item"><a href="caching.html#clearing-the-cache">Clearing the Cache</a></li><li id="caching-html-cache-chaining" class="toc-item"><a href="caching.html#cache-chaining">Cache Chaining</a></li><li id="caching-html-cache-slams" class="toc-item"><a href="caching.html#cache-slams">Cache Slams</a></li></ul></li><li id="improving-performance-html" class="toc-item"><a href="improving-performance.html">Improving Performance</a><ul><li id="improving-performance-html-bytecode-cache" class="toc-item"><a href="improving-performance.html#bytecode-cache">Bytecode Cache</a></li><li id="improving-performance-html-metadata-and-query-caches" class="toc-item"><a href="improving-performance.html#metadata-and-query-caches">Metadata and Query caches</a></li><li id="improving-performance-html-alternative-query-result-formats" class="toc-item"><a href="improving-performance.html#alternative-query-result-formats">Alternative Query Result Formats</a></li><li id="improving-performance-html-read-only-entities" class="toc-item"><a href="improving-performance.html#read-only-entities">Read-Only Entities</a></li><li id="improving-performance-html-extra-lazy-collections" class="toc-item"><a href="improving-performance.html#extra-lazy-collections">Extra-Lazy Collections</a></li><li id="improving-performance-html-temporarily-change-fetch-mode-in-dql" class="toc-item"><a href="improving-performance.html#temporarily-change-fetch-mode-in-dql">Temporarily change fetch mode in DQL</a></li><li id="improving-performance-html-apply-best-practices" class="toc-item"><a href="improving-performance.html#apply-best-practices">Apply Best Practices</a></li><li id="improving-performance-html-change-tracking-policies" class="toc-item"><a href="improving-performance.html#change-tracking-policies">Change Tracking policies</a></li></ul></li><li id="tools-html" class="toc-item"><a href="tools.html">Tools</a><ul><li id="tools-html-doctrine-console" class="toc-item"><a href="tools.html#doctrine-console">Doctrine Console</a><ul><li id="tools-html-setting-up-the-console" class="toc-item"><a href="tools.html#setting-up-the-console">Setting Up the Console</a></li><li id="tools-html-display-help-information" class="toc-item"><a href="tools.html#display-help-information">Display Help Information</a></li><li id="tools-html-command-overview" class="toc-item"><a href="tools.html#command-overview">Command Overview</a></li></ul></li><li id="tools-html-database-schema-generation" class="toc-item"><a href="tools.html#database-schema-generation">Database Schema Generation</a></li><li id="tools-html-runtime-vs-development-mapping-validation" class="toc-item"><a href="tools.html#runtime-vs-development-mapping-validation">Runtime vs Development Mapping Validation</a></li><li id="tools-html-adding-own-commands" class="toc-item"><a href="tools.html#adding-own-commands">Adding own commands</a></li><li id="tools-html-re-use-console-application" class="toc-item"><a href="tools.html#re-use-console-application">Re-use console application</a></li></ul></li><li id="metadata-drivers-html" class="toc-item"><a href="metadata-drivers.html">Metadata Drivers</a><ul><li id="metadata-drivers-html-core-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#core-metadata-drivers">Core Metadata Drivers</a></li><li id="metadata-drivers-html-implementing-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#implementing-metadata-drivers">Implementing Metadata Drivers</a></li><li id="metadata-drivers-html-classmetadata" class="toc-item"><a href="metadata-drivers.html#classmetadata">ClassMetadata</a></li><li id="metadata-drivers-html-getting-classmetadata-instances" class="toc-item"><a href="metadata-drivers.html#getting-classmetadata-instances">Getting ClassMetadata Instances</a></li></ul></li><li id="best-practices-html" class="toc-item"><a href="best-practices.html">Best Practices</a><ul><li id="best-practices-html-constrain-relationships-as-much-as-possible" class="toc-item"><a href="best-practices.html#constrain-relationships-as-much-as-possible">Constrain relationships as much as possible</a></li><li id="best-practices-html-avoid-composite-keys" class="toc-item"><a href="best-practices.html#avoid-composite-keys">Avoid composite keys</a></li><li id="best-practices-html-use-events-judiciously" class="toc-item"><a href="best-practices.html#use-events-judiciously">Use events judiciously</a></li><li id="best-practices-html-use-cascades-judiciously" class="toc-item"><a href="best-practices.html#use-cascades-judiciously">Use cascades judiciously</a></li><li id="best-practices-html-don-t-use-special-characters" class="toc-item"><a href="best-practices.html#don-t-use-special-characters">Don't use special characters</a></li><li id="best-practices-html-don-t-use-identifier-quoting" class="toc-item"><a href="best-practices.html#don-t-use-identifier-quoting">Don't use identifier quoting</a></li><li id="best-practices-html-initialize-collections-in-the-constructor" class="toc-item"><a href="best-practices.html#initialize-collections-in-the-constructor">Initialize collections in the constructor</a></li><li id="best-practices-html-don-t-map-foreign-keys-to-fields-in-an-entity" class="toc-item"><a href="best-practices.html#don-t-map-foreign-keys-to-fields-in-an-entity">Don't map foreign keys to fields in an entity</a></li><li id="best-practices-html-use-explicit-transaction-demarcation" class="toc-item"><a href="best-practices.html#use-explicit-transaction-demarcation">Use explicit transaction demarcation</a></li></ul></li><li id="limitations-and-known-issues-html" class="toc-item"><a href="limitations-and-known-issues.html">Limitations and Known Issues</a><ul><li id="limitations-and-known-issues-html-current-limitations" class="toc-item"><a href="limitations-and-known-issues.html#current-limitations">Current Limitations</a><ul><li id="limitations-and-known-issues-html-join-columns-with-non-primary-keys" class="toc-item"><a href="limitations-and-known-issues.html#join-columns-with-non-primary-keys">Join-Columns with non-primary keys</a></li><li id="limitations-and-known-issues-html-mapping-arrays-to-a-join-table" class="toc-item"><a href="limitations-and-known-issues.html#mapping-arrays-to-a-join-table">Mapping Arrays to a Join Table</a></li><li id="limitations-and-known-issues-html-custom-persisters" class="toc-item"><a href="limitations-and-known-issues.html#custom-persisters">Custom Persisters</a></li><li id="limitations-and-known-issues-html-persist-keys-of-collections" class="toc-item"><a href="limitations-and-known-issues.html#persist-keys-of-collections">Persist Keys of Collections</a></li><li id="limitations-and-known-issues-html-mapping-many-tables-to-one-entity" class="toc-item"><a href="limitations-and-known-issues.html#mapping-many-tables-to-one-entity">Mapping many tables to one entity</a></li><li id="limitations-and-known-issues-html-behaviors" class="toc-item"><a href="limitations-and-known-issues.html#behaviors">Behaviors</a></li><li id="limitations-and-known-issues-html-nested-set" class="toc-item"><a href="limitations-and-known-issues.html#nested-set">Nested Set</a></li><li id="limitations-and-known-issues-html-using-traits-in-entity-classes" class="toc-item"><a href="limitations-and-known-issues.html#using-traits-in-entity-classes">Using Traits in Entity Classes</a></li><li id="limitations-and-known-issues-html-mapping-multiple-private-fields-of-the-same-name" class="toc-item"><a href="limitations-and-known-issues.html#mapping-multiple-private-fields-of-the-same-name">Mapping multiple private fields of the same name</a></li></ul></li><li id="limitations-and-known-issues-html-known-issues" class="toc-item"><a href="limitations-and-known-issues.html#known-issues">Known Issues</a><ul><li id="limitations-and-known-issues-html-identifier-quoting-and-legacy-databases" class="toc-item"><a href="limitations-and-known-issues.html#identifier-quoting-and-legacy-databases">Identifier Quoting and Legacy Databases</a></li><li id="limitations-and-known-issues-html-microsoft-sql-server-and-doctrine-datetime" class="toc-item"><a href="limitations-and-known-issues.html#microsoft-sql-server-and-doctrine-datetime">Microsoft SQL Server and Doctrine "datetime"</a></li><li id="limitations-and-known-issues-html-mysql-with-myisam-tables" class="toc-item"><a href="limitations-and-known-issues.html#mysql-with-myisam-tables">MySQL with MyISAM tables</a></li></ul></li></ul></li><li id="tutorials-pagination-html" class="toc-item"><a href="../tutorials/pagination.html">Pagination</a></li><li id="filters-html" class="toc-item"><a href="filters.html">Filters</a><ul><li id="filters-html-example-filter-class" class="toc-item"><a href="filters.html#example-filter-class">Example filter class</a></li><li id="filters-html-configuration" class="toc-item"><a href="filters.html#configuration">Configuration</a></li><li id="filters-html-disabling-enabling-filters-and-setting-parameters" class="toc-item"><a href="filters.html#disabling-enabling-filters-and-setting-parameters">Disabling/Enabling Filters and Setting Parameters</a></li><li id="filters-html-suspending-restoring-filters" class="toc-item"><a href="filters.html#suspending-restoring-filters">Suspending/Restoring Filters</a></li></ul></li><li id="namingstrategy-html" class="toc-item"><a href="namingstrategy.html">Implementing a NamingStrategy</a><ul><li id="namingstrategy-html-configuring-a-naming-strategy" class="toc-item"><a href="namingstrategy.html#configuring-a-naming-strategy">Configuring a naming strategy</a></li><li id="namingstrategy-html-underscore-naming-strategy" class="toc-item"><a href="namingstrategy.html#underscore-naming-strategy">Underscore naming strategy</a></li><li id="namingstrategy-html-naming-strategy-interface" class="toc-item"><a href="namingstrategy.html#naming-strategy-interface">Naming strategy interface</a></li><li id="namingstrategy-html-implementing-a-naming-strategy" class="toc-item"><a href="namingstrategy.html#implementing-a-naming-strategy">Implementing a naming strategy</a></li></ul></li><li id="advanced-configuration-html" class="toc-item"><a href="advanced-configuration.html">Advanced Configuration</a><ul><li id="advanced-configuration-html-doctrine-and-caching" class="toc-item"><a href="advanced-configuration.html#doctrine-and-caching">Doctrine and Caching</a></li><li id="advanced-configuration-html-configuration-options" class="toc-item"><a href="advanced-configuration.html#configuration-options">Configuration Options</a><ul><li id="advanced-configuration-html-proxy-directory-required" class="toc-item"><a href="advanced-configuration.html#proxy-directory-required">Proxy Directory (***REQUIRED***)</a></li><li id="advanced-configuration-html-proxy-namespace-required" class="toc-item"><a href="advanced-configuration.html#proxy-namespace-required">Proxy Namespace (***REQUIRED***)</a></li><li id="advanced-configuration-html-metadata-driver-required" class="toc-item"><a href="advanced-configuration.html#metadata-driver-required">Metadata Driver (***REQUIRED***)</a></li><li id="advanced-configuration-html-metadata-cache-recommended" class="toc-item"><a href="advanced-configuration.html#metadata-cache-recommended">Metadata Cache (***RECOMMENDED***)</a></li><li id="advanced-configuration-html-query-cache-recommended" class="toc-item"><a href="advanced-configuration.html#query-cache-recommended">Query Cache (***RECOMMENDED***)</a></li><li id="advanced-configuration-html-sql-logger-optional" class="toc-item"><a href="advanced-configuration.html#sql-logger-optional">SQL Logger (***Optional***)</a></li><li id="advanced-configuration-html-auto-generating-proxy-classes-optional" class="toc-item"><a href="advanced-configuration.html#auto-generating-proxy-classes-optional">Auto-generating Proxy Classes (***OPTIONAL***)</a></li></ul></li><li id="advanced-configuration-html-development-vs-production-configuration" class="toc-item"><a href="advanced-configuration.html#development-vs-production-configuration">Development vs Production Configuration</a></li><li id="advanced-configuration-html-connection" class="toc-item"><a href="advanced-configuration.html#connection">Connection</a></li><li id="advanced-configuration-html-proxy-objects" class="toc-item"><a href="advanced-configuration.html#proxy-objects">Proxy Objects</a><ul><li id="advanced-configuration-html-reference-proxies" class="toc-item"><a href="advanced-configuration.html#reference-proxies">Reference Proxies</a></li><li id="advanced-configuration-html-association-proxies" class="toc-item"><a href="advanced-configuration.html#association-proxies">Association proxies</a></li><li id="advanced-configuration-html-generating-proxy-classes" class="toc-item"><a href="advanced-configuration.html#generating-proxy-classes">Generating Proxy classes</a></li></ul></li><li id="advanced-configuration-html-autoloading-proxies" class="toc-item"><a href="advanced-configuration.html#autoloading-proxies">Autoloading Proxies</a></li><li id="advanced-configuration-html-multiple-metadata-sources" class="toc-item"><a href="advanced-configuration.html#multiple-metadata-sources">Multiple Metadata Sources</a></li><li id="advanced-configuration-html-default-repository-optional" class="toc-item"><a href="advanced-configuration.html#default-repository-optional">Default Repository (***OPTIONAL***)</a></li><li id="advanced-configuration-html-ignoring-entities-optional" class="toc-item"><a href="advanced-configuration.html#ignoring-entities-optional">Ignoring entities (***OPTIONAL***)</a></li><li id="advanced-configuration-html-setting-up-the-console" class="toc-item"><a href="advanced-configuration.html#setting-up-the-console">Setting up the Console</a></li></ul></li><li id="second-level-cache-html" class="toc-item"><a href="second-level-cache.html">The Second Level Cache</a><ul><li id="second-level-cache-html-caching-regions" class="toc-item"><a href="second-level-cache.html#caching-regions">Caching Regions</a></li><li id="second-level-cache-html-cache-regions" class="toc-item"><a href="second-level-cache.html#cache-regions">Cache Regions</a><ul><li id="second-level-cache-html-cache-region" class="toc-item"><a href="second-level-cache.html#cache-region">Cache region</a></li><li id="second-level-cache-html-concurrent-cache-region" class="toc-item"><a href="second-level-cache.html#concurrent-cache-region">Concurrent cache region</a></li><li id="second-level-cache-html-timestamp-region" class="toc-item"><a href="second-level-cache.html#timestamp-region">Timestamp region</a></li></ul></li><li id="second-level-cache-html-caching-mode" class="toc-item"><a href="second-level-cache.html#caching-mode">Caching mode</a><ul><li id="second-level-cache-html-built-in-cached-persisters" class="toc-item"><a href="second-level-cache.html#built-in-cached-persisters">Built-in cached persisters</a></li></ul></li><li id="second-level-cache-html-configuration" class="toc-item"><a href="second-level-cache.html#configuration">Configuration</a><ul><li id="second-level-cache-html-enable-second-level-cache" class="toc-item"><a href="second-level-cache.html#enable-second-level-cache">Enable Second Level Cache</a></li><li id="second-level-cache-html-cache-factory" class="toc-item"><a href="second-level-cache.html#cache-factory">Cache Factory</a></li><li id="second-level-cache-html-region-lifetime" class="toc-item"><a href="second-level-cache.html#region-lifetime">Region Lifetime</a></li><li id="second-level-cache-html-cache-log" class="toc-item"><a href="second-level-cache.html#cache-log">Cache Log</a></li></ul></li><li id="second-level-cache-html-entity-cache-definition" class="toc-item"><a href="second-level-cache.html#entity-cache-definition">Entity cache definition</a></li><li id="second-level-cache-html-association-cache-definition" class="toc-item"><a href="second-level-cache.html#association-cache-definition">Association cache definition</a><ul><li id="second-level-cache-html-cache-usage" class="toc-item"><a href="second-level-cache.html#cache-usage">Cache usage</a></li></ul></li><li id="second-level-cache-html-using-the-query-cache" class="toc-item"><a href="second-level-cache.html#using-the-query-cache">Using the query cache</a><ul><li id="second-level-cache-html-cache-mode" class="toc-item"><a href="second-level-cache.html#cache-mode">Cache mode</a></li><li id="second-level-cache-html-delete-update-queries" class="toc-item"><a href="second-level-cache.html#delete-update-queries">DELETE / UPDATE queries</a></li></ul></li><li id="second-level-cache-html-using-the-repository-query-cache" class="toc-item"><a href="second-level-cache.html#using-the-repository-query-cache">Using the repository query cache</a></li><li id="second-level-cache-html-cache-api" class="toc-item"><a href="second-level-cache.html#cache-api">Cache API</a></li><li id="second-level-cache-html-limitations" class="toc-item"><a href="second-level-cache.html#limitations">Limitations</a><ul><li id="second-level-cache-html-composite-primary-key" class="toc-item"><a href="second-level-cache.html#composite-primary-key">Composite primary key</a></li><li id="second-level-cache-html-distributed-environments" class="toc-item"><a href="second-level-cache.html#distributed-environments">Distributed environments</a></li><li id="second-level-cache-html-paginator" class="toc-item"><a href="second-level-cache.html#paginator">Paginator</a></li></ul></li></ul></li><li id="security-html" class="toc-item"><a href="security.html">Security</a><ul><li id="security-html-user-input-and-doctrine-orm" class="toc-item"><a href="security.html#user-input-and-doctrine-orm">User input and Doctrine ORM</a></li><li id="security-html-preventing-mass-assignment-vulnerabilities" class="toc-item"><a href="security.html#preventing-mass-assignment-vulnerabilities">Preventing Mass Assignment Vulnerabilities</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Cookbook</h2>
<div class="toc"><ul><li id="cookbook-aggregate-fields-html" class="toc-item"><a href="../cookbook/aggregate-fields.html">Aggregate Fields</a><ul><li id="cookbook-aggregate-fields-html-an-example-model" class="toc-item"><a href="../cookbook/aggregate-fields.html#an-example-model">An example model</a></li><li id="cookbook-aggregate-fields-html-using-dql" class="toc-item"><a href="../cookbook/aggregate-fields.html#using-dql">Using DQL</a></li><li id="cookbook-aggregate-fields-html-using-your-domain-model" class="toc-item"><a href="../cookbook/aggregate-fields.html#using-your-domain-model">Using your Domain Model</a></li><li id="cookbook-aggregate-fields-html-using-an-aggregate-field" class="toc-item"><a href="../cookbook/aggregate-fields.html#using-an-aggregate-field">Using an Aggregate Field</a></li><li id="cookbook-aggregate-fields-html-tackling-race-conditions-with-aggregate-fields" class="toc-item"><a href="../cookbook/aggregate-fields.html#tackling-race-conditions-with-aggregate-fields">Tackling Race Conditions with Aggregate Fields</a></li><li id="cookbook-aggregate-fields-html-keeping-updates-and-deletes-in-sync" class="toc-item"><a href="../cookbook/aggregate-fields.html#keeping-updates-and-deletes-in-sync">Keeping Updates and Deletes in Sync</a></li><li id="cookbook-aggregate-fields-html-conclusion" class="toc-item"><a href="../cookbook/aggregate-fields.html#conclusion">Conclusion</a></li></ul></li><li id="cookbook-custom-mapping-types-html" class="toc-item"><a href="../cookbook/custom-mapping-types.html">Custom Mapping Types</a></li><li id="cookbook-decorator-pattern-html" class="toc-item"><a href="../cookbook/decorator-pattern.html">Persisting the Decorator Pattern</a><ul><li id="cookbook-decorator-pattern-html-component" class="toc-item"><a href="../cookbook/decorator-pattern.html#component">Component</a></li><li id="cookbook-decorator-pattern-html-concretecomponent" class="toc-item"><a href="../cookbook/decorator-pattern.html#concretecomponent">ConcreteComponent</a></li><li id="cookbook-decorator-pattern-html-decorator" class="toc-item"><a href="../cookbook/decorator-pattern.html#decorator">Decorator</a></li><li id="cookbook-decorator-pattern-html-concretedecorator" class="toc-item"><a href="../cookbook/decorator-pattern.html#concretedecorator">ConcreteDecorator</a></li><li id="cookbook-decorator-pattern-html-examples" class="toc-item"><a href="../cookbook/decorator-pattern.html#examples">Examples</a></li></ul></li><li id="cookbook-dql-custom-walkers-html" class="toc-item"><a href="../cookbook/dql-custom-walkers.html">Extending DQL in Doctrine ORM: Custom AST Walkers</a><ul><li id="cookbook-dql-custom-walkers-html-generic-count-query-for-pagination" class="toc-item"><a href="../cookbook/dql-custom-walkers.html#generic-count-query-for-pagination">Generic count query for pagination</a></li><li id="cookbook-dql-custom-walkers-html-modify-the-output-walker-to-generate-vendor-specific-sql" class="toc-item"><a href="../cookbook/dql-custom-walkers.html#modify-the-output-walker-to-generate-vendor-specific-sql">Modify the Output Walker to generate Vendor specific SQL</a></li></ul></li><li id="cookbook-dql-user-defined-functions-html" class="toc-item"><a href="../cookbook/dql-user-defined-functions.html">DQL User Defined Functions</a><ul><li id="cookbook-dql-user-defined-functions-html-registering-your-own-dql-functions" class="toc-item"><a href="../cookbook/dql-user-defined-functions.html#registering-your-own-dql-functions">Registering your own DQL functions</a></li><li id="cookbook-dql-user-defined-functions-html-date-diff" class="toc-item"><a href="../cookbook/dql-user-defined-functions.html#date-diff">Date Diff</a></li><li id="cookbook-dql-user-defined-functions-html-date-add" class="toc-item"><a href="../cookbook/dql-user-defined-functions.html#date-add">Date Add</a></li><li id="cookbook-dql-user-defined-functions-html-conclusion" class="toc-item"><a href="../cookbook/dql-user-defined-functions.html#conclusion">Conclusion</a></li></ul></li><li id="cookbook-implementing-arrayaccess-for-domain-objects-html" class="toc-item"><a href="../cookbook/implementing-arrayaccess-for-domain-objects.html">Implementing ArrayAccess for Domain Objects</a><ul><li id="cookbook-implementing-arrayaccess-for-domain-objects-html-option-1" class="toc-item"><a href="../cookbook/implementing-arrayaccess-for-domain-objects.html#option-1">Option 1</a></li><li id="cookbook-implementing-arrayaccess-for-domain-objects-html-option-2" class="toc-item"><a href="../cookbook/implementing-arrayaccess-for-domain-objects.html#option-2">Option 2</a></li><li id="cookbook-implementing-arrayaccess-for-domain-objects-html-read-only" class="toc-item"><a href="../cookbook/implementing-arrayaccess-for-domain-objects.html#read-only">Read-only</a></li></ul></li><li id="cookbook-resolve-target-entity-listener-html" class="toc-item"><a href="../cookbook/resolve-target-entity-listener.html">Keeping your Modules independent</a><ul><li id="cookbook-resolve-target-entity-listener-html-background" class="toc-item"><a href="../cookbook/resolve-target-entity-listener.html#background">Background</a></li><li id="cookbook-resolve-target-entity-listener-html-set-up" class="toc-item"><a href="../cookbook/resolve-target-entity-listener.html#set-up">Set up</a></li><li id="cookbook-resolve-target-entity-listener-html-final-thoughts" class="toc-item"><a href="../cookbook/resolve-target-entity-listener.html#final-thoughts">Final Thoughts</a></li></ul></li><li id="cookbook-sql-table-prefixes-html" class="toc-item"><a href="../cookbook/sql-table-prefixes.html">SQL-Table Prefixes</a><ul><li id="cookbook-sql-table-prefixes-html-implementing-the-listener" class="toc-item"><a href="../cookbook/sql-table-prefixes.html#implementing-the-listener">Implementing the listener</a></li><li id="cookbook-sql-table-prefixes-html-telling-the-entitymanager-about-our-listener" class="toc-item"><a href="../cookbook/sql-table-prefixes.html#telling-the-entitymanager-about-our-listener">Telling the EntityManager about our listener</a></li></ul></li><li id="cookbook-strategy-cookbook-introduction-html" class="toc-item"><a href="../cookbook/strategy-cookbook-introduction.html">Strategy-Pattern</a><ul><li id="cookbook-strategy-cookbook-introduction-html-scenario-problem" class="toc-item"><a href="../cookbook/strategy-cookbook-introduction.html#scenario-problem">Scenario / Problem</a></li><li id="cookbook-strategy-cookbook-introduction-html-solution" class="toc-item"><a href="../cookbook/strategy-cookbook-introduction.html#solution">Solution</a></li></ul></li><li id="cookbook-validation-of-entities-html" class="toc-item"><a href="../cookbook/validation-of-entities.html">Validation of Entities</a></li><li id="cookbook-working-with-datetime-html" class="toc-item"><a href="../cookbook/working-with-datetime.html">Working with DateTime Instances</a><ul><li id="cookbook-working-with-datetime-html-datetime-changes-are-detected-by-reference" class="toc-item"><a href="../cookbook/working-with-datetime.html#datetime-changes-are-detected-by-reference">DateTime changes are detected by Reference</a></li><li id="cookbook-working-with-datetime-html-default-timezone-gotcha" class="toc-item"><a href="../cookbook/working-with-datetime.html#default-timezone-gotcha">Default Timezone Gotcha</a></li><li id="cookbook-working-with-datetime-html-handling-different-timezones-with-the-datetime-type" class="toc-item"><a href="../cookbook/working-with-datetime.html#handling-different-timezones-with-the-datetime-type">Handling different Timezones with the DateTime Type</a></li></ul></li><li id="cookbook-mysql-enums-html" class="toc-item"><a href="../cookbook/mysql-enums.html">Mysql Enums</a><ul><li id="cookbook-mysql-enums-html-solution-1-mapping-to-varchars" class="toc-item"><a href="../cookbook/mysql-enums.html#solution-1-mapping-to-varchars">Solution 1: Mapping to Varchars</a></li><li id="cookbook-mysql-enums-html-solution-2-defining-a-type" class="toc-item"><a href="../cookbook/mysql-enums.html#solution-2-defining-a-type">Solution 2: Defining a Type</a></li></ul></li><li id="cookbook-advanced-field-value-conversion-using-custom-mapping-types-html" class="toc-item"><a href="../cookbook/advanced-field-value-conversion-using-custom-mapping-types.html">Advanced field value conversion using custom mapping types</a><ul><li id="cookbook-advanced-field-value-conversion-using-custom-mapping-types-html-the-entity" class="toc-item"><a href="../cookbook/advanced-field-value-conversion-using-custom-mapping-types.html#the-entity">The entity</a></li><li id="cookbook-advanced-field-value-conversion-using-custom-mapping-types-html-the-mapping-type" class="toc-item"><a href="../cookbook/advanced-field-value-conversion-using-custom-mapping-types.html#the-mapping-type">The mapping type</a></li><li id="cookbook-advanced-field-value-conversion-using-custom-mapping-types-html-example-usage" class="toc-item"><a href="../cookbook/advanced-field-value-conversion-using-custom-mapping-types.html#example-usage">Example usage</a></li></ul></li><li id="cookbook-entities-in-session-html" class="toc-item"><a href="../cookbook/entities-in-session.html">Entities in the Session</a><ul><li id="cookbook-entities-in-session-html-updating-an-entity" class="toc-item"><a href="../cookbook/entities-in-session.html#updating-an-entity">Updating an entity</a><ul><li id="cookbook-entities-in-session-html-working-with-scalars" class="toc-item"><a href="../cookbook/entities-in-session.html#working-with-scalars">Working with scalars</a></li><li id="cookbook-entities-in-session-html-working-with-custom-data-transfer-objects" class="toc-item"><a href="../cookbook/entities-in-session.html#working-with-custom-data-transfer-objects">Working with custom data transfer objects</a></li></ul></li><li id="cookbook-entities-in-session-html-serializing-entity-into-the-session" class="toc-item"><a href="../cookbook/entities-in-session.html#serializing-entity-into-the-session">Serializing entity into the session</a></li></ul></li></ul></div>
</div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "ORM",
            "item": "https://www.doctrine-project.org/projects/orm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-orm/en/3.1/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Transactions and Concurrency",
            "item": "https://www.doctrine-project.org/projects/doctrine-orm/en/3.1/reference/transactions-and-concurrency.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/orm.html">ORM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-orm/en/3.1/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Transactions and Concurrency</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that has not yet been released.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-orm/en/3.1/reference/transactions-and-concurrency.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        3.1
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-orm/en/latest/reference/transactions-and-concurrency.html">
                                                        4.0

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-orm/en/3.1/reference/transactions-and-concurrency.html">
                                                        3.1

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-orm/en/3.0/reference/transactions-and-concurrency.html">
                                                        3.0.0

                                                                                                                    (current)
                                                        
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-orm/en/2.19/reference/transactions-and-concurrency.html">
                                                        2.19

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-orm/en/2.18/reference/transactions-and-concurrency.html">
                                                        2.18.0

                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.17/reference/transactions-and-concurrency.html">2.17</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.16/reference/transactions-and-concurrency.html">2.16</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.15/reference/transactions-and-concurrency.html">2.15</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.14/reference/transactions-and-concurrency.html">2.14</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.13/reference/transactions-and-concurrency.html">2.13</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.12/reference/transactions-and-concurrency.html">2.12</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.11/reference/transactions-and-concurrency.html">2.11</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.10/reference/transactions-and-concurrency.html">2.10</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.9/reference/transactions-and-concurrency.html">2.9</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.8/reference/transactions-and-concurrency.html">2.8</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.7/reference/transactions-and-concurrency.html">2.7</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.6/reference/transactions-and-concurrency.html">2.6</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.5/reference/transactions-and-concurrency.html">2.5</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-orm/en/2.4/reference/transactions-and-concurrency.html">2.4</a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="transactions-and-concurrency" name="transactions-and-concurrency"></a><h1 class="section-header"><a href="#transactions-and-concurrency">Transactions and Concurrency<i class="fas fa-link"></i></a></h1>
<a id="transactions-and-concurrency_transaction-demarcation"></a>
<div class="section"><a class="section-anchor" id="transaction-demarcation" name="transaction-demarcation"></a><h2 class="section-header"><a href="#transaction-demarcation">Transaction Demarcation<i class="fas fa-link"></i></a></h2>
<p>Transaction demarcation is the task of defining your transaction
boundaries. Proper transaction demarcation is very important
because if not done properly it can negatively affect the
performance of your application. Many databases and database
abstraction layers like PDO by default operate in auto-commit mode,
which means that every single SQL statement is wrapped in a small
transaction. Without any explicit transaction demarcation from your
side, this quickly results in poor performance because transactions
are not cheap.</p>
<p>For the most part, Doctrine ORM already takes care of proper
transaction demarcation for you: All the write operations
(INSERT/UPDATE/DELETE) are queued until <code>EntityManager#flush()</code>
is invoked which wraps all of these changes in a single
transaction.</p>
<p>However, Doctrine ORM also allows (and encourages) you to take over
and control transaction demarcation yourself.</p>
<p>These are two ways to deal with transactions when using the
Doctrine ORM and are now described in more detail.</p>
<a id="transactions-and-concurrency_approach-implicitly"></a>
<div class="section"><a class="section-anchor" id="approach-1-implicitly" name="approach-1-implicitly"></a><h3 class="section-header"><a href="#approach-1-implicitly">Approach 1: Implicitly<i class="fas fa-link"></i></a></h3>
<p>The first approach is to use the implicit transaction handling
provided by the Doctrine ORM EntityManager. Given the following
code snippet, without any explicit transaction demarcation:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="aa983b3d2a5caf9798bebde31e622c63c767310b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="aa983b3d2a5caf9798bebde31e622c63c767310b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-1" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// $em instanceof EntityManager</span>
$user = <span class="hljs-keyword">new</span> User;
$user-&gt;setName(<span class="hljs-string">'George'</span>);
$em-&gt;persist($user);
$em-&gt;flush();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-2" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-3" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-4" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-5" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-6" class="line-number-anchor" /><a href="#line-number-aa983b3d2a5caf9798bebde31e622c63c767310b-6">6</a></td></tr></table></div></code></pre>
<p>Since we do not do any custom transaction demarcation in the above
code, <code>EntityManager#flush()</code> will begin and commit/rollback a
transaction. This behavior is made possible by the aggregation of
the DML operations by the Doctrine ORM and is sufficient if all the
data manipulation that is part of a unit of work happens through
the domain model and thus the ORM.</p>
<a id="transactions-and-concurrency_approach-explicitly"></a>
</div>
<div class="section"><a class="section-anchor" id="approach-2-explicitly" name="approach-2-explicitly"></a><h3 class="section-header"><a href="#approach-2-explicitly">Approach 2: Explicitly<i class="fas fa-link"></i></a></h3>
<p>The explicit alternative is to use the <code>Doctrine\DBAL\Connection</code>
API directly to control the transaction boundaries. The code then
looks like this:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="f4617abe0f4830df09086487723eb567794ccad4"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="f4617abe0f4830df09086487723eb567794ccad4"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-1" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-1">1</a></td><td class="code-line" rowspan="14"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// $em instanceof EntityManager</span>
$em-&gt;getConnection()-&gt;beginTransaction(); <span class="hljs-comment">// suspend auto-commit</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ... do some work</span>
    $user = <span class="hljs-keyword">new</span> User;
    $user-&gt;setName(<span class="hljs-string">'George'</span>);
    $em-&gt;persist($user);
    $em-&gt;flush();
    $em-&gt;getConnection()-&gt;commit();
} <span class="hljs-keyword">catch</span> (<span class="hljs-keyword">Exception</span> $e) {
    $em-&gt;getConnection()-&gt;rollBack();
    <span class="hljs-keyword">throw</span> $e;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-2" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-3" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-4" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-5" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-6" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-7" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-8" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-9" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-10" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-11" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-12" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-13" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f4617abe0f4830df09086487723eb567794ccad4-14" class="line-number-anchor" /><a href="#line-number-f4617abe0f4830df09086487723eb567794ccad4-14">14</a></td></tr></table></div></code></pre>
<p>Explicit transaction demarcation is required when you want to
include custom DBAL operations in a unit of work or when you want
to make use of some methods of the <code>EntityManager</code> API that
require an active transaction. Such methods will throw a
<code>TransactionRequiredException</code> to inform you of that
requirement.</p>
<p>A more convenient alternative for explicit transaction demarcation is the use
of provided control abstractions in the form of
<code>Connection#transactional($func)</code> and <code>EntityManager#transactional($func)</code>.
When used, these control abstractions ensure that you never forget to rollback
the transaction, in addition to the obvious code reduction. An example that is
functionally equivalent to the previously shown code looks as follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e21f15c72d3f770aa881795b301523475428d162"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e21f15c72d3f770aa881795b301523475428d162"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-1" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// $em instanceof EntityManager</span>
$em-&gt;transactional(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($em)</span> </span>{
    <span class="hljs-comment">// ... do some work</span>
    $user = <span class="hljs-keyword">new</span> User;
    $user-&gt;setName(<span class="hljs-string">'George'</span>);
    $em-&gt;persist($user);
});</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-2" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-3" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-4" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-5" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-6" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-7" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e21f15c72d3f770aa881795b301523475428d162-8" class="line-number-anchor" /><a href="#line-number-e21f15c72d3f770aa881795b301523475428d162-8">8</a></td></tr></table></div></code></pre>
<div class="alert warning-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-circle text-warning mr-2"></i></td><td><p>For historical reasons, <code>EntityManager#transactional($func)</code> will return
<code>true</code> whenever the return value of <code>$func</code> is loosely false.
Some examples of this include <code>array()</code>, <code>&quot;0&quot;</code>, <code>&quot;&quot;</code>, <code>0</code>, and
<code>null</code>.</p>
</td></tr></table></div>
<p>The difference between <code>Connection#transactional($func)</code> and
<code>EntityManager#transactional($func)</code> is that the latter
abstraction flushes the <code>EntityManager</code> prior to transaction
commit and in case of an exception the <code>EntityManager</code> gets closed
in addition to the transaction rollback.</p>
<a id="transactions-and-concurrency_exception-handling"></a>
</div>
<div class="section"><a class="section-anchor" id="exception-handling" name="exception-handling"></a><h3 class="section-header"><a href="#exception-handling">Exception Handling<i class="fas fa-link"></i></a></h3>
<p>When using implicit transaction demarcation and an exception occurs
during <code>EntityManager#flush()</code>, the transaction is automatically
rolled back and the <code>EntityManager</code> closed.</p>
<p>When using explicit transaction demarcation and an exception
occurs, the transaction should be rolled back immediately and the
<code>EntityManager</code> closed by invoking <code>EntityManager#close()</code> and
subsequently discarded, as demonstrated in the example above. This
can be handled elegantly by the control abstractions shown earlier.
Note that when catching <code>Exception</code> you should generally re-throw
the exception. If you intend to recover from some exceptions, catch
them explicitly in earlier catch blocks (but do not forget to
rollback the transaction and close the <code>EntityManager</code> there as
well). All other best practices of exception handling apply
similarly (i.e. either log or re-throw, not both, etc.).</p>
<p>As a result of this procedure, all previously managed or removed
instances of the <code>EntityManager</code> become detached. The state of
the detached objects will be the state at the point at which the
transaction was rolled back. The state of the objects is in no way
rolled back and thus the objects are now out of synch with the
database. The application can continue to use the detached objects,
knowing that their state is potentially no longer accurate.</p>
<p>If you intend to start another unit of work after an exception has
occurred you should do that with a new <code>EntityManager</code>.</p>
<a id="transactions-and-concurrency_locking-support"></a>
</div>
</div>
<div class="section"><a class="section-anchor" id="locking-support" name="locking-support"></a><h2 class="section-header"><a href="#locking-support">Locking Support<i class="fas fa-link"></i></a></h2>
<p>Doctrine ORM offers support for Pessimistic- and Optimistic-locking
strategies natively. This allows to take very fine-grained control
over what kind of locking is required for your Entities in your
application.</p>
<a id="transactions-and-concurrency_optimistic-locking"></a>
<div class="section"><a class="section-anchor" id="optimistic-locking" name="optimistic-locking"></a><h3 class="section-header"><a href="#optimistic-locking">Optimistic Locking<i class="fas fa-link"></i></a></h3>
<p>Database transactions are fine for concurrency control during a
single request. However, a database transaction should not span
across requests, the so-called user think time. Therefore a
long-running business transaction that spans multiple requests
needs to involve several database transactions. Thus, database
transactions alone can no longer control concurrency during such a
long-running business transaction. Concurrency control becomes the
partial responsibility of the application itself.</p>
<p>Doctrine has integrated support for automatic optimistic locking
via a version field. In this approach any entity that should be
protected against concurrent modifications during long-running
business transactions gets a version field that is either a simple
number (mapping type: integer) or a timestamp (mapping type:
datetime). When changes to such an entity are persisted at the end
of a long-running conversation the version of the entity is
compared to the version in the database and if they don't match, an
<code>OptimisticLockException</code> is thrown, indicating that the entity
has been modified by someone else already.</p>
<p>You designate a version field in an entity as follows. In this
example we'll use an integer.</p>
<div class="configuration-block jsactive clearfix"><ul class="simple"><li><em>ATTRIBUTE</em><div class="highlight-attribute"><pre class="code-block-table"><code class="attribute"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="2d929cc16973736812494509a09ab890cacd9d57"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="2d929cc16973736812494509a09ab890cacd9d57"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-1" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">#[Version, Column(type: 'integer')]</span>
    <span class="hljs-keyword">private</span> int $version;
    <span class="hljs-comment">// ...</span>
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-2" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-3" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-4" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-5" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-6" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-7" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2d929cc16973736812494509a09ab890cacd9d57-8" class="line-number-anchor" /><a href="#line-number-2d929cc16973736812494509a09ab890cacd9d57-8">8</a></td></tr></table></div></code></pre></div></li><li><em>XML</em><div class="highlight-xml"><pre class="code-block-table"><code class="xml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="3a4b2894675ed13d6781ca0983ccd945a07a0010"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="3a4b2894675ed13d6781ca0983ccd945a07a0010"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-1" class="line-number-anchor" /><a href="#line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-tag">&lt;<span class="hljs-name">doctrine-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"User"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"version"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"integer"</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"true"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">doctrine-mapping</span>&gt;</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-2" class="line-number-anchor" /><a href="#line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-3" class="line-number-anchor" /><a href="#line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-4" class="line-number-anchor" /><a href="#line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-5" class="line-number-anchor" /><a href="#line-number-3a4b2894675ed13d6781ca0983ccd945a07a0010-5">5</a></td></tr></table></div></code></pre></div></li></ul></div>
<p>Alternatively a datetime type can be used (which maps to a SQL
timestamp or datetime):</p>
<div class="configuration-block jsactive clearfix"><ul class="simple"><li><em>ATTRIBUTE</em><div class="highlight-attribute"><pre class="code-block-table"><code class="attribute"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e8fdf6f99946c8e8cbeb7467af351f580d040015"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e8fdf6f99946c8e8cbeb7467af351f580d040015"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-1" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">#[Version, Column(type: 'datetime')]</span>
    <span class="hljs-keyword">private</span> DateTime $version;
    <span class="hljs-comment">// ...</span>
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-2" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-3" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-4" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-5" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-6" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-7" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-8" class="line-number-anchor" /><a href="#line-number-e8fdf6f99946c8e8cbeb7467af351f580d040015-8">8</a></td></tr></table></div></code></pre></div></li><li><em>XML</em><div class="highlight-xml"><pre class="code-block-table"><code class="xml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9c3a6b2f07164137a5c9dee94b5808617b9e18eb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9c3a6b2f07164137a5c9dee94b5808617b9e18eb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-1" class="line-number-anchor" /><a href="#line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-tag">&lt;<span class="hljs-name">doctrine-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">entity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"User"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"version"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"datetime"</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"true"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">entity</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">doctrine-mapping</span>&gt;</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-2" class="line-number-anchor" /><a href="#line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-3" class="line-number-anchor" /><a href="#line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-4" class="line-number-anchor" /><a href="#line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-5" class="line-number-anchor" /><a href="#line-number-9c3a6b2f07164137a5c9dee94b5808617b9e18eb-5">5</a></td></tr></table></div></code></pre></div></li></ul></div>
<p>Version numbers (not timestamps) should however be preferred as
they can not potentially conflict in a highly concurrent
environment, unlike timestamps where this is a possibility,
depending on the resolution of the timestamp on the particular
database platform.</p>
<p>When a version conflict is encountered during
<code>EntityManager#flush()</code>, an <code>OptimisticLockException</code> is thrown
and the active transaction rolled back (or marked for rollback).
This exception can be caught and handled. Potential responses to an
OptimisticLockException are to present the conflict to the user or
to refresh or reload objects in a new transaction and then retrying
the transaction.</p>
<p>With PHP promoting a share-nothing architecture, the time between
showing an update form and actually modifying the entity can in the
worst scenario be as long as your applications session timeout. If
changes happen to the entity in that time frame you want to know
directly when retrieving the entity that you will hit an optimistic
locking exception:</p>
<p>You can always verify the version of an entity during a request
either when calling <code>EntityManager#find()</code>:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="29b49ccb2dc90101e7f94bb8d041d260d3868e60"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="29b49ccb2dc90101e7f94bb8d041d260d3868e60"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-1" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-1">1</a></td><td class="code-line" rowspan="16"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">LockMode</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">OptimisticLockException</span>;

$theEntityId = <span class="hljs-number">1</span>;
$expectedVersion = <span class="hljs-number">184</span>;

<span class="hljs-keyword">try</span> {
    $entity = $em-&gt;find(<span class="hljs-string">'User'</span>, $theEntityId, LockMode::OPTIMISTIC, $expectedVersion);

    <span class="hljs-comment">// do the work</span>

    $em-&gt;flush();
} <span class="hljs-keyword">catch</span>(OptimisticLockException $e) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Sorry, but someone else has already changed this entity. Please apply the changes again!"</span>;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-2" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-3" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-4" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-5" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-6" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-7" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-8" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-9" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-10" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-11" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-12" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-13" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-14" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-15" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-16" class="line-number-anchor" /><a href="#line-number-29b49ccb2dc90101e7f94bb8d041d260d3868e60-16">16</a></td></tr></table></div></code></pre>
<p>Or you can use <code>EntityManager#lock()</code> to find out:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="c1a7bb07687eaf61615b5269f8d435b8f11a0b36"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="c1a7bb07687eaf61615b5269f8d435b8f11a0b36"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-1" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-1">1</a></td><td class="code-line" rowspan="16"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">DBAL</span>\<span class="hljs-title">LockMode</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">OptimisticLockException</span>;

$theEntityId = <span class="hljs-number">1</span>;
$expectedVersion = <span class="hljs-number">184</span>;

$entity = $em-&gt;find(<span class="hljs-string">'User'</span>, $theEntityId);

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// assert version</span>
    $em-&gt;lock($entity, LockMode::OPTIMISTIC, $expectedVersion);

} <span class="hljs-keyword">catch</span>(OptimisticLockException $e) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Sorry, but someone else has already changed this entity. Please apply the changes again!"</span>;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-2" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-3" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-4" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-5" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-6" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-7" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-8" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-9" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-10" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-11" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-12" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-13" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-14" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-15" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-16" class="line-number-anchor" /><a href="#line-number-c1a7bb07687eaf61615b5269f8d435b8f11a0b36-16">16</a></td></tr></table></div></code></pre>
<div class="section"><a class="section-anchor" id="important-implementation-notes" name="important-implementation-notes"></a><h4 class="section-header"><a href="#important-implementation-notes">Important Implementation Notes<i class="fas fa-link"></i></a></h4>
<p>You can easily get the optimistic locking workflow wrong if you
compare the wrong versions. Say you have Alice and Bob editing a
hypothetical blog post:</p>
<ul>
    <li class="dash">Alice reads the headline of the blog post being &quot;Foo&quot;, at
optimistic lock version 1 (GET Request)</li>
<li class="dash">Bob reads the headline of the blog post being &quot;Foo&quot;, at
optimistic lock version 1 (GET Request)</li>
<li class="dash">Bob updates the headline to &quot;Bar&quot;, upgrading the optimistic lock
version to 2 (POST Request of a Form)</li>
<li class="dash">Alice updates the headline to &quot;Baz&quot;, ... (POST Request of a
Form)</li>
</ul>
<p>Now at the last stage of this scenario the blog post has to be read
again from the database before Alice's headline can be applied. At
this point you will want to check if the blog post is still at
version 1 (which it is not in this scenario).</p>
<p>Using optimistic locking correctly, you <em>have</em> to add the version
as an additional hidden field (or into the SESSION for more
safety). Otherwise you cannot verify the version is still the one
being originally read from the database when Alice performed her
GET request for the blog post. If this happens you might see lost
updates you wanted to prevent with Optimistic Locking.</p>
<p>See the example code, The form (GET Request):</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="52f5f29ff33eada51684a7387a23fad30b1c11b5"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="52f5f29ff33eada51684a7387a23fad30b1c11b5"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-1" class="line-number-anchor" /><a href="#line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>
$post = $em-&gt;find(<span class="hljs-string">'BlogPost'</span>, <span class="hljs-number">123456</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;input type="hidden" name="id" value="'</span> . $post-&gt;getId() . <span class="hljs-string">'" /&gt;'</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;input type="hidden" name="version" value="'</span> . $post-&gt;getCurrentVersion() . <span class="hljs-string">'" /&gt;'</span>;</td></tr>
<tr><td class="line-number noselect"><a name="line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-2" class="line-number-anchor" /><a href="#line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-3" class="line-number-anchor" /><a href="#line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-4" class="line-number-anchor" /><a href="#line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-5" class="line-number-anchor" /><a href="#line-number-52f5f29ff33eada51684a7387a23fad30b1c11b5-5">5</a></td></tr></table></div></code></pre>
<p>And the change headline action (POST Request):</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e31b01bebd91216b3613fc9a34c6274b5d38eed6"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e31b01bebd91216b3613fc9a34c6274b5d38eed6"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-1" class="line-number-anchor" /><a href="#line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>
$postId = (int)$_GET[<span class="hljs-string">'id'</span>];
$postVersion = (int)$_GET[<span class="hljs-string">'version'</span>];

$post = $em-&gt;find(<span class="hljs-string">'BlogPost'</span>, $postId, \Doctrine\DBAL\LockMode::OPTIMISTIC, $postVersion);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-2" class="line-number-anchor" /><a href="#line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-3" class="line-number-anchor" /><a href="#line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-4" class="line-number-anchor" /><a href="#line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-5" class="line-number-anchor" /><a href="#line-number-e31b01bebd91216b3613fc9a34c6274b5d38eed6-5">5</a></td></tr></table></div></code></pre>
<a id="transactions-and-concurrency_pessimistic-locking"></a>
</div>
</div>
<div class="section"><a class="section-anchor" id="pessimistic-locking" name="pessimistic-locking"></a><h3 class="section-header"><a href="#pessimistic-locking">Pessimistic Locking<i class="fas fa-link"></i></a></h3>
<p>Doctrine ORM supports Pessimistic Locking at the database level. No
attempt is being made to implement pessimistic locking inside
Doctrine, rather vendor-specific and ANSI-SQL commands are used to
acquire row-level locks. Every Entity can be part of a pessimistic
lock, there is no special metadata required to use this feature.</p>
<p>However for Pessimistic Locking to work you have to disable the
Auto-Commit Mode of your Database and start a transaction around
your pessimistic lock use-case using the Approach 2: Explicit
Transaction Demarcation described above. Doctrine ORM will throw an
Exception if you attempt to acquire an pessimistic lock and no
transaction is running.</p>
<p>Doctrine ORM currently supports two pessimistic lock modes:</p>
<ul>
    <li class="dash">Pessimistic Write
(<code>Doctrine\DBAL\LockMode::PESSIMISTIC_WRITE</code>), locks the
underlying database rows for concurrent Read and Write Operations.</li>
<li class="dash">Pessimistic Read (<code>Doctrine\DBAL\LockMode::PESSIMISTIC_READ</code>),
locks other concurrent requests that attempt to update or lock rows
in write mode.</li>
</ul>
<p>You can use pessimistic locks in four different scenarios:</p>
<ol class="arabic">
    <li>Using
<code>EntityManager#find($className, $id, \Doctrine\DBAL\LockMode::PESSIMISTIC_WRITE)</code>
or
<code>EntityManager#find($className, $id, \Doctrine\DBAL\LockMode::PESSIMISTIC_READ)</code></li>
<li>Using
<code>EntityManager#lock($entity, \Doctrine\DBAL\LockMode::PESSIMISTIC_WRITE)</code>
or
<code>EntityManager#lock($entity, \Doctrine\DBAL\LockMode::PESSIMISTIC_READ)</code></li>
<li>Using
<code>EntityManager#refresh($entity, \Doctrine\DBAL\LockMode::PESSIMISTIC_WRITE)</code>
or
<code>EntityManager#refresh($entity, \Doctrine\DBAL\LockMode::PESSIMISTIC_READ)</code></li>
<li>Using
<code>Query#setLockMode(\Doctrine\DBAL\LockMode::PESSIMISTIC_WRITE)</code>
or
<code>Query#setLockMode(\Doctrine\DBAL\LockMode::PESSIMISTIC_READ)</code></li>
</ol>

</div>
</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?5364f3"
                            integrity="sha384-yT1xut8dmITuccyh+MOljcF0MzMJFhaP227UZREURvpogyieLsqm9J/duGcSbb6q"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'orm';
            var versionSlug = '3.1';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search ORM 3.1'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
