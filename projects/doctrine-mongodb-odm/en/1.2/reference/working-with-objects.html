<!DOCTYPE html>
<html>
    <head>
        <title>Working with Objects - Doctrine MongoDB Object Document Mapper (MongoDB ODM)</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine MongoDB Object Document Mapper Documentation: Working with Objects ">

        <meta name="keywords" content="php,mongodb,odm,data,mapper,mapping,object,documentation,working,with,objects">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.3/reference/working-with-objects.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?c12da0"
                        integrity="sha384-5lbt2Avo9fHKChuQ44H6yXl4Sc6VcjqyEN69sxQ7mDwXQGycdD++DxYtf1GbnCJ6"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/1.2/reference/working-with-objects.html" />
        <meta property="og:title" content="Working with Objects - Doctrine MongoDB Object Document Mapper (MongoDB ODM)" />
        <meta property="og:description" content="Doctrine MongoDB Object Document Mapper Documentation: Working with Objects " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine MongoDB Object Document Mapper",
            "description": "Working with Objects",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar stop-war-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                 <a href="/stop-war.html">ðŸ‡ºðŸ‡¦ UKRAINE NEEDS YOUR HELP NOW!</a>
            </nav>

            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/mongodb-odm/edit/1.2.x/docs/en/reference/working-with-objects.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc"><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-mapping-classes-to-the-orm-and-odm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mapping-classes-to-the-orm-and-odm">Mapping Classes to the ORM and ODM</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-test-subject" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#test-subject">Test Subject</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mapping-information" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mapping-information">Mapping Information</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-orm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#orm">ORM</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mongodb-odm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mongodb-odm">MongoDB ODM</a></li></ul></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-repository-classes" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#repository-classes">Repository Classes</a></li></ul></li><li id="cookbook-soft-delete-extension-html-soft-delete-extension" class="toc-item"><a href="../cookbook/soft-delete-extension.html#soft-delete-extension">Soft Delete Extension</a><ul><li id="cookbook-soft-delete-extension-html-installation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#installation">Installation</a></li><li id="cookbook-soft-delete-extension-html-setup" class="toc-item"><a href="../cookbook/soft-delete-extension.html#setup">Setup</a></li><li id="cookbook-soft-delete-extension-html-softdeleteable-interface" class="toc-item"><a href="../cookbook/soft-delete-extension.html#softdeleteable-interface">SoftDeleteable Interface</a></li><li id="cookbook-soft-delete-extension-html-example-implementation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#example-implementation">Example Implementation</a></li><li id="cookbook-soft-delete-extension-html-usage" class="toc-item"><a href="../cookbook/soft-delete-extension.html#usage">Usage</a></li><li id="cookbook-soft-delete-extension-html-events" class="toc-item"><a href="../cookbook/soft-delete-extension.html#events">Events</a></li><li id="cookbook-soft-delete-extension-html-cascading-soft-deletes" class="toc-item"><a href="../cookbook/soft-delete-extension.html#cascading-soft-deletes">Cascading Soft Deletes</a></li></ul></li><li id="cookbook-resolve-target-document-listener-html-keeping-your-modules-independent" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#keeping-your-modules-independent">Keeping Your Modules Independent</a><ul><li id="cookbook-resolve-target-document-listener-html-background" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#background">Background</a></li><li id="cookbook-resolve-target-document-listener-html-configuration" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#configuration">Configuration</a></li><li id="cookbook-resolve-target-document-listener-html-final-thoughts" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#final-thoughts">Final Thoughts</a></li></ul></li><li id="cookbook-implementing-the-notify-changetracking-policy-html-implementing-the-notify-changetracking-policy" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html#implementing-the-notify-changetracking-policy">Implementing the Notify ChangeTracking Policy</a><ul><li id="cookbook-implementing-the-notify-changetracking-policy-html-implementing-notifypropertychanged" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html#implementing-notifypropertychanged">Implementing NotifyPropertyChanged</a></li></ul></li><li id="cookbook-implementing-array-access-for-domain-objects-html-implementing-arrayaccess-for-domain-objects" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#implementing-arrayaccess-for-domain-objects">Implementing ArrayAccess for Domain Objects</a><ul><li id="cookbook-implementing-array-access-for-domain-objects-html-option-1" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-1">Option 1</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-option-2" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-2">Option 2</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-read-only" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#read-only">Read-only</a></li></ul></li><li id="cookbook-blending-orm-and-mongodb-odm-html-blending-the-orm-and-mongodb-odm" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#blending-the-orm-and-mongodb-odm">Blending the ORM and MongoDB ODM</a><ul><li id="cookbook-blending-orm-and-mongodb-odm-html-define-product" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-product">Define Product</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-define-entity" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-entity">Define Entity</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-event-subscriber" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#event-subscriber">Event Subscriber</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-working-with-products-and-orders" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#working-with-products-and-orders">Working with Products and Orders</a></li></ul></li><li id="cookbook-simple-search-engine-html-simple-search-engine" class="toc-item"><a href="../cookbook/simple-search-engine.html#simple-search-engine">Simple Search Engine</a><ul><li id="cookbook-simple-search-engine-html-sample-model-product" class="toc-item"><a href="../cookbook/simple-search-engine.html#sample-model-product">Sample Model: Product</a></li><li id="cookbook-simple-search-engine-html-working-with-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#working-with-keywords">Working with Keywords</a></li><li id="cookbook-simple-search-engine-html-searching-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#searching-keywords">Searching Keywords</a><ul><li id="cookbook-simple-search-engine-html-user-input" class="toc-item"><a href="../cookbook/simple-search-engine.html#user-input">User Input</a></li></ul></li><li id="cookbook-simple-search-engine-html-embedded-documents" class="toc-item"><a href="../cookbook/simple-search-engine.html#embedded-documents">Embedded Documents</a><ul><li id="cookbook-simple-search-engine-html-definition" class="toc-item"><a href="../cookbook/simple-search-engine.html#definition">Definition</a></li></ul></li></ul></li><li id="cookbook-validation-of-documents-html-validation-of-documents" class="toc-item"><a href="../cookbook/validation-of-documents.html#validation-of-documents">Validation of Documents</a></li><li id="cookbook-implementing-wakeup-or-clone-html-implementing-wakeup-or-clone" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#implementing-wakeup-or-clone">Implementing Wakeup or Clone</a><ul><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-wakeup" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-wakeup">Safely implementing \_\_wakeup</a></li><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-clone" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-clone">Safely implementing \_\_clone</a></li><li id="cookbook-implementing-wakeup-or-clone-html-summary" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#summary">Summary</a></li></ul></li><li id="tutorials-getting-started-html-getting-started" class="toc-item"><a href="../tutorials/getting-started.html#getting-started">Getting Started</a><ul><li id="tutorials-getting-started-html-example-model-simple-blog" class="toc-item"><a href="../tutorials/getting-started.html#example-model-simple-blog">Example Model: Simple Blog</a></li><li id="tutorials-getting-started-html-a-first-prototype" class="toc-item"><a href="../tutorials/getting-started.html#a-first-prototype">A first prototype</a></li><li id="tutorials-getting-started-html-persistent-models" class="toc-item"><a href="../tutorials/getting-started.html#persistent-models">Persistent Models</a></li><li id="tutorials-getting-started-html-usage" class="toc-item"><a href="../tutorials/getting-started.html#usage">Usage</a></li></ul></li><li id="console-commands-html-console-commands" class="toc-item"><a href="console-commands.html#console-commands">Console Commands</a></li><li id="yml-mapping-html-yaml-mapping" class="toc-item"><a href="yml-mapping.html#yaml-mapping">YAML Mapping</a><ul><li id="yml-mapping-html-simplified-yaml-driver" class="toc-item"><a href="yml-mapping.html#simplified-yaml-driver">Simplified YAML Driver</a><ul><li id="yml-mapping-html-example" class="toc-item"><a href="yml-mapping.html#example">Example</a></li><li id="yml-mapping-html-reference" class="toc-item"><a href="yml-mapping.html#reference">Reference</a></li></ul></li></ul></li><li id="priming-references-html-priming-references" class="toc-item"><a href="priming-references.html#priming-references">Priming References</a><ul><li id="priming-references-html-query-builder" class="toc-item"><a href="priming-references.html#query-builder">Query Builder</a></li><li id="priming-references-html-inverse-references" class="toc-item"><a href="priming-references.html#inverse-references">Inverse references</a></li><li id="priming-references-html-primer-callback" class="toc-item"><a href="priming-references.html#primer-callback">Primer Callback</a></li></ul></li><li id="aggregation-builder-html-aggregation-builder" class="toc-item"><a href="aggregation-builder.html#aggregation-builder">Aggregation builder</a><ul><li id="aggregation-builder-html-creating-an-aggregation-builder" class="toc-item"><a href="aggregation-builder.html#creating-an-aggregation-builder">Creating an Aggregation Builder</a><ul><li id="aggregation-builder-html-adding-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#adding-pipeline-stages">Adding pipeline stages</a></li><li id="aggregation-builder-html-nesting-expressions" class="toc-item"><a href="aggregation-builder.html#nesting-expressions">Nesting expressions</a></li><li id="aggregation-builder-html-executing-an-aggregation-pipeline" class="toc-item"><a href="aggregation-builder.html#executing-an-aggregation-pipeline">Executing an aggregation pipeline</a></li><li id="aggregation-builder-html-hydration" class="toc-item"><a href="aggregation-builder.html#hydration">Hydration</a></li></ul></li><li id="aggregation-builder-html-aggregation-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#aggregation-pipeline-stages">Aggregation pipeline stages</a><ul><li id="aggregation-builder-html-addfields" class="toc-item"><a href="aggregation-builder.html#addfields">$addFields</a></li><li id="aggregation-builder-html-bucket" class="toc-item"><a href="aggregation-builder.html#bucket">$bucket</a></li><li id="aggregation-builder-html-bucketauto" class="toc-item"><a href="aggregation-builder.html#bucketauto">$bucketAuto</a></li><li id="aggregation-builder-html-collstats" class="toc-item"><a href="aggregation-builder.html#collstats">$collStats</a></li><li id="aggregation-builder-html-count" class="toc-item"><a href="aggregation-builder.html#count">$count</a></li><li id="aggregation-builder-html-facet" class="toc-item"><a href="aggregation-builder.html#facet">$facet</a></li><li id="aggregation-builder-html-geonear" class="toc-item"><a href="aggregation-builder.html#geonear">$geoNear</a></li><li id="aggregation-builder-html-graphlookup" class="toc-item"><a href="aggregation-builder.html#graphlookup">$graphLookup</a></li><li id="aggregation-builder-html-group" class="toc-item"><a href="aggregation-builder.html#group">$group</a></li><li id="aggregation-builder-html-indexstats" class="toc-item"><a href="aggregation-builder.html#indexstats">$indexStats</a></li><li id="aggregation-builder-html-lookup" class="toc-item"><a href="aggregation-builder.html#lookup">$lookup</a></li><li id="aggregation-builder-html-match" class="toc-item"><a href="aggregation-builder.html#match">$match</a></li><li id="aggregation-builder-html-out" class="toc-item"><a href="aggregation-builder.html#out">$out</a></li><li id="aggregation-builder-html-project" class="toc-item"><a href="aggregation-builder.html#project">$project</a></li><li id="aggregation-builder-html-redact" class="toc-item"><a href="aggregation-builder.html#redact">$redact</a></li><li id="aggregation-builder-html-replaceroot" class="toc-item"><a href="aggregation-builder.html#replaceroot">$replaceRoot</a></li><li id="aggregation-builder-html-sample" class="toc-item"><a href="aggregation-builder.html#sample">$sample</a></li><li id="aggregation-builder-html-sort-limit-and-skip" class="toc-item"><a href="aggregation-builder.html#sort-limit-and-skip">$sort, $limit and $skip</a></li><li id="aggregation-builder-html-sortbycount" class="toc-item"><a href="aggregation-builder.html#sortbycount">$sortByCount</a></li><li id="aggregation-builder-html-unwind" class="toc-item"><a href="aggregation-builder.html#unwind">$unwind</a></li></ul></li></ul></li><li id="find-and-update-html-find-and-modify" class="toc-item"><a href="find-and-update.html#find-and-modify">Find and Modify</a><ul><li id="find-and-update-html-update" class="toc-item"><a href="find-and-update.html#update">Update</a></li><li id="find-and-update-html-remove" class="toc-item"><a href="find-and-update.html#remove">Remove</a></li></ul></li><li id="indexes-html-indexes" class="toc-item"><a href="indexes.html#indexes">Indexes</a><ul><li id="indexes-html-index-options" class="toc-item"><a href="indexes.html#index-options">Index Options</a></li><li id="indexes-html-unique-index" class="toc-item"><a href="indexes.html#unique-index">Unique Index</a></li><li id="indexes-html-embedded-indexes" class="toc-item"><a href="indexes.html#embedded-indexes">Embedded Indexes</a></li><li id="indexes-html-geospatial-indexing" class="toc-item"><a href="indexes.html#geospatial-indexing">Geospatial Indexing</a></li><li id="indexes-html-partial-indexes" class="toc-item"><a href="indexes.html#partial-indexes">Partial indexes</a></li><li id="indexes-html-requiring-indexes" class="toc-item"><a href="indexes.html#requiring-indexes">Requiring Indexes</a></li></ul></li><li id="eager-cursors-html-eager-cursors" class="toc-item"><a href="eager-cursors.html#eager-cursors">Eager Cursors</a></li><li id="xml-mapping-html-xml-mapping" class="toc-item"><a href="xml-mapping.html#xml-mapping">XML Mapping</a><ul><li id="xml-mapping-html-simplified-xml-driver" class="toc-item"><a href="xml-mapping.html#simplified-xml-driver">Simplified XML Driver</a><ul><li id="xml-mapping-html-example" class="toc-item"><a href="xml-mapping.html#example">Example</a></li><li id="xml-mapping-html-reference" class="toc-item"><a href="xml-mapping.html#reference">Reference</a></li></ul></li></ul></li><li id="basic-mapping-html-basic-mapping" class="toc-item"><a href="basic-mapping.html#basic-mapping">Basic Mapping</a><ul><li id="basic-mapping-html-mapping-drivers" class="toc-item"><a href="basic-mapping.html#mapping-drivers">Mapping Drivers</a></li><li id="basic-mapping-html-introduction-to-docblock-annotations" class="toc-item"><a href="basic-mapping.html#introduction-to-docblock-annotations">Introduction to Docblock Annotations</a></li><li id="basic-mapping-html-persistent-classes" class="toc-item"><a href="basic-mapping.html#persistent-classes">Persistent classes</a></li><li id="basic-mapping-html-doctrine-mapping-types" class="toc-item"><a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a></li><li id="basic-mapping-html-property-mapping" class="toc-item"><a href="basic-mapping.html#property-mapping">Property Mapping</a><ul><li id="basic-mapping-html-identifiers" class="toc-item"><a href="basic-mapping.html#identifiers">Identifiers</a></li><li id="basic-mapping-html-fields" class="toc-item"><a href="basic-mapping.html#fields">Fields</a></li></ul></li><li id="basic-mapping-html-custom-mapping-types" class="toc-item"><a href="basic-mapping.html#custom-mapping-types">Custom Mapping Types</a></li><li id="basic-mapping-html-multiple-document-types-in-a-collection" class="toc-item"><a href="basic-mapping.html#multiple-document-types-in-a-collection">Multiple Document Types in a Collection</a></li></ul></li><li id="slave-okay-queries-html-slave-okay-queries" class="toc-item"><a href="slave-okay-queries.html#slave-okay-queries">Slave Okay Queries</a><ul><li id="slave-okay-queries-html-documents" class="toc-item"><a href="slave-okay-queries.html#documents">Documents</a></li><li id="slave-okay-queries-html-queries" class="toc-item"><a href="slave-okay-queries.html#queries">Queries</a></li></ul></li><li id="transactions-and-concurrency-html-transactions-and-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#transactions-and-concurrency">Transactions and Concurrency</a><ul><li id="transactions-and-concurrency-html-transactions" class="toc-item"><a href="transactions-and-concurrency.html#transactions">Transactions</a><ul><li id="transactions-and-concurrency-html-limitation" class="toc-item"><a href="transactions-and-concurrency.html#limitation">Limitation</a></li><li id="transactions-and-concurrency-html-workaround" class="toc-item"><a href="transactions-and-concurrency.html#workaround">Workaround</a></li></ul></li><li id="transactions-and-concurrency-html-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#concurrency">Concurrency</a><ul><li id="transactions-and-concurrency-html-optimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#optimistic-locking">Optimistic Locking</a></li><li id="transactions-and-concurrency-html-pessimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#pessimistic-locking">Pessimistic Locking</a></li></ul></li></ul></li><li id="document-repositories-html-document-repositories" class="toc-item"><a href="document-repositories.html#document-repositories">Document Repositories</a><ul><li id="document-repositories-html-custom-repositories" class="toc-item"><a href="document-repositories.html#custom-repositories">Custom Repositories</a></li><li id="document-repositories-html-repositories-with-additional-dependencies" class="toc-item"><a href="document-repositories.html#repositories-with-additional-dependencies">Repositories with Additional Dependencies</a></li></ul></li><li id="complex-references-html-complex-references" class="toc-item"><a href="complex-references.html#complex-references">Complex References</a><ul><li id="complex-references-html-basic-example" class="toc-item"><a href="complex-references.html#basic-example">Basic Example</a></li><li id="complex-references-html-020ddd601958aaad53d92cbe5be8acd6fa218ab1-example" class="toc-item"><a href="complex-references.html#020ddd601958aaad53d92cbe5be8acd6fa218ab1-example">020ddd601958aaad53d92cbe5be8acd6fa218ab1 Example</a></li><li id="complex-references-html-81885aa34cb52bfce4e195259720afaeb143e2af-example" class="toc-item"><a href="complex-references.html#81885aa34cb52bfce4e195259720afaeb143e2af-example">81885aa34cb52bfce4e195259720afaeb143e2af Example</a></li></ul></li><li id="storing-files-with-mongogridfs-html-storing-files-with-mongogridfs" class="toc-item"><a href="storing-files-with-mongogridfs.html#storing-files-with-mongogridfs">Storing Files with MongoGridFS</a></li><li id="sharding-html-sharding" class="toc-item"><a href="sharding.html#sharding">Sharding</a></li><li id="logging-html-logging" class="toc-item"><a href="logging.html#logging">Logging</a></li><li id="geospatial-queries-html-geospatial-queries" class="toc-item"><a href="geospatial-queries.html#geospatial-queries">Geospatial Queries</a><ul><li id="geospatial-queries-html-mapping" class="toc-item"><a href="geospatial-queries.html#mapping">Mapping</a></li><li id="geospatial-queries-html-near-query" class="toc-item"><a href="geospatial-queries.html#near-query">Near Query</a></li><li id="geospatial-queries-html-geonear-command" class="toc-item"><a href="geospatial-queries.html#geonear-command">GeoNear Command</a></li><li id="geospatial-queries-html-within-box" class="toc-item"><a href="geospatial-queries.html#within-box">Within Box</a></li><li id="geospatial-queries-html-within-center" class="toc-item"><a href="geospatial-queries.html#within-center">Within Center</a></li></ul></li><li id="architecture-html-architecture" class="toc-item"><a href="architecture.html#architecture">Architecture</a><ul><li id="architecture-html-documents" class="toc-item"><a href="architecture.html#documents">Documents</a><ul><li id="architecture-html-document-states" class="toc-item"><a href="architecture.html#document-states">Document states</a></li><li id="architecture-html-persistent-fields" class="toc-item"><a href="architecture.html#persistent-fields">Persistent fields</a></li><li id="architecture-html-serializing-documents" class="toc-item"><a href="architecture.html#serializing-documents">Serializing documents</a></li></ul></li><li id="architecture-html-the-documentmanager" class="toc-item"><a href="architecture.html#the-documentmanager">The DocumentManager</a><ul><li id="architecture-html-transactional-write-behind" class="toc-item"><a href="architecture.html#transactional-write-behind">Transactional write-behind</a></li><li id="architecture-html-the-unit-of-work" class="toc-item"><a href="architecture.html#the-unit-of-work">The Unit of Work</a></li></ul></li></ul></li><li id="custom-collections-html-custom-collections" class="toc-item"><a href="custom-collections.html#custom-collections">Custom Collections</a><ul><li id="custom-collections-html-custom-collection-classes" class="toc-item"><a href="custom-collections.html#custom-collection-classes">Custom Collection Classes</a></li><li id="custom-collections-html-taking-control-of-the-collection-s-constructor" class="toc-item"><a href="custom-collections.html#taking-control-of-the-collection-s-constructor">Taking Control of the Collection's Constructor</a></li></ul></li><li id="working-with-objects-html-working-with-objects" class="toc-item"><a href="working-with-objects.html#working-with-objects">Working with Objects</a><ul><li id="working-with-objects-html-understanding" class="toc-item"><a href="working-with-objects.html#understanding">Understanding</a><ul><li id="working-with-objects-html-the-size-of-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a></li><li id="working-with-objects-html-the-cost-of-flush" class="toc-item"><a href="working-with-objects.html#the-cost-of-flush">The cost of flush()</a></li><li id="working-with-objects-html-direct-access-to-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a></li></ul></li><li id="working-with-objects-html-persisting-documents" class="toc-item"><a href="working-with-objects.html#persisting-documents">Persisting documents</a></li><li id="working-with-objects-html-flush-options" class="toc-item"><a href="working-with-objects.html#flush-options">Flush Options</a></li><li id="working-with-objects-html-removing-documents" class="toc-item"><a href="working-with-objects.html#removing-documents">Removing documents</a></li><li id="working-with-objects-html-detaching-documents" class="toc-item"><a href="working-with-objects.html#detaching-documents">Detaching documents</a></li><li id="working-with-objects-html-merging-documents" class="toc-item"><a href="working-with-objects.html#merging-documents">Merging documents</a></li><li id="working-with-objects-html-references" class="toc-item"><a href="working-with-objects.html#references">References</a></li><li id="working-with-objects-html-establishing-references" class="toc-item"><a href="working-with-objects.html#establishing-references">Establishing References</a></li><li id="working-with-objects-html-removing-references" class="toc-item"><a href="working-with-objects.html#removing-references">Removing References</a></li><li id="working-with-objects-html-transitive-persistence" class="toc-item"><a href="working-with-objects.html#transitive-persistence">Transitive persistence</a></li><li id="working-with-objects-html-querying" class="toc-item"><a href="working-with-objects.html#querying">Querying</a><ul><li id="working-with-objects-html-by-primary-key" class="toc-item"><a href="working-with-objects.html#by-primary-key">By Primary Key</a></li><li id="working-with-objects-html-by-simple-conditions" class="toc-item"><a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a></li><li id="working-with-objects-html-by-lazy-loading" class="toc-item"><a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a></li><li id="working-with-objects-html-by-query-builder-objects" class="toc-item"><a href="working-with-objects.html#by-query-builder-objects">By Query Builder Objects</a></li><li id="working-with-objects-html-by-reference" class="toc-item"><a href="working-with-objects.html#by-reference">By Reference</a></li></ul></li></ul></li><li id="change-tracking-policies-html-change-tracking-policies" class="toc-item"><a href="change-tracking-policies.html#change-tracking-policies">Change Tracking Policies</a><ul><li id="change-tracking-policies-html-deferred-implicit" class="toc-item"><a href="change-tracking-policies.html#deferred-implicit">Deferred Implicit</a></li><li id="change-tracking-policies-html-deferred-explicit" class="toc-item"><a href="change-tracking-policies.html#deferred-explicit">Deferred Explicit</a></li><li id="change-tracking-policies-html-notify" class="toc-item"><a href="change-tracking-policies.html#notify">Notify</a></li></ul></li><li id="reference-mapping-html-reference-mapping" class="toc-item"><a href="reference-mapping.html#reference-mapping">Reference Mapping</a><ul><li id="reference-mapping-html-collections" class="toc-item"><a href="reference-mapping.html#collections">Collections</a></li><li id="reference-mapping-html-reference-one" class="toc-item"><a href="reference-mapping.html#reference-one">Reference One</a></li><li id="reference-mapping-html-reference-many" class="toc-item"><a href="reference-mapping.html#reference-many">Reference Many</a></li><li id="reference-mapping-html-mixing-document-types" class="toc-item"><a href="reference-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="reference-mapping-html-storing-references" class="toc-item"><a href="reference-mapping.html#storing-references">Storing References</a></li><li id="reference-mapping-html-cascading-operations" class="toc-item"><a href="reference-mapping.html#cascading-operations">Cascading Operations</a></li><li id="reference-mapping-html-orphan-removal" class="toc-item"><a href="reference-mapping.html#orphan-removal">Orphan Removal</a></li></ul></li><li id="introduction-html-introduction" class="toc-item"><a href="introduction.html#introduction">Introduction</a><ul><li id="introduction-html-features-overview" class="toc-item"><a href="introduction.html#features-overview">Features Overview</a></li><li id="introduction-html-setup" class="toc-item"><a href="introduction.html#setup">Setup</a></li><li id="introduction-html-using-php-7" class="toc-item"><a href="introduction.html#using-php-7">Using PHP 7</a></li></ul></li><li id="filters-html-filters" class="toc-item"><a href="filters.html#filters">Filters</a><ul><li id="filters-html-example-filter-class" class="toc-item"><a href="filters.html#example-filter-class">Example filter class</a></li><li id="filters-html-configuration" class="toc-item"><a href="filters.html#configuration">Configuration</a></li><li id="filters-html-disabling-enabling-filters-and-setting-parameters" class="toc-item"><a href="filters.html#disabling-enabling-filters-and-setting-parameters">Disabling/Enabling Filters and Setting Parameters</a></li></ul></li><li id="map-reduce-html-map-reduce" class="toc-item"><a href="map-reduce.html#map-reduce">Map Reduce</a></li><li id="events-html-events" class="toc-item"><a href="events.html#events">Events</a><ul><li id="events-html-the-event-system" class="toc-item"><a href="events.html#the-event-system">The Event System</a></li><li id="events-html-lifecycle-events" class="toc-item"><a href="events.html#lifecycle-events">Lifecycle Events</a></li><li id="events-html-lifecycle-callbacks" class="toc-item"><a href="events.html#lifecycle-callbacks">Lifecycle Callbacks</a></li><li id="events-html-listening-to-lifecycle-events" class="toc-item"><a href="events.html#listening-to-lifecycle-events">Listening to Lifecycle Events</a></li><li id="events-html-implementing-event-listeners" class="toc-item"><a href="events.html#implementing-event-listeners">Implementing Event Listeners</a><ul><li id="events-html-prepersist" class="toc-item"><a href="events.html#prepersist">prePersist</a></li><li id="events-html-preload" class="toc-item"><a href="events.html#preload">preLoad</a></li><li id="events-html-postload" class="toc-item"><a href="events.html#postload">postLoad</a></li><li id="events-html-preremove" class="toc-item"><a href="events.html#preremove">preRemove</a></li><li id="events-html-preflush" class="toc-item"><a href="events.html#preflush">preFlush</a></li><li id="events-html-onflush" class="toc-item"><a href="events.html#onflush">onFlush</a></li><li id="events-html-postflush" class="toc-item"><a href="events.html#postflush">postFlush</a></li><li id="events-html-preupdate" class="toc-item"><a href="events.html#preupdate">preUpdate</a></li><li id="events-html-onclear" class="toc-item"><a href="events.html#onclear">onClear</a></li><li id="events-html-documentnotfound" class="toc-item"><a href="events.html#documentnotfound">documentNotFound</a></li><li id="events-html-postupdate-postremove-postpersist" class="toc-item"><a href="events.html#postupdate-postremove-postpersist">postUpdate, postRemove, postPersist</a></li><li id="events-html-postcollectionload" class="toc-item"><a href="events.html#postcollectionload">postCollectionLoad</a></li></ul></li><li id="events-html-load-classmetadata-event" class="toc-item"><a href="events.html#load-classmetadata-event">Load ClassMetadata Event</a></li></ul></li><li id="capped-collections-html-capped-collections" class="toc-item"><a href="capped-collections.html#capped-collections">Capped Collections</a><ul><li id="capped-collections-html-mapping" class="toc-item"><a href="capped-collections.html#mapping">Mapping</a></li><li id="capped-collections-html-creating" class="toc-item"><a href="capped-collections.html#creating">Creating</a></li></ul></li><li id="upserting-documents-html-upserting-documents" class="toc-item"><a href="upserting-documents.html#upserting-documents">Upserting Documents</a></li><li id="bidirectional-references-html-bi-directional-references" class="toc-item"><a href="bidirectional-references.html#bi-directional-references">Bi-Directional References</a><ul><li id="bidirectional-references-html-owning-and-inverse-sides" class="toc-item"><a href="bidirectional-references.html#owning-and-inverse-sides">Owning and Inverse Sides</a><ul><li id="bidirectional-references-html-one-to-many" class="toc-item"><a href="bidirectional-references.html#one-to-many">One to Many</a></li></ul></li><li id="bidirectional-references-html-other-examples" class="toc-item"><a href="bidirectional-references.html#other-examples">Other Examples</a><ul><li id="bidirectional-references-html-one-to-one" class="toc-item"><a href="bidirectional-references.html#one-to-one">One to One</a></li><li id="bidirectional-references-html-self-referencing-many-to-many" class="toc-item"><a href="bidirectional-references.html#self-referencing-many-to-many">Self-Referencing Many to Many</a></li></ul></li></ul></li><li id="migrating-schemas-html-migrating-schemas" class="toc-item"><a href="migrating-schemas.html#migrating-schemas">Migrating Schemas</a><ul><li id="migrating-schemas-html-renaming-a-field" class="toc-item"><a href="migrating-schemas.html#renaming-a-field">Renaming a Field</a></li><li id="migrating-schemas-html-transforming-data" class="toc-item"><a href="migrating-schemas.html#transforming-data">Transforming Data</a></li><li id="migrating-schemas-html-moving-fields" class="toc-item"><a href="migrating-schemas.html#moving-fields">Moving Fields</a></li></ul></li><li id="storage-strategies-html-storage-strategies" class="toc-item"><a href="storage-strategies.html#storage-strategies">Storage Strategies</a><ul><li id="storage-strategies-html-increment" class="toc-item"><a href="storage-strategies.html#increment">increment</a></li><li id="storage-strategies-html-addtoset" class="toc-item"><a href="storage-strategies.html#addtoset">addToSet</a></li><li id="storage-strategies-html-set" class="toc-item"><a href="storage-strategies.html#set">set</a></li><li id="storage-strategies-html-setarray" class="toc-item"><a href="storage-strategies.html#setarray">setArray</a></li><li id="storage-strategies-html-pushall" class="toc-item"><a href="storage-strategies.html#pushall">pushAll</a></li><li id="storage-strategies-html-atomicset" class="toc-item"><a href="storage-strategies.html#atomicset">atomicSet</a></li><li id="storage-strategies-html-atomicsetarray" class="toc-item"><a href="storage-strategies.html#atomicsetarray">atomicSetArray</a></li></ul></li><li id="embedded-mapping-html-embedded-mapping" class="toc-item"><a href="embedded-mapping.html#embedded-mapping">Embedded Mapping</a><ul><li id="embedded-mapping-html-embed-one" class="toc-item"><a href="embedded-mapping.html#embed-one">Embed One</a></li><li id="embedded-mapping-html-embed-many" class="toc-item"><a href="embedded-mapping.html#embed-many">Embed Many</a></li><li id="embedded-mapping-html-mixing-document-types" class="toc-item"><a href="embedded-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="embedded-mapping-html-cascading-operations" class="toc-item"><a href="embedded-mapping.html#cascading-operations">Cascading Operations</a></li></ul></li><li id="metadata-drivers-html-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#metadata-drivers">Metadata Drivers</a><ul><li id="metadata-drivers-html-core-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#core-metadata-drivers">Core Metadata Drivers</a></li><li id="metadata-drivers-html-implementing-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#implementing-metadata-drivers">Implementing Metadata Drivers</a></li><li id="metadata-drivers-html-classmetadata" class="toc-item"><a href="metadata-drivers.html#classmetadata">ClassMetadata</a></li><li id="metadata-drivers-html-getting-classmetadata-instances" class="toc-item"><a href="metadata-drivers.html#getting-classmetadata-instances">Getting ClassMetadata Instances</a></li></ul></li><li id="trees-html-trees" class="toc-item"><a href="trees.html#trees">Trees</a><ul><li id="trees-html-full-tree-in-single-document" class="toc-item"><a href="trees.html#full-tree-in-single-document">Full Tree in Single Document</a></li><li id="trees-html-parent-reference" class="toc-item"><a href="trees.html#parent-reference">Parent Reference</a></li><li id="trees-html-child-reference" class="toc-item"><a href="trees.html#child-reference">Child Reference</a></li><li id="trees-html-array-of-ancestors" class="toc-item"><a href="trees.html#array-of-ancestors">Array of Ancestors</a></li><li id="trees-html-materialized-paths" class="toc-item"><a href="trees.html#materialized-paths">Materialized Paths</a></li></ul></li><li id="best-practices-html-best-practices" class="toc-item"><a href="best-practices.html#best-practices">Best Practices</a><ul><li id="best-practices-html-constrain-relationships-as-much-as-possible" class="toc-item"><a href="best-practices.html#constrain-relationships-as-much-as-possible">Constrain relationships as much as possible</a></li><li id="best-practices-html-use-events-judiciously" class="toc-item"><a href="best-practices.html#use-events-judiciously">Use events judiciously</a></li><li id="best-practices-html-use-cascades-judiciously" class="toc-item"><a href="best-practices.html#use-cascades-judiciously">Use cascades judiciously</a></li><li id="best-practices-html-don-t-use-special-characters" class="toc-item"><a href="best-practices.html#don-t-use-special-characters">Don't use special characters</a></li><li id="best-practices-html-initialize-collections-in-the-constructor" class="toc-item"><a href="best-practices.html#initialize-collections-in-the-constructor">Initialize collections in the constructor</a></li></ul></li><li id="inheritance-mapping-html-inheritance-mapping" class="toc-item"><a href="inheritance-mapping.html#inheritance-mapping">Inheritance Mapping</a><ul><li id="inheritance-mapping-html-mapped-superclasses" class="toc-item"><a href="inheritance-mapping.html#mapped-superclasses">Mapped Superclasses</a></li><li id="inheritance-mapping-html-single-collection-inheritance" class="toc-item"><a href="inheritance-mapping.html#single-collection-inheritance">Single Collection Inheritance</a></li><li id="inheritance-mapping-html-collection-per-class-inheritance" class="toc-item"><a href="inheritance-mapping.html#collection-per-class-inheritance">Collection Per Class Inheritance</a></li></ul></li><li id="query-builder-api-html-query-builder-api" class="toc-item"><a href="query-builder-api.html#query-builder-api">Query Builder API</a><ul><li id="query-builder-api-html-finding-documents" class="toc-item"><a href="query-builder-api.html#finding-documents">Finding Documents</a></li><li id="query-builder-api-html-creating-a-query-builder" class="toc-item"><a href="query-builder-api.html#creating-a-query-builder">Creating a Query Builder</a><ul><li id="query-builder-api-html-executing-queries" class="toc-item"><a href="query-builder-api.html#executing-queries">Executing Queries</a></li><li id="query-builder-api-html-debugging-queries" class="toc-item"><a href="query-builder-api.html#debugging-queries">Debugging Queries</a></li><li id="query-builder-api-html-eager-cursors" class="toc-item"><a href="query-builder-api.html#eager-cursors">Eager Cursors</a></li><li id="query-builder-api-html-getting-single-result" class="toc-item"><a href="query-builder-api.html#getting-single-result">Getting Single Result</a></li><li id="query-builder-api-html-selecting-fields" class="toc-item"><a href="query-builder-api.html#selecting-fields">Selecting Fields</a></li><li id="query-builder-api-html-index-hints" class="toc-item"><a href="query-builder-api.html#index-hints">Index hints</a></li><li id="query-builder-api-html-selecting-distinct-values" class="toc-item"><a href="query-builder-api.html#selecting-distinct-values">Selecting Distinct Values</a></li><li id="query-builder-api-html-refreshing-documents" class="toc-item"><a href="query-builder-api.html#refreshing-documents">Refreshing Documents</a></li><li id="query-builder-api-html-fetching-documents-as-read-only" class="toc-item"><a href="query-builder-api.html#fetching-documents-as-read-only">Fetching Documents as Read-Only</a></li><li id="query-builder-api-html-disabling-hydration" class="toc-item"><a href="query-builder-api.html#disabling-hydration">Disabling Hydration</a></li><li id="query-builder-api-html-limiting-results" class="toc-item"><a href="query-builder-api.html#limiting-results">Limiting Results</a></li><li id="query-builder-api-html-sorting-results" class="toc-item"><a href="query-builder-api.html#sorting-results">Sorting Results</a></li><li id="query-builder-api-html-map-reduce" class="toc-item"><a href="query-builder-api.html#map-reduce">Map Reduce</a></li><li id="query-builder-api-html-conditional-operators" class="toc-item"><a href="query-builder-api.html#conditional-operators">Conditional Operators</a></li><li id="query-builder-api-html-text-search" class="toc-item"><a href="query-builder-api.html#text-search">Text Search</a></li><li id="query-builder-api-html-update-queries" class="toc-item"><a href="query-builder-api.html#update-queries">Update Queries</a></li></ul></li><li id="query-builder-api-html-updating-multiple-documents" class="toc-item"><a href="query-builder-api.html#updating-multiple-documents">Updating multiple documents</a></li><li id="query-builder-api-html-modifier-operations" class="toc-item"><a href="query-builder-api.html#modifier-operations">Modifier Operations</a></li><li id="query-builder-api-html-remove-queries" class="toc-item"><a href="query-builder-api.html#remove-queries">Remove Queries</a></li><li id="query-builder-api-html-group-queries" class="toc-item"><a href="query-builder-api.html#group-queries">Group Queries</a></li></ul></li><li id="annotations-reference-html-annotations-reference" class="toc-item"><a href="annotations-reference.html#annotations-reference">Annotations Reference</a><ul><li id="annotations-reference-html-alsoload" class="toc-item"><a href="annotations-reference.html#alsoload">@AlsoLoad</a></li><li id="annotations-reference-html-bin" class="toc-item"><a href="annotations-reference.html#bin">@Bin</a></li><li id="annotations-reference-html-bincustom" class="toc-item"><a href="annotations-reference.html#bincustom">@BinCustom</a></li><li id="annotations-reference-html-binfunc" class="toc-item"><a href="annotations-reference.html#binfunc">@BinFunc</a></li><li id="annotations-reference-html-binmd5" class="toc-item"><a href="annotations-reference.html#binmd5">@BinMD5</a></li><li id="annotations-reference-html-binuuid" class="toc-item"><a href="annotations-reference.html#binuuid">@BinUUID</a></li><li id="annotations-reference-html-binuuidrfc4122" class="toc-item"><a href="annotations-reference.html#binuuidrfc4122">@BinUUIDRFC4122</a></li><li id="annotations-reference-html-bool" class="toc-item"><a href="annotations-reference.html#bool">@Bool</a></li><li id="annotations-reference-html-boolean" class="toc-item"><a href="annotations-reference.html#boolean">@Boolean</a></li><li id="annotations-reference-html-changetrackingpolicy" class="toc-item"><a href="annotations-reference.html#changetrackingpolicy">@ChangeTrackingPolicy</a></li><li id="annotations-reference-html-collection" class="toc-item"><a href="annotations-reference.html#collection">@Collection</a></li><li id="annotations-reference-html-date" class="toc-item"><a href="annotations-reference.html#date">@Date</a></li><li id="annotations-reference-html-defaultdiscriminatorvalue" class="toc-item"><a href="annotations-reference.html#defaultdiscriminatorvalue">@DefaultDiscriminatorValue</a></li><li id="annotations-reference-html-discriminatorfield" class="toc-item"><a href="annotations-reference.html#discriminatorfield">@DiscriminatorField</a></li><li id="annotations-reference-html-discriminatormap" class="toc-item"><a href="annotations-reference.html#discriminatormap">@DiscriminatorMap</a></li><li id="annotations-reference-html-distance" class="toc-item"><a href="annotations-reference.html#distance">@Distance</a></li><li id="annotations-reference-html-document" class="toc-item"><a href="annotations-reference.html#document">@Document</a></li><li id="annotations-reference-html-embedmany" class="toc-item"><a href="annotations-reference.html#embedmany">@EmbedMany</a></li><li id="annotations-reference-html-embedone" class="toc-item"><a href="annotations-reference.html#embedone">@EmbedOne</a></li><li id="annotations-reference-html-embeddeddocument" class="toc-item"><a href="annotations-reference.html#embeddeddocument">@EmbeddedDocument</a></li><li id="annotations-reference-html-field" class="toc-item"><a href="annotations-reference.html#field">@Field</a></li><li id="annotations-reference-html-file" class="toc-item"><a href="annotations-reference.html#file">@File</a></li><li id="annotations-reference-html-float" class="toc-item"><a href="annotations-reference.html#float">@Float</a></li><li id="annotations-reference-html-haslifecyclecallbacks" class="toc-item"><a href="annotations-reference.html#haslifecyclecallbacks">@HasLifecycleCallbacks</a></li><li id="annotations-reference-html-hash" class="toc-item"><a href="annotations-reference.html#hash">@Hash</a></li><li id="annotations-reference-html-id" class="toc-item"><a href="annotations-reference.html#id">@Id</a></li><li id="annotations-reference-html-increment" class="toc-item"><a href="annotations-reference.html#increment">@Increment</a></li><li id="annotations-reference-html-index" class="toc-item"><a href="annotations-reference.html#index">@Index</a></li><li id="annotations-reference-html-indexes" class="toc-item"><a href="annotations-reference.html#indexes">@Indexes</a></li><li id="annotations-reference-html-inheritancetype" class="toc-item"><a href="annotations-reference.html#inheritancetype">@InheritanceType</a></li><li id="annotations-reference-html-int" class="toc-item"><a href="annotations-reference.html#int">@Int</a></li><li id="annotations-reference-html-integer" class="toc-item"><a href="annotations-reference.html#integer">@Integer</a></li><li id="annotations-reference-html-key" class="toc-item"><a href="annotations-reference.html#key">@Key</a></li><li id="annotations-reference-html-lock" class="toc-item"><a href="annotations-reference.html#lock">@Lock</a></li><li id="annotations-reference-html-mappedsuperclass" class="toc-item"><a href="annotations-reference.html#mappedsuperclass">@MappedSuperclass</a></li><li id="annotations-reference-html-notsaved" class="toc-item"><a href="annotations-reference.html#notsaved">@NotSaved</a></li><li id="annotations-reference-html-postload" class="toc-item"><a href="annotations-reference.html#postload">@PostLoad</a></li><li id="annotations-reference-html-postpersist" class="toc-item"><a href="annotations-reference.html#postpersist">@PostPersist</a></li><li id="annotations-reference-html-postremove" class="toc-item"><a href="annotations-reference.html#postremove">@PostRemove</a></li><li id="annotations-reference-html-postupdate" class="toc-item"><a href="annotations-reference.html#postupdate">@PostUpdate</a></li><li id="annotations-reference-html-preflush" class="toc-item"><a href="annotations-reference.html#preflush">@PreFlush</a></li><li id="annotations-reference-html-preload" class="toc-item"><a href="annotations-reference.html#preload">@PreLoad</a></li><li id="annotations-reference-html-prepersist" class="toc-item"><a href="annotations-reference.html#prepersist">@PrePersist</a></li><li id="annotations-reference-html-preremove" class="toc-item"><a href="annotations-reference.html#preremove">@PreRemove</a></li><li id="annotations-reference-html-preupdate" class="toc-item"><a href="annotations-reference.html#preupdate">@PreUpdate</a></li><li id="annotations-reference-html-readpreference" class="toc-item"><a href="annotations-reference.html#readpreference">@ReadPreference</a></li><li id="annotations-reference-html-referencemany" class="toc-item"><a href="annotations-reference.html#referencemany">@ReferenceMany</a></li><li id="annotations-reference-html-referenceone" class="toc-item"><a href="annotations-reference.html#referenceone">@ReferenceOne</a></li><li id="annotations-reference-html-shardkey" class="toc-item"><a href="annotations-reference.html#shardkey">@ShardKey</a></li><li id="annotations-reference-html-string" class="toc-item"><a href="annotations-reference.html#string">@String</a></li><li id="annotations-reference-html-timestamp" class="toc-item"><a href="annotations-reference.html#timestamp">@Timestamp</a></li><li id="annotations-reference-html-uniqueindex" class="toc-item"><a href="annotations-reference.html#uniqueindex">@UniqueIndex</a></li><li id="annotations-reference-html-version" class="toc-item"><a href="annotations-reference.html#version">@Version</a></li></ul></li><li id="index-html-doctrine-mongodb-odm-s-documentation" class="toc-item"><a href="../index.html#doctrine-mongodb-odm-s-documentation">Doctrine MongoDB ODM's documentation!</a><ul><li id="index-html-getting-help" class="toc-item"><a href="../index.html#getting-help">Getting Help</a></li><li id="index-html-getting-started" class="toc-item"><a href="../index.html#getting-started">Getting Started</a></li><li id="index-html-mapping-objects-onto-a-database" class="toc-item"><a href="../index.html#mapping-objects-onto-a-database">Mapping Objects onto a Database</a></li><li id="index-html-working-with-objects" class="toc-item"><a href="../index.html#working-with-objects">Working with Objects</a></li><li id="index-html-advanced-topics" class="toc-item"><a href="../index.html#advanced-topics">Advanced Topics</a></li><li id="index-html-cookbook" class="toc-item"><a href="../index.html#cookbook">Cookbook</a></li></ul></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "MongoDB ODM",
            "item": "https://www.doctrine-project.org/projects/mongodb-odm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/1.2/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Working with Objects",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/1.2/reference/working-with-objects.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/1.2/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Working with Objects</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-mongodb-odm/en/1.2/reference/working-with-objects.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        1.2.11
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/latest/reference/working-with-objects.html">
                                                    2.4.3

                                                    
                                                                                                            (upcoming)
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.3/reference/working-with-objects.html">
                                                    2.3.3

                                                                                                            (current)
                                                    
                                                                                                    </a>
                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.2/reference/working-with-objects.html">2.2</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.1/reference/working-with-objects.html">2.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.0/reference/working-with-objects.html">2.0</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.3/reference/working-with-objects.html">1.3</a>
                                                                                            
                                                <a class="dropdown-item active" href="/projects/doctrine-mongodb-odm/en/1.2/reference/working-with-objects.html">1.2</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.1/reference/working-with-objects.html">1.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.0/reference/working-with-objects.html">1.0</a>
                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="working-with-objects" name="working-with-objects"></a><h1 class="section-header"><a href="#working-with-objects">Working with Objects<i class="fas fa-link"></i></a></h1>
<div class="section"><a class="section-anchor" id="understanding" name="understanding"></a><h2 class="section-header"><a href="#understanding">Understanding<i class="fas fa-link"></i></a></h2>
<p>In this chapter we will help you understand the <code>DocumentManager</code>
and the <code>UnitOfWork</code>. A Unit of Work is similar to an
object-level transaction. A new Unit of Work is implicitly started
when a DocumentManager is initially created or after
<code>DocumentManager#flush()</code> has been invoked. A Unit of Work is
committed (and a new one started) by invoking
<code>DocumentManager#flush()</code>.</p>
<p>A Unit of Work can be manually closed by calling
<code>DocumentManager#close()</code>. Any changes to objects within this
Unit of Work that have not yet been persisted are lost.</p>
<div class="section"><a class="section-anchor" id="the-size-of-a-unit-of-work" name="the-size-of-a-unit-of-work"></a><h3 class="section-header"><a href="#the-size-of-a-unit-of-work">The size of a Unit of Work<i class="fas fa-link"></i></a></h3>
<p>The size of a Unit of Work mainly refers to the number of managed
documents at a particular point in time.</p>
</div>
<div class="section"><a class="section-anchor" id="the-cost-of-flush" name="the-cost-of-flush"></a><h3 class="section-header"><a href="#the-cost-of-flush">The cost of flush()<i class="fas fa-link"></i></a></h3>
<p>How costly a flush operation is in terms of performance mainly
depends on the size. You can get the size of your Unit of Work as
follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="13a969684316248876a5148a4dcd1549caeff8c8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="13a969684316248876a5148a4dcd1549caeff8c8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-1" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$uowSize = $dm-&gt;getUnitOfWork()-&gt;size();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-2" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-13a969684316248876a5148a4dcd1549caeff8c8-3" class="line-number-anchor" /><a href="#line-number-13a969684316248876a5148a4dcd1549caeff8c8-3">3</a></td></tr></table></div></code></pre>
<p>The size represents the number of managed documents in the Unit of
Work. This size affects the performance of flush() operations due
to change tracking and, of course, memory consumption, so you may
want to check it from time to time during development.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Do not invoke <code>flush</code> after every change to a
document or every single invocation of persist/remove/merge/...
This is an anti-pattern and unnecessarily reduces the performance
of your application. Instead, form units of work that operate on
your objects and call <code>flush</code> when you are done. While serving a
single HTTP request there should be usually no need for invoking
<code>flush</code> more than 0-2 times.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="direct-access-to-a-unit-of-work" name="direct-access-to-a-unit-of-work"></a><h3 class="section-header"><a href="#direct-access-to-a-unit-of-work">Direct access to a Unit of Work<i class="fas fa-link"></i></a></h3>
<p>You can get direct access to the Unit of Work by calling
<code>DocumentManager#getUnitOfWork()</code>. This will return the
UnitOfWork instance the DocumentManager is currently using.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="445e14effe022a571257bd61d6a4e865dc062559"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="445e14effe022a571257bd61d6a4e865dc062559"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-1" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$uow = $dm-&gt;getUnitOfWork();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-2" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-445e14effe022a571257bd61d6a4e865dc062559-3" class="line-number-anchor" /><a href="#line-number-445e14effe022a571257bd61d6a4e865dc062559-3">3</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Directly manipulating a UnitOfWork is not recommended.
When working directly with the UnitOfWork API, respect methods
marked as INTERNAL by not using them and carefully read the API
documentation.</p>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="persisting-documents" name="persisting-documents"></a><h2 class="section-header"><a href="#persisting-documents">Persisting documents<i class="fas fa-link"></i></a></h2>
<p>A document can be made persistent by passing it to the
<code>DocumentManager#persist($document)</code> method. By applying the
persist operation on some document, that document becomes MANAGED,
which means that its persistence is from now on managed by an
DocumentManager. As a result the persistent state of such a
document will subsequently be properly synchronized with the
database when <code>DocumentManager#flush()</code> is invoked.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Invoking the <code>persist</code> method on a document does NOT
cause an immediate insert to be issued on the database. Doctrine
applies a strategy called transactional write-behind, which means
that it will delay most operations until
<code>DocumentManager#flush()</code> is invoked which will then issue all
necessary queries to synchronize your objects with the database in
the most efficient way.</p>
</td></tr></table></div>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a2095c404ddd4c034ee8910c78bf8bc08d1af17e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a2095c404ddd4c034ee8910c78bf8bc08d1af17e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-1" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$user = <span class="hljs-keyword">new</span> User();
$user-&gt;setUsername(<span class="hljs-string">'jwage'</span>);
$user-&gt;setPassword(<span class="hljs-string">'changeme'</span>);
$dm-&gt;persist($user);
$dm-&gt;flush();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-2" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-3" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-4" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-5" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-6" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-7" class="line-number-anchor" /><a href="#line-number-a2095c404ddd4c034ee8910c78bf8bc08d1af17e-7">7</a></td></tr></table></div></code></pre>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>The document identifier is generated during <code>persist</code> if not previously
specified. Users cannot rely on a document identifier being available during
the <code>prePersist</code> event.</p>
</td></tr></table></div>
<p>The semantics of the persist operation, applied on a document X,
are as follows:</p>
<ul><li class="dash">   If X is a new document, it becomes managed. The document X will be
   entered into the database as a result of the flush operation.</li>
<li class="dash">   If X is a preexisting managed document, it is ignored by the
   persist operation. However, the persist operation is cascaded to
   documents referenced by X, if the relationships from X to these
   other documents are mapped with cascade=PERSIST or cascade=ALL.</li>
<li class="dash"> If X is a removed document, it becomes managed.</li>
<li class="dash"> If X is a detached document, the behavior is undefined.</li>
</ul>

<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Do not pass detached documents to the persist operation.</p>
</td></tr></table></div>
<a id="flush_options"></a>
</div>
<div class="section"><a class="section-anchor" id="flush-options" name="flush-options"></a><h2 class="section-header"><a href="#flush-options">Flush Options<i class="fas fa-link"></i></a></h2>
<p>When committing your documents you can specify an array of options to the
<code>flush</code> method. With it you can send options to the underlying database
like <code>safe</code>, <code>fsync</code>, etc.</p>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="81680c5dfa7b24303390655a7055f569e4bfef79"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="81680c5dfa7b24303390655a7055f569e4bfef79"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-1" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;find($userId);
<span class="hljs-comment">// ...</span>
$user-&gt;setPassword(<span class="hljs-string">'changeme'</span>);
$dm-&gt;flush(<span class="hljs-keyword">null</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">'safe'</span> =&gt; <span class="hljs-keyword">true</span>, <span class="hljs-string">'fsync'</span> =&gt; <span class="hljs-keyword">true</span>));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-2" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-3" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-4" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-5" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81680c5dfa7b24303390655a7055f569e4bfef79-6" class="line-number-anchor" /><a href="#line-number-81680c5dfa7b24303390655a7055f569e4bfef79-6">6</a></td></tr></table></div></code></pre>
<p>You can configure the default flush options on your <code>Configuration</code> object
if you want to set them globally for all flushes.</p>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="24841d1d1760a24af0b956ddd6994fcdd552927a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="24841d1d1760a24af0b956ddd6994fcdd552927a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-1" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$config-&gt;setDefaultCommitOptions(<span class="hljs-keyword">array</span>(
    <span class="hljs-string">'safe'</span> =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'fsync'</span> =&gt; <span class="hljs-keyword">true</span>
));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-2" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-3" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-4" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-5" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-6" class="line-number-anchor" /><a href="#line-number-24841d1d1760a24af0b956ddd6994fcdd552927a-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Safe is set to true by default for all writes when using the ODM.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="removing-documents" name="removing-documents"></a><h2 class="section-header"><a href="#removing-documents">Removing documents<i class="fas fa-link"></i></a></h2>
<p>A document can be removed from persistent storage by passing it to
the <code>DocumentManager#remove($document)</code> method. By applying the
<code>remove</code> operation on some document, that document becomes
REMOVED, which means that its persistent state will be deleted once
<code>DocumentManager#flush()</code> is invoked. The in-memory state of a
document is unaffected by the <code>remove</code> operation.</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Just like <code>persist</code>, invoking <code>remove</code> on a
document does NOT cause an immediate query to be issued on the
database. The document will be removed on the next invocation of
<code>DocumentManager#flush()</code> that involves that document.</p>
</td></tr></table></div>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="0b3659c87a57d98d6eb101657eb2f8e0a12ede9e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="0b3659c87a57d98d6eb101657eb2f8e0a12ede9e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-1" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;remove($user);
$dm-&gt;flush();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-2" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-3" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-4" class="line-number-anchor" /><a href="#line-number-0b3659c87a57d98d6eb101657eb2f8e0a12ede9e-4">4</a></td></tr></table></div></code></pre>
<p>The semantics of the remove operation, applied to a document X are
as follows:</p>
<ul><li class="dash">   If X is a new document, it is ignored by the remove operation.
   However, the remove operation is cascaded to documents referenced
   by X, if the relationship from X to these other documents is mapped
   with cascade=REMOVE or cascade=ALL.</li>
<li class="dash">   If X is a managed document, the remove operation causes it to
   become removed. The remove operation is cascaded to documents
   referenced by X, if the relationships from X to these other
   documents is mapped with cascade=REMOVE or cascade=ALL.</li>
<li class="dash">   If X is a detached document, an InvalidArgumentException will be
   thrown.</li>
<li class="dash">   If X is a removed document, it is ignored by the remove operation.</li>
<li class="dash">   A removed document X will be removed from the database as a result
   of the flush operation.</li>
</ul>

</div>
<div class="section"><a class="section-anchor" id="detaching-documents" name="detaching-documents"></a><h2 class="section-header"><a href="#detaching-documents">Detaching documents<i class="fas fa-link"></i></a></h2>
<p>A document is detached from a DocumentManager and thus no longer
managed by invoking the <code>DocumentManager#detach($document)</code>
method on it or by cascading the detach operation to it. Changes
made to the detached document, if any (including removal of the
document), will not be synchronized to the database after the
document has been detached.</p>
<p>Doctrine will not hold on to any references to a detached
document.</p>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-1" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;detach($document);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-2" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-3" class="line-number-anchor" /><a href="#line-number-e8855cae5f8f2597cf1b9a28ce6e9a9922fc01e0-3">3</a></td></tr></table></div></code></pre>
<p>The semantics of the detach operation, applied to a document X are
as follows:</p>
<ul><li class="dash">   If X is a managed document, the detach operation causes it to
   become detached. The detach operation is cascaded to documents
   referenced by X, if the relationships from X to these other
   documents is mapped with cascade=DETACH or cascade=ALL. Documents
   which previously referenced X will continue to reference X.</li>
<li class="dash">   If X is a new or detached document, it is ignored by the detach
   operation.</li>
<li class="dash">   If X is a removed document, the detach operation is cascaded to
   documents referenced by X, if the relationships from X to these
   other documents is mapped with cascade=DETACH or
   cascade=ALL/Documents which previously referenced X will continue
   to reference X.</li>
</ul>

<p>There are several situations in which a document is detached
automatically without invoking the <code>detach</code> method:</p>
<ul><li class="dash">   When <code>DocumentManager#clear()</code> is invoked, all documents that are
   currently managed by the DocumentManager instance become detached.</li>
<li class="dash">   When serializing a document. The document retrieved upon subsequent
   unserialization will be detached (This is the case for all
   documents that are serialized and stored in some cache).</li>
</ul>

<p>The <code>detach</code> operation is usually not as frequently needed and
used as <code>persist</code> and <code>remove</code>.</p>
</div>
<div class="section"><a class="section-anchor" id="merging-documents" name="merging-documents"></a><h2 class="section-header"><a href="#merging-documents">Merging documents<i class="fas fa-link"></i></a></h2>
<p>Merging documents refers to the merging of (usually detached)
documents into the context of a DocumentManager so that they
become managed again. To merge the state of a document into an
DocumentManager use the <code>DocumentManager#merge($document)</code>
method. The state of the passed document will be merged into a
managed copy of this document and this copy will subsequently be
returned.</p>
<p>Example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="00951a8cc54ad7a016deccc09f85dec68b8805b8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="00951a8cc54ad7a016deccc09f85dec68b8805b8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-1" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-meta">&lt;?php</span>

$detachedDocument = unserialize($serializedDocument); <span class="hljs-comment">// some detached document</span>
$document = $dm-&gt;merge($detachedDocument);
<span class="hljs-comment">// $document now refers to the fully managed copy returned by the merge operation.</span>
<span class="hljs-comment">// The DocumentManager $dm now manages the persistence of $document as usual.</span>

The semantics of the merge operation, applied to a document X, are
<span class="hljs-keyword">as</span> follows:</td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-2" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-3" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-4" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-5" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-6" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-7" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-8" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-9" class="line-number-anchor" /><a href="#line-number-00951a8cc54ad7a016deccc09f85dec68b8805b8-9">9</a></td></tr></table></div></code></pre>
<ul><li class="dash">   If X is a detached document, the state of X is copied onto a
   pre-existing managed document instance X' of the same iddocument or
   a new managed copy X' of X is created.</li>
<li class="dash">   If X is a new document instance, an InvalidArgumentException will
   be thrown.</li>
<li class="dash">   If X is a removed document instance, an InvalidArgumentException
   will be thrown.</li>
<li class="dash">   If X is a managed document, it is ignored by the merge operation,
   however, the merge operation is cascaded to documents referenced by
   relationships from X if these relationships have been mapped with
   the cascade element value MERGE or ALL.</li>
<li class="dash">   For all documents Y referenced by relationships from X having the
   cascade element value MERGE or ALL, Y is merged recursively as Y'.
   For all such Y referenced by X, X' is set to reference Y'. (Note
   that if X is managed then X is the same object as X'.)</li>
<li class="dash">   If X is a document merged to X', with a reference to another
   document Y, where cascade=MERGE or cascade=ALL is not specified,
   then navigation of the same association from X' yields a reference
   to a managed object Y' with the same persistent iddocument as Y.</li>
</ul>

<p>The <code>merge</code> operation is usually not as frequently needed and
used as <code>persist</code> and <code>remove</code>. The most common scenario for
the <code>merge</code> operation is to reattach documents to an
DocumentManager that come from some cache (and are therefore
detached) and you want to modify and persist such a document.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>If you load some detached documents from a cache and you
do not need to persist or delete them or otherwise make use of them
without the need for persistence services there is no need to use
<code>merge</code>. I.e. you can simply pass detached objects from a cache
directly to the view.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="references" name="references"></a><h2 class="section-header"><a href="#references">References<i class="fas fa-link"></i></a></h2>
<p>References between documents and embedded documents are represented
just like in regular object-oriented PHP, with references to other
objects or collections of objects.</p>
</div>
<div class="section"><a class="section-anchor" id="establishing-references" name="establishing-references"></a><h2 class="section-header"><a href="#establishing-references">Establishing References<i class="fas fa-link"></i></a></h2>
<p>Establishing a reference to another document is straight forward:</p>
<p>Here is an example where we add a new comment to an article:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="62afebf20e4be23565228ab8aaa187d2afc91860"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="62afebf20e4be23565228ab8aaa187d2afc91860"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-1" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$comment = <span class="hljs-keyword">new</span> Comment();
<span class="hljs-comment">// ...</span>

$article-&gt;getComments()-&gt;add($comment);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-2" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-3" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-4" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-5" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-62afebf20e4be23565228ab8aaa187d2afc91860-6" class="line-number-anchor" /><a href="#line-number-62afebf20e4be23565228ab8aaa187d2afc91860-6">6</a></td></tr></table></div></code></pre>
<p>Or you can set a single reference:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="db86d55d7bbeb273582b8d184b60d04d7bbceae2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="db86d55d7bbeb273582b8d184b60d04d7bbceae2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-1" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$address = <span class="hljs-keyword">new</span> Address();
<span class="hljs-comment">// ...</span>

$user-&gt;setAddress($address);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-2" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-3" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-4" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-5" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-6" class="line-number-anchor" /><a href="#line-number-db86d55d7bbeb273582b8d184b60d04d7bbceae2-6">6</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="removing-references" name="removing-references"></a><h2 class="section-header"><a href="#removing-references">Removing References<i class="fas fa-link"></i></a></h2>
<p>Removing an association between two documents is similarly
straight-forward. There are two strategies to do so, by key and by
element. Here are some examples:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9ca3d5ad3b862285d3365a3768ec7e2031d1382a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9ca3d5ad3b862285d3365a3768ec7e2031d1382a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-1" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$article-&gt;getComments()-&gt;removeElement($comment);
$article-&gt;getComments()-&gt;remove($ithComment);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-2" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-3" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-4" class="line-number-anchor" /><a href="#line-number-9ca3d5ad3b862285d3365a3768ec7e2031d1382a-4">4</a></td></tr></table></div></code></pre>
<p>Or you can remove a single reference:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7108609d2f8c8f71f3b1769d7977624894b7f27f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7108609d2f8c8f71f3b1769d7977624894b7f27f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-1" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user-&gt;setAddress(<span class="hljs-keyword">null</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-2" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-3" class="line-number-anchor" /><a href="#line-number-7108609d2f8c8f71f3b1769d7977624894b7f27f-3">3</a></td></tr></table></div></code></pre>
<p>When working with collections, keep in mind that a Collection is
essentially an ordered map (just like a PHP array). That is why the
<code>remove</code> operation accepts an index/key. <code>removeElement</code> is a
separate method that has O(n) complexity, where n is the size of
the map.</p>
</div>
<div class="section"><a class="section-anchor" id="transitive-persistence" name="transitive-persistence"></a><h2 class="section-header"><a href="#transitive-persistence">Transitive persistence<i class="fas fa-link"></i></a></h2>
<p>Persisting, removing, detaching and merging individual documents
can become pretty cumbersome, especially when a larger object graph
with collections is involved. Therefore Doctrine provides a
mechanism for transitive persistence through cascading of these
operations. Each reference to another document or a collection of
documents can be configured to automatically cascade certain
operations. By default, no operations are cascaded.</p>
<p>The following cascade options exist:</p>
<ul><li class="dash">   persist : Cascades persist operations to the associated documents.</li>
<li class="dash"> remove : Cascades remove operations to the associated documents.</li>
<li class="dash"> merge : Cascades merge operations to the associated documents.</li>
<li class="dash"> detach : Cascades detach operations to the associated documents.</li>
<li class="dash">   all : Cascades persist, remove, merge and detach operations to
   associated documents.</li>
</ul>

<p>The following example shows an association to a number of
addresses. If persist() or remove() is invoked on any User
document, it will be cascaded to all associated Address documents
in the $addresses collection.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8fa8863e2b120cc26af6564af9aa178632a29107"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8fa8863e2b120cc26af6564af9aa178632a29107"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-1" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-1">1</a></td><td class="code-line" rowspan="11"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> 
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ReferenceMany</span>(targetDocument="Address", cascade={"persist", "remove"})
     */</span>
    <span class="hljs-keyword">private</span> $addresses;
    <span class="hljs-comment">//...</span>
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-2" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-3" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-4" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-5" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-6" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-7" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-8" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-9" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-10" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8fa8863e2b120cc26af6564af9aa178632a29107-11" class="line-number-anchor" /><a href="#line-number-8fa8863e2b120cc26af6564af9aa178632a29107-11">11</a></td></tr></table></div></code></pre>
<p>Even though automatic cascading is convenient it should be used
with care. Do not blindly apply cascade=all to all associations as
it will unnecessarily degrade the performance of your application.</p>
</div>
<div class="section"><a class="section-anchor" id="querying" name="querying"></a><h2 class="section-header"><a href="#querying">Querying<i class="fas fa-link"></i></a></h2>
<p>Doctrine provides the following ways, in increasing level of power
and flexibility, to query for persistent objects. You should always
start with the simplest one that suits your needs.</p>
<div class="section"><a class="section-anchor" id="by-primary-key" name="by-primary-key"></a><h3 class="section-header"><a href="#by-primary-key">By Primary Key<i class="fas fa-link"></i></a></h3>
<p>The most basic way to query for a persistent object is by its
identifier / primary key using the
<code>DocumentManager#find($documentName, $id)</code> method. Here is an
example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5e53a14901c39d7044f80ad9ebb901b4ca98ac28"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5e53a14901c39d7044f80ad9ebb901b4ca98ac28"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-1" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;find(<span class="hljs-string">'User'</span>, $id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-2" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-3" class="line-number-anchor" /><a href="#line-number-5e53a14901c39d7044f80ad9ebb901b4ca98ac28-3">3</a></td></tr></table></div></code></pre>
<p>The return value is either the found document instance or null if
no instance could be found with the given identifier.</p>
<p>Essentially, <code>DocumentManager#find()</code> is just a shortcut for the
following:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="108dbc3b6599dec9edd7b1451c8a767dc046a4fd"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="108dbc3b6599dec9edd7b1451c8a767dc046a4fd"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-1" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;find($id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-2" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-3" class="line-number-anchor" /><a href="#line-number-108dbc3b6599dec9edd7b1451c8a767dc046a4fd-3">3</a></td></tr></table></div></code></pre>
<p><code>DocumentManager#getRepository($documentName)</code> returns a
repository object which provides many ways to retrieve documents of
the specified type. By default, the repository instance is of type
<code>Doctrine\ODM\MongoDB\DocumentRepository</code>. You can also use
custom repository classes.</p>
</div>
<div class="section"><a class="section-anchor" id="by-simple-conditions" name="by-simple-conditions"></a><h3 class="section-header"><a href="#by-simple-conditions">By Simple Conditions<i class="fas fa-link"></i></a></h3>
<p>To query for one or more documents based on several conditions that
form a logical conjunction, use the <code>findBy</code> and <code>findOneBy</code>
methods on a repository as follows:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5613c027a5e95ae3438dc7911e776e50f1e2871e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5613c027a5e95ae3438dc7911e776e50f1e2871e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-1" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-1">1</a></td><td class="code-line" rowspan="10"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// All users that are 20 years old</span>
$users = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'age'</span> =&gt; <span class="hljs-number">20</span>));

<span class="hljs-comment">// All users that are 20 years old and have a surname of 'Miller'</span>
$users = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'age'</span> =&gt; <span class="hljs-number">20</span>, <span class="hljs-string">'surname'</span> =&gt; <span class="hljs-string">'Miller'</span>));

<span class="hljs-comment">// A single user by its nickname</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'nickname'</span> =&gt; <span class="hljs-string">'romanb'</span>));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-2" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-3" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-4" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-5" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-6" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-7" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-8" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-9" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-10" class="line-number-anchor" /><a href="#line-number-5613c027a5e95ae3438dc7911e776e50f1e2871e-10">10</a></td></tr></table></div></code></pre>
<p>A DocumentRepository also provides a mechanism for more concise
calls through its use of <code>__call</code>. Thus, the following two
examples are equivalent:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="328adaffb5e2c4ab95e6b3990026a0f5f465ec8f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="328adaffb5e2c4ab95e6b3990026a0f5f465ec8f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-1" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// A single user by its nickname</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneBy(<span class="hljs-keyword">array</span>(<span class="hljs-string">'nickname'</span> =&gt; <span class="hljs-string">'romanb'</span>));

<span class="hljs-comment">// A single user by its nickname (__call magic)</span>
$user = $dm-&gt;getRepository(<span class="hljs-string">'User'</span>)-&gt;findOneByNickname(<span class="hljs-string">'romanb'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-2" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-3" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-4" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-5" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-6" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-7" class="line-number-anchor" /><a href="#line-number-328adaffb5e2c4ab95e6b3990026a0f5f465ec8f-7">7</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>You can learn more about Repositories in a <a href="document-repositories.html#document_repositories">dedicated chapter</a>.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="by-lazy-loading" name="by-lazy-loading"></a><h3 class="section-header"><a href="#by-lazy-loading">By Lazy Loading<i class="fas fa-link"></i></a></h3>
<p>Whenever you have a managed document instance at hand, you can
traverse and use any associations of that document as if they were
in-memory already. Doctrine will automatically load the associated
objects on demand through the concept of lazy-loading.</p>
</div>
<div class="section"><a class="section-anchor" id="by-query-builder-objects" name="by-query-builder-objects"></a><h3 class="section-header"><a href="#by-query-builder-objects">By Query Builder Objects<i class="fas fa-link"></i></a></h3>
<p>The most powerful and flexible method to query for persistent
objects is the Query\Builder object. The Query\Builder object enables you to query
for persistent objects with a fluent object oriented interface.</p>
<p>You can create a query using
<code>DocumentManager#createQueryBuilder($documentName = null)</code>. Here is a
simple example:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7df2a0bf98763fe076bf433420426ee2045d381a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7df2a0bf98763fe076bf433420426ee2045d381a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-1" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// All users with an age between 20 and 30 (inclusive).</span>
$qb = $dm-&gt;createQueryBuilder(<span class="hljs-string">'User'</span>)
    -&gt;field(<span class="hljs-string">'age'</span>)-&gt;range(<span class="hljs-number">20</span>, <span class="hljs-number">30</span>);
$q = $qb-&gt;getQuery()
$users = $q-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-2" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-3" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-4" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-5" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-6" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7df2a0bf98763fe076bf433420426ee2045d381a-7" class="line-number-anchor" /><a href="#line-number-7df2a0bf98763fe076bf433420426ee2045d381a-7">7</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="by-reference" name="by-reference"></a><h3 class="section-header"><a href="#by-reference">By Reference<i class="fas fa-link"></i></a></h3>
<p>To query documents with a ReferenceOne association to another document, use the <code>references($document)</code> expression:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="df3a18f88eb96de0ab6349e8bb9272e57054f019"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="df3a18f88eb96de0ab6349e8bb9272e57054f019"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-1" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$group = $dm-&gt;find(<span class="hljs-string">'Group'</span>, $id);
$usersWithGroup = $dm-&gt;createQueryBuilder(<span class="hljs-string">'User'</span>)
    -&gt;field(<span class="hljs-string">'group'</span>)-&gt;references($group)
    -&gt;getQuery()-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-2" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-3" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-4" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-5" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-6" class="line-number-anchor" /><a href="#line-number-df3a18f88eb96de0ab6349e8bb9272e57054f019-6">6</a></td></tr></table></div></code></pre>
<p>To find documents with a ReferenceMany association that includes a certain document, use the <code>includesReferenceTo($document)</code> expression:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="54cae0efb98f3aa522e131be0b69635784ed2ea9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="54cae0efb98f3aa522e131be0b69635784ed2ea9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-1" class="line-number-anchor" /><a href="#line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

$users = $dm-&gt;createQueryBuilder(<span class="hljs-string">'User'</span>)
    -&gt;field(<span class="hljs-string">'groups'</span>)-&gt;includesReferenceTo($group)
    -&gt;getQuery()-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-2" class="line-number-anchor" /><a href="#line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-3" class="line-number-anchor" /><a href="#line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-4" class="line-number-anchor" /><a href="#line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-5" class="line-number-anchor" /><a href="#line-number-54cae0efb98f3aa522e131be0b69635784ed2ea9-5">5</a></td></tr></table></div></code></pre>

</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?161e55"
                            integrity="sha384-ZQ6qlvTBtfiU76YxxALyPv3/HvMipQbIgpk6risK+vIGd/IMwfA2/e+ztgwPiLOj"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'mongodb-odm';
            var versionSlug = '1.2';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search MongoDB ODM 1.2'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
