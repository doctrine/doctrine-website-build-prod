<!DOCTYPE html>
<html>
    <head>
        <title>Query Builder API - Doctrine MongoDB Object Document Mapper (MongoDB ODM)</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine MongoDB Object Document Mapper Documentation: Query Builder API ">

        <meta name="keywords" content="php,mongodb,odm,data,mapper,mapping,object,documentation,query,builder,api">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.3/reference/query-builder-api.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?872f7e"
                        integrity="sha384-bZsEB71Y4iNSgVBqRpdfrMlt47Yelru109ZBtBWZTOqrVUwMj1ilWncB/TvsLRw5"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.1/reference/query-builder-api.html" />
        <meta property="og:title" content="Query Builder API - Doctrine MongoDB Object Document Mapper (MongoDB ODM)" />
        <meta property="og:description" content="Doctrine MongoDB Object Document Mapper Documentation: Query Builder API " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine MongoDB Object Document Mapper",
            "description": "Query Builder API",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar stop-war-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                 <a href="/stop-war.html">ðŸ‡ºðŸ‡¦ UKRAINE NEEDS YOUR HELP NOW!</a>
            </nav>

            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/mongodb-odm/edit/2.1.x/docs/en/reference/query-builder-api.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc-section"><h2 class="toc-header">Tutorials</h2>
<div class="toc"><ul><li id="tutorials-getting-started-html-getting-started" class="toc-item"><a href="../tutorials/getting-started.html#getting-started">Getting Started</a><ul><li id="tutorials-getting-started-html-example-model-simple-blog" class="toc-item"><a href="../tutorials/getting-started.html#example-model-simple-blog">Example Model: Simple Blog</a></li><li id="tutorials-getting-started-html-a-first-prototype" class="toc-item"><a href="../tutorials/getting-started.html#a-first-prototype">A first prototype</a></li><li id="tutorials-getting-started-html-persistent-models" class="toc-item"><a href="../tutorials/getting-started.html#persistent-models">Persistent Models</a></li><li id="tutorials-getting-started-html-usage" class="toc-item"><a href="../tutorials/getting-started.html#usage">Usage</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Reference</h2>
<div class="toc"><ul><li id="introduction-html-introduction" class="toc-item"><a href="introduction.html#introduction">Introduction</a><ul><li id="introduction-html-features-overview" class="toc-item"><a href="introduction.html#features-overview">Features Overview</a></li><li id="introduction-html-setup" class="toc-item"><a href="introduction.html#setup">Setup</a></li><li id="introduction-html-providing-a-custom-client" class="toc-item"><a href="introduction.html#providing-a-custom-client">Providing a custom client</a></li></ul></li><li id="architecture-html-architecture" class="toc-item"><a href="architecture.html#architecture">Architecture</a><ul><li id="architecture-html-documents" class="toc-item"><a href="architecture.html#documents">Documents</a><ul><li id="architecture-html-document-states" class="toc-item"><a href="architecture.html#document-states">Document states</a></li><li id="architecture-html-persistent-fields" class="toc-item"><a href="architecture.html#persistent-fields">Persistent fields</a></li><li id="architecture-html-serializing-documents" class="toc-item"><a href="architecture.html#serializing-documents">Serializing documents</a></li></ul></li><li id="architecture-html-the-documentmanager" class="toc-item"><a href="architecture.html#the-documentmanager">The DocumentManager</a><ul><li id="architecture-html-transactional-write-behind" class="toc-item"><a href="architecture.html#transactional-write-behind">Transactional write-behind</a></li><li id="architecture-html-the-unit-of-work" class="toc-item"><a href="architecture.html#the-unit-of-work">The Unit of Work</a></li></ul></li></ul></li><li id="console-commands-html-console-commands" class="toc-item"><a href="console-commands.html#console-commands">Console Commands</a></li><li id="basic-mapping-html-basic-mapping" class="toc-item"><a href="basic-mapping.html#basic-mapping">Basic Mapping</a><ul><li id="basic-mapping-html-mapping-drivers" class="toc-item"><a href="basic-mapping.html#mapping-drivers">Mapping Drivers</a></li><li id="basic-mapping-html-introduction-to-docblock-annotations" class="toc-item"><a href="basic-mapping.html#introduction-to-docblock-annotations">Introduction to Docblock Annotations</a></li><li id="basic-mapping-html-persistent-classes" class="toc-item"><a href="basic-mapping.html#persistent-classes">Persistent classes</a></li><li id="basic-mapping-html-doctrine-mapping-types" class="toc-item"><a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a></li><li id="basic-mapping-html-property-mapping" class="toc-item"><a href="basic-mapping.html#property-mapping">Property Mapping</a><ul><li id="basic-mapping-html-identifiers" class="toc-item"><a href="basic-mapping.html#identifiers">Identifiers</a></li><li id="basic-mapping-html-fields" class="toc-item"><a href="basic-mapping.html#fields">Fields</a></li></ul></li><li id="basic-mapping-html-multiple-document-types-in-a-collection" class="toc-item"><a href="basic-mapping.html#multiple-document-types-in-a-collection">Multiple Document Types in a Collection</a></li></ul></li><li id="custom-mapping-types-html-custom-mapping-types" class="toc-item"><a href="custom-mapping-types.html#custom-mapping-types">Custom Mapping Types</a></li><li id="reference-mapping-html-reference-mapping" class="toc-item"><a href="reference-mapping.html#reference-mapping">Reference Mapping</a><ul><li id="reference-mapping-html-collections" class="toc-item"><a href="reference-mapping.html#collections">Collections</a></li><li id="reference-mapping-html-reference-one" class="toc-item"><a href="reference-mapping.html#reference-one">Reference One</a></li><li id="reference-mapping-html-reference-many" class="toc-item"><a href="reference-mapping.html#reference-many">Reference Many</a></li><li id="reference-mapping-html-mixing-document-types" class="toc-item"><a href="reference-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="reference-mapping-html-storing-references" class="toc-item"><a href="reference-mapping.html#storing-references">Storing References</a></li><li id="reference-mapping-html-cascading-operations" class="toc-item"><a href="reference-mapping.html#cascading-operations">Cascading Operations</a></li><li id="reference-mapping-html-orphan-removal" class="toc-item"><a href="reference-mapping.html#orphan-removal">Orphan Removal</a></li></ul></li><li id="bidirectional-references-html-bi-directional-references" class="toc-item"><a href="bidirectional-references.html#bi-directional-references">Bi-Directional References</a><ul><li id="bidirectional-references-html-owning-and-inverse-sides" class="toc-item"><a href="bidirectional-references.html#owning-and-inverse-sides">Owning and Inverse Sides</a><ul><li id="bidirectional-references-html-one-to-many" class="toc-item"><a href="bidirectional-references.html#one-to-many">One to Many</a></li></ul></li><li id="bidirectional-references-html-other-examples" class="toc-item"><a href="bidirectional-references.html#other-examples">Other Examples</a><ul><li id="bidirectional-references-html-one-to-one" class="toc-item"><a href="bidirectional-references.html#one-to-one">One to One</a></li><li id="bidirectional-references-html-self-referencing-many-to-many" class="toc-item"><a href="bidirectional-references.html#self-referencing-many-to-many">Self-Referencing Many to Many</a></li></ul></li></ul></li><li id="complex-references-html-complex-references" class="toc-item"><a href="complex-references.html#complex-references">Complex References</a><ul><li id="complex-references-html-basic-example" class="toc-item"><a href="complex-references.html#basic-example">Basic Example</a></li><li id="complex-references-html-9cf5832be15789fbeb1550a7fd99dfe65411d51e-example" class="toc-item"><a href="complex-references.html#9cf5832be15789fbeb1550a7fd99dfe65411d51e-example">9cf5832be15789fbeb1550a7fd99dfe65411d51e Example</a></li><li id="complex-references-html-8f576dd049fa68b977c973d9c4c46ae2ce75a7b5-example" class="toc-item"><a href="complex-references.html#8f576dd049fa68b977c973d9c4c46ae2ce75a7b5-example">8f576dd049fa68b977c973d9c4c46ae2ce75a7b5 Example</a></li></ul></li><li id="indexes-html-indexes" class="toc-item"><a href="indexes.html#indexes">Indexes</a><ul><li id="indexes-html-index-options" class="toc-item"><a href="indexes.html#index-options">Index Options</a></li><li id="indexes-html-unique-index" class="toc-item"><a href="indexes.html#unique-index">Unique Index</a></li><li id="indexes-html-embedded-indexes" class="toc-item"><a href="indexes.html#embedded-indexes">Embedded Indexes</a></li><li id="indexes-html-geospatial-indexing" class="toc-item"><a href="indexes.html#geospatial-indexing">Geospatial Indexing</a></li><li id="indexes-html-partial-indexes" class="toc-item"><a href="indexes.html#partial-indexes">Partial indexes</a></li></ul></li><li id="inheritance-mapping-html-inheritance-mapping" class="toc-item"><a href="inheritance-mapping.html#inheritance-mapping">Inheritance Mapping</a><ul><li id="inheritance-mapping-html-mapped-superclasses" class="toc-item"><a href="inheritance-mapping.html#mapped-superclasses">Mapped Superclasses</a></li><li id="inheritance-mapping-html-single-collection-inheritance" class="toc-item"><a href="inheritance-mapping.html#single-collection-inheritance">Single Collection Inheritance</a></li><li id="inheritance-mapping-html-collection-per-class-inheritance" class="toc-item"><a href="inheritance-mapping.html#collection-per-class-inheritance">Collection Per Class Inheritance</a></li></ul></li><li id="embedded-mapping-html-embedded-mapping" class="toc-item"><a href="embedded-mapping.html#embedded-mapping">Embedded Mapping</a><ul><li id="embedded-mapping-html-embed-one" class="toc-item"><a href="embedded-mapping.html#embed-one">Embed One</a></li><li id="embedded-mapping-html-embed-many" class="toc-item"><a href="embedded-mapping.html#embed-many">Embed Many</a></li><li id="embedded-mapping-html-mixing-document-types" class="toc-item"><a href="embedded-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="embedded-mapping-html-cascading-operations" class="toc-item"><a href="embedded-mapping.html#cascading-operations">Cascading Operations</a></li></ul></li><li id="trees-html-trees" class="toc-item"><a href="trees.html#trees">Trees</a><ul><li id="trees-html-full-tree-in-single-document" class="toc-item"><a href="trees.html#full-tree-in-single-document">Full Tree in Single Document</a></li><li id="trees-html-parent-reference" class="toc-item"><a href="trees.html#parent-reference">Parent Reference</a></li><li id="trees-html-child-reference" class="toc-item"><a href="trees.html#child-reference">Child Reference</a></li><li id="trees-html-array-of-ancestors" class="toc-item"><a href="trees.html#array-of-ancestors">Array of Ancestors</a></li><li id="trees-html-materialized-paths" class="toc-item"><a href="trees.html#materialized-paths">Materialized Paths</a></li></ul></li><li id="storing-files-with-gridfs-html-storing-files-with-gridfs" class="toc-item"><a href="storing-files-with-gridfs.html#storing-files-with-gridfs">Storing Files with GridFS</a><ul><li id="storing-files-with-gridfs-html-about-gridfs" class="toc-item"><a href="storing-files-with-gridfs.html#about-gridfs">About GridFS</a></li><li id="storing-files-with-gridfs-html-mapping-documents-as-gridfs-files" class="toc-item"><a href="storing-files-with-gridfs.html#mapping-documents-as-gridfs-files">Mapping documents as GridFS files</a></li><li id="storing-files-with-gridfs-html-inserting-files-into-gridfs-buckets" class="toc-item"><a href="storing-files-with-gridfs.html#inserting-files-into-gridfs-buckets">Inserting files into GridFS buckets</a></li><li id="storing-files-with-gridfs-html-reading-files-from-gridfs-buckets" class="toc-item"><a href="storing-files-with-gridfs.html#reading-files-from-gridfs-buckets">Reading files from GridFS buckets</a></li></ul></li><li id="xml-mapping-html-xml-mapping" class="toc-item"><a href="xml-mapping.html#xml-mapping">XML Mapping</a><ul><li id="xml-mapping-html-simplified-xml-driver" class="toc-item"><a href="xml-mapping.html#simplified-xml-driver">Simplified XML Driver</a><ul><li id="xml-mapping-html-example" class="toc-item"><a href="xml-mapping.html#example">Example</a></li><li id="xml-mapping-html-reference" class="toc-item"><a href="xml-mapping.html#reference">Reference</a></li></ul></li></ul></li><li id="annotations-reference-html-annotations-reference" class="toc-item"><a href="annotations-reference.html#annotations-reference">Annotations Reference</a><ul><li id="annotations-reference-html-alsoload" class="toc-item"><a href="annotations-reference.html#alsoload">@AlsoLoad</a></li><li id="annotations-reference-html-changetrackingpolicy" class="toc-item"><a href="annotations-reference.html#changetrackingpolicy">@ChangeTrackingPolicy</a></li><li id="annotations-reference-html-defaultdiscriminatorvalue" class="toc-item"><a href="annotations-reference.html#defaultdiscriminatorvalue">@DefaultDiscriminatorValue</a></li><li id="annotations-reference-html-discriminatorfield" class="toc-item"><a href="annotations-reference.html#discriminatorfield">@DiscriminatorField</a></li><li id="annotations-reference-html-discriminatormap" class="toc-item"><a href="annotations-reference.html#discriminatormap">@DiscriminatorMap</a></li><li id="annotations-reference-html-document" class="toc-item"><a href="annotations-reference.html#document">@Document</a></li><li id="annotations-reference-html-embedmany" class="toc-item"><a href="annotations-reference.html#embedmany">@EmbedMany</a></li><li id="annotations-reference-html-embedone" class="toc-item"><a href="annotations-reference.html#embedone">@EmbedOne</a></li><li id="annotations-reference-html-embeddeddocument" class="toc-item"><a href="annotations-reference.html#embeddeddocument">@EmbeddedDocument</a></li><li id="annotations-reference-html-field" class="toc-item"><a href="annotations-reference.html#field">@Field</a></li><li id="annotations-reference-html-file" class="toc-item"><a href="annotations-reference.html#file">@File</a></li><li id="annotations-reference-html-file-chunksize" class="toc-item"><a href="annotations-reference.html#file-chunksize">@File\ChunkSize</a></li><li id="annotations-reference-html-file-filename" class="toc-item"><a href="annotations-reference.html#file-filename">@File\Filename</a></li><li id="annotations-reference-html-file-length" class="toc-item"><a href="annotations-reference.html#file-length">@File\Length</a></li><li id="annotations-reference-html-file-metadata" class="toc-item"><a href="annotations-reference.html#file-metadata">@File\Metadata</a></li><li id="annotations-reference-html-file-uploaddate" class="toc-item"><a href="annotations-reference.html#file-uploaddate">@File\UploadDate</a></li><li id="annotations-reference-html-haslifecyclecallbacks" class="toc-item"><a href="annotations-reference.html#haslifecyclecallbacks">@HasLifecycleCallbacks</a></li><li id="annotations-reference-html-id" class="toc-item"><a href="annotations-reference.html#id">@Id</a></li><li id="annotations-reference-html-index" class="toc-item"><a href="annotations-reference.html#index">@Index</a></li><li id="annotations-reference-html-indexes" class="toc-item"><a href="annotations-reference.html#indexes">@Indexes</a></li><li id="annotations-reference-html-inheritancetype" class="toc-item"><a href="annotations-reference.html#inheritancetype">@InheritanceType</a></li><li id="annotations-reference-html-lock" class="toc-item"><a href="annotations-reference.html#lock">@Lock</a></li><li id="annotations-reference-html-mappedsuperclass" class="toc-item"><a href="annotations-reference.html#mappedsuperclass">@MappedSuperclass</a></li><li id="annotations-reference-html-postload" class="toc-item"><a href="annotations-reference.html#postload">@PostLoad</a></li><li id="annotations-reference-html-postpersist" class="toc-item"><a href="annotations-reference.html#postpersist">@PostPersist</a></li><li id="annotations-reference-html-postremove" class="toc-item"><a href="annotations-reference.html#postremove">@PostRemove</a></li><li id="annotations-reference-html-postupdate" class="toc-item"><a href="annotations-reference.html#postupdate">@PostUpdate</a></li><li id="annotations-reference-html-preflush" class="toc-item"><a href="annotations-reference.html#preflush">@PreFlush</a></li><li id="annotations-reference-html-preload" class="toc-item"><a href="annotations-reference.html#preload">@PreLoad</a></li><li id="annotations-reference-html-prepersist" class="toc-item"><a href="annotations-reference.html#prepersist">@PrePersist</a></li><li id="annotations-reference-html-preremove" class="toc-item"><a href="annotations-reference.html#preremove">@PreRemove</a></li><li id="annotations-reference-html-preupdate" class="toc-item"><a href="annotations-reference.html#preupdate">@PreUpdate</a></li><li id="annotations-reference-html-readpreference" class="toc-item"><a href="annotations-reference.html#readpreference">@ReadPreference</a></li><li id="annotations-reference-html-referencemany" class="toc-item"><a href="annotations-reference.html#referencemany">@ReferenceMany</a></li><li id="annotations-reference-html-referenceone" class="toc-item"><a href="annotations-reference.html#referenceone">@ReferenceOne</a></li><li id="annotations-reference-html-shardkey" class="toc-item"><a href="annotations-reference.html#shardkey">@ShardKey</a></li><li id="annotations-reference-html-uniqueindex" class="toc-item"><a href="annotations-reference.html#uniqueindex">@UniqueIndex</a></li><li id="annotations-reference-html-version" class="toc-item"><a href="annotations-reference.html#version">@Version</a></li><li id="annotations-reference-html-view" class="toc-item"><a href="annotations-reference.html#view">@View</a></li></ul></li><li id="metadata-drivers-html-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#metadata-drivers">Metadata Drivers</a><ul><li id="metadata-drivers-html-core-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#core-metadata-drivers">Core Metadata Drivers</a></li><li id="metadata-drivers-html-implementing-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#implementing-metadata-drivers">Implementing Metadata Drivers</a></li><li id="metadata-drivers-html-classmetadata" class="toc-item"><a href="metadata-drivers.html#classmetadata">ClassMetadata</a></li><li id="metadata-drivers-html-getting-classmetadata-instances" class="toc-item"><a href="metadata-drivers.html#getting-classmetadata-instances">Getting ClassMetadata Instances</a></li></ul></li><li id="working-with-objects-html-working-with-objects" class="toc-item"><a href="working-with-objects.html#working-with-objects">Working with Objects</a><ul><li id="working-with-objects-html-understanding" class="toc-item"><a href="working-with-objects.html#understanding">Understanding</a><ul><li id="working-with-objects-html-the-size-of-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a></li><li id="working-with-objects-html-the-cost-of-flush" class="toc-item"><a href="working-with-objects.html#the-cost-of-flush">The cost of flush()</a></li><li id="working-with-objects-html-direct-access-to-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a></li></ul></li><li id="working-with-objects-html-persisting-documents" class="toc-item"><a href="working-with-objects.html#persisting-documents">Persisting documents</a></li><li id="working-with-objects-html-flush-options" class="toc-item"><a href="working-with-objects.html#flush-options">Flush Options</a></li><li id="working-with-objects-html-removing-documents" class="toc-item"><a href="working-with-objects.html#removing-documents">Removing documents</a></li><li id="working-with-objects-html-detaching-documents" class="toc-item"><a href="working-with-objects.html#detaching-documents">Detaching documents</a></li><li id="working-with-objects-html-merging-documents" class="toc-item"><a href="working-with-objects.html#merging-documents">Merging documents</a></li><li id="working-with-objects-html-references" class="toc-item"><a href="working-with-objects.html#references">References</a></li><li id="working-with-objects-html-establishing-references" class="toc-item"><a href="working-with-objects.html#establishing-references">Establishing References</a></li><li id="working-with-objects-html-removing-references" class="toc-item"><a href="working-with-objects.html#removing-references">Removing References</a></li><li id="working-with-objects-html-transitive-persistence" class="toc-item"><a href="working-with-objects.html#transitive-persistence">Transitive persistence</a></li><li id="working-with-objects-html-querying" class="toc-item"><a href="working-with-objects.html#querying">Querying</a><ul><li id="working-with-objects-html-by-primary-key" class="toc-item"><a href="working-with-objects.html#by-primary-key">By Primary Key</a></li><li id="working-with-objects-html-by-simple-conditions" class="toc-item"><a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a></li><li id="working-with-objects-html-by-lazy-loading" class="toc-item"><a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a></li><li id="working-with-objects-html-by-query-builder-objects" class="toc-item"><a href="working-with-objects.html#by-query-builder-objects">By Query Builder Objects</a></li><li id="working-with-objects-html-by-reference" class="toc-item"><a href="working-with-objects.html#by-reference">By Reference</a></li></ul></li></ul></li><li id="document-repositories-html-document-repositories" class="toc-item"><a href="document-repositories.html#document-repositories">Document Repositories</a><ul><li id="document-repositories-html-custom-repositories" class="toc-item"><a href="document-repositories.html#custom-repositories">Custom Repositories</a></li><li id="document-repositories-html-repositories-with-additional-dependencies" class="toc-item"><a href="document-repositories.html#repositories-with-additional-dependencies">Repositories with Additional Dependencies</a></li></ul></li><li id="events-html-events" class="toc-item"><a href="events.html#events">Events</a><ul><li id="events-html-the-event-system" class="toc-item"><a href="events.html#the-event-system">The Event System</a></li><li id="events-html-lifecycle-events" class="toc-item"><a href="events.html#lifecycle-events">Lifecycle Events</a></li><li id="events-html-lifecycle-callbacks" class="toc-item"><a href="events.html#lifecycle-callbacks">Lifecycle Callbacks</a></li><li id="events-html-listening-to-lifecycle-events" class="toc-item"><a href="events.html#listening-to-lifecycle-events">Listening to Lifecycle Events</a></li><li id="events-html-implementing-event-listeners" class="toc-item"><a href="events.html#implementing-event-listeners">Implementing Event Listeners</a><ul><li id="events-html-prepersist" class="toc-item"><a href="events.html#prepersist">prePersist</a></li><li id="events-html-preload" class="toc-item"><a href="events.html#preload">preLoad</a></li><li id="events-html-postload" class="toc-item"><a href="events.html#postload">postLoad</a></li><li id="events-html-preremove" class="toc-item"><a href="events.html#preremove">preRemove</a></li><li id="events-html-preflush" class="toc-item"><a href="events.html#preflush">preFlush</a></li><li id="events-html-onflush" class="toc-item"><a href="events.html#onflush">onFlush</a></li><li id="events-html-postflush" class="toc-item"><a href="events.html#postflush">postFlush</a></li><li id="events-html-preupdate" class="toc-item"><a href="events.html#preupdate">preUpdate</a></li><li id="events-html-onclear" class="toc-item"><a href="events.html#onclear">onClear</a></li><li id="events-html-documentnotfound" class="toc-item"><a href="events.html#documentnotfound">documentNotFound</a></li><li id="events-html-postupdate-postremove-postpersist" class="toc-item"><a href="events.html#postupdate-postremove-postpersist">postUpdate, postRemove, postPersist</a></li><li id="events-html-postcollectionload" class="toc-item"><a href="events.html#postcollectionload">postCollectionLoad</a></li></ul></li><li id="events-html-load-classmetadata-event" class="toc-item"><a href="events.html#load-classmetadata-event">Load ClassMetadata Event</a></li></ul></li><li id="migrating-schemas-html-migrating-schemas" class="toc-item"><a href="migrating-schemas.html#migrating-schemas">Migrating Schemas</a><ul><li id="migrating-schemas-html-renaming-a-field" class="toc-item"><a href="migrating-schemas.html#renaming-a-field">Renaming a Field</a></li><li id="migrating-schemas-html-transforming-data" class="toc-item"><a href="migrating-schemas.html#transforming-data">Transforming Data</a></li><li id="migrating-schemas-html-moving-fields" class="toc-item"><a href="migrating-schemas.html#moving-fields">Moving Fields</a></li></ul></li><li id="query-builder-api-html-query-builder-api" class="toc-item"><a href="query-builder-api.html#query-builder-api">Query Builder API</a><ul><li id="query-builder-api-html-finding-documents" class="toc-item"><a href="query-builder-api.html#finding-documents">Finding Documents</a></li><li id="query-builder-api-html-creating-a-query-builder" class="toc-item"><a href="query-builder-api.html#creating-a-query-builder">Creating a Query Builder</a><ul><li id="query-builder-api-html-executing-queries" class="toc-item"><a href="query-builder-api.html#executing-queries">Executing Queries</a></li><li id="query-builder-api-html-debugging-queries" class="toc-item"><a href="query-builder-api.html#debugging-queries">Debugging Queries</a></li><li id="query-builder-api-html-getting-single-result" class="toc-item"><a href="query-builder-api.html#getting-single-result">Getting Single Result</a></li><li id="query-builder-api-html-selecting-fields" class="toc-item"><a href="query-builder-api.html#selecting-fields">Selecting Fields</a></li><li id="query-builder-api-html-index-hints" class="toc-item"><a href="query-builder-api.html#index-hints">Index hints</a></li><li id="query-builder-api-html-selecting-distinct-values" class="toc-item"><a href="query-builder-api.html#selecting-distinct-values">Selecting Distinct Values</a></li><li id="query-builder-api-html-refreshing-documents" class="toc-item"><a href="query-builder-api.html#refreshing-documents">Refreshing Documents</a></li><li id="query-builder-api-html-fetching-documents-as-read-only" class="toc-item"><a href="query-builder-api.html#fetching-documents-as-read-only">Fetching Documents as Read-Only</a></li><li id="query-builder-api-html-disabling-hydration" class="toc-item"><a href="query-builder-api.html#disabling-hydration">Disabling Hydration</a></li><li id="query-builder-api-html-disabling-result-caching" class="toc-item"><a href="query-builder-api.html#disabling-result-caching">Disabling Result Caching</a></li><li id="query-builder-api-html-limiting-results" class="toc-item"><a href="query-builder-api.html#limiting-results">Limiting Results</a></li><li id="query-builder-api-html-sorting-results" class="toc-item"><a href="query-builder-api.html#sorting-results">Sorting Results</a></li><li id="query-builder-api-html-conditional-operators" class="toc-item"><a href="query-builder-api.html#conditional-operators">Conditional Operators</a></li><li id="query-builder-api-html-text-search" class="toc-item"><a href="query-builder-api.html#text-search">Text Search</a></li><li id="query-builder-api-html-update-queries" class="toc-item"><a href="query-builder-api.html#update-queries">Update Queries</a></li></ul></li><li id="query-builder-api-html-updating-multiple-documents" class="toc-item"><a href="query-builder-api.html#updating-multiple-documents">Updating multiple documents</a></li><li id="query-builder-api-html-modifier-operations" class="toc-item"><a href="query-builder-api.html#modifier-operations">Modifier Operations</a></li><li id="query-builder-api-html-remove-queries" class="toc-item"><a href="query-builder-api.html#remove-queries">Remove Queries</a></li></ul></li><li id="aggregation-builder-html-aggregation-builder" class="toc-item"><a href="aggregation-builder.html#aggregation-builder">Aggregation builder</a><ul><li id="aggregation-builder-html-creating-an-aggregation-builder" class="toc-item"><a href="aggregation-builder.html#creating-an-aggregation-builder">Creating an Aggregation Builder</a><ul><li id="aggregation-builder-html-adding-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#adding-pipeline-stages">Adding pipeline stages</a></li><li id="aggregation-builder-html-nesting-expressions" class="toc-item"><a href="aggregation-builder.html#nesting-expressions">Nesting expressions</a></li><li id="aggregation-builder-html-executing-an-aggregation-pipeline" class="toc-item"><a href="aggregation-builder.html#executing-an-aggregation-pipeline">Executing an aggregation pipeline</a></li><li id="aggregation-builder-html-hydration" class="toc-item"><a href="aggregation-builder.html#hydration">Hydration</a></li><li id="aggregation-builder-html-disabling-result-caching" class="toc-item"><a href="aggregation-builder.html#disabling-result-caching">Disabling Result Caching</a></li></ul></li><li id="aggregation-builder-html-aggregation-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#aggregation-pipeline-stages">Aggregation pipeline stages</a><ul><li id="aggregation-builder-html-addfields" class="toc-item"><a href="aggregation-builder.html#addfields">$addFields</a></li><li id="aggregation-builder-html-bucket" class="toc-item"><a href="aggregation-builder.html#bucket">$bucket</a></li><li id="aggregation-builder-html-bucketauto" class="toc-item"><a href="aggregation-builder.html#bucketauto">$bucketAuto</a></li><li id="aggregation-builder-html-collstats" class="toc-item"><a href="aggregation-builder.html#collstats">$collStats</a></li><li id="aggregation-builder-html-count" class="toc-item"><a href="aggregation-builder.html#count">$count</a></li><li id="aggregation-builder-html-facet" class="toc-item"><a href="aggregation-builder.html#facet">$facet</a></li><li id="aggregation-builder-html-geonear" class="toc-item"><a href="aggregation-builder.html#geonear">$geoNear</a></li><li id="aggregation-builder-html-graphlookup" class="toc-item"><a href="aggregation-builder.html#graphlookup">$graphLookup</a></li><li id="aggregation-builder-html-group" class="toc-item"><a href="aggregation-builder.html#group">$group</a></li><li id="aggregation-builder-html-indexstats" class="toc-item"><a href="aggregation-builder.html#indexstats">$indexStats</a></li><li id="aggregation-builder-html-lookup" class="toc-item"><a href="aggregation-builder.html#lookup">$lookup</a></li><li id="aggregation-builder-html-match" class="toc-item"><a href="aggregation-builder.html#match">$match</a></li><li id="aggregation-builder-html-out" class="toc-item"><a href="aggregation-builder.html#out">$out</a></li><li id="aggregation-builder-html-project" class="toc-item"><a href="aggregation-builder.html#project">$project</a></li><li id="aggregation-builder-html-redact" class="toc-item"><a href="aggregation-builder.html#redact">$redact</a></li><li id="aggregation-builder-html-replaceroot" class="toc-item"><a href="aggregation-builder.html#replaceroot">$replaceRoot</a></li><li id="aggregation-builder-html-sample" class="toc-item"><a href="aggregation-builder.html#sample">$sample</a></li><li id="aggregation-builder-html-sort-limit-and-skip" class="toc-item"><a href="aggregation-builder.html#sort-limit-and-skip">$sort, $limit and $skip</a></li><li id="aggregation-builder-html-sortbycount" class="toc-item"><a href="aggregation-builder.html#sortbycount">$sortByCount</a></li><li id="aggregation-builder-html-unwind" class="toc-item"><a href="aggregation-builder.html#unwind">$unwind</a></li></ul></li></ul></li><li id="geospatial-queries-html-geospatial-queries" class="toc-item"><a href="geospatial-queries.html#geospatial-queries">Geospatial Queries</a><ul><li id="geospatial-queries-html-mapping" class="toc-item"><a href="geospatial-queries.html#mapping">Mapping</a></li><li id="geospatial-queries-html-near-query" class="toc-item"><a href="geospatial-queries.html#near-query">Near Query</a></li></ul></li><li id="find-and-update-html-find-and-modify" class="toc-item"><a href="find-and-update.html#find-and-modify">Find and Modify</a><ul><li id="find-and-update-html-update" class="toc-item"><a href="find-and-update.html#update">Update</a></li><li id="find-and-update-html-remove" class="toc-item"><a href="find-and-update.html#remove">Remove</a></li></ul></li><li id="upserting-documents-html-upserting-documents" class="toc-item"><a href="upserting-documents.html#upserting-documents">Upserting Documents</a></li><li id="filters-html-filters" class="toc-item"><a href="filters.html#filters">Filters</a><ul><li id="filters-html-example-filter-class" class="toc-item"><a href="filters.html#example-filter-class">Example filter class</a></li><li id="filters-html-configuration" class="toc-item"><a href="filters.html#configuration">Configuration</a></li><li id="filters-html-disabling-enabling-filters-and-setting-parameters" class="toc-item"><a href="filters.html#disabling-enabling-filters-and-setting-parameters">Disabling/Enabling Filters and Setting Parameters</a></li></ul></li><li id="priming-references-html-priming-references" class="toc-item"><a href="priming-references.html#priming-references">Priming References</a><ul><li id="priming-references-html-query-builder" class="toc-item"><a href="priming-references.html#query-builder">Query Builder</a></li><li id="priming-references-html-inverse-references" class="toc-item"><a href="priming-references.html#inverse-references">Inverse references</a></li><li id="priming-references-html-primer-callback" class="toc-item"><a href="priming-references.html#primer-callback">Primer Callback</a></li></ul></li><li id="capped-collections-html-capped-collections" class="toc-item"><a href="capped-collections.html#capped-collections">Capped Collections</a><ul><li id="capped-collections-html-mapping" class="toc-item"><a href="capped-collections.html#mapping">Mapping</a></li><li id="capped-collections-html-creating" class="toc-item"><a href="capped-collections.html#creating">Creating</a></li></ul></li><li id="storage-strategies-html-storage-strategies" class="toc-item"><a href="storage-strategies.html#storage-strategies">Storage Strategies</a><ul><li id="storage-strategies-html-increment" class="toc-item"><a href="storage-strategies.html#increment">increment</a></li><li id="storage-strategies-html-addtoset" class="toc-item"><a href="storage-strategies.html#addtoset">addToSet</a></li><li id="storage-strategies-html-set" class="toc-item"><a href="storage-strategies.html#set">set</a></li><li id="storage-strategies-html-setarray" class="toc-item"><a href="storage-strategies.html#setarray">setArray</a></li><li id="storage-strategies-html-pushall" class="toc-item"><a href="storage-strategies.html#pushall">pushAll</a></li><li id="storage-strategies-html-atomicset" class="toc-item"><a href="storage-strategies.html#atomicset">atomicSet</a></li><li id="storage-strategies-html-atomicsetarray" class="toc-item"><a href="storage-strategies.html#atomicsetarray">atomicSetArray</a></li></ul></li><li id="custom-collections-html-custom-collections" class="toc-item"><a href="custom-collections.html#custom-collections">Custom Collections</a><ul><li id="custom-collections-html-custom-collection-classes" class="toc-item"><a href="custom-collections.html#custom-collection-classes">Custom Collection Classes</a></li><li id="custom-collections-html-taking-control-of-the-collection-s-constructor" class="toc-item"><a href="custom-collections.html#taking-control-of-the-collection-s-constructor">Taking Control of the Collection's Constructor</a></li></ul></li><li id="sharding-html-sharding" class="toc-item"><a href="sharding.html#sharding">Sharding</a></li><li id="transactions-and-concurrency-html-transactions-and-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#transactions-and-concurrency">Transactions and Concurrency</a><ul><li id="transactions-and-concurrency-html-transactions" class="toc-item"><a href="transactions-and-concurrency.html#transactions">Transactions</a><ul><li id="transactions-and-concurrency-html-limitation" class="toc-item"><a href="transactions-and-concurrency.html#limitation">Limitation</a></li><li id="transactions-and-concurrency-html-workaround" class="toc-item"><a href="transactions-and-concurrency.html#workaround">Workaround</a></li></ul></li><li id="transactions-and-concurrency-html-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#concurrency">Concurrency</a><ul><li id="transactions-and-concurrency-html-optimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#optimistic-locking">Optimistic Locking</a></li><li id="transactions-and-concurrency-html-pessimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#pessimistic-locking">Pessimistic Locking</a></li></ul></li></ul></li><li id="best-practices-html-best-practices" class="toc-item"><a href="best-practices.html#best-practices">Best Practices</a><ul><li id="best-practices-html-constrain-relationships-as-much-as-possible" class="toc-item"><a href="best-practices.html#constrain-relationships-as-much-as-possible">Constrain relationships as much as possible</a></li><li id="best-practices-html-use-events-judiciously" class="toc-item"><a href="best-practices.html#use-events-judiciously">Use events judiciously</a></li><li id="best-practices-html-use-cascades-judiciously" class="toc-item"><a href="best-practices.html#use-cascades-judiciously">Use cascades judiciously</a></li><li id="best-practices-html-don-t-use-special-characters" class="toc-item"><a href="best-practices.html#don-t-use-special-characters">Don't use special characters</a></li><li id="best-practices-html-initialize-collections-in-the-constructor" class="toc-item"><a href="best-practices.html#initialize-collections-in-the-constructor">Initialize collections in the constructor</a></li></ul></li><li id="change-tracking-policies-html-change-tracking-policies" class="toc-item"><a href="change-tracking-policies.html#change-tracking-policies">Change Tracking Policies</a><ul><li id="change-tracking-policies-html-deferred-implicit" class="toc-item"><a href="change-tracking-policies.html#deferred-implicit">Deferred Implicit</a></li><li id="change-tracking-policies-html-deferred-explicit" class="toc-item"><a href="change-tracking-policies.html#deferred-explicit">Deferred Explicit</a></li><li id="change-tracking-policies-html-notify" class="toc-item"><a href="change-tracking-policies.html#notify">Notify</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Cookbook</h2>
<div class="toc"><ul><li id="cookbook-blending-orm-and-mongodb-odm-html-blending-the-orm-and-mongodb-odm" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#blending-the-orm-and-mongodb-odm">Blending the ORM and MongoDB ODM</a><ul><li id="cookbook-blending-orm-and-mongodb-odm-html-define-product" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-product">Define Product</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-define-entity" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-entity">Define Entity</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-event-subscriber" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#event-subscriber">Event Subscriber</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-working-with-products-and-orders" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#working-with-products-and-orders">Working with Products and Orders</a></li></ul></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mapping-classes-to-the-orm-and-odm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mapping-classes-to-the-orm-and-odm">Mapping Classes to the ORM and ODM</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-test-subject" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#test-subject">Test Subject</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mapping-information" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mapping-information">Mapping Information</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-orm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#orm">ORM</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mongodb-odm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mongodb-odm">MongoDB ODM</a></li></ul></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-repository-classes" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#repository-classes">Repository Classes</a></li></ul></li><li id="cookbook-implementing-wakeup-or-clone-html-implementing-wakeup-or-clone" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#implementing-wakeup-or-clone">Implementing Wakeup or Clone</a><ul><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-wakeup" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-wakeup">Safely implementing \_\_wakeup</a></li><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-clone" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-clone">Safely implementing \_\_clone</a></li><li id="cookbook-implementing-wakeup-or-clone-html-summary" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#summary">Summary</a></li></ul></li><li id="cookbook-implementing-the-notify-changetracking-policy-html-implementing-the-notify-changetracking-policy" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html#implementing-the-notify-changetracking-policy">Implementing the Notify ChangeTracking Policy</a><ul><li id="cookbook-implementing-the-notify-changetracking-policy-html-implementing-notifypropertychanged" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html#implementing-notifypropertychanged">Implementing NotifyPropertyChanged</a></li></ul></li><li id="cookbook-implementing-array-access-for-domain-objects-html-implementing-arrayaccess-for-domain-objects" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#implementing-arrayaccess-for-domain-objects">Implementing ArrayAccess for Domain Objects</a><ul><li id="cookbook-implementing-array-access-for-domain-objects-html-option-1" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-1">Option 1</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-option-2" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-2">Option 2</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-read-only" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#read-only">Read-only</a></li></ul></li><li id="cookbook-validation-of-documents-html-validation-of-documents" class="toc-item"><a href="../cookbook/validation-of-documents.html#validation-of-documents">Validation of Documents</a></li><li id="cookbook-resolve-target-document-listener-html-keeping-your-modules-independent" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#keeping-your-modules-independent">Keeping Your Modules Independent</a><ul><li id="cookbook-resolve-target-document-listener-html-background" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#background">Background</a></li><li id="cookbook-resolve-target-document-listener-html-configuration" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#configuration">Configuration</a></li><li id="cookbook-resolve-target-document-listener-html-final-thoughts" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#final-thoughts">Final Thoughts</a></li></ul></li><li id="cookbook-soft-delete-extension-html-soft-delete-extension" class="toc-item"><a href="../cookbook/soft-delete-extension.html#soft-delete-extension">Soft Delete Extension</a><ul><li id="cookbook-soft-delete-extension-html-installation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#installation">Installation</a></li><li id="cookbook-soft-delete-extension-html-setup" class="toc-item"><a href="../cookbook/soft-delete-extension.html#setup">Setup</a></li><li id="cookbook-soft-delete-extension-html-softdeleteable-interface" class="toc-item"><a href="../cookbook/soft-delete-extension.html#softdeleteable-interface">SoftDeleteable Interface</a></li><li id="cookbook-soft-delete-extension-html-example-implementation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#example-implementation">Example Implementation</a></li><li id="cookbook-soft-delete-extension-html-usage" class="toc-item"><a href="../cookbook/soft-delete-extension.html#usage">Usage</a></li><li id="cookbook-soft-delete-extension-html-events" class="toc-item"><a href="../cookbook/soft-delete-extension.html#events">Events</a></li><li id="cookbook-soft-delete-extension-html-cascading-soft-deletes" class="toc-item"><a href="../cookbook/soft-delete-extension.html#cascading-soft-deletes">Cascading Soft Deletes</a></li></ul></li><li id="cookbook-simple-search-engine-html-simple-search-engine" class="toc-item"><a href="../cookbook/simple-search-engine.html#simple-search-engine">Simple Search Engine</a><ul><li id="cookbook-simple-search-engine-html-sample-model-product" class="toc-item"><a href="../cookbook/simple-search-engine.html#sample-model-product">Sample Model: Product</a></li><li id="cookbook-simple-search-engine-html-working-with-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#working-with-keywords">Working with Keywords</a></li><li id="cookbook-simple-search-engine-html-searching-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#searching-keywords">Searching Keywords</a><ul><li id="cookbook-simple-search-engine-html-user-input" class="toc-item"><a href="../cookbook/simple-search-engine.html#user-input">User Input</a></li></ul></li><li id="cookbook-simple-search-engine-html-embedded-documents" class="toc-item"><a href="../cookbook/simple-search-engine.html#embedded-documents">Embedded Documents</a><ul><li id="cookbook-simple-search-engine-html-definition" class="toc-item"><a href="../cookbook/simple-search-engine.html#definition">Definition</a></li></ul></li></ul></li></ul></div>
</div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "MongoDB ODM",
            "item": "https://www.doctrine-project.org/projects/mongodb-odm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.1/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Query Builder API",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.1/reference/query-builder-api.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.1/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Query Builder API</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-mongodb-odm/en/2.1/reference/query-builder-api.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        2.1.3
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/latest/reference/query-builder-api.html">
                                                    2.4.2

                                                    
                                                                                                            (upcoming)
                                                                                                    </a>
                                                                                            
                                                <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.3/reference/query-builder-api.html">
                                                    2.3.3

                                                                                                            (current)
                                                    
                                                                                                    </a>
                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.2/reference/query-builder-api.html">2.2</a>
                                                                                            
                                                <a class="dropdown-item active" href="/projects/doctrine-mongodb-odm/en/2.1/reference/query-builder-api.html">2.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.0/reference/query-builder-api.html">2.0</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.3/reference/query-builder-api.html">1.3</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.2/reference/query-builder-api.html">1.2</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.1/reference/query-builder-api.html">1.1</a>
                                                                                            
                                                <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.0/reference/query-builder-api.html">1.0</a>
                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="query-builder-api" name="query-builder-api"></a><h1 class="section-header"><a href="#query-builder-api">Query Builder API<i class="fas fa-link"></i></a></h1>
<div class="role"><p>Querying for documents with Doctrine is just as simple as if you
weren't using Doctrine at all. Of course you always have your
traditional <code>find()</code> and <code>findOne()</code> methods but you also have
a <code>Query</code> object with a fluent API for defining the query that
should be executed.</p></div>
<p>The <code>Query</code> object supports several types of queries</p>
<ul><li class="dash">FIND</li>
<li class="dash">FIND_AND_UPDATE</li>
<li class="dash">FIND_AND_REMOVE</li>
<li class="dash">INSERT</li>
<li class="dash">UPDATE</li>
<li class="dash">REMOVE</li>
<li class="dash">DISTINCT_FIELD</li>
<li class="dash">GEO_LOCATION</li>
</ul>

<p>This section will show examples for the different types of queries.</p>
<div class="section"><a class="section-anchor" id="finding-documents" name="finding-documents"></a><h2 class="section-header"><a href="#finding-documents">Finding Documents<i class="fas fa-link"></i></a></h2>
<p>You have a few different ways to find documents. You can use the <code>find()</code> method
to find a document by its identifier:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a6bb6959d048966fddde3be45fb8a6b4f7635c60"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a6bb6959d048966fddde3be45fb8a6b4f7635c60"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-1" class="line-number-anchor" /><a href="#line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$users = $dm-&gt;find(User::class, $id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-2" class="line-number-anchor" /><a href="#line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-3" class="line-number-anchor" /><a href="#line-number-a6bb6959d048966fddde3be45fb8a6b4f7635c60-3">3</a></td></tr></table></div></code></pre>
<p>The <code>find()</code> method is just a convenience shortcut method to:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="2239a3c337263f63dd051503d52d4b53619d3b27"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="2239a3c337263f63dd051503d52d4b53619d3b27"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-2239a3c337263f63dd051503d52d4b53619d3b27-1" class="line-number-anchor" /><a href="#line-number-2239a3c337263f63dd051503d52d4b53619d3b27-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;getRepository(User::class)-&gt;find($id);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-2239a3c337263f63dd051503d52d4b53619d3b27-2" class="line-number-anchor" /><a href="#line-number-2239a3c337263f63dd051503d52d4b53619d3b27-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-2239a3c337263f63dd051503d52d4b53619d3b27-3" class="line-number-anchor" /><a href="#line-number-2239a3c337263f63dd051503d52d4b53619d3b27-3">3</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The <code>find()</code> method checks the local in memory identity map for the document
before querying the database for the document.</p>
</td></tr></table></div>
<p>On the <code>DocumentRepository</code> you have a few other methods for finding documents:</p>
<ul><li class="dash"><code>findBy</code> - find documents by an array of criteria</li>
<li class="dash"><code>findOneBy</code> - find one document by an array of criteria</li>
</ul>

<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-1" class="line-number-anchor" /><a href="#line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$users = $dm-&gt;getRepository(User::class)-&gt;findBy([<span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'employee'</span>]);
$user = $dm-&gt;getRepository(User::class)-&gt;findOneBy([<span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'jwage'</span>]);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-2" class="line-number-anchor" /><a href="#line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-3" class="line-number-anchor" /><a href="#line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-4" class="line-number-anchor" /><a href="#line-number-a6b0d4c7cd25a1a0aa3b30f6a56a3ab0e0e4df9d-4">4</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="creating-a-query-builder" name="creating-a-query-builder"></a><h2 class="section-header"><a href="#creating-a-query-builder">Creating a Query Builder<i class="fas fa-link"></i></a></h2>
<p>You can easily create a new <code>Query\Builder</code> object with the
<code>DocumentManager::createQueryBuilder()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9f1f53a3c27fff299c2854b78762c15cb9c7ffaf"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9f1f53a3c27fff299c2854b78762c15cb9c7ffaf"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-1" class="line-number-anchor" /><a href="#line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-2" class="line-number-anchor" /><a href="#line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-3" class="line-number-anchor" /><a href="#line-number-9f1f53a3c27fff299c2854b78762c15cb9c7ffaf-3">3</a></td></tr></table></div></code></pre>
<p>The first and only argument is optional, you can specify it later
with the <code>find()</code>, <code>update()</code> (deprecated), <code>updateOne()</code>,
<code>updateMany()</code> or <code>remove()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5836c89f8586765d8337c431472cc47181443340"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5836c89f8586765d8337c431472cc47181443340"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-1" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder();

<span class="hljs-comment">// ...</span>

$qb-&gt;find(User::class);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-2" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-3" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-4" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-5" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-6" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5836c89f8586765d8337c431472cc47181443340-7" class="line-number-anchor" /><a href="#line-number-5836c89f8586765d8337c431472cc47181443340-7">7</a></td></tr></table></div></code></pre>
<div class="section"><a class="section-anchor" id="executing-queries" name="executing-queries"></a><h3 class="section-header"><a href="#executing-queries">Executing Queries<i class="fas fa-link"></i></a></h3>
<p>You can execute a query by getting a <code>Query</code> through the <code>getQuery()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="ca84b954786912bb2076140a8d2a7b32ce3f3827"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="ca84b954786912bb2076140a8d2a7b32ce3f3827"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-1" class="line-number-anchor" /><a href="#line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class);
$query = $qb-&gt;getQuery();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-2" class="line-number-anchor" /><a href="#line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-3" class="line-number-anchor" /><a href="#line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-4" class="line-number-anchor" /><a href="#line-number-ca84b954786912bb2076140a8d2a7b32ce3f3827-4">4</a></td></tr></table></div></code></pre>
<p>Now you can <code>execute()</code> that query and it will return an <code>Iterator</code> for you to iterate over the results:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="bad8a6d64286937a40d4c8076806a14f2d3353d7"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="bad8a6d64286937a40d4c8076806a14f2d3353d7"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-1" class="line-number-anchor" /><a href="#line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$users = $query-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-2" class="line-number-anchor" /><a href="#line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-3" class="line-number-anchor" /><a href="#line-number-bad8a6d64286937a40d4c8076806a14f2d3353d7-3">3</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="debugging-queries" name="debugging-queries"></a><h3 class="section-header"><a href="#debugging-queries">Debugging Queries<i class="fas fa-link"></i></a></h3>
<p>While building not complicated queries is really simple sometimes it might be hard to wrap your head
around more sophisticated queries that involves building separate expressions to work properly. If
you are not sure if your the query constructed with Builder is in fact correct you may want to <code>debug()</code> it</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="c731c83520b8f333c3602cc433b55777b366d8e9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="c731c83520b8f333c3602cc433b55777b366d8e9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-c731c83520b8f333c3602cc433b55777b366d8e9-1" class="line-number-anchor" /><a href="#line-number-c731c83520b8f333c3602cc433b55777b366d8e9-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class);
$query = $qb-&gt;getQuery();
$debug = $query-&gt;debug();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-c731c83520b8f333c3602cc433b55777b366d8e9-2" class="line-number-anchor" /><a href="#line-number-c731c83520b8f333c3602cc433b55777b366d8e9-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c731c83520b8f333c3602cc433b55777b366d8e9-3" class="line-number-anchor" /><a href="#line-number-c731c83520b8f333c3602cc433b55777b366d8e9-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c731c83520b8f333c3602cc433b55777b366d8e9-4" class="line-number-anchor" /><a href="#line-number-c731c83520b8f333c3602cc433b55777b366d8e9-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c731c83520b8f333c3602cc433b55777b366d8e9-5" class="line-number-anchor" /><a href="#line-number-c731c83520b8f333c3602cc433b55777b366d8e9-5">5</a></td></tr></table></div></code></pre>
<p>At this point your query is <em>prepared</em> - that means ODM done all its job in renaming fields to match their
database name, added discriminator fields, applied filters, created correct references and all other things
you employ ODM to. The array returned by <code>-&gt;debug()</code> is what is passed to the underlying driver for the
query to be performed.</p>
</div>
<div class="section"><a class="section-anchor" id="getting-single-result" name="getting-single-result"></a><h3 class="section-header"><a href="#getting-single-result">Getting Single Result<i class="fas fa-link"></i></a></h3>
<p>If you want to just get a single result you can use the <code>Query#getSingleResult()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="d64cb82cb6d8bce3a44a767d2b5d19017bbba8db"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="d64cb82cb6d8bce3a44a767d2b5d19017bbba8db"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-1" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'jwage'</span>)
    -&gt;getQuery()
    -&gt;getSingleResult();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-2" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-3" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-4" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-5" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-6" class="line-number-anchor" /><a href="#line-number-d64cb82cb6d8bce3a44a767d2b5d19017bbba8db-6">6</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="selecting-fields" name="selecting-fields"></a><h3 class="section-header"><a href="#selecting-fields">Selecting Fields<i class="fas fa-link"></i></a></h3>
<p>You can limit the fields that are returned in the results by using
the <code>select()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="25e6cdd1c9850735a24b058a2703e9a8e9f38f18"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="25e6cdd1c9850735a24b058a2703e9a8e9f38f18"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-1" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;select(<span class="hljs-string">'username'</span>, <span class="hljs-string">'password'</span>);
$query = $qb-&gt;getQuery();
$users = $query-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-2" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-3" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-4" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-5" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-6" class="line-number-anchor" /><a href="#line-number-25e6cdd1c9850735a24b058a2703e9a8e9f38f18-6">6</a></td></tr></table></div></code></pre>
<p>In the results only the data from the username and password will be
returned.</p>
</div>
<div class="section"><a class="section-anchor" id="index-hints" name="index-hints"></a><h3 class="section-header"><a href="#index-hints">Index hints<i class="fas fa-link"></i></a></h3>
<p>You can force MongoDB to use a specific index for a query with the <code>hint()</code> method (see <a href="https://docs.mongodb.com/manual/reference/operator/meta/hint/">hint</a>)</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-1" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;hint(<span class="hljs-string">'user_pass_idx'</span>);
$query = $qb-&gt;getQuery();
$users = $query-&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-2" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-3" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-4" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-5" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-6" class="line-number-anchor" /><a href="#line-number-7b62fe5bb9592bfcd71272ec46534e4bb3bbbcfe-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Combining <code>select()</code> and  <code>hint()</code> on appropriate indexes can result in very fast
<a href="https://docs.mongodb.com/manual/core/query-optimization/#covered-query">covered queries</a></p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="selecting-distinct-values" name="selecting-distinct-values"></a><h3 class="section-header"><a href="#selecting-distinct-values">Selecting Distinct Values<i class="fas fa-link"></i></a></h3>
<p>Sometimes you may want to get an array of distinct values in a
collection. You can accomplish this using the <code>distinct()</code>
method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="abd63169896202aac7df37289852df26a8af7cfb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="abd63169896202aac7df37289852df26a8af7cfb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-1" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$ages = $dm-&gt;createQueryBuilder(User::class)
    -&gt;distinct(<span class="hljs-string">'age'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-2" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-3" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-4" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-5" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-abd63169896202aac7df37289852df26a8af7cfb-6" class="line-number-anchor" /><a href="#line-number-abd63169896202aac7df37289852df26a8af7cfb-6">6</a></td></tr></table></div></code></pre>
<p>The above would give you an array of all the distinct user ages!</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>MongoDB's <a href="https://docs.mongodb.com/manual/reference/command/distinct/">distinct command</a>
does not support sorting, so you cannot combine <code>distinct()</code> with
<code>sort()</code>. If you would like to sort the results of a distinct query, you
will need to do so in PHP after executing the query.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="refreshing-documents" name="refreshing-documents"></a><h3 class="section-header"><a href="#refreshing-documents">Refreshing Documents<i class="fas fa-link"></i></a></h3>
<p>When a query (e.g. find) returns one or more hydrated documents whose
identifiers are already in the identity map, ODM returns the managed document
instances for those results. In this case, a managed document's data may differ
from whatever was just returned by the database query.</p>
<p>The query builder's <code>refresh()</code> method may be used to instruct ODM to override
the managed document with data from the query result. This is comparable to
calling <code>DocumentManager::refresh()</code> for a managed document. The document's
changeset will be reset in the process.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="0c481743959895d6054b9c632f447b3561ef516b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="0c481743959895d6054b9c632f447b3561ef516b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-1" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'jwage'</span>)
    -&gt;refresh()
    -&gt;getQuery()
    -&gt;getSingleResult();

<span class="hljs-comment">// Jon's user will have the latest data, even if it was already managed</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-2" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-3" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-4" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-5" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-6" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-7" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-8" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-0c481743959895d6054b9c632f447b3561ef516b-9" class="line-number-anchor" /><a href="#line-number-0c481743959895d6054b9c632f447b3561ef516b-9">9</a></td></tr></table></div></code></pre>
<p>Refreshing is not applicable if hydration is disabled.</p>
</div>
<div class="section"><a class="section-anchor" id="fetching-documents-as-read-only" name="fetching-documents-as-read-only"></a><h3 class="section-header"><a href="#fetching-documents-as-read-only">Fetching Documents as Read-Only<i class="fas fa-link"></i></a></h3>
<p>Similar to <code>refresh()</code>, <code>readOnly()</code> instructs ODM to not only hydrate the
latest data but also to create new document's instance (i.e. if found document
would be already managed by Doctrine, new instance will be returned) and not
register it in <code>UnitOfWork</code>.</p>
<p>This technique can prove especially useful when using <code>select()</code> with no intent
to update fetched documents.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-1" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-1">1</a></td><td class="code-line" rowspan="10"><span class="hljs-meta">&lt;?php</span>

$user = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'malarzm'</span>)
    -&gt;readOnly()
    -&gt;getQuery()
    -&gt;getSingleResult();

<span class="hljs-comment">// Maciej's user will have the latest data, and will not be the same object</span>
<span class="hljs-comment">// as the one that was already managed (if it was)</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-2" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-3" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-4" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-5" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-6" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-7" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-8" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-9" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-10" class="line-number-anchor" /><a href="#line-number-ede3d1c9e7a9ddd2b035adaede5e7ada9cc0ace1-10">10</a></td></tr></table></div></code></pre>
<p>Read-Only is not applicable if hydration is disabled.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Read-only mode is not deep, i.e. any references (be it owning or inverse) of
fetched WILL be managed by Doctrine. This is a shortcoming of current
implementation, may change in future and will not be considered a BC break
(will be treated as a feature instead).</p>
</td></tr></table></div>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>To manage a document previously fetched in read-only mode, always use the
`merge` method of the DocumentManager. Using `persist` in these cases can
have unwanted side effects.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="disabling-hydration" name="disabling-hydration"></a><h3 class="section-header"><a href="#disabling-hydration">Disabling Hydration<i class="fas fa-link"></i></a></h3>
<p>For find queries the results by default are hydrated and you get
document objects back instead of arrays. You can disable this and
get the raw results directly back from mongo by using the
<code>hydrate(false)</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="c228c62c3e6263c50241c47e016df438e864c174"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="c228c62c3e6263c50241c47e016df438e864c174"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-1" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$users = $dm-&gt;createQueryBuilder(User::class)
    -&gt;hydrate(<span class="hljs-keyword">false</span>)
    -&gt;getQuery()
    -&gt;execute();

print_r($users);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-2" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-3" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-4" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-5" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-6" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-7" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c228c62c3e6263c50241c47e016df438e864c174-8" class="line-number-anchor" /><a href="#line-number-c228c62c3e6263c50241c47e016df438e864c174-8">8</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="disabling-result-caching" name="disabling-result-caching"></a><h3 class="section-header"><a href="#disabling-result-caching">Disabling Result Caching<i class="fas fa-link"></i></a></h3>
<p>Due to MongoDB cursors not being rewindable, ODM uses a caching iterator when
returning results from queries. This cache allows you to iterate a result cursor
multiple times without re-executing the original query. However, in long-running
processes or when handling a large number of results, this can lead to high
memory usage. To disable this result cache, you can tell the query builder to
not return a caching iterator:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="57fa306643e6525e4d7b40e5514fcb9102aef6f1"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="57fa306643e6525e4d7b40e5514fcb9102aef6f1"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-1" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

$blogPosts = $dm-&gt;createQueryBuilder(BlogPost::class)
    -&gt;setRewindable(<span class="hljs-keyword">false</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-2" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-3" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-4" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-5" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-6" class="line-number-anchor" /><a href="#line-number-57fa306643e6525e4d7b40e5514fcb9102aef6f1-6">6</a></td></tr></table></div></code></pre>
<p>When setting this option to <code>false</code>, attempting a second iteration will result
in an exception.</p>
</div>
<div class="section"><a class="section-anchor" id="limiting-results" name="limiting-results"></a><h3 class="section-header"><a href="#limiting-results">Limiting Results<i class="fas fa-link"></i></a></h3>
<p>You can limit results similar to how you would in a relational
database with a limit and offset by using the <code>limit()</code> and
<code>skip()</code> method.</p>
<p>Here is an example where we get the third page of blog posts when
we show twenty at a time:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="f808717a8cd65813fba40cbc4fee7426949952b1"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="f808717a8cd65813fba40cbc4fee7426949952b1"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-1" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$blogPosts = $dm-&gt;createQueryBuilder(BlogPost::class)
    -&gt;limit(<span class="hljs-number">20</span>)
    -&gt;skip(<span class="hljs-number">40</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-2" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-3" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-4" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-5" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-6" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-f808717a8cd65813fba40cbc4fee7426949952b1-7" class="line-number-anchor" /><a href="#line-number-f808717a8cd65813fba40cbc4fee7426949952b1-7">7</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="sorting-results" name="sorting-results"></a><h3 class="section-header"><a href="#sorting-results">Sorting Results<i class="fas fa-link"></i></a></h3>
<p>You can sort the results by using the <code>sort()</code> method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="df80cc34aef5f82567b205c23feadc72c3c7df41"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="df80cc34aef5f82567b205c23feadc72c3c7df41"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-1" class="line-number-anchor" /><a href="#line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class)
    -&gt;sort(<span class="hljs-string">'createdAt'</span>, <span class="hljs-string">'desc'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-2" class="line-number-anchor" /><a href="#line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-3" class="line-number-anchor" /><a href="#line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-4" class="line-number-anchor" /><a href="#line-number-df80cc34aef5f82567b205c23feadc72c3c7df41-4">4</a></td></tr></table></div></code></pre>
<p>If you want to an additional sort you can call <code>sort()</code> again. The calls are stacked and ordered
in the order you call the method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="cab7898d6515b9d6bfc1fd477d290d4abd3f1536"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="cab7898d6515b9d6bfc1fd477d290d4abd3f1536"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-1" class="line-number-anchor" /><a href="#line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-1">1</a></td><td class="code-line" rowspan="3"><span class="hljs-meta">&lt;?php</span>

$query-&gt;sort(<span class="hljs-string">'featured'</span>, <span class="hljs-string">'desc'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-2" class="line-number-anchor" /><a href="#line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-3" class="line-number-anchor" /><a href="#line-number-cab7898d6515b9d6bfc1fd477d290d4abd3f1536-3">3</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="conditional-operators" name="conditional-operators"></a><h3 class="section-header"><a href="#conditional-operators">Conditional Operators<i class="fas fa-link"></i></a></h3>
<p>The conditional operators in Mongo are available to limit the returned results through a easy to use API. Doctrine abstracts this to a fluent object oriented interface with a fluent API. Here is a list of all the conditional operation methods you can use on the `Query\Builder` object.</p>
<ul><li><code>where($javascript)</code></li>
<li><code>in($values)</code></li>
<li><code>notIn($values)</code></li>
<li><code>equals($value)</code></li>
<li><code>notEqual($value)</code></li>
<li><code>gt($value)</code></li>
<li><code>gte($value)</code></li>
<li><code>lt($value)</code></li>
<li><code>lte($value)</code></li>
<li><code>range($start, $end)</code></li>
<li><code>size($size)</code></li>
<li><code>exists($bool)</code></li>
<li><code>type($type)</code></li>
<li><code>all($values)</code></li>
<li><code>mod($mod)</code></li>
<li><code>addOr($expr)</code></li>
<li><code>references($document)</code></li>
<li><code>includesReferenceTo($document)</code></li>
</ul>

<p>Query for active administrator users:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9581a2bea44d1f08d9a381ee34d663052beab211"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9581a2bea44d1f08d9a381ee34d663052beab211"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9581a2bea44d1f08d9a381ee34d663052beab211-1" class="line-number-anchor" /><a href="#line-number-9581a2bea44d1f08d9a381ee34d663052beab211-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'type'</span>)-&gt;equals(<span class="hljs-string">'admin'</span>)
    -&gt;field(<span class="hljs-string">'active'</span>)-&gt;equals(<span class="hljs-keyword">true</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9581a2bea44d1f08d9a381ee34d663052beab211-2" class="line-number-anchor" /><a href="#line-number-9581a2bea44d1f08d9a381ee34d663052beab211-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9581a2bea44d1f08d9a381ee34d663052beab211-3" class="line-number-anchor" /><a href="#line-number-9581a2bea44d1f08d9a381ee34d663052beab211-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9581a2bea44d1f08d9a381ee34d663052beab211-4" class="line-number-anchor" /><a href="#line-number-9581a2bea44d1f08d9a381ee34d663052beab211-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9581a2bea44d1f08d9a381ee34d663052beab211-5" class="line-number-anchor" /><a href="#line-number-9581a2bea44d1f08d9a381ee34d663052beab211-5">5</a></td></tr></table></div></code></pre>
<p>Query for articles that have some tags:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8275205367f91313d5f76835ecee41a574810521"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8275205367f91313d5f76835ecee41a574810521"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8275205367f91313d5f76835ecee41a574810521-1" class="line-number-anchor" /><a href="#line-number-8275205367f91313d5f76835ecee41a574810521-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class)
    -&gt;field(<span class="hljs-string">'tags.name'</span>)-&gt;in([<span class="hljs-string">'tag1'</span>, <span class="hljs-string">'tag2'</span>]);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-8275205367f91313d5f76835ecee41a574810521-2" class="line-number-anchor" /><a href="#line-number-8275205367f91313d5f76835ecee41a574810521-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8275205367f91313d5f76835ecee41a574810521-3" class="line-number-anchor" /><a href="#line-number-8275205367f91313d5f76835ecee41a574810521-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8275205367f91313d5f76835ecee41a574810521-4" class="line-number-anchor" /><a href="#line-number-8275205367f91313d5f76835ecee41a574810521-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/in/">$in operator</a>
in the Mongo docs</p>
<p>Query for articles that do not have some tags:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7f57f196ee2d1ce2a342e2a009a491bec84869d2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7f57f196ee2d1ce2a342e2a009a491bec84869d2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-1" class="line-number-anchor" /><a href="#line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class)
    -&gt;field(<span class="hljs-string">'tags.name'</span>)-&gt;notIn([<span class="hljs-string">'tag3'</span>]);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-2" class="line-number-anchor" /><a href="#line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-3" class="line-number-anchor" /><a href="#line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-4" class="line-number-anchor" /><a href="#line-number-7f57f196ee2d1ce2a342e2a009a491bec84869d2-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/nin/">$nin operator</a>
in the Mongo docs.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="6e850b9d8df26ae87452267a9ec66325b74143ad"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="6e850b9d8df26ae87452267a9ec66325b74143ad"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-1" class="line-number-anchor" /><a href="#line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'type'</span>)-&gt;notEqual(<span class="hljs-string">'admin'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-2" class="line-number-anchor" /><a href="#line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-3" class="line-number-anchor" /><a href="#line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-4" class="line-number-anchor" /><a href="#line-number-6e850b9d8df26ae87452267a9ec66325b74143ad-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/ne/">$ne operator</a>
in the Mongo docs.</p>
<p>Query for accounts with an amount due greater than 30:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="14a31c6521f02f73b2cf2ec546010f4db6de95a0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="14a31c6521f02f73b2cf2ec546010f4db6de95a0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-1" class="line-number-anchor" /><a href="#line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Account::class)
    -&gt;field(<span class="hljs-string">'amount_due'</span>)-&gt;gt(<span class="hljs-number">30</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-2" class="line-number-anchor" /><a href="#line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-3" class="line-number-anchor" /><a href="#line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-4" class="line-number-anchor" /><a href="#line-number-14a31c6521f02f73b2cf2ec546010f4db6de95a0-4">4</a></td></tr></table></div></code></pre>
<p>Query for accounts with an amount due greater than or equal to 30:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-1" class="line-number-anchor" /><a href="#line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Account::class)
    -&gt;field(<span class="hljs-string">'amount_due'</span>)-&gt;gte(<span class="hljs-number">30</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-2" class="line-number-anchor" /><a href="#line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-3" class="line-number-anchor" /><a href="#line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-4" class="line-number-anchor" /><a href="#line-number-b2d2f2e948e1b5e1abb8ea0c141101a35a4f039a-4">4</a></td></tr></table></div></code></pre>
<p>Query for accounts with an amount due less than 30:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-1" class="line-number-anchor" /><a href="#line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Account::class)
    -&gt;field(<span class="hljs-string">'amount_due'</span>)-&gt;lt(<span class="hljs-number">30</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-2" class="line-number-anchor" /><a href="#line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-3" class="line-number-anchor" /><a href="#line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-4" class="line-number-anchor" /><a href="#line-number-685ae2d7f0ae6c9babb999aa5c2a192b9f5f7d7b-4">4</a></td></tr></table></div></code></pre>
<p>Query for accounts with an amount due less than or equal to 30:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8c02901d6d26ea750f2cf49eabe8a0f2244bc23a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8c02901d6d26ea750f2cf49eabe8a0f2244bc23a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-1" class="line-number-anchor" /><a href="#line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Account::class)
    -&gt;field(<span class="hljs-string">'amount_due'</span>)-&gt;lte(<span class="hljs-number">30</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-2" class="line-number-anchor" /><a href="#line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-3" class="line-number-anchor" /><a href="#line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-4" class="line-number-anchor" /><a href="#line-number-8c02901d6d26ea750f2cf49eabe8a0f2244bc23a-4">4</a></td></tr></table></div></code></pre>
<p>Query for accounts with an amount due between 10 and 20:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="82cb3ac242827aaf7716ef7fa0b45d870681b103"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="82cb3ac242827aaf7716ef7fa0b45d870681b103"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-1" class="line-number-anchor" /><a href="#line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Account::class)
    -&gt;field(<span class="hljs-string">'amount_due'</span>)-&gt;range(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-2" class="line-number-anchor" /><a href="#line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-3" class="line-number-anchor" /><a href="#line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-4" class="line-number-anchor" /><a href="#line-number-82cb3ac242827aaf7716ef7fa0b45d870681b103-4">4</a></td></tr></table></div></code></pre>
<p>Read more about
<a href="http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-ConditionalOperators%3A%3C%2C%3C%3D%2C%3E%2C%3E%3D">conditional operators</a>
in the Mongo docs.</p>
<p>Query for articles with no comments:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="65ae9dde1f114bfa2051cf024f5a4783d4775707"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="65ae9dde1f114bfa2051cf024f5a4783d4775707"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-1" class="line-number-anchor" /><a href="#line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class)
    -&gt;field(<span class="hljs-string">'comments'</span>)-&gt;size(<span class="hljs-number">0</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-2" class="line-number-anchor" /><a href="#line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-3" class="line-number-anchor" /><a href="#line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-4" class="line-number-anchor" /><a href="#line-number-65ae9dde1f114bfa2051cf024f5a4783d4775707-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/size/">$size operator</a>
in the Mongo docs.</p>
<p>Query for users that have a login field before it was renamed to
username:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b1d76a8500cbe0d2e332be2222741565ceaec499"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b1d76a8500cbe0d2e332be2222741565ceaec499"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-1" class="line-number-anchor" /><a href="#line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'login'</span>)-&gt;exists(<span class="hljs-keyword">true</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-2" class="line-number-anchor" /><a href="#line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-3" class="line-number-anchor" /><a href="#line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-4" class="line-number-anchor" /><a href="#line-number-b1d76a8500cbe0d2e332be2222741565ceaec499-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/exists/">$exists operator</a>
in the Mongo docs.</p>
<p>Query for users that have a type field that is of integer bson
type:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="dc55f221a565306b7b0a56574717219f6295fb6f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="dc55f221a565306b7b0a56574717219f6295fb6f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-dc55f221a565306b7b0a56574717219f6295fb6f-1" class="line-number-anchor" /><a href="#line-number-dc55f221a565306b7b0a56574717219f6295fb6f-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'type'</span>)-&gt;type(<span class="hljs-string">'integer'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-dc55f221a565306b7b0a56574717219f6295fb6f-2" class="line-number-anchor" /><a href="#line-number-dc55f221a565306b7b0a56574717219f6295fb6f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-dc55f221a565306b7b0a56574717219f6295fb6f-3" class="line-number-anchor" /><a href="#line-number-dc55f221a565306b7b0a56574717219f6295fb6f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-dc55f221a565306b7b0a56574717219f6295fb6f-4" class="line-number-anchor" /><a href="#line-number-dc55f221a565306b7b0a56574717219f6295fb6f-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/type/">$type operator</a>
in the Mongo docs.</p>
<p>Query for users that are in all the specified Groups:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="65a87a6b6893fe785f9b388b8fa034bb08088404"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="65a87a6b6893fe785f9b388b8fa034bb08088404"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-1" class="line-number-anchor" /><a href="#line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'groups'</span>)-&gt;all([<span class="hljs-string">'Group 1'</span>, <span class="hljs-string">'Group 2'</span>]);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-2" class="line-number-anchor" /><a href="#line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-3" class="line-number-anchor" /><a href="#line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-4" class="line-number-anchor" /><a href="#line-number-65a87a6b6893fe785f9b388b8fa034bb08088404-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/all/">$all operator</a>
in the Mongo docs.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="46a000a5b34866f3e48bc6f8ded0c9996a23f6ab"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="46a000a5b34866f3e48bc6f8ded0c9996a23f6ab"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-1" class="line-number-anchor" /><a href="#line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Transaction::class)
    -&gt;field(<span class="hljs-string">'field'</span>)-&gt;mod(<span class="hljs-string">'field'</span>, [<span class="hljs-number">10</span>, <span class="hljs-number">1</span>]);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-2" class="line-number-anchor" /><a href="#line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-3" class="line-number-anchor" /><a href="#line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-4" class="line-number-anchor" /><a href="#line-number-46a000a5b34866f3e48bc6f8ded0c9996a23f6ab-4">4</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/mod/">$mod operator</a> in the Mongo docs.</p>
<p>Query for users who have subscribed or are in a trial.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5297a679e539fc5f253c483106c2a40f9f542ae0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5297a679e539fc5f253c483106c2a40f9f542ae0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-1" class="line-number-anchor" /><a href="#line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class);
$qb-&gt;addOr($qb-&gt;expr()-&gt;field(<span class="hljs-string">'subscriber'</span>)-&gt;equals(<span class="hljs-keyword">true</span>));
$qb-&gt;addOr($qb-&gt;expr()-&gt;field(<span class="hljs-string">'inTrial'</span>)-&gt;equals(<span class="hljs-keyword">true</span>));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-2" class="line-number-anchor" /><a href="#line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-3" class="line-number-anchor" /><a href="#line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-4" class="line-number-anchor" /><a href="#line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-5" class="line-number-anchor" /><a href="#line-number-5297a679e539fc5f253c483106c2a40f9f542ae0-5">5</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/query/or/">$or operator</a> in the Mongo docs.</p>
<p>The <code>references()</code> method may be used to query the owning side of a
<a href="annotations-reference.html#annotations_reference_reference_one">@ReferenceOne</a> relationship. In the
following example, we query for all articles written by a particular user.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="953682699a0e6207572294264f073615d9f4585e"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="953682699a0e6207572294264f073615d9f4585e"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-953682699a0e6207572294264f073615d9f4585e-1" class="line-number-anchor" /><a href="#line-number-953682699a0e6207572294264f073615d9f4585e-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// Suppose $user has already been fetched from the database</span>
$qb = $dm-&gt;createQueryBuilder(Article::class)
    -&gt;field(<span class="hljs-string">'user'</span>)-&gt;references($user);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-953682699a0e6207572294264f073615d9f4585e-2" class="line-number-anchor" /><a href="#line-number-953682699a0e6207572294264f073615d9f4585e-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-953682699a0e6207572294264f073615d9f4585e-3" class="line-number-anchor" /><a href="#line-number-953682699a0e6207572294264f073615d9f4585e-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-953682699a0e6207572294264f073615d9f4585e-4" class="line-number-anchor" /><a href="#line-number-953682699a0e6207572294264f073615d9f4585e-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-953682699a0e6207572294264f073615d9f4585e-5" class="line-number-anchor" /><a href="#line-number-953682699a0e6207572294264f073615d9f4585e-5">5</a></td></tr></table></div></code></pre>
<p>The <code>includesReferenceTo()</code> method may be used to query the owning side of a
<a href="annotations-reference.html#annotations_reference_reference_many">@ReferenceMany</a> relationship. In
the following example, we query for the user(s) that have access to a particular
account.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="fe33579caaefb0bc23f9760b40dd8bd07598ebcb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="fe33579caaefb0bc23f9760b40dd8bd07598ebcb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-1" class="line-number-anchor" /><a href="#line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// Suppose $account has already been fetched from the database</span>
$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'accounts'</span>)-&gt;includesReferenceTo($account);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-2" class="line-number-anchor" /><a href="#line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-3" class="line-number-anchor" /><a href="#line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-4" class="line-number-anchor" /><a href="#line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-5" class="line-number-anchor" /><a href="#line-number-fe33579caaefb0bc23f9760b40dd8bd07598ebcb-5">5</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="text-search" name="text-search"></a><h3 class="section-header"><a href="#text-search">Text Search<i class="fas fa-link"></i></a></h3>
<p>You can use the
<a href="https://docs.mongodb.com/manual/reference/operator/query/text/">$text operator</a>
to run a text search against a field with a text index. To do so, create a
document with a text index:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="af04a58defe549355f3fc9a3e49685c0bf23363a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="af04a58defe549355f3fc9a3e49685c0bf23363a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-1" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-1">1</a></td><td class="code-line" rowspan="17"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@Document</span>
 * <span class="hljs-doctag">@Index</span>(keys={"description"="text"})
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Document</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@Id</span> */</span>
    <span class="hljs-keyword">public</span> $id;

    <span class="hljs-comment">/** <span class="hljs-doctag">@Field</span>(type="string") */</span>
    <span class="hljs-keyword">public</span> $description;

    <span class="hljs-comment">/** <span class="hljs-doctag">@Field</span>(notSaved=true) */</span>
    <span class="hljs-keyword">public</span> $score;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-2" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-3" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-4" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-5" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-6" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-7" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-8" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-9" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-10" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-11" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-12" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-13" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-14" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-15" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-16" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-17" class="line-number-anchor" /><a href="#line-number-af04a58defe549355f3fc9a3e49685c0bf23363a-17">17</a></td></tr></table></div></code></pre>
<p>You can then run queries using the text operator:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="378459542fccba44e0d970128db3732dc6f1e2e9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="378459542fccba44e0d970128db3732dc6f1e2e9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-378459542fccba44e0d970128db3732dc6f1e2e9-1" class="line-number-anchor" /><a href="#line-number-378459542fccba44e0d970128db3732dc6f1e2e9-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// Run a text search against the index</span>
$qb = $dm-&gt;createQueryBuilder(Document::class)
    -&gt;text(<span class="hljs-string">'words you are looking for'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-378459542fccba44e0d970128db3732dc6f1e2e9-2" class="line-number-anchor" /><a href="#line-number-378459542fccba44e0d970128db3732dc6f1e2e9-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-378459542fccba44e0d970128db3732dc6f1e2e9-3" class="line-number-anchor" /><a href="#line-number-378459542fccba44e0d970128db3732dc6f1e2e9-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-378459542fccba44e0d970128db3732dc6f1e2e9-4" class="line-number-anchor" /><a href="#line-number-378459542fccba44e0d970128db3732dc6f1e2e9-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-378459542fccba44e0d970128db3732dc6f1e2e9-5" class="line-number-anchor" /><a href="#line-number-378459542fccba44e0d970128db3732dc6f1e2e9-5">5</a></td></tr></table></div></code></pre>
<p>To fetch the calculated score for the text search, use the <code>selectMeta()</code>
method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="fe403508bf304f2910227ba653a722f27973e02c"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="fe403508bf304f2910227ba653a722f27973e02c"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-1" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// Run a text search against the index</span>
$qb = $dm-&gt;createQueryBuilder(Document::class)
    -&gt;selectMeta(<span class="hljs-string">'score'</span>, <span class="hljs-string">'textScore'</span>)
    -&gt;text(<span class="hljs-string">'words you are looking for'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-2" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-3" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-4" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-5" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-fe403508bf304f2910227ba653a722f27973e02c-6" class="line-number-anchor" /><a href="#line-number-fe403508bf304f2910227ba653a722f27973e02c-6">6</a></td></tr></table></div></code></pre>
<p>You can also change the language used for stemming using the <code>language()</code>
method:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a4f3d3fba618ad9eff31c283972d773ef03ba6cb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a4f3d3fba618ad9eff31c283972d773ef03ba6cb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-1" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// Run a text search against the index</span>
$qb = $dm-&gt;createQueryBuilder(Document::class)
    -&gt;text(<span class="hljs-string">'parole che stai cercando'</span>)
    -&gt;language(<span class="hljs-string">'it'</span>);</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-2" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-3" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-4" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-5" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-6" class="line-number-anchor" /><a href="#line-number-a4f3d3fba618ad9eff31c283972d773ef03ba6cb-6">6</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="update-queries" name="update-queries"></a><h3 class="section-header"><a href="#update-queries">Update Queries<i class="fas fa-link"></i></a></h3>
<p>Doctrine also supports executing atomic update queries using the `Query\Builder`
object. You can use the conditional operations in combination with the ability to
change document field values atomically. Additionally if you are modifying a field
that is a reference you can pass managed document to the Builder and let ODM build
<code>DBRef</code> object for you.</p>
<p>You have several modifier operations
available to you that make it easy to update documents in Mongo:</p>
<ul><li><code>set($name, $value, $atomic = true)</code></li>
<li><code>setNewObj($newObj)</code></li>
<li><code>inc($name, $value)</code></li>
<li><code>unsetField($field)</code></li>
<li><code>push($field, $value)</code></li>
<li><code>addToSet($field, $value)</code></li>
<li><code>popFirst($field)</code></li>
<li><code>popLast($field)</code></li>
<li><code>pull($field, $value)</code></li>
<li><code>pullAll($field, array $valueArray)</code></li>
</ul>

</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="updating-multiple-documents" name="updating-multiple-documents"></a><h2 class="section-header"><a href="#updating-multiple-documents">Updating multiple documents<i class="fas fa-link"></i></a></h2>
<p>By default Mongo updates only one document unless <code>multi</code> option is provided and true.
In ODM the distinction is done by explicitly calling <code>updateMany()</code> method of the builder:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-1" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;updateMany()
    -&gt;field(<span class="hljs-string">'someField'</span>)-&gt;set(<span class="hljs-string">'newValue'</span>)
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'sgoettschkes'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-2" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-3" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-4" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-5" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-6" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-7" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-8" class="line-number-anchor" /><a href="#line-number-51bd0b0a5695d1cdab4a2393b68afb3a4aee69f5-8">8</a></td></tr></table></div></code></pre>
</div>
<div class="section"><a class="section-anchor" id="modifier-operations" name="modifier-operations"></a><h2 class="section-header"><a href="#modifier-operations">Modifier Operations<i class="fas fa-link"></i></a></h2>
<p>Change a users password:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="90a66ae5e48a79ca14eff514ec9505089c2e0ace"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="90a66ae5e48a79ca14eff514ec9505089c2e0ace"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-1" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'password'</span>)-&gt;set(<span class="hljs-string">'newpassword'</span>)
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'jwage'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-2" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-3" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-4" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-5" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-6" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-7" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-8" class="line-number-anchor" /><a href="#line-number-90a66ae5e48a79ca14eff514ec9505089c2e0ace-8">8</a></td></tr></table></div></code></pre>
<p>If you want to just set the values of an entirely new object you
can do so by passing false as the third argument of <code>set()</code> to
tell it the update is not an atomic one:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b0361a38f5a7bb0e2ed93cb75e06a801429b60eb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b0361a38f5a7bb0e2ed93cb75e06a801429b60eb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-1" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-1">1</a></td><td class="code-line" rowspan="10"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;set(<span class="hljs-string">'jwage'</span>, <span class="hljs-keyword">false</span>)
    -&gt;field(<span class="hljs-string">'password'</span>)-&gt;set(<span class="hljs-string">'password'</span>, <span class="hljs-keyword">false</span>)
    <span class="hljs-comment">// ... set other remaining fields</span>
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'jwage'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-2" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-3" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-4" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-5" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-6" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-7" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-8" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-9" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-10" class="line-number-anchor" /><a href="#line-number-b0361a38f5a7bb0e2ed93cb75e06a801429b60eb-10">10</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/set/">$set modifier</a>
in the Mongo docs.</p>
<p>You can set an entirely new object to update as well:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="c0070dab14284b787d96cf3e5336b7e3f2942ffc"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="c0070dab14284b787d96cf3e5336b7e3f2942ffc"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-1" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-1">1</a></td><td class="code-line" rowspan="13"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;setNewObj(
       [
           <span class="hljs-string">'username'</span> =&gt; <span class="hljs-string">'jwage'</span>,
           <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">'password'</span>,
           <span class="hljs-comment">// ... other fields</span>
       ]
    )
    -&gt;field(<span class="hljs-string">'username'</span>)-&gt;equals(<span class="hljs-string">'jwage'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-2" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-3" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-4" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-5" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-6" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-7" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-8" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-9" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-10" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-11" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-12" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-13" class="line-number-anchor" /><a href="#line-number-c0070dab14284b787d96cf3e5336b7e3f2942ffc-13">13</a></td></tr></table></div></code></pre>
<p>Increment the value of a document:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e10d5b95b83f32b0478c9fc4063165da5f48b626"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e10d5b95b83f32b0478c9fc4063165da5f48b626"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-1" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Package::class)
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;field(<span class="hljs-string">'downloads'</span>)-&gt;inc(<span class="hljs-number">1</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-2" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-3" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-4" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-5" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-6" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-7" class="line-number-anchor" /><a href="#line-number-e10d5b95b83f32b0478c9fc4063165da5f48b626-7">7</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/inc/">$inc modifier</a>
in the Mongo docs.</p>
<p>Unset the login field from users where the login field still
exists:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-1" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;updateMany()
    -&gt;field(<span class="hljs-string">'login'</span>)-&gt;unsetField()-&gt;exists(<span class="hljs-keyword">true</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-2" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-3" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-4" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-5" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-6" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-7" class="line-number-anchor" /><a href="#line-number-e6d3242d2bc0a9bdfbb74a629af04dc4e5a631dc-7">7</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/unset/">$unset modifier</a>
in the Mongo docs.</p>
<p>Append new tag to the tags array:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="3441794e671384535475f7d7f90bb89ac67c12c7"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="3441794e671384535475f7d7f90bb89ac67c12c7"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-1" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;push(<span class="hljs-string">'tag5'</span>)
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-2" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-3" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-4" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-5" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-6" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-7" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-3441794e671384535475f7d7f90bb89ac67c12c7-8" class="line-number-anchor" /><a href="#line-number-3441794e671384535475f7d7f90bb89ac67c12c7-8">8</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/push/">$push modifier</a>
in the Mongo docs.</p>
<p>Append new tags to the tags array:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5eaba696014d679f8e0700ba71817ed1db9020c8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5eaba696014d679f8e0700ba71817ed1db9020c8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-1" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class);
$qb-&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;push($qb-&gt;expr()-&gt;each([<span class="hljs-string">'tag6'</span>, <span class="hljs-string">'tag7'</span>]))
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-2" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-3" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-4" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-5" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-6" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-7" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-8" class="line-number-anchor" /><a href="#line-number-5eaba696014d679f8e0700ba71817ed1db9020c8-8">8</a></td></tr></table></div></code></pre>
<p>Add value to array only if its not in the array already:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="05d2fff65d8c394bb7aaa0b02e57d146c774b22a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="05d2fff65d8c394bb7aaa0b02e57d146c774b22a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-1" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;addToSet(<span class="hljs-string">'tag1'</span>)
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-2" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-3" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-4" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-5" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-6" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-7" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-8" class="line-number-anchor" /><a href="#line-number-05d2fff65d8c394bb7aaa0b02e57d146c774b22a-8">8</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/addToSet/">$addToSet modifier</a>
in the Mongo docs.</p>
<p>Add many values to the array only if they do not exist in the array
already:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a2458b5bdd5580c2709d11c9ed1ad1521faee965"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a2458b5bdd5580c2709d11c9ed1ad1521faee965"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-1" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(Article::class);
$qb-&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;addToSet($qb-&gt;expr()-&gt;each([<span class="hljs-string">'tag6'</span>, <span class="hljs-string">'tag7'</span>]))
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-2" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-3" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-4" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-5" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-6" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-7" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-8" class="line-number-anchor" /><a href="#line-number-a2458b5bdd5580c2709d11c9ed1ad1521faee965-8">8</a></td></tr></table></div></code></pre>
<p>Remove first element in an array:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4b3cfa0f2d28026c55c05267921c0280d9557cf7"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4b3cfa0f2d28026c55c05267921c0280d9557cf7"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-1" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;popFirst()
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-2" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-3" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-4" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-5" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-6" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-7" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-8" class="line-number-anchor" /><a href="#line-number-4b3cfa0f2d28026c55c05267921c0280d9557cf7-8">8</a></td></tr></table></div></code></pre>
<p>Remove last element in an array:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="384c96cf712fcbbaa9ab96aa735adf62a20b6ee2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="384c96cf712fcbbaa9ab96aa735adf62a20b6ee2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-1" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateOne()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;popLast()
    -&gt;field(<span class="hljs-string">'id'</span>)-&gt;equals(<span class="hljs-string">'theid'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-2" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-3" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-4" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-5" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-6" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-7" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-8" class="line-number-anchor" /><a href="#line-number-384c96cf712fcbbaa9ab96aa735adf62a20b6ee2-8">8</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/pop/">$pop modifier</a>
in the Mongo docs.</p>
<p>Remove all occurrences of value from array:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="1a496825d97e5e7c44ed99d498eb0115b57131a2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="1a496825d97e5e7c44ed99d498eb0115b57131a2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-1" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateMany()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;pull(<span class="hljs-string">'tag1'</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-2" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-3" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-4" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-5" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-6" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-7" class="line-number-anchor" /><a href="#line-number-1a496825d97e5e7c44ed99d498eb0115b57131a2-7">7</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/pull/">$pull modifier</a>
in the Mongo docs.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="571fde180907b5f5628cf32becebaef1cd2ffb53"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="571fde180907b5f5628cf32becebaef1cd2ffb53"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-1" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(Article::class)
    -&gt;updateMany()
    -&gt;field(<span class="hljs-string">'tags'</span>)-&gt;pullAll([<span class="hljs-string">'tag1'</span>, <span class="hljs-string">'tag2'</span>])
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-2" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-3" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-4" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-5" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-6" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-7" class="line-number-anchor" /><a href="#line-number-571fde180907b5f5628cf32becebaef1cd2ffb53-7">7</a></td></tr></table></div></code></pre>
<p>Read more about the
<a href="https://docs.mongodb.com/manual/reference/operator/update/pullAll/">$pullAll modifier</a>
in the Mongo docs.</p>
</div>
<div class="section"><a class="section-anchor" id="remove-queries" name="remove-queries"></a><h2 class="section-header"><a href="#remove-queries">Remove Queries<i class="fas fa-link"></i></a></h2>
<p>In addition to updating you can also issue queries to remove
documents from a collection. It works pretty much the same way as
everything else and you can use the conditional operations to
specify which documents you want to remove.</p>
<p>Here is an example where we remove users who have never logged in:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="84c04fb4bbafbf66dee4deb8b380c0e91325e2a8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="84c04fb4bbafbf66dee4deb8b380c0e91325e2a8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-1" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-meta">&lt;?php</span>

$dm-&gt;createQueryBuilder(User::class)
    -&gt;remove()
    -&gt;field(<span class="hljs-string">'num_logins'</span>)-&gt;equals(<span class="hljs-number">0</span>)
    -&gt;getQuery()
    -&gt;execute();</td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-2" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-3" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-4" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-5" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-6" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-7" class="line-number-anchor" /><a href="#line-number-84c04fb4bbafbf66dee4deb8b380c0e91325e2a8-7">7</a></td></tr></table></div></code></pre>

</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?e690ec"
                            integrity="sha384-HlquHHnsk57fOpIpNpH5aTJexhmiFWe5VxXE0QVH7gUjNSFr8HSaSFq1lqEAuxEr"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'mongodb-odm';
            var versionSlug = '2.1';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search MongoDB ODM 2.1'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
