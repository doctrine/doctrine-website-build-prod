<!DOCTYPE html>
<html>
    <head>
        <title>        Priming References - Doctrine MongoDB Object Document Mapper (MongoDB ODM)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine MongoDB Object Document Mapper Documentation: Priming References ">

        <meta name="keywords" content="                    php,mongodb,odm,data,mapper,mapping,object,documentation,priming,references
    ">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.8/reference/priming-references.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?7ed5f2"
                        integrity="sha384-5tK8pAp+O7PVIamh2Zw0CvUiN8GqArCP7G+3+6DICtPdywmEVZnXjUOL5pJhstda"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.0/reference/priming-references.html" />
        <meta property="og:title" content="        Priming References - Doctrine MongoDB Object Document Mapper (MongoDB ODM)
    " />
        <meta property="og:description" content="Doctrine MongoDB Object Document Mapper Documentation: Priming References " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine MongoDB Object Document Mapper",
            "description": "Priming References",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/mongodb-odm/edit/2.0.x/docs/en/reference/priming-references.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc-section"><h2 class="toc-header">Tutorials</h2>
<div class="toc"><ul><li id="tutorials-getting-started-html" class="toc-item"><a href="../tutorials/getting-started.html">Getting Started</a><ul><li id="tutorials-getting-started-html-example-model-simple-blog" class="toc-item"><a href="../tutorials/getting-started.html#example-model-simple-blog">Example Model: Simple Blog</a></li><li id="tutorials-getting-started-html-a-first-prototype" class="toc-item"><a href="../tutorials/getting-started.html#a-first-prototype">A first prototype</a></li><li id="tutorials-getting-started-html-persistent-models" class="toc-item"><a href="../tutorials/getting-started.html#persistent-models">Persistent Models</a></li><li id="tutorials-getting-started-html-usage" class="toc-item"><a href="../tutorials/getting-started.html#usage">Usage</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Reference</h2>
<div class="toc"><ul><li id="introduction-html" class="toc-item"><a href="introduction.html">Introduction</a><ul><li id="introduction-html-features-overview" class="toc-item"><a href="introduction.html#features-overview">Features Overview</a></li><li id="introduction-html-setup" class="toc-item"><a href="introduction.html#setup">Setup</a></li><li id="introduction-html-providing-a-custom-client" class="toc-item"><a href="introduction.html#providing-a-custom-client">Providing a custom client</a></li></ul></li><li id="architecture-html" class="toc-item"><a href="architecture.html">Architecture</a><ul><li id="architecture-html-documents" class="toc-item"><a href="architecture.html#documents">Documents</a><ul><li id="architecture-html-document-states" class="toc-item"><a href="architecture.html#document-states">Document states</a></li><li id="architecture-html-persistent-fields" class="toc-item"><a href="architecture.html#persistent-fields">Persistent fields</a></li><li id="architecture-html-serializing-documents" class="toc-item"><a href="architecture.html#serializing-documents">Serializing documents</a></li></ul></li><li id="architecture-html-the-documentmanager" class="toc-item"><a href="architecture.html#the-documentmanager">The DocumentManager</a><ul><li id="architecture-html-transactional-write-behind" class="toc-item"><a href="architecture.html#transactional-write-behind">Transactional write-behind</a></li><li id="architecture-html-the-unit-of-work" class="toc-item"><a href="architecture.html#the-unit-of-work">The Unit of Work</a></li></ul></li></ul></li><li id="console-commands-html" class="toc-item"><a href="console-commands.html">Console Commands</a></li><li id="basic-mapping-html" class="toc-item"><a href="basic-mapping.html">Basic Mapping</a><ul><li id="basic-mapping-html-mapping-drivers" class="toc-item"><a href="basic-mapping.html#mapping-drivers">Mapping Drivers</a></li><li id="basic-mapping-html-introduction-to-docblock-annotations" class="toc-item"><a href="basic-mapping.html#introduction-to-docblock-annotations">Introduction to Docblock Annotations</a></li><li id="basic-mapping-html-persistent-classes" class="toc-item"><a href="basic-mapping.html#persistent-classes">Persistent classes</a></li><li id="basic-mapping-html-doctrine-mapping-types" class="toc-item"><a href="basic-mapping.html#doctrine-mapping-types">Doctrine Mapping Types</a></li><li id="basic-mapping-html-property-mapping" class="toc-item"><a href="basic-mapping.html#property-mapping">Property Mapping</a><ul><li id="basic-mapping-html-identifiers" class="toc-item"><a href="basic-mapping.html#identifiers">Identifiers</a></li><li id="basic-mapping-html-fields" class="toc-item"><a href="basic-mapping.html#fields">Fields</a></li></ul></li><li id="basic-mapping-html-custom-mapping-types" class="toc-item"><a href="basic-mapping.html#custom-mapping-types">Custom Mapping Types</a></li><li id="basic-mapping-html-multiple-document-types-in-a-collection" class="toc-item"><a href="basic-mapping.html#multiple-document-types-in-a-collection">Multiple Document Types in a Collection</a></li></ul></li><li id="reference-mapping-html" class="toc-item"><a href="reference-mapping.html">Reference Mapping</a><ul><li id="reference-mapping-html-collections" class="toc-item"><a href="reference-mapping.html#collections">Collections</a></li><li id="reference-mapping-html-reference-one" class="toc-item"><a href="reference-mapping.html#reference-one">Reference One</a></li><li id="reference-mapping-html-reference-many" class="toc-item"><a href="reference-mapping.html#reference-many">Reference Many</a></li><li id="reference-mapping-html-mixing-document-types" class="toc-item"><a href="reference-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="reference-mapping-html-storing-references" class="toc-item"><a href="reference-mapping.html#storing-references">Storing References</a></li><li id="reference-mapping-html-cascading-operations" class="toc-item"><a href="reference-mapping.html#cascading-operations">Cascading Operations</a></li><li id="reference-mapping-html-orphan-removal" class="toc-item"><a href="reference-mapping.html#orphan-removal">Orphan Removal</a></li></ul></li><li id="bidirectional-references-html" class="toc-item"><a href="bidirectional-references.html">Bi-Directional References</a><ul><li id="bidirectional-references-html-owning-and-inverse-sides" class="toc-item"><a href="bidirectional-references.html#owning-and-inverse-sides">Owning and Inverse Sides</a><ul><li id="bidirectional-references-html-one-to-many" class="toc-item"><a href="bidirectional-references.html#one-to-many">One to Many</a></li></ul></li><li id="bidirectional-references-html-other-examples" class="toc-item"><a href="bidirectional-references.html#other-examples">Other Examples</a><ul><li id="bidirectional-references-html-one-to-one" class="toc-item"><a href="bidirectional-references.html#one-to-one">One to One</a></li><li id="bidirectional-references-html-self-referencing-many-to-many" class="toc-item"><a href="bidirectional-references.html#self-referencing-many-to-many">Self-Referencing Many to Many</a></li></ul></li></ul></li><li id="complex-references-html" class="toc-item"><a href="complex-references.html">Complex References</a><ul><li id="complex-references-html-basic-example" class="toc-item"><a href="complex-references.html#basic-example">Basic Example</a></li><li id="complex-references-html-criteria-example" class="toc-item"><a href="complex-references.html#criteria-example">criteria Example</a></li><li id="complex-references-html-repositorymethod-example" class="toc-item"><a href="complex-references.html#repositorymethod-example">repositoryMethod Example</a></li></ul></li><li id="indexes-html" class="toc-item"><a href="indexes.html">Indexes</a><ul><li id="indexes-html-index-options" class="toc-item"><a href="indexes.html#index-options">Index Options</a></li><li id="indexes-html-unique-index" class="toc-item"><a href="indexes.html#unique-index">Unique Index</a></li><li id="indexes-html-embedded-indexes" class="toc-item"><a href="indexes.html#embedded-indexes">Embedded Indexes</a></li><li id="indexes-html-geospatial-indexing" class="toc-item"><a href="indexes.html#geospatial-indexing">Geospatial Indexing</a></li><li id="indexes-html-partial-indexes" class="toc-item"><a href="indexes.html#partial-indexes">Partial indexes</a></li></ul></li><li id="inheritance-mapping-html" class="toc-item"><a href="inheritance-mapping.html">Inheritance Mapping</a><ul><li id="inheritance-mapping-html-mapped-superclasses" class="toc-item"><a href="inheritance-mapping.html#mapped-superclasses">Mapped Superclasses</a></li><li id="inheritance-mapping-html-single-collection-inheritance" class="toc-item"><a href="inheritance-mapping.html#single-collection-inheritance">Single Collection Inheritance</a></li><li id="inheritance-mapping-html-collection-per-class-inheritance" class="toc-item"><a href="inheritance-mapping.html#collection-per-class-inheritance">Collection Per Class Inheritance</a></li></ul></li><li id="embedded-mapping-html" class="toc-item"><a href="embedded-mapping.html">Embedded Mapping</a><ul><li id="embedded-mapping-html-embed-one" class="toc-item"><a href="embedded-mapping.html#embed-one">Embed One</a></li><li id="embedded-mapping-html-embed-many" class="toc-item"><a href="embedded-mapping.html#embed-many">Embed Many</a></li><li id="embedded-mapping-html-mixing-document-types" class="toc-item"><a href="embedded-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="embedded-mapping-html-cascading-operations" class="toc-item"><a href="embedded-mapping.html#cascading-operations">Cascading Operations</a></li></ul></li><li id="reference-mapping-html" class="toc-item"><a href="reference-mapping.html">Reference Mapping</a><ul><li id="reference-mapping-html-collections" class="toc-item"><a href="reference-mapping.html#collections">Collections</a></li><li id="reference-mapping-html-reference-one" class="toc-item"><a href="reference-mapping.html#reference-one">Reference One</a></li><li id="reference-mapping-html-reference-many" class="toc-item"><a href="reference-mapping.html#reference-many">Reference Many</a></li><li id="reference-mapping-html-mixing-document-types" class="toc-item"><a href="reference-mapping.html#mixing-document-types">Mixing Document Types</a></li><li id="reference-mapping-html-storing-references" class="toc-item"><a href="reference-mapping.html#storing-references">Storing References</a></li><li id="reference-mapping-html-cascading-operations" class="toc-item"><a href="reference-mapping.html#cascading-operations">Cascading Operations</a></li><li id="reference-mapping-html-orphan-removal" class="toc-item"><a href="reference-mapping.html#orphan-removal">Orphan Removal</a></li></ul></li><li id="trees-html" class="toc-item"><a href="trees.html">Trees</a><ul><li id="trees-html-full-tree-in-single-document" class="toc-item"><a href="trees.html#full-tree-in-single-document">Full Tree in Single Document</a></li><li id="trees-html-parent-reference" class="toc-item"><a href="trees.html#parent-reference">Parent Reference</a></li><li id="trees-html-child-reference" class="toc-item"><a href="trees.html#child-reference">Child Reference</a></li><li id="trees-html-array-of-ancestors" class="toc-item"><a href="trees.html#array-of-ancestors">Array of Ancestors</a></li><li id="trees-html-materialized-paths" class="toc-item"><a href="trees.html#materialized-paths">Materialized Paths</a></li></ul></li><li id="storing-files-with-gridfs-html" class="toc-item"><a href="storing-files-with-gridfs.html">Storing Files with GridFS</a><ul><li id="storing-files-with-gridfs-html-about-gridfs" class="toc-item"><a href="storing-files-with-gridfs.html#about-gridfs">About GridFS</a></li><li id="storing-files-with-gridfs-html-mapping-documents-as-gridfs-files" class="toc-item"><a href="storing-files-with-gridfs.html#mapping-documents-as-gridfs-files">Mapping documents as GridFS files</a></li><li id="storing-files-with-gridfs-html-inserting-files-into-gridfs-buckets" class="toc-item"><a href="storing-files-with-gridfs.html#inserting-files-into-gridfs-buckets">Inserting files into GridFS buckets</a></li><li id="storing-files-with-gridfs-html-reading-files-from-gridfs-buckets" class="toc-item"><a href="storing-files-with-gridfs.html#reading-files-from-gridfs-buckets">Reading files from GridFS buckets</a></li></ul></li><li id="xml-mapping-html" class="toc-item"><a href="xml-mapping.html">XML Mapping</a><ul><li id="xml-mapping-html-simplified-xml-driver" class="toc-item"><a href="xml-mapping.html#simplified-xml-driver">Simplified XML Driver</a><ul><li id="xml-mapping-html-example" class="toc-item"><a href="xml-mapping.html#example">Example</a></li><li id="xml-mapping-html-reference" class="toc-item"><a href="xml-mapping.html#reference">Reference</a></li></ul></li></ul></li><li id="annotations-reference-html" class="toc-item"><a href="annotations-reference.html">Annotations Reference</a><ul><li id="annotations-reference-html-alsoload" class="toc-item"><a href="annotations-reference.html#alsoload">@AlsoLoad</a></li><li id="annotations-reference-html-changetrackingpolicy" class="toc-item"><a href="annotations-reference.html#changetrackingpolicy">@ChangeTrackingPolicy</a></li><li id="annotations-reference-html-defaultdiscriminatorvalue" class="toc-item"><a href="annotations-reference.html#defaultdiscriminatorvalue">@DefaultDiscriminatorValue</a></li><li id="annotations-reference-html-discriminatorfield" class="toc-item"><a href="annotations-reference.html#discriminatorfield">@DiscriminatorField</a></li><li id="annotations-reference-html-discriminatormap" class="toc-item"><a href="annotations-reference.html#discriminatormap">@DiscriminatorMap</a></li><li id="annotations-reference-html-document" class="toc-item"><a href="annotations-reference.html#document">@Document</a></li><li id="annotations-reference-html-embedmany" class="toc-item"><a href="annotations-reference.html#embedmany">@EmbedMany</a></li><li id="annotations-reference-html-embedone" class="toc-item"><a href="annotations-reference.html#embedone">@EmbedOne</a></li><li id="annotations-reference-html-embeddeddocument" class="toc-item"><a href="annotations-reference.html#embeddeddocument">@EmbeddedDocument</a></li><li id="annotations-reference-html-field" class="toc-item"><a href="annotations-reference.html#field">@Field</a></li><li id="annotations-reference-html-file" class="toc-item"><a href="annotations-reference.html#file">@File</a></li><li id="annotations-reference-html-filechunksize" class="toc-item"><a href="annotations-reference.html#filechunksize">@FileChunkSize</a></li><li id="annotations-reference-html-filefilename" class="toc-item"><a href="annotations-reference.html#filefilename">@FileFilename</a></li><li id="annotations-reference-html-filelength" class="toc-item"><a href="annotations-reference.html#filelength">@FileLength</a></li><li id="annotations-reference-html-filemetadata" class="toc-item"><a href="annotations-reference.html#filemetadata">@FileMetadata</a></li><li id="annotations-reference-html-fileuploaddate" class="toc-item"><a href="annotations-reference.html#fileuploaddate">@FileUploadDate</a></li><li id="annotations-reference-html-haslifecyclecallbacks" class="toc-item"><a href="annotations-reference.html#haslifecyclecallbacks">@HasLifecycleCallbacks</a></li><li id="annotations-reference-html-id" class="toc-item"><a href="annotations-reference.html#id">@Id</a></li><li id="annotations-reference-html-index" class="toc-item"><a href="annotations-reference.html#index">@Index</a></li><li id="annotations-reference-html-indexes" class="toc-item"><a href="annotations-reference.html#indexes">@Indexes</a></li><li id="annotations-reference-html-inheritancetype" class="toc-item"><a href="annotations-reference.html#inheritancetype">@InheritanceType</a></li><li id="annotations-reference-html-lock" class="toc-item"><a href="annotations-reference.html#lock">@Lock</a></li><li id="annotations-reference-html-mappedsuperclass" class="toc-item"><a href="annotations-reference.html#mappedsuperclass">@MappedSuperclass</a></li><li id="annotations-reference-html-postload" class="toc-item"><a href="annotations-reference.html#postload">@PostLoad</a></li><li id="annotations-reference-html-postpersist" class="toc-item"><a href="annotations-reference.html#postpersist">@PostPersist</a></li><li id="annotations-reference-html-postremove" class="toc-item"><a href="annotations-reference.html#postremove">@PostRemove</a></li><li id="annotations-reference-html-postupdate" class="toc-item"><a href="annotations-reference.html#postupdate">@PostUpdate</a></li><li id="annotations-reference-html-preflush" class="toc-item"><a href="annotations-reference.html#preflush">@PreFlush</a></li><li id="annotations-reference-html-preload" class="toc-item"><a href="annotations-reference.html#preload">@PreLoad</a></li><li id="annotations-reference-html-prepersist" class="toc-item"><a href="annotations-reference.html#prepersist">@PrePersist</a></li><li id="annotations-reference-html-preremove" class="toc-item"><a href="annotations-reference.html#preremove">@PreRemove</a></li><li id="annotations-reference-html-preupdate" class="toc-item"><a href="annotations-reference.html#preupdate">@PreUpdate</a></li><li id="annotations-reference-html-readpreference" class="toc-item"><a href="annotations-reference.html#readpreference">@ReadPreference</a></li><li id="annotations-reference-html-referencemany" class="toc-item"><a href="annotations-reference.html#referencemany">@ReferenceMany</a></li><li id="annotations-reference-html-referenceone" class="toc-item"><a href="annotations-reference.html#referenceone">@ReferenceOne</a></li><li id="annotations-reference-html-shardkey" class="toc-item"><a href="annotations-reference.html#shardkey">@ShardKey</a></li><li id="annotations-reference-html-uniqueindex" class="toc-item"><a href="annotations-reference.html#uniqueindex">@UniqueIndex</a></li><li id="annotations-reference-html-version" class="toc-item"><a href="annotations-reference.html#version">@Version</a></li></ul></li><li id="metadata-drivers-html" class="toc-item"><a href="metadata-drivers.html">Metadata Drivers</a><ul><li id="metadata-drivers-html-core-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#core-metadata-drivers">Core Metadata Drivers</a></li><li id="metadata-drivers-html-implementing-metadata-drivers" class="toc-item"><a href="metadata-drivers.html#implementing-metadata-drivers">Implementing Metadata Drivers</a></li><li id="metadata-drivers-html-classmetadata" class="toc-item"><a href="metadata-drivers.html#classmetadata">ClassMetadata</a></li><li id="metadata-drivers-html-getting-classmetadata-instances" class="toc-item"><a href="metadata-drivers.html#getting-classmetadata-instances">Getting ClassMetadata Instances</a></li></ul></li><li id="working-with-objects-html" class="toc-item"><a href="working-with-objects.html">Working with Objects</a><ul><li id="working-with-objects-html-understanding" class="toc-item"><a href="working-with-objects.html#understanding">Understanding</a><ul><li id="working-with-objects-html-the-size-of-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#the-size-of-a-unit-of-work">The size of a Unit of Work</a></li><li id="working-with-objects-html-the-cost-of-flush" class="toc-item"><a href="working-with-objects.html#the-cost-of-flush">The cost of flush()</a></li><li id="working-with-objects-html-direct-access-to-a-unit-of-work" class="toc-item"><a href="working-with-objects.html#direct-access-to-a-unit-of-work">Direct access to a Unit of Work</a></li></ul></li><li id="working-with-objects-html-persisting-documents" class="toc-item"><a href="working-with-objects.html#persisting-documents">Persisting documents</a></li><li id="working-with-objects-html-flush-options" class="toc-item"><a href="working-with-objects.html#flush-options">Flush Options</a></li><li id="working-with-objects-html-removing-documents" class="toc-item"><a href="working-with-objects.html#removing-documents">Removing documents</a></li><li id="working-with-objects-html-detaching-documents" class="toc-item"><a href="working-with-objects.html#detaching-documents">Detaching documents</a></li><li id="working-with-objects-html-merging-documents" class="toc-item"><a href="working-with-objects.html#merging-documents">Merging documents</a></li><li id="working-with-objects-html-references" class="toc-item"><a href="working-with-objects.html#references">References</a></li><li id="working-with-objects-html-establishing-references" class="toc-item"><a href="working-with-objects.html#establishing-references">Establishing References</a></li><li id="working-with-objects-html-removing-references" class="toc-item"><a href="working-with-objects.html#removing-references">Removing References</a></li><li id="working-with-objects-html-transitive-persistence" class="toc-item"><a href="working-with-objects.html#transitive-persistence">Transitive persistence</a></li><li id="working-with-objects-html-querying" class="toc-item"><a href="working-with-objects.html#querying">Querying</a><ul><li id="working-with-objects-html-by-primary-key" class="toc-item"><a href="working-with-objects.html#by-primary-key">By Primary Key</a></li><li id="working-with-objects-html-by-simple-conditions" class="toc-item"><a href="working-with-objects.html#by-simple-conditions">By Simple Conditions</a></li><li id="working-with-objects-html-by-lazy-loading" class="toc-item"><a href="working-with-objects.html#by-lazy-loading">By Lazy Loading</a></li><li id="working-with-objects-html-by-query-builder-objects" class="toc-item"><a href="working-with-objects.html#by-query-builder-objects">By Query Builder Objects</a></li><li id="working-with-objects-html-by-reference" class="toc-item"><a href="working-with-objects.html#by-reference">By Reference</a></li></ul></li></ul></li><li id="document-repositories-html" class="toc-item"><a href="document-repositories.html">Document Repositories</a><ul><li id="document-repositories-html-custom-repositories" class="toc-item"><a href="document-repositories.html#custom-repositories">Custom Repositories</a></li><li id="document-repositories-html-repositories-with-additional-dependencies" class="toc-item"><a href="document-repositories.html#repositories-with-additional-dependencies">Repositories with Additional Dependencies</a></li></ul></li><li id="events-html" class="toc-item"><a href="events.html">Events</a><ul><li id="events-html-the-event-system" class="toc-item"><a href="events.html#the-event-system">The Event System</a></li><li id="events-html-lifecycle-events" class="toc-item"><a href="events.html#lifecycle-events">Lifecycle Events</a></li><li id="events-html-lifecycle-callbacks" class="toc-item"><a href="events.html#lifecycle-callbacks">Lifecycle Callbacks</a></li><li id="events-html-listening-to-lifecycle-events" class="toc-item"><a href="events.html#listening-to-lifecycle-events">Listening to Lifecycle Events</a></li><li id="events-html-implementing-event-listeners" class="toc-item"><a href="events.html#implementing-event-listeners">Implementing Event Listeners</a><ul><li id="events-html-prepersist" class="toc-item"><a href="events.html#prepersist">prePersist</a></li><li id="events-html-preload" class="toc-item"><a href="events.html#preload">preLoad</a></li><li id="events-html-postload" class="toc-item"><a href="events.html#postload">postLoad</a></li><li id="events-html-preremove" class="toc-item"><a href="events.html#preremove">preRemove</a></li><li id="events-html-preflush" class="toc-item"><a href="events.html#preflush">preFlush</a></li><li id="events-html-onflush" class="toc-item"><a href="events.html#onflush">onFlush</a></li><li id="events-html-postflush" class="toc-item"><a href="events.html#postflush">postFlush</a></li><li id="events-html-preupdate" class="toc-item"><a href="events.html#preupdate">preUpdate</a></li><li id="events-html-onclear" class="toc-item"><a href="events.html#onclear">onClear</a></li><li id="events-html-documentnotfound" class="toc-item"><a href="events.html#documentnotfound">documentNotFound</a></li><li id="events-html-postupdate-postremove-postpersist" class="toc-item"><a href="events.html#postupdate-postremove-postpersist">postUpdate, postRemove, postPersist</a></li><li id="events-html-postcollectionload" class="toc-item"><a href="events.html#postcollectionload">postCollectionLoad</a></li></ul></li><li id="events-html-load-classmetadata-event" class="toc-item"><a href="events.html#load-classmetadata-event">Load ClassMetadata Event</a></li></ul></li><li id="migrating-schemas-html" class="toc-item"><a href="migrating-schemas.html">Migrating Schemas</a><ul><li id="migrating-schemas-html-renaming-a-field" class="toc-item"><a href="migrating-schemas.html#renaming-a-field">Renaming a Field</a></li><li id="migrating-schemas-html-transforming-data" class="toc-item"><a href="migrating-schemas.html#transforming-data">Transforming Data</a></li><li id="migrating-schemas-html-moving-fields" class="toc-item"><a href="migrating-schemas.html#moving-fields">Moving Fields</a></li></ul></li><li id="query-builder-api-html" class="toc-item"><a href="query-builder-api.html">Query Builder API</a><ul><li id="query-builder-api-html-finding-documents" class="toc-item"><a href="query-builder-api.html#finding-documents">Finding Documents</a></li><li id="query-builder-api-html-creating-a-query-builder" class="toc-item"><a href="query-builder-api.html#creating-a-query-builder">Creating a Query Builder</a><ul><li id="query-builder-api-html-executing-queries" class="toc-item"><a href="query-builder-api.html#executing-queries">Executing Queries</a></li><li id="query-builder-api-html-debugging-queries" class="toc-item"><a href="query-builder-api.html#debugging-queries">Debugging Queries</a></li><li id="query-builder-api-html-getting-single-result" class="toc-item"><a href="query-builder-api.html#getting-single-result">Getting Single Result</a></li><li id="query-builder-api-html-selecting-fields" class="toc-item"><a href="query-builder-api.html#selecting-fields">Selecting Fields</a></li><li id="query-builder-api-html-index-hints" class="toc-item"><a href="query-builder-api.html#index-hints">Index hints</a></li><li id="query-builder-api-html-selecting-distinct-values" class="toc-item"><a href="query-builder-api.html#selecting-distinct-values">Selecting Distinct Values</a></li><li id="query-builder-api-html-refreshing-documents" class="toc-item"><a href="query-builder-api.html#refreshing-documents">Refreshing Documents</a></li><li id="query-builder-api-html-fetching-documents-as-read-only" class="toc-item"><a href="query-builder-api.html#fetching-documents-as-read-only">Fetching Documents as Read-Only</a></li><li id="query-builder-api-html-disabling-hydration" class="toc-item"><a href="query-builder-api.html#disabling-hydration">Disabling Hydration</a></li><li id="query-builder-api-html-limiting-results" class="toc-item"><a href="query-builder-api.html#limiting-results">Limiting Results</a></li><li id="query-builder-api-html-sorting-results" class="toc-item"><a href="query-builder-api.html#sorting-results">Sorting Results</a></li><li id="query-builder-api-html-conditional-operators" class="toc-item"><a href="query-builder-api.html#conditional-operators">Conditional Operators</a></li><li id="query-builder-api-html-text-search" class="toc-item"><a href="query-builder-api.html#text-search">Text Search</a></li><li id="query-builder-api-html-update-queries" class="toc-item"><a href="query-builder-api.html#update-queries">Update Queries</a></li></ul></li><li id="query-builder-api-html-updating-multiple-documents" class="toc-item"><a href="query-builder-api.html#updating-multiple-documents">Updating multiple documents</a></li><li id="query-builder-api-html-modifier-operations" class="toc-item"><a href="query-builder-api.html#modifier-operations">Modifier Operations</a></li><li id="query-builder-api-html-remove-queries" class="toc-item"><a href="query-builder-api.html#remove-queries">Remove Queries</a></li></ul></li><li id="aggregation-builder-html" class="toc-item"><a href="aggregation-builder.html">Aggregation builder</a><ul><li id="aggregation-builder-html-creating-an-aggregation-builder" class="toc-item"><a href="aggregation-builder.html#creating-an-aggregation-builder">Creating an Aggregation Builder</a><ul><li id="aggregation-builder-html-adding-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#adding-pipeline-stages">Adding pipeline stages</a></li><li id="aggregation-builder-html-nesting-expressions" class="toc-item"><a href="aggregation-builder.html#nesting-expressions">Nesting expressions</a></li><li id="aggregation-builder-html-executing-an-aggregation-pipeline" class="toc-item"><a href="aggregation-builder.html#executing-an-aggregation-pipeline">Executing an aggregation pipeline</a></li><li id="aggregation-builder-html-hydration" class="toc-item"><a href="aggregation-builder.html#hydration">Hydration</a></li></ul></li><li id="aggregation-builder-html-aggregation-pipeline-stages" class="toc-item"><a href="aggregation-builder.html#aggregation-pipeline-stages">Aggregation pipeline stages</a><ul><li id="aggregation-builder-html-addfields" class="toc-item"><a href="aggregation-builder.html#addfields">$addFields</a></li><li id="aggregation-builder-html-bucket" class="toc-item"><a href="aggregation-builder.html#bucket">$bucket</a></li><li id="aggregation-builder-html-bucketauto" class="toc-item"><a href="aggregation-builder.html#bucketauto">$bucketAuto</a></li><li id="aggregation-builder-html-collstats" class="toc-item"><a href="aggregation-builder.html#collstats">$collStats</a></li><li id="aggregation-builder-html-count" class="toc-item"><a href="aggregation-builder.html#count">$count</a></li><li id="aggregation-builder-html-facet" class="toc-item"><a href="aggregation-builder.html#facet">$facet</a></li><li id="aggregation-builder-html-geonear" class="toc-item"><a href="aggregation-builder.html#geonear">$geoNear</a></li><li id="aggregation-builder-html-graphlookup" class="toc-item"><a href="aggregation-builder.html#graphlookup">$graphLookup</a></li><li id="aggregation-builder-html-group" class="toc-item"><a href="aggregation-builder.html#group">$group</a></li><li id="aggregation-builder-html-indexstats" class="toc-item"><a href="aggregation-builder.html#indexstats">$indexStats</a></li><li id="aggregation-builder-html-lookup" class="toc-item"><a href="aggregation-builder.html#lookup">$lookup</a></li><li id="aggregation-builder-html-match" class="toc-item"><a href="aggregation-builder.html#match">$match</a></li><li id="aggregation-builder-html-out" class="toc-item"><a href="aggregation-builder.html#out">$out</a></li><li id="aggregation-builder-html-project" class="toc-item"><a href="aggregation-builder.html#project">$project</a></li><li id="aggregation-builder-html-redact" class="toc-item"><a href="aggregation-builder.html#redact">$redact</a></li><li id="aggregation-builder-html-replaceroot" class="toc-item"><a href="aggregation-builder.html#replaceroot">$replaceRoot</a></li><li id="aggregation-builder-html-sample" class="toc-item"><a href="aggregation-builder.html#sample">$sample</a></li><li id="aggregation-builder-html-sort-limit-and-skip" class="toc-item"><a href="aggregation-builder.html#sort-limit-and-skip">$sort, $limit and $skip</a></li><li id="aggregation-builder-html-sortbycount" class="toc-item"><a href="aggregation-builder.html#sortbycount">$sortByCount</a></li><li id="aggregation-builder-html-unwind" class="toc-item"><a href="aggregation-builder.html#unwind">$unwind</a></li></ul></li></ul></li><li id="geospatial-queries-html" class="toc-item"><a href="geospatial-queries.html">Geospatial Queries</a><ul><li id="geospatial-queries-html-mapping" class="toc-item"><a href="geospatial-queries.html#mapping">Mapping</a></li><li id="geospatial-queries-html-near-query" class="toc-item"><a href="geospatial-queries.html#near-query">Near Query</a></li></ul></li><li id="find-and-update-html" class="toc-item"><a href="find-and-update.html">Find and Modify</a><ul><li id="find-and-update-html-update" class="toc-item"><a href="find-and-update.html#update">Update</a></li><li id="find-and-update-html-remove" class="toc-item"><a href="find-and-update.html#remove">Remove</a></li></ul></li><li id="upserting-documents-html" class="toc-item"><a href="upserting-documents.html">Upserting Documents</a></li><li id="filters-html" class="toc-item"><a href="filters.html">Filters</a><ul><li id="filters-html-example-filter-class" class="toc-item"><a href="filters.html#example-filter-class">Example filter class</a></li><li id="filters-html-configuration" class="toc-item"><a href="filters.html#configuration">Configuration</a></li><li id="filters-html-disabling-enabling-filters-and-setting-parameters" class="toc-item"><a href="filters.html#disabling-enabling-filters-and-setting-parameters">Disabling/Enabling Filters and Setting Parameters</a></li></ul></li><li id="priming-references-html-priming-references" class="toc-item"><a href="priming-references.html#priming-references">Priming References</a><ul><li id="priming-references-html-query-builder" class="toc-item"><a href="priming-references.html#query-builder">Query Builder</a></li><li id="priming-references-html-inverse-references" class="toc-item"><a href="priming-references.html#inverse-references">Inverse references</a></li><li id="priming-references-html-primer-callback" class="toc-item"><a href="priming-references.html#primer-callback">Primer Callback</a></li></ul></li><li id="capped-collections-html" class="toc-item"><a href="capped-collections.html">Capped Collections</a><ul><li id="capped-collections-html-mapping" class="toc-item"><a href="capped-collections.html#mapping">Mapping</a></li><li id="capped-collections-html-creating" class="toc-item"><a href="capped-collections.html#creating">Creating</a></li></ul></li><li id="storage-strategies-html" class="toc-item"><a href="storage-strategies.html">Storage Strategies</a><ul><li id="storage-strategies-html-increment" class="toc-item"><a href="storage-strategies.html#increment">increment</a></li><li id="storage-strategies-html-addtoset" class="toc-item"><a href="storage-strategies.html#addtoset">addToSet</a></li><li id="storage-strategies-html-set" class="toc-item"><a href="storage-strategies.html#set">set</a></li><li id="storage-strategies-html-setarray" class="toc-item"><a href="storage-strategies.html#setarray">setArray</a></li><li id="storage-strategies-html-pushall" class="toc-item"><a href="storage-strategies.html#pushall">pushAll</a></li><li id="storage-strategies-html-atomicset" class="toc-item"><a href="storage-strategies.html#atomicset">atomicSet</a></li><li id="storage-strategies-html-atomicsetarray" class="toc-item"><a href="storage-strategies.html#atomicsetarray">atomicSetArray</a></li></ul></li><li id="custom-collections-html" class="toc-item"><a href="custom-collections.html">Custom Collections</a><ul><li id="custom-collections-html-custom-collection-classes" class="toc-item"><a href="custom-collections.html#custom-collection-classes">Custom Collection Classes</a></li><li id="custom-collections-html-taking-control-of-the-collection-s-constructor" class="toc-item"><a href="custom-collections.html#taking-control-of-the-collection-s-constructor">Taking Control of the Collection's Constructor</a></li></ul></li><li id="sharding-html" class="toc-item"><a href="sharding.html">Sharding</a></li><li id="transactions-and-concurrency-html" class="toc-item"><a href="transactions-and-concurrency.html">Transactions and Concurrency</a><ul><li id="transactions-and-concurrency-html-transactions" class="toc-item"><a href="transactions-and-concurrency.html#transactions">Transactions</a><ul><li id="transactions-and-concurrency-html-limitation" class="toc-item"><a href="transactions-and-concurrency.html#limitation">Limitation</a></li><li id="transactions-and-concurrency-html-workaround" class="toc-item"><a href="transactions-and-concurrency.html#workaround">Workaround</a></li></ul></li><li id="transactions-and-concurrency-html-concurrency" class="toc-item"><a href="transactions-and-concurrency.html#concurrency">Concurrency</a><ul><li id="transactions-and-concurrency-html-optimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#optimistic-locking">Optimistic Locking</a></li><li id="transactions-and-concurrency-html-pessimistic-locking" class="toc-item"><a href="transactions-and-concurrency.html#pessimistic-locking">Pessimistic Locking</a></li></ul></li></ul></li><li id="best-practices-html" class="toc-item"><a href="best-practices.html">Best Practices</a><ul><li id="best-practices-html-constrain-relationships-as-much-as-possible" class="toc-item"><a href="best-practices.html#constrain-relationships-as-much-as-possible">Constrain relationships as much as possible</a></li><li id="best-practices-html-use-events-judiciously" class="toc-item"><a href="best-practices.html#use-events-judiciously">Use events judiciously</a></li><li id="best-practices-html-use-cascades-judiciously" class="toc-item"><a href="best-practices.html#use-cascades-judiciously">Use cascades judiciously</a></li><li id="best-practices-html-don-t-use-special-characters" class="toc-item"><a href="best-practices.html#don-t-use-special-characters">Don't use special characters</a></li><li id="best-practices-html-initialize-collections-in-the-constructor" class="toc-item"><a href="best-practices.html#initialize-collections-in-the-constructor">Initialize collections in the constructor</a></li></ul></li><li id="change-tracking-policies-html" class="toc-item"><a href="change-tracking-policies.html">Change Tracking Policies</a><ul><li id="change-tracking-policies-html-deferred-implicit" class="toc-item"><a href="change-tracking-policies.html#deferred-implicit">Deferred Implicit</a></li><li id="change-tracking-policies-html-deferred-explicit" class="toc-item"><a href="change-tracking-policies.html#deferred-explicit">Deferred Explicit</a></li><li id="change-tracking-policies-html-notify" class="toc-item"><a href="change-tracking-policies.html#notify">Notify</a></li></ul></li></ul></div>
</div>
<div class="toc-section"><h2 class="toc-header">Cookbook</h2>
<div class="toc"><ul><li id="cookbook-blending-orm-and-mongodb-odm-html" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html">Blending the ORM and MongoDB ODM</a><ul><li id="cookbook-blending-orm-and-mongodb-odm-html-define-product" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-product">Define Product</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-define-entity" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#define-entity">Define Entity</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-event-subscriber" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#event-subscriber">Event Subscriber</a></li><li id="cookbook-blending-orm-and-mongodb-odm-html-working-with-products-and-orders" class="toc-item"><a href="../cookbook/blending-orm-and-mongodb-odm.html#working-with-products-and-orders">Working with Products and Orders</a></li></ul></li><li id="cookbook-implementing-array-access-for-domain-objects-html" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html">Implementing ArrayAccess for Domain Objects</a><ul><li id="cookbook-implementing-array-access-for-domain-objects-html-option-1" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-1">Option 1</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-option-2" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#option-2">Option 2</a></li><li id="cookbook-implementing-array-access-for-domain-objects-html-read-only" class="toc-item"><a href="../cookbook/implementing-array-access-for-domain-objects.html#read-only">Read-only</a></li></ul></li><li id="cookbook-implementing-the-notify-changetracking-policy-html" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html">Implementing the Notify ChangeTracking Policy</a><ul><li id="cookbook-implementing-the-notify-changetracking-policy-html-implementing-notifypropertychanged" class="toc-item"><a href="../cookbook/implementing-the-notify-changetracking-policy.html#implementing-notifypropertychanged">Implementing NotifyPropertyChanged</a></li></ul></li><li id="cookbook-implementing-wakeup-or-clone-html" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html">Implementing Wakeup or Clone</a><ul><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-wakeup" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-wakeup">Safely implementing __wakeup</a></li><li id="cookbook-implementing-wakeup-or-clone-html-safely-implementing-clone" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#safely-implementing-clone">Safely implementing __clone</a></li><li id="cookbook-implementing-wakeup-or-clone-html-summary" class="toc-item"><a href="../cookbook/implementing-wakeup-or-clone.html#summary">Summary</a></li></ul></li><li id="cookbook-mapping-classes-to-orm-and-odm-html" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html">Mapping Classes to the ORM and ODM</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-test-subject" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#test-subject">Test Subject</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mapping-information" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mapping-information">Mapping Information</a><ul><li id="cookbook-mapping-classes-to-orm-and-odm-html-orm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#orm">ORM</a></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-mongodb-odm" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#mongodb-odm">MongoDB ODM</a></li></ul></li><li id="cookbook-mapping-classes-to-orm-and-odm-html-repository-classes" class="toc-item"><a href="../cookbook/mapping-classes-to-orm-and-odm.html#repository-classes">Repository Classes</a></li></ul></li><li id="cookbook-resolve-target-document-listener-html" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html">Keeping Your Modules Independent</a><ul><li id="cookbook-resolve-target-document-listener-html-background" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#background">Background</a></li><li id="cookbook-resolve-target-document-listener-html-configuration" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#configuration">Configuration</a></li><li id="cookbook-resolve-target-document-listener-html-final-thoughts" class="toc-item"><a href="../cookbook/resolve-target-document-listener.html#final-thoughts">Final Thoughts</a></li></ul></li><li id="cookbook-simple-search-engine-html" class="toc-item"><a href="../cookbook/simple-search-engine.html">Simple Search Engine</a><ul><li id="cookbook-simple-search-engine-html-sample-model-product" class="toc-item"><a href="../cookbook/simple-search-engine.html#sample-model-product">Sample Model: Product</a></li><li id="cookbook-simple-search-engine-html-working-with-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#working-with-keywords">Working with Keywords</a></li><li id="cookbook-simple-search-engine-html-searching-keywords" class="toc-item"><a href="../cookbook/simple-search-engine.html#searching-keywords">Searching Keywords</a><ul><li id="cookbook-simple-search-engine-html-user-input" class="toc-item"><a href="../cookbook/simple-search-engine.html#user-input">User Input</a></li></ul></li><li id="cookbook-simple-search-engine-html-embedded-documents" class="toc-item"><a href="../cookbook/simple-search-engine.html#embedded-documents">Embedded Documents</a><ul><li id="cookbook-simple-search-engine-html-definition" class="toc-item"><a href="../cookbook/simple-search-engine.html#definition">Definition</a></li></ul></li></ul></li><li id="cookbook-soft-delete-extension-html" class="toc-item"><a href="../cookbook/soft-delete-extension.html">Soft Delete Extension</a><ul><li id="cookbook-soft-delete-extension-html-installation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#installation">Installation</a></li><li id="cookbook-soft-delete-extension-html-setup" class="toc-item"><a href="../cookbook/soft-delete-extension.html#setup">Setup</a></li><li id="cookbook-soft-delete-extension-html-softdeleteable-interface" class="toc-item"><a href="../cookbook/soft-delete-extension.html#softdeleteable-interface">SoftDeleteable Interface</a></li><li id="cookbook-soft-delete-extension-html-example-implementation" class="toc-item"><a href="../cookbook/soft-delete-extension.html#example-implementation">Example Implementation</a></li><li id="cookbook-soft-delete-extension-html-usage" class="toc-item"><a href="../cookbook/soft-delete-extension.html#usage">Usage</a></li><li id="cookbook-soft-delete-extension-html-events" class="toc-item"><a href="../cookbook/soft-delete-extension.html#events">Events</a></li><li id="cookbook-soft-delete-extension-html-cascading-soft-deletes" class="toc-item"><a href="../cookbook/soft-delete-extension.html#cascading-soft-deletes">Cascading Soft Deletes</a></li></ul></li><li id="cookbook-validation-of-documents-html" class="toc-item"><a href="../cookbook/validation-of-documents.html">Validation of Documents</a></li></ul></div>
</div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "MongoDB ODM",
            "item": "https://www.doctrine-project.org/projects/mongodb-odm.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.0/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Priming References",
            "item": "https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.0/reference/priming-references.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine-mongodb-odm/en/2.0/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Priming References</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>You are browsing a version that is no longer maintained.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-mongodb-odm/en/2.0/reference/priming-references.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        2.0.6
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/latest/reference/priming-references.html">
                                                        2.9

                                                        
                                                                                                                    (upcoming)
                                                                                                            </a>
                                                                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.8/reference/priming-references.html">
                                                        2.8.1

                                                                                                                    (current)
                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.7/reference/priming-references.html">2.7</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.6/reference/priming-references.html">2.6</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.5/reference/priming-references.html">2.5</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.4/reference/priming-references.html">2.4</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.3/reference/priming-references.html">2.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.2/reference/priming-references.html">2.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/2.1/reference/priming-references.html">2.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item active" href="/projects/doctrine-mongodb-odm/en/2.0/reference/priming-references.html">2.0</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.3/reference/priming-references.html">1.3</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.2/reference/priming-references.html">1.2</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.1/reference/priming-references.html">1.1</a>
                                                                                                                                                                                                
                                                    <a class="dropdown-item" href="/projects/doctrine-mongodb-odm/en/1.0/reference/priming-references.html">1.0</a>
                                                                                                                                                                        </div>
                                </div>
                            
                            
<div class="section"><a class="section-anchor" id="priming-references" name="priming-references"></a><h1 class="section-header"><a href="#priming-references">Priming References<i class="fas fa-link"></i></a></h1>
<p>Priming references allows you to consolidate database queries when working with
<a href="reference-mapping.html#reference_one">one</a> and <a href="reference-mapping.html#reference_many">many</a> reference mappings.
This is useful for avoiding the
<a href="http://stackoverflow.com/q/97197/162228">n+1 problem</a> in your application.</p>
<div class="section"><a class="section-anchor" id="query-builder" name="query-builder"></a><h2 class="section-header"><a href="#query-builder">Query Builder<i class="fas fa-link"></i></a></h2>
<p>Consider the following abbreviated model:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9a48093d8c2e5afee72fdcc377561baca4f0ef75"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9a48093d8c2e5afee72fdcc377561baca4f0ef75"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-1" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@ReferenceMany</span>(targetDocument=Account::class) */</span>
    <span class="hljs-keyword">private</span> $accounts;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-2" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-3" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-4" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-5" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-6" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-7" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-8" class="line-number-anchor" /><a href="#line-number-9a48093d8c2e5afee72fdcc377561baca4f0ef75-8">8</a></td></tr></table></div></code></pre>
<p>We would like to query for 100 users and then iterate over their referenced
accounts.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="d1cb1abaea507bdd71b028de55ee8edb2e15450b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="d1cb1abaea507bdd71b028de55ee8edb2e15450b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-1" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-1">1</a></td><td class="code-line" rowspan="16"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;limit(<span class="hljs-number">100</span>);
$query = $qb-&gt;getQuery();
$users = $query-&gt;execute();

<span class="hljs-keyword">foreach</span> ($users <span class="hljs-keyword">as</span> $user) {
    <span class="hljs-comment">/* PersistentCollection::initialize() will be invoked when we begin
     * iterating through the user's accounts. Any accounts not already
     * managed by the unit of work will need to be queried.
     */</span>
    <span class="hljs-keyword">foreach</span> ($user-&gt;getAccounts() <span class="hljs-keyword">as</span> $account) {
        <span class="hljs-comment">// ...</span>
    }
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-2" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-3" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-4" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-5" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-6" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-7" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-8" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-9" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-10" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-11" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-12" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-13" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-14" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-15" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-16" class="line-number-anchor" /><a href="#line-number-d1cb1abaea507bdd71b028de55ee8edb2e15450b-16">16</a></td></tr></table></div></code></pre>
<p>In this example, ODM would query the database once for the result set of users
and then, for each user, issue a separate query to load any accounts that are
not already being managed by the unit of work. This could result in as many as
100 additional database queries!</p>
<p>If we expect to iterate through all users and their accounts, we could optimize
this process by loading all of the referenced accounts with one query. The query
builder's <code>prime()</code> method allows us to do just that.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="968fc478fc610a315c391d09ee41d2595439a945"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="968fc478fc610a315c391d09ee41d2595439a945"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-1" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-1">1</a></td><td class="code-line" rowspan="20"><span class="hljs-meta">&lt;?php</span>

$qb = $dm-&gt;createQueryBuilder(User::class)
    -&gt;field(<span class="hljs-string">'accounts'</span>)-&gt;prime(<span class="hljs-keyword">true</span>)
    -&gt;limit(<span class="hljs-number">100</span>);
$query = $qb-&gt;getQuery();

<span class="hljs-comment">/* After querying for the users, ODM will collect the IDs of all referenced
 * accounts and load them with a single additional query.
 */</span>
$users = $query-&gt;execute();

<span class="hljs-keyword">foreach</span> ($users <span class="hljs-keyword">as</span> $user) {
    <span class="hljs-comment">/* Accounts have already been loaded, so iterating through accounts will
     * not query an additional query.
     */</span>
    <span class="hljs-keyword">foreach</span> ($user-&gt;getAccounts() <span class="hljs-keyword">as</span> $account) {

    }
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-2" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-3" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-4" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-5" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-6" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-7" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-8" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-9" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-10" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-11" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-12" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-13" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-14" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-15" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-16" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-17" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-18" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-18">18</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-19" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-19">19</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-968fc478fc610a315c391d09ee41d2595439a945-20" class="line-number-anchor" /><a href="#line-number-968fc478fc610a315c391d09ee41d2595439a945-20">20</a></td></tr></table></div></code></pre>
<p>In this case, priming will allow us to load all users and referenced accounts in
two database queries. If the accounts had used an
<a href="inheritance-mapping.html#inheritance_mapping">inheritance mapping</a>, priming might require several
queries (one per discriminated class name).</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Priming is also compatible with <a href="reference-mapping.html#storing_references">ID references</a>
and discriminated references. When priming discriminated references, ODM
will issue one query per distinct class among the referenced document(s).</p>
</td></tr></table></div>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Hydration must be enabled in the query builder for priming to work properly.
Disabling hydration will cause the DBRef to be returned for a referenced
document instead of the hydrated document object.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="inverse-references" name="inverse-references"></a><h2 class="section-header"><a href="#inverse-references">Inverse references<i class="fas fa-link"></i></a></h2>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>This feature was added in version 1.2.</p>
</td></tr></table></div>
<p>When using inverse references (references mapped using <code>mappedBy</code> or
<code>repositoryMethod</code>) you can also enable primers on one-to-many references by
specifying them in the mapping:</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="bafaa20f1cffa990990a1e05c7469b37781f065d"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="bafaa20f1cffa990990a1e05c7469b37781f065d"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-1" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">/** <span class="hljs-doctag">@Document</span> */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@ReferenceMany</span>(targetDocument=Account::class, prime={"user"}) */</span>
    <span class="hljs-keyword">private</span> $accounts;
}</td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-2" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-3" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-4" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-5" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-6" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-7" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-8" class="line-number-anchor" /><a href="#line-number-bafaa20f1cffa990990a1e05c7469b37781f065d-8">8</a></td></tr></table></div></code></pre>
<p>When the collection is initialized, the configured primers are automatically
added to the query.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>When using inverse references with <code>repositoryMethod</code>, any primers you
might have added in the <code>repositoryMethod</code> are overwritten with those
specified in the mapping.</p>
</td></tr></table></div>
</div>
<div class="section"><a class="section-anchor" id="primer-callback" name="primer-callback"></a><h2 class="section-header"><a href="#primer-callback">Primer Callback<i class="fas fa-link"></i></a></h2>
<p>Passing <code>true</code> to <code>prime()</code> instructs ODM to load the referenced document(s)
on its own; however, we can also pass a custom callable (e.g. Closure instance)
to <code>prime()</code>, which allows more control over the priming query.</p>
<p>As an example, we can look at the default callable, which is found in the
<code>ReferencePrimer</code> class.</p>
<pre class="code-block-table"><code class="php"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-1" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-1">1</a></td><td class="code-line" rowspan="18"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(DocumentManager $dm, ClassMetadata $class, array $ids, array $hints)</span> : <span class="hljs-title">void</span> </span>{
    <span class="hljs-keyword">if</span> ($class-&gt;identifier === <span class="hljs-keyword">null</span>) {
        <span class="hljs-keyword">return</span>;
    }

    $qb = $dm-&gt;createQueryBuilder($class-&gt;name)
        -&gt;field($class-&gt;identifier)-&gt;in($ids);

    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>($hints[Query::HINT_READ_PREFERENCE])) {
        $qb-&gt;setReadPreference($hints[Query::HINT_READ_PREFERENCE]);
    }

    $iterator = $qb-&gt;getQuery()-&gt;execute();
    assert($iterator <span class="hljs-keyword">instanceof</span> Iterator);
    $iterator-&gt;toArray();
};</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-2" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-3" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-4" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-5" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-6" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-7" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-8" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-9" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-10" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-11" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-12" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-13" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-14" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-15" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-16" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-17" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-18" class="line-number-anchor" /><a href="#line-number-7fe4d61514ada9c0acde8974b41b4fe8ef3a0f09-18">18</a></td></tr></table></div></code></pre>
<p>Firstly, the callable is passed the <code>DocumentManager</code> of the main query. This
is necessary to create the query used for priming, and ensures that the results
will become managed in the same scope. The <code>ClassMetadata</code> argument provides
mapping information for the referenced class as well as its name, which is used
to create the query builder. An array of identifiers follows, which is used to
query for the documents to be primed. Lastly, the <code>UnitOfWork</code> hints from the
original query are provided so that the priming query can apply them as well.</p>

</div>
</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?ff3b61"
                            integrity="sha384-N2Oz1dttUU0TaVXAlk6POyhAwbZkGGv8eoZIiydnHJOew7MFr46LOksoWc9U9rdU"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'mongodb-odm';
            var versionSlug = '2.0';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search MongoDB ODM 2.0'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
