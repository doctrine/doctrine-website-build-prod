<!DOCTYPE html>
<html>
    <head>
        <title>DQL: Doctrine Query Language - Doctrine Doctrine1 ORM (Doctrine1)</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Doctrine1 ORM Documentation: DQL: Doctrine Query Language ">

        <meta name="keywords" content="php,doctrine1,orm,database,documentation,dql:,doctrine,query,language">

                    <meta name="robots" content="index, follow">
        
        
                    <link rel="canonical" href="https://www.doctrine-project.org/projects/doctrine1/en/latest/manual/dql-doctrine-query-language.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://www.doctrine-project.org/frontend/css/index.css?f35337"
                        integrity="sha384-30C2W4aoxQYq0lTM6l53Z8KI97otIpXGpfX9wKukTMo6BxBraB+P/RrwRs7skVdI"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://www.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://www.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://www.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://www.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://www.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://www.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://www.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://www.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.doctrine-project.org/projects/doctrine1/en/latest/manual/dql-doctrine-query-language.html" />
        <meta property="og:title" content="DQL: Doctrine Query Language - Doctrine Doctrine1 ORM (Doctrine1)" />
        <meta property="og:description" content="Doctrine Doctrine1 ORM Documentation: DQL: Doctrine Query Language " />
        <meta property="og:image" content="https://www.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://www.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://www.doctrine-project.org",
            "logo": "https://www.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://www.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://www.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://www.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Doctrine1 ORM",
            "description": "DQL: Doctrine Query Language",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://www.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://www.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/reflection.html">Reflection</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/rst-parser.html">RST Parser</a>
                                                                    <a class="dropdown-item notranslate" href="/projects/skeleton-mapper.html">Skeleton Mapper</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/team/maintainers.html">Maintainers</a>
                                <a class="dropdown-item" href="/team/contributors.html">Contributors</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/events.html">Events</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/consulting.html">Consulting</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/doctrine1/edit/master/docs/en/manual/dql-doctrine-query-language.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://www.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        <div class="toc"><ul><li id="searching-html-searching" class="toc-item"><a href="searching.html#searching">Searching</a><ul><li id="searching-html-introduction" class="toc-item"><a href="searching.html#introduction">Introduction</a></li><li id="searching-html-index-structure" class="toc-item"><a href="searching.html#index-structure">Index structure</a></li><li id="searching-html-index-building" class="toc-item"><a href="searching.html#index-building">Index Building</a></li><li id="searching-html-text-analyzers" class="toc-item"><a href="searching.html#text-analyzers">Text Analyzers</a></li><li id="searching-html-query-language" class="toc-item"><a href="searching.html#query-language">Query language</a></li><li id="searching-html-performing-searches" class="toc-item"><a href="searching.html#performing-searches">Performing Searches</a></li><li id="searching-html-file-searches" class="toc-item"><a href="searching.html#file-searches">File searches</a></li><li id="searching-html-conclusion" class="toc-item"><a href="searching.html#conclusion">Conclusion</a></li></ul></li><li id="native-sql-html-native-sql" class="toc-item"><a href="native-sql.html#native-sql">Native SQL</a><ul><li id="native-sql-html-introduction" class="toc-item"><a href="native-sql.html#introduction">Introduction</a></li><li id="native-sql-html-component-queries" class="toc-item"><a href="native-sql.html#component-queries">Component Queries</a></li><li id="native-sql-html-fetching-from-multiple-components" class="toc-item"><a href="native-sql.html#fetching-from-multiple-components">Fetching from Multiple Components</a></li><li id="native-sql-html-conclusion" class="toc-item"><a href="native-sql.html#conclusion">Conclusion</a></li></ul></li><li id="data-validation-html-data-validation" class="toc-item"><a href="data-validation.html#data-validation">Data Validation</a><ul><li id="data-validation-html-introduction" class="toc-item"><a href="data-validation.html#introduction">Introduction</a></li><li id="data-validation-html-examples" class="toc-item"><a href="data-validation.html#examples">Examples</a></li><li id="data-validation-html-conclusion" class="toc-item"><a href="data-validation.html#conclusion">Conclusion</a></li></ul></li><li id="caching-html-caching" class="toc-item"><a href="caching.html#caching">Caching</a><ul><li id="caching-html-introduction" class="toc-item"><a href="caching.html#introduction">Introduction</a></li><li id="caching-html-drivers" class="toc-item"><a href="caching.html#drivers">Drivers</a><ul><li id="caching-html-memcache" class="toc-item"><a href="caching.html#memcache">Memcache</a></li><li id="caching-html-apc" class="toc-item"><a href="caching.html#apc">APC</a></li><li id="caching-html-db" class="toc-item"><a href="caching.html#db">Db</a></li></ul></li><li id="caching-html-query-cache-result-cache" class="toc-item"><a href="caching.html#query-cache-result-cache">Query Cache & Result Cache</a><ul><li id="caching-html-introduction" class="toc-item"><a href="caching.html#introduction">Introduction</a></li><li id="caching-html-query-cache" class="toc-item"><a href="caching.html#query-cache">Query Cache</a></li><li id="caching-html-result-cache" class="toc-item"><a href="caching.html#result-cache">Result Cache</a></li></ul></li><li id="caching-html-conclusion" class="toc-item"><a href="caching.html#conclusion">Conclusion</a></li></ul></li><li id="connections-html-connections" class="toc-item"><a href="connections.html#connections">Connections</a><ul><li id="connections-html-introduction" class="toc-item"><a href="connections.html#introduction">Introduction</a></li><li id="connections-html-opening-connections" class="toc-item"><a href="connections.html#opening-connections">Opening Connections</a></li><li id="connections-html-retrieve-connections" class="toc-item"><a href="connections.html#retrieve-connections">Retrieve Connections</a></li><li id="connections-html-current-connection" class="toc-item"><a href="connections.html#current-connection">Current Connection</a></li><li id="connections-html-change-current-connection" class="toc-item"><a href="connections.html#change-current-connection">Change Current Connection</a></li><li id="connections-html-iterating-connections" class="toc-item"><a href="connections.html#iterating-connections">Iterating Connections</a></li><li id="connections-html-get-connection-name" class="toc-item"><a href="connections.html#get-connection-name">Get Connection Name</a></li><li id="connections-html-close-connection" class="toc-item"><a href="connections.html#close-connection">Close Connection</a></li><li id="connections-html-get-all-connections" class="toc-item"><a href="connections.html#get-all-connections">Get All Connections</a></li><li id="connections-html-count-connections" class="toc-item"><a href="connections.html#count-connections">Count Connections</a></li><li id="connections-html-creating-and-dropping-database" class="toc-item"><a href="connections.html#creating-and-dropping-database">Creating and Dropping Database</a><ul><li id="connections-html-for-a-specific-connection" class="toc-item"><a href="connections.html#for-a-specific-connection">For a Specific Connection</a></li></ul></li><li id="connections-html-writing-custom-connections" class="toc-item"><a href="connections.html#writing-custom-connections">Writing Custom Connections</a></li><li id="connections-html-conclusion" class="toc-item"><a href="connections.html#conclusion">Conclusion</a></li></ul></li><li id="working-with-models-html-working-with-models" class="toc-item"><a href="working-with-models.html#working-with-models">Working with Models</a><ul><li id="working-with-models-html-define-test-schema" class="toc-item"><a href="working-with-models.html#define-test-schema">Define Test Schema</a></li><li id="working-with-models-html-dealing-with-relations" class="toc-item"><a href="working-with-models.html#dealing-with-relations">Dealing with Relations</a><ul><li id="working-with-models-html-creating-related-records" class="toc-item"><a href="working-with-models.html#creating-related-records">Creating Related Records</a></li><li id="working-with-models-html-retrieving-related-records" class="toc-item"><a href="working-with-models.html#retrieving-related-records">Retrieving Related Records</a></li><li id="working-with-models-html-updating-related-records" class="toc-item"><a href="working-with-models.html#updating-related-records">Updating Related Records</a></li><li id="working-with-models-html-clearing-related-records" class="toc-item"><a href="working-with-models.html#clearing-related-records">Clearing Related Records</a></li><li id="working-with-models-html-deleting-related-records" class="toc-item"><a href="working-with-models.html#deleting-related-records">Deleting Related Records</a></li><li id="working-with-models-html-working-with-related-records" class="toc-item"><a href="working-with-models.html#working-with-related-records">Working with Related Records</a></li></ul></li><li id="working-with-models-html-many-to-many-relations" class="toc-item"><a href="working-with-models.html#many-to-many-relations">Many-to-Many Relations</a><ul><li id="working-with-models-html-creating-a-new-link" class="toc-item"><a href="working-with-models.html#creating-a-new-link">Creating a New Link</a></li><li id="working-with-models-html-deleting-a-link" class="toc-item"><a href="working-with-models.html#deleting-a-link">Deleting a Link</a></li></ul></li><li id="working-with-models-html-fetching-objects" class="toc-item"><a href="working-with-models.html#fetching-objects">Fetching Objects</a><ul><li id="working-with-models-html-sample-queries" class="toc-item"><a href="working-with-models.html#sample-queries">Sample Queries</a></li><li id="working-with-models-html-field-lazy-loading" class="toc-item"><a href="working-with-models.html#field-lazy-loading">Field Lazy Loading</a></li></ul></li><li id="working-with-models-html-arrays-and-objects" class="toc-item"><a href="working-with-models.html#arrays-and-objects">Arrays and Objects</a><ul><li id="working-with-models-html-to-array" class="toc-item"><a href="working-with-models.html#to-array">To Array</a></li><li id="working-with-models-html-from-array" class="toc-item"><a href="working-with-models.html#from-array">From Array</a></li><li id="working-with-models-html-synchronize-with-array" class="toc-item"><a href="working-with-models.html#synchronize-with-array">Synchronize With Array</a></li></ul></li><li id="working-with-models-html-overriding-the-constructor" class="toc-item"><a href="working-with-models.html#overriding-the-constructor">Overriding the Constructor</a></li><li id="working-with-models-html-conclusion" class="toc-item"><a href="working-with-models.html#conclusion">Conclusion</a></li></ul></li><li id="inheritance-html-inheritance" class="toc-item"><a href="inheritance.html#inheritance">Inheritance</a><ul><li id="inheritance-html-simple" class="toc-item"><a href="inheritance.html#simple">Simple</a></li><li id="inheritance-html-concrete" class="toc-item"><a href="inheritance.html#concrete">Concrete</a></li><li id="inheritance-html-column-aggregation" class="toc-item"><a href="inheritance.html#column-aggregation">Column Aggregation</a></li><li id="inheritance-html-conclusion" class="toc-item"><a href="inheritance.html#conclusion">Conclusion</a></li></ul></li><li id="about-sensio-html-about-sensio" class="toc-item"><a href="about-sensio.html#about-sensio">About Sensio</a></li><li id="acknowledgements-html-acknowledgements-and-contributors" class="toc-item"><a href="acknowledgements.html#acknowledgements-and-contributors">Acknowledgements and Contributors</a><ul><li id="acknowledgements-html-contributors" class="toc-item"><a href="acknowledgements.html#contributors">Contributors</a><ul><li id="acknowledgements-html-roman-s-borschel" class="toc-item"><a href="acknowledgements.html#roman-s-borschel">Roman S. Borschel</a></li><li id="acknowledgements-html-guilherme-blanco" class="toc-item"><a href="acknowledgements.html#guilherme-blanco">Guilherme Blanco</a></li><li id="acknowledgements-html-konsta-vesterinen" class="toc-item"><a href="acknowledgements.html#konsta-vesterinen">Konsta Vesterinen</a></li></ul></li><li id="acknowledgements-html-companies" class="toc-item"><a href="acknowledgements.html#companies">Companies</a><ul><li id="acknowledgements-html-centre-source" class="toc-item"><a href="acknowledgements.html#centre-source">centre{source}</a></li><li id="acknowledgements-html-sensio-labs" class="toc-item"><a href="acknowledgements.html#sensio-labs">Sensio Labs</a></li></ul></li><li id="acknowledgements-html-other-contributors" class="toc-item"><a href="acknowledgements.html#other-contributors">Other Contributors</a></li></ul></li><li id="introduction-to-connections-html-introduction-to-connections" class="toc-item"><a href="introduction-to-connections.html#introduction-to-connections">Introduction to Connections</a><ul><li id="introduction-to-connections-html-dsn-the-data-source-name" class="toc-item"><a href="introduction-to-connections.html#dsn-the-data-source-name">DSN, the Data Source Name</a><ul><li id="introduction-to-connections-html-main-parts" class="toc-item"><a href="introduction-to-connections.html#main-parts">Main Parts</a></li><li id="introduction-to-connections-html-providing-the-dsn" class="toc-item"><a href="introduction-to-connections.html#providing-the-dsn">Providing the DSN</a></li><li id="introduction-to-connections-html-examples" class="toc-item"><a href="introduction-to-connections.html#examples">Examples</a></li></ul></li><li id="introduction-to-connections-html-opening-new-connections" class="toc-item"><a href="introduction-to-connections.html#opening-new-connections">Opening New Connections</a></li><li id="introduction-to-connections-html-lazy-database-connecting" class="toc-item"><a href="introduction-to-connections.html#lazy-database-connecting">Lazy Database Connecting</a></li><li id="introduction-to-connections-html-testing-your-connection" class="toc-item"><a href="introduction-to-connections.html#testing-your-connection">Testing your Connection</a></li><li id="introduction-to-connections-html-conclusion" class="toc-item"><a href="introduction-to-connections.html#conclusion">Conclusion</a></li></ul></li><li id="extensions-html-extensions" class="toc-item"><a href="extensions.html#extensions">Extensions</a></li><li id="license-html-attribution-share-alike-3-0-unported-license" class="toc-item"><a href="license.html#attribution-share-alike-3-0-unported-license">Attribution-Share Alike 3.0 Unported License</a></li><li id="improving-performance-html-improving-performance" class="toc-item"><a href="improving-performance.html#improving-performance">Improving Performance</a><ul><li id="improving-performance-html-introduction" class="toc-item"><a href="improving-performance.html#introduction">Introduction</a></li><li id="improving-performance-html-compile" class="toc-item"><a href="improving-performance.html#compile">Compile</a></li><li id="improving-performance-html-conservative-fetching" class="toc-item"><a href="improving-performance.html#conservative-fetching">Conservative Fetching</a></li><li id="improving-performance-html-bundle-your-class-files" class="toc-item"><a href="improving-performance.html#bundle-your-class-files">Bundle your Class Files</a></li><li id="improving-performance-html-use-a-bytecode-cache" class="toc-item"><a href="improving-performance.html#use-a-bytecode-cache">Use a Bytecode Cache</a></li><li id="improving-performance-html-free-objects" class="toc-item"><a href="improving-performance.html#free-objects">Free Objects</a></li><li id="improving-performance-html-other-tips" class="toc-item"><a href="improving-performance.html#other-tips">Other Tips</a></li><li id="improving-performance-html-conclusion" class="toc-item"><a href="improving-performance.html#conclusion">Conclusion</a></li></ul></li><li id="coding-standards-html-coding-standards" class="toc-item"><a href="coding-standards.html#coding-standards">Coding Standards</a><ul><li id="coding-standards-html-php-file-formatting" class="toc-item"><a href="coding-standards.html#php-file-formatting">PHP File Formatting</a><ul><li id="coding-standards-html-general" class="toc-item"><a href="coding-standards.html#general">General</a></li><li id="coding-standards-html-indentation" class="toc-item"><a href="coding-standards.html#indentation">Indentation</a></li><li id="coding-standards-html-maximum-line-length" class="toc-item"><a href="coding-standards.html#maximum-line-length">Maximum Line Length</a></li><li id="coding-standards-html-line-termination" class="toc-item"><a href="coding-standards.html#line-termination">Line Termination</a></li></ul></li><li id="coding-standards-html-naming-conventions" class="toc-item"><a href="coding-standards.html#naming-conventions">Naming Conventions</a><ul><li id="coding-standards-html-classes" class="toc-item"><a href="coding-standards.html#classes">Classes</a></li><li id="coding-standards-html-interfaces" class="toc-item"><a href="coding-standards.html#interfaces">Interfaces</a></li><li id="coding-standards-html-filenames" class="toc-item"><a href="coding-standards.html#filenames">Filenames</a></li><li id="coding-standards-html-functions-and-methods" class="toc-item"><a href="coding-standards.html#functions-and-methods">Functions and Methods</a></li><li id="coding-standards-html-variables" class="toc-item"><a href="coding-standards.html#variables">Variables</a></li><li id="coding-standards-html-constants" class="toc-item"><a href="coding-standards.html#constants">Constants</a></li><li id="coding-standards-html-record-columns" class="toc-item"><a href="coding-standards.html#record-columns">Record Columns</a></li></ul></li><li id="coding-standards-html-coding-style" class="toc-item"><a href="coding-standards.html#coding-style">Coding Style</a><ul><li id="coding-standards-html-php-code-demarcation" class="toc-item"><a href="coding-standards.html#php-code-demarcation">PHP Code Demarcation</a></li><li id="coding-standards-html-strings" class="toc-item"><a href="coding-standards.html#strings">Strings</a></li><li id="coding-standards-html-arrays" class="toc-item"><a href="coding-standards.html#arrays">Arrays</a></li><li id="coding-standards-html-classes" class="toc-item"><a href="coding-standards.html#classes">Classes</a></li><li id="coding-standards-html-functions-and-methods" class="toc-item"><a href="coding-standards.html#functions-and-methods">Functions and Methods</a></li><li id="coding-standards-html-control-statements" class="toc-item"><a href="coding-standards.html#control-statements">Control Statements</a></li><li id="coding-standards-html-inline-documentation" class="toc-item"><a href="coding-standards.html#inline-documentation">Inline Documentation</a></li></ul></li><li id="coding-standards-html-conclusion" class="toc-item"><a href="coding-standards.html#conclusion">Conclusion</a></li></ul></li><li id="hierarchical-data-html-hierarchical-data" class="toc-item"><a href="hierarchical-data.html#hierarchical-data">Hierarchical Data</a><ul><li id="hierarchical-data-html-introduction" class="toc-item"><a href="hierarchical-data.html#introduction">Introduction</a></li><li id="hierarchical-data-html-nested-set" class="toc-item"><a href="hierarchical-data.html#nested-set">Nested Set</a><ul><li id="hierarchical-data-html-introduction" class="toc-item"><a href="hierarchical-data.html#introduction">Introduction</a></li><li id="hierarchical-data-html-setting-up" class="toc-item"><a href="hierarchical-data.html#setting-up">Setting Up</a></li><li id="hierarchical-data-html-multiple-trees" class="toc-item"><a href="hierarchical-data.html#multiple-trees">Multiple Trees</a></li><li id="hierarchical-data-html-working-with-trees" class="toc-item"><a href="hierarchical-data.html#working-with-trees">Working with Trees</a></li><li id="hierarchical-data-html-advanced-usage" class="toc-item"><a href="hierarchical-data.html#advanced-usage">Advanced Usage</a></li><li id="hierarchical-data-html-rendering-with-indention" class="toc-item"><a href="hierarchical-data.html#rendering-with-indention">Rendering with Indention</a></li></ul></li><li id="hierarchical-data-html-conclusion" class="toc-item"><a href="hierarchical-data.html#conclusion">Conclusion</a></li></ul></li><li id="introduction-to-models-html-introduction-to-models" class="toc-item"><a href="introduction-to-models.html#introduction-to-models">Introduction to Models</a><ul><li id="introduction-to-models-html-introduction" class="toc-item"><a href="introduction-to-models.html#introduction">Introduction</a></li><li id="introduction-to-models-html-generating-models" class="toc-item"><a href="introduction-to-models.html#generating-models">Generating Models</a><ul><li id="introduction-to-models-html-existing-databases" class="toc-item"><a href="introduction-to-models.html#existing-databases">Existing Databases</a></li><li id="introduction-to-models-html-schema-files" class="toc-item"><a href="introduction-to-models.html#schema-files">Schema Files</a></li></ul></li><li id="introduction-to-models-html-manually-writing-models" class="toc-item"><a href="introduction-to-models.html#manually-writing-models">Manually Writing Models</a></li><li id="introduction-to-models-html-autoloading-models" class="toc-item"><a href="introduction-to-models.html#autoloading-models">Autoloading Models</a><ul><li id="introduction-to-models-html-conservative" class="toc-item"><a href="introduction-to-models.html#conservative">Conservative</a></li><li id="introduction-to-models-html-aggressive" class="toc-item"><a href="introduction-to-models.html#aggressive">Aggressive</a></li></ul></li><li id="introduction-to-models-html-conclusion" class="toc-item"><a href="introduction-to-models.html#conclusion">Conclusion</a></li></ul></li><li id="data-hydrators-html-data-hydrators" class="toc-item"><a href="data-hydrators.html#data-hydrators">Data Hydrators</a><ul><li id="data-hydrators-html-core-hydration-methods" class="toc-item"><a href="data-hydrators.html#core-hydration-methods">Core Hydration Methods</a><ul><li id="data-hydrators-html-record" class="toc-item"><a href="data-hydrators.html#record">Record</a></li><li id="data-hydrators-html-array" class="toc-item"><a href="data-hydrators.html#array">Array</a></li><li id="data-hydrators-html-scalar" class="toc-item"><a href="data-hydrators.html#scalar">Scalar</a></li><li id="data-hydrators-html-single-scalar" class="toc-item"><a href="data-hydrators.html#single-scalar">Single Scalar</a></li><li id="data-hydrators-html-on-demand" class="toc-item"><a href="data-hydrators.html#on-demand">On Demand</a></li><li id="data-hydrators-html-nested-set-record-hierarchy" class="toc-item"><a href="data-hydrators.html#nested-set-record-hierarchy">Nested Set Record Hierarchy</a></li><li id="data-hydrators-html-nested-set-array-hierarchy" class="toc-item"><a href="data-hydrators.html#nested-set-array-hierarchy">Nested Set Array Hierarchy</a></li></ul></li><li id="data-hydrators-html-writing-hydration-method" class="toc-item"><a href="data-hydrators.html#writing-hydration-method">Writing Hydration Method</a></li></ul></li><li id="utilities-html-utilities" class="toc-item"><a href="utilities.html#utilities">Utilities</a><ul><li id="utilities-html-pagination" class="toc-item"><a href="utilities.html#pagination">Pagination</a><ul><li id="utilities-html-introduction" class="toc-item"><a href="utilities.html#introduction">Introduction</a></li><li id="utilities-html-working-with-pager" class="toc-item"><a href="utilities.html#working-with-pager">Working with Pager</a></li><li id="utilities-html-controlling-range-styles" class="toc-item"><a href="utilities.html#controlling-range-styles">Controlling Range Styles</a></li><li id="utilities-html-advanced-layouts-with-pager" class="toc-item"><a href="utilities.html#advanced-layouts-with-pager">Advanced layouts with pager</a></li><li id="utilities-html-customizing-pager-layout" class="toc-item"><a href="utilities.html#customizing-pager-layout">Customizing pager layout</a></li></ul></li><li id="utilities-html-facade" class="toc-item"><a href="utilities.html#facade">Facade</a><ul><li id="utilities-html-creating-dropping-databases" class="toc-item"><a href="utilities.html#creating-dropping-databases">Creating & Dropping Databases</a></li><li id="utilities-html-convenience-methods" class="toc-item"><a href="utilities.html#convenience-methods">Convenience Methods</a></li><li id="utilities-html-tasks" class="toc-item"><a href="utilities.html#tasks">Tasks</a></li></ul></li><li id="utilities-html-command-line-interface" class="toc-item"><a href="utilities.html#command-line-interface">Command Line Interface</a><ul><li id="utilities-html-introduction-the-doctrine-cli-is-a-collection-of-tasks-that-help-you" class="toc-item"><a href="utilities.html#introduction-the-doctrine-cli-is-a-collection-of-tasks-that-help-you">Introduction The Doctrine Cli is a collection of tasks that help you</a></li><li id="utilities-html-tasks" class="toc-item"><a href="utilities.html#tasks">Tasks</a></li><li id="utilities-html-usage" class="toc-item"><a href="utilities.html#usage">Usage</a></li></ul></li><li id="utilities-html-sandbox" class="toc-item"><a href="utilities.html#sandbox">Sandbox</a><ul><li id="utilities-html-installation" class="toc-item"><a href="utilities.html#installation">Installation</a></li></ul></li><li id="utilities-html-conclusion" class="toc-item"><a href="utilities.html#conclusion">Conclusion</a></li></ul></li><li id="database-abstraction-layer-html-database-abstraction-layer" class="toc-item"><a href="database-abstraction-layer.html#database-abstraction-layer">Database Abstraction Layer</a><ul><li id="database-abstraction-layer-html-export" class="toc-item"><a href="database-abstraction-layer.html#export">Export</a><ul><li id="database-abstraction-layer-html-introduction" class="toc-item"><a href="database-abstraction-layer.html#introduction">Introduction</a></li><li id="database-abstraction-layer-html-creating-databases" class="toc-item"><a href="database-abstraction-layer.html#creating-databases">Creating Databases</a></li><li id="database-abstraction-layer-html-creating-tables" class="toc-item"><a href="database-abstraction-layer.html#creating-tables">Creating Tables</a></li><li id="database-abstraction-layer-html-creating-foreign-keys" class="toc-item"><a href="database-abstraction-layer.html#creating-foreign-keys">Creating Foreign Keys</a></li><li id="database-abstraction-layer-html-altering-table" class="toc-item"><a href="database-abstraction-layer.html#altering-table">Altering table</a></li><li id="database-abstraction-layer-html-creating-indexes" class="toc-item"><a href="database-abstraction-layer.html#creating-indexes">Creating Indexes</a></li><li id="database-abstraction-layer-html-deleting-database-elements" class="toc-item"><a href="database-abstraction-layer.html#deleting-database-elements">Deleting database elements</a></li></ul></li><li id="database-abstraction-layer-html-import" class="toc-item"><a href="database-abstraction-layer.html#import">Import</a><ul><li id="database-abstraction-layer-html-introduction" class="toc-item"><a href="database-abstraction-layer.html#introduction">Introduction</a></li><li id="database-abstraction-layer-html-listing-databases" class="toc-item"><a href="database-abstraction-layer.html#listing-databases">Listing Databases</a></li><li id="database-abstraction-layer-html-listing-sequences" class="toc-item"><a href="database-abstraction-layer.html#listing-sequences">Listing Sequences</a></li><li id="database-abstraction-layer-html-listing-constraints" class="toc-item"><a href="database-abstraction-layer.html#listing-constraints">Listing Constraints</a></li><li id="database-abstraction-layer-html-listing-table-columns" class="toc-item"><a href="database-abstraction-layer.html#listing-table-columns">Listing Table Columns</a></li><li id="database-abstraction-layer-html-listing-table-indexes" class="toc-item"><a href="database-abstraction-layer.html#listing-table-indexes">Listing Table Indexes</a></li><li id="database-abstraction-layer-html-listing-tables" class="toc-item"><a href="database-abstraction-layer.html#listing-tables">Listing Tables</a></li><li id="database-abstraction-layer-html-listing-views" class="toc-item"><a href="database-abstraction-layer.html#listing-views">Listing Views</a></li></ul></li><li id="database-abstraction-layer-html-datadict" class="toc-item"><a href="database-abstraction-layer.html#datadict">DataDict</a><ul><li id="database-abstraction-layer-html-introduction" class="toc-item"><a href="database-abstraction-layer.html#introduction">Introduction</a></li><li id="database-abstraction-layer-html-getting-portable-declaration" class="toc-item"><a href="database-abstraction-layer.html#getting-portable-declaration">Getting portable declaration</a></li><li id="database-abstraction-layer-html-getting-native-declaration" class="toc-item"><a href="database-abstraction-layer.html#getting-native-declaration">Getting Native Declaration</a></li></ul></li><li id="database-abstraction-layer-html-drivers" class="toc-item"><a href="database-abstraction-layer.html#drivers">Drivers</a><ul><li id="database-abstraction-layer-html-mysql" class="toc-item"><a href="database-abstraction-layer.html#mysql">Mysql</a></li></ul></li><li id="database-abstraction-layer-html-conclusion" class="toc-item"><a href="database-abstraction-layer.html#conclusion">Conclusion</a></li></ul></li><li id="about-author-html-about-the-author" class="toc-item"><a href="about-author.html#about-the-author">About the Author</a></li><li id="index-html-doctrine-version-orm-manual" class="toc-item"><a href="index.html#doctrine-version-orm-manual">Doctrine |version| ORM Manual</a></li><li id="yaml-schema-files-html-yaml-schema-files" class="toc-item"><a href="yaml-schema-files.html#yaml-schema-files">YAML Schema Files</a><ul><li id="yaml-schema-files-html-introduction" class="toc-item"><a href="yaml-schema-files.html#introduction">Introduction</a></li><li id="yaml-schema-files-html-abbreviated-syntax" class="toc-item"><a href="yaml-schema-files.html#abbreviated-syntax">Abbreviated Syntax</a></li><li id="yaml-schema-files-html-verbose-syntax" class="toc-item"><a href="yaml-schema-files.html#verbose-syntax">Verbose Syntax</a></li><li id="yaml-schema-files-html-relationships" class="toc-item"><a href="yaml-schema-files.html#relationships">Relationships</a><ul><li id="yaml-schema-files-html-detect-relations" class="toc-item"><a href="yaml-schema-files.html#detect-relations">Detect Relations</a></li><li id="yaml-schema-files-html-customizing-relationships" class="toc-item"><a href="yaml-schema-files.html#customizing-relationships">Customizing Relationships</a></li><li id="yaml-schema-files-html-one-to-one" class="toc-item"><a href="yaml-schema-files.html#one-to-one">One to One</a></li><li id="yaml-schema-files-html-one-to-many" class="toc-item"><a href="yaml-schema-files.html#one-to-many">One to Many</a></li><li id="yaml-schema-files-html-many-to-many" class="toc-item"><a href="yaml-schema-files.html#many-to-many">Many to Many</a></li></ul></li><li id="yaml-schema-files-html-features-examples" class="toc-item"><a href="yaml-schema-files.html#features-examples">Features & Examples</a><ul><li id="yaml-schema-files-html-connection-binding" class="toc-item"><a href="yaml-schema-files.html#connection-binding">Connection Binding</a></li><li id="yaml-schema-files-html-attributes" class="toc-item"><a href="yaml-schema-files.html#attributes">Attributes</a></li><li id="yaml-schema-files-html-enums" class="toc-item"><a href="yaml-schema-files.html#enums">Enums</a></li><li id="yaml-schema-files-html-actas-behaviors" class="toc-item"><a href="yaml-schema-files.html#actas-behaviors">ActAs Behaviors</a></li><li id="yaml-schema-files-html-listeners" class="toc-item"><a href="yaml-schema-files.html#listeners">Listeners</a></li><li id="yaml-schema-files-html-options" class="toc-item"><a href="yaml-schema-files.html#options">Options</a></li><li id="yaml-schema-files-html-indexes" class="toc-item"><a href="yaml-schema-files.html#indexes">Indexes</a></li><li id="yaml-schema-files-html-inheritance" class="toc-item"><a href="yaml-schema-files.html#inheritance">Inheritance</a></li><li id="yaml-schema-files-html-column-aliases" class="toc-item"><a href="yaml-schema-files.html#column-aliases">Column Aliases</a></li><li id="yaml-schema-files-html-packages" class="toc-item"><a href="yaml-schema-files.html#packages">Packages</a></li><li id="yaml-schema-files-html-global-schema-information" class="toc-item"><a href="yaml-schema-files.html#global-schema-information">Global Schema Information</a></li></ul></li><li id="yaml-schema-files-html-using-schema-files" class="toc-item"><a href="yaml-schema-files.html#using-schema-files">Using Schema Files</a></li><li id="yaml-schema-files-html-conclusion" class="toc-item"><a href="yaml-schema-files.html#conclusion">Conclusion</a></li></ul></li><li id="migrations-html-migrations" class="toc-item"><a href="migrations.html#migrations">Migrations</a><ul><li id="migrations-html-performing-migrations" class="toc-item"><a href="migrations.html#performing-migrations">Performing Migrations</a></li><li id="migrations-html-implement" class="toc-item"><a href="migrations.html#implement">Implement</a></li><li id="migrations-html-writing-migration-classes" class="toc-item"><a href="migrations.html#writing-migration-classes">Writing Migration Classes</a></li><li id="migrations-html-conclusion" class="toc-item"><a href="migrations.html#conclusion">Conclusion</a></li></ul></li><li id="technology-html-technology" class="toc-item"><a href="technology.html#technology">Technology</a><ul><li id="technology-html-introduction" class="toc-item"><a href="technology.html#introduction">Introduction</a></li><li id="technology-html-architecture" class="toc-item"><a href="technology.html#architecture">Architecture</a><ul><li id="technology-html-doctrine-core" class="toc-item"><a href="technology.html#doctrine-core">Doctrine CORE</a></li><li id="technology-html-doctrine-dbal" class="toc-item"><a href="technology.html#doctrine-dbal">Doctrine DBAL</a></li><li id="technology-html-doctrine-orm" class="toc-item"><a href="technology.html#doctrine-orm">Doctrine ORM</a></li></ul></li><li id="technology-html-design-patterns-used" class="toc-item"><a href="technology.html#design-patterns-used">Design Patterns Used</a></li><li id="technology-html-speed" class="toc-item"><a href="technology.html#speed">Speed</a></li><li id="technology-html-conclusion" class="toc-item"><a href="technology.html#conclusion">Conclusion</a></li></ul></li><li id="event-listeners-html-event-listeners" class="toc-item"><a href="event-listeners.html#event-listeners">Event Listeners</a><ul><li id="event-listeners-html-introduction" class="toc-item"><a href="event-listeners.html#introduction">Introduction</a></li><li id="event-listeners-html-connection-listeners" class="toc-item"><a href="event-listeners.html#connection-listeners">Connection Listeners</a><ul><li id="event-listeners-html-creating-a-new-listener" class="toc-item"><a href="event-listeners.html#creating-a-new-listener">Creating a New Listener</a></li><li id="event-listeners-html-attaching-listeners" class="toc-item"><a href="event-listeners.html#attaching-listeners">Attaching listeners</a></li><li id="event-listeners-html-pre-and-post-connect" class="toc-item"><a href="event-listeners.html#pre-and-post-connect">Pre and Post Connect</a></li><li id="event-listeners-html-transaction-listeners" class="toc-item"><a href="event-listeners.html#transaction-listeners">Transaction Listeners</a></li><li id="event-listeners-html-query-execution-listeners" class="toc-item"><a href="event-listeners.html#query-execution-listeners">Query Execution Listeners</a></li></ul></li><li id="event-listeners-html-hydration-listeners" class="toc-item"><a href="event-listeners.html#hydration-listeners">Hydration Listeners</a></li><li id="event-listeners-html-record-listeners" class="toc-item"><a href="event-listeners.html#record-listeners">Record Listeners</a></li><li id="event-listeners-html-record-hooks" class="toc-item"><a href="event-listeners.html#record-hooks">Record Hooks</a></li><li id="event-listeners-html-dql-hooks" class="toc-item"><a href="event-listeners.html#dql-hooks">DQL Hooks</a></li><li id="event-listeners-html-chaining-listeners" class="toc-item"><a href="event-listeners.html#chaining-listeners">Chaining Listeners</a></li><li id="event-listeners-html-the-event-object" class="toc-item"><a href="event-listeners.html#the-event-object">The Event object</a><ul><li id="event-listeners-html-getting-the-invoker" class="toc-item"><a href="event-listeners.html#getting-the-invoker">Getting the Invoker</a></li><li id="event-listeners-html-event-codes" class="toc-item"><a href="event-listeners.html#event-codes">Event Codes</a></li><li id="event-listeners-html-getting-the-invoker" class="toc-item"><a href="event-listeners.html#getting-the-invoker">Getting the Invoker</a></li><li id="event-listeners-html-skip-next-operation" class="toc-item"><a href="event-listeners.html#skip-next-operation">Skip Next Operation</a></li><li id="event-listeners-html-skip-next-listener" class="toc-item"><a href="event-listeners.html#skip-next-listener">Skip Next Listener</a></li></ul></li><li id="event-listeners-html-conclusion" class="toc-item"><a href="event-listeners.html#conclusion">Conclusion</a></li></ul></li><li id="component-overview-html-component-overview" class="toc-item"><a href="component-overview.html#component-overview">Component Overview</a><ul><li id="component-overview-html-manager" class="toc-item"><a href="component-overview.html#manager">Manager</a><ul><li id="component-overview-html-retrieving-connections" class="toc-item"><a href="component-overview.html#retrieving-connections">Retrieving Connections</a></li></ul></li><li id="component-overview-html-connection" class="toc-item"><a href="component-overview.html#connection">Connection</a><ul><li id="component-overview-html-available-drivers" class="toc-item"><a href="component-overview.html#available-drivers">Available Drivers</a></li><li id="component-overview-html-creating-connections" class="toc-item"><a href="component-overview.html#creating-connections">Creating Connections</a></li><li id="component-overview-html-flushing-the-connection" class="toc-item"><a href="component-overview.html#flushing-the-connection">Flushing the Connection</a></li></ul></li><li id="component-overview-html-table" class="toc-item"><a href="component-overview.html#table">Table</a><ul><li id="component-overview-html-getting-a-table-object" class="toc-item"><a href="component-overview.html#getting-a-table-object">Getting a Table Object</a></li><li id="component-overview-html-getting-column-information" class="toc-item"><a href="component-overview.html#getting-column-information">Getting Column Information</a></li><li id="component-overview-html-getting-relation-information" class="toc-item"><a href="component-overview.html#getting-relation-information">Getting Relation Information</a></li><li id="component-overview-html-finder-methods" class="toc-item"><a href="component-overview.html#finder-methods">Finder Methods</a></li><li id="component-overview-html-custom-finders" class="toc-item"><a href="component-overview.html#custom-finders">Custom Finders</a></li></ul></li><li id="component-overview-html-record" class="toc-item"><a href="component-overview.html#record">Record</a><ul><li id="component-overview-html-properties" class="toc-item"><a href="component-overview.html#properties">Properties</a></li><li id="component-overview-html-updating-records" class="toc-item"><a href="component-overview.html#updating-records">Updating Records</a></li><li id="component-overview-html-replacing-records" class="toc-item"><a href="component-overview.html#replacing-records">Replacing Records</a></li><li id="component-overview-html-refreshing-records" class="toc-item"><a href="component-overview.html#refreshing-records">Refreshing Records</a></li><li id="component-overview-html-refreshing-relationships" class="toc-item"><a href="component-overview.html#refreshing-relationships">Refreshing relationships</a></li><li id="component-overview-html-deleting-records" class="toc-item"><a href="component-overview.html#deleting-records">Deleting Records</a></li><li id="component-overview-html-using-expression-values" class="toc-item"><a href="component-overview.html#using-expression-values">Using Expression Values</a></li><li id="component-overview-html-getting-record-state" class="toc-item"><a href="component-overview.html#getting-record-state">Getting Record State</a></li><li id="component-overview-html-getting-object-copy" class="toc-item"><a href="component-overview.html#getting-object-copy">Getting Object Copy</a></li><li id="component-overview-html-saving-a-blank-record" class="toc-item"><a href="component-overview.html#saving-a-blank-record">Saving a Blank Record</a></li><li id="component-overview-html-mapping-custom-values" class="toc-item"><a href="component-overview.html#mapping-custom-values">Mapping Custom Values</a></li><li id="component-overview-html-serializing" class="toc-item"><a href="component-overview.html#serializing">Serializing</a></li><li id="component-overview-html-checking-existence" class="toc-item"><a href="component-overview.html#checking-existence">Checking Existence</a></li><li id="component-overview-html-function-callbacks-for-columns" class="toc-item"><a href="component-overview.html#function-callbacks-for-columns">Function Callbacks for Columns</a></li></ul></li><li id="component-overview-html-collection" class="toc-item"><a href="component-overview.html#collection">Collection</a><ul><li id="component-overview-html-accessing-elements" class="toc-item"><a href="component-overview.html#accessing-elements">Accessing Elements</a></li><li id="component-overview-html-adding-new-elements" class="toc-item"><a href="component-overview.html#adding-new-elements">Adding new Elements</a></li><li id="component-overview-html-getting-collection-count" class="toc-item"><a href="component-overview.html#getting-collection-count">Getting Collection Count</a></li><li id="component-overview-html-saving-the-collection" class="toc-item"><a href="component-overview.html#saving-the-collection">Saving the Collection</a></li><li id="component-overview-html-deleting-the-collection" class="toc-item"><a href="component-overview.html#deleting-the-collection">Deleting the Collection</a></li><li id="component-overview-html-key-mapping" class="toc-item"><a href="component-overview.html#key-mapping">Key Mapping</a></li><li id="component-overview-html-loading-related-records" class="toc-item"><a href="component-overview.html#loading-related-records">Loading Related Records</a></li></ul></li><li id="component-overview-html-validator" class="toc-item"><a href="component-overview.html#validator">Validator</a><ul><li id="component-overview-html-more-validation" class="toc-item"><a href="component-overview.html#more-validation">More Validation</a></li><li id="component-overview-html-valid-or-not-valid" class="toc-item"><a href="component-overview.html#valid-or-not-valid">Valid or Not Valid</a></li></ul></li><li id="component-overview-html-profiler" class="toc-item"><a href="component-overview.html#profiler">Profiler</a><ul><li id="component-overview-html-basic-usage" class="toc-item"><a href="component-overview.html#basic-usage">Basic Usage</a></li></ul></li><li id="component-overview-html-locking-manager" class="toc-item"><a href="component-overview.html#locking-manager">Locking Manager</a><ul><li id="component-overview-html-optimistic-locking" class="toc-item"><a href="component-overview.html#optimistic-locking">Optimistic Locking</a></li><li id="component-overview-html-pessimistic-locking" class="toc-item"><a href="component-overview.html#pessimistic-locking">Pessimistic Locking</a></li><li id="component-overview-html-examples" class="toc-item"><a href="component-overview.html#examples">Examples</a></li><li id="component-overview-html-technical-details" class="toc-item"><a href="component-overview.html#technical-details">Technical Details</a></li></ul></li><li id="component-overview-html-views" class="toc-item"><a href="component-overview.html#views">Views</a><ul><li id="component-overview-html-using-views" class="toc-item"><a href="component-overview.html#using-views">Using Views</a></li></ul></li><li id="component-overview-html-conclusion" class="toc-item"><a href="component-overview.html#conclusion">Conclusion</a></li></ul></li><li id="configuration-html-configuration" class="toc-item"><a href="configuration.html#configuration">Configuration</a><ul><li id="configuration-html-levels-of-configuration" class="toc-item"><a href="configuration.html#levels-of-configuration">Levels of Configuration</a></li><li id="configuration-html-default-attributes" class="toc-item"><a href="configuration.html#default-attributes">Default Attributes</a><ul><li id="configuration-html-default-column-options" class="toc-item"><a href="configuration.html#default-column-options">Default Column Options</a></li><li id="configuration-html-default-added-auto-id" class="toc-item"><a href="configuration.html#default-added-auto-id">Default Added Auto Id</a></li></ul></li><li id="configuration-html-portability" class="toc-item"><a href="configuration.html#portability">Portability</a><ul><li id="configuration-html-portability-mode-attributes" class="toc-item"><a href="configuration.html#portability-mode-attributes">Portability Mode Attributes</a></li><li id="configuration-html-examples" class="toc-item"><a href="configuration.html#examples">Examples</a></li></ul></li><li id="configuration-html-identifier-quoting" class="toc-item"><a href="configuration.html#identifier-quoting">Identifier quoting</a></li><li id="configuration-html-hydration-overwriting" class="toc-item"><a href="configuration.html#hydration-overwriting">Hydration Overwriting</a></li><li id="configuration-html-configure-table-class" class="toc-item"><a href="configuration.html#configure-table-class">Configure Table Class</a></li><li id="configuration-html-configure-query-class" class="toc-item"><a href="configuration.html#configure-query-class">Configure Query Class</a></li><li id="configuration-html-configure-collection-class" class="toc-item"><a href="configuration.html#configure-collection-class">Configure Collection Class</a></li><li id="configuration-html-disabling-cascading-saves" class="toc-item"><a href="configuration.html#disabling-cascading-saves">Disabling Cascading Saves</a></li><li id="configuration-html-exporting" class="toc-item"><a href="configuration.html#exporting">Exporting</a></li><li id="configuration-html-naming-convention-attributes" class="toc-item"><a href="configuration.html#naming-convention-attributes">Naming convention attributes</a><ul><li id="configuration-html-index-name-format" class="toc-item"><a href="configuration.html#index-name-format">Index name format</a></li><li id="configuration-html-sequence-name-format" class="toc-item"><a href="configuration.html#sequence-name-format">Sequence name format</a></li><li id="configuration-html-table-name-format" class="toc-item"><a href="configuration.html#table-name-format">Table name format</a></li><li id="configuration-html-database-name-format" class="toc-item"><a href="configuration.html#database-name-format">Database name format</a></li><li id="configuration-html-validation-attributes" class="toc-item"><a href="configuration.html#validation-attributes">Validation attributes</a></li><li id="configuration-html-validation-mode-constants" class="toc-item"><a href="configuration.html#validation-mode-constants">Validation mode constants</a></li><li id="configuration-html-examples" class="toc-item"><a href="configuration.html#examples">Examples</a></li></ul></li><li id="configuration-html-conclusion" class="toc-item"><a href="configuration.html#conclusion">Conclusion</a></li></ul></li><li id="data-fixtures-html-data-fixtures" class="toc-item"><a href="data-fixtures.html#data-fixtures">Data Fixtures</a><ul><li id="data-fixtures-html-importing" class="toc-item"><a href="data-fixtures.html#importing">Importing</a></li><li id="data-fixtures-html-dumping" class="toc-item"><a href="data-fixtures.html#dumping">Dumping</a></li><li id="data-fixtures-html-implement" class="toc-item"><a href="data-fixtures.html#implement">Implement</a></li><li id="data-fixtures-html-writing" class="toc-item"><a href="data-fixtures.html#writing">Writing</a></li><li id="data-fixtures-html-fixtures-for-nested-sets" class="toc-item"><a href="data-fixtures.html#fixtures-for-nested-sets">Fixtures For Nested Sets</a></li><li id="data-fixtures-html-fixtures-for-i18n" class="toc-item"><a href="data-fixtures.html#fixtures-for-i18n">Fixtures For I18n</a></li><li id="data-fixtures-html-conclusion" class="toc-item"><a href="data-fixtures.html#conclusion">Conclusion</a></li></ul></li><li id="defining-models-html-defining-models" class="toc-item"><a href="defining-models.html#defining-models">Defining Models</a><ul><li id="defining-models-html-columns" class="toc-item"><a href="defining-models.html#columns">Columns</a><ul><li id="defining-models-html-column-lengths" class="toc-item"><a href="defining-models.html#column-lengths">Column Lengths</a></li><li id="defining-models-html-column-aliases" class="toc-item"><a href="defining-models.html#column-aliases">Column Aliases</a></li><li id="defining-models-html-default-values" class="toc-item"><a href="defining-models.html#default-values">Default values</a></li><li id="defining-models-html-data-types" class="toc-item"><a href="defining-models.html#data-types">Data types</a></li><li id="defining-models-html-examples" class="toc-item"><a href="defining-models.html#examples">Examples</a></li></ul></li><li id="defining-models-html-relationships" class="toc-item"><a href="defining-models.html#relationships">Relationships</a><ul><li id="defining-models-html-introduction" class="toc-item"><a href="defining-models.html#introduction">Introduction</a></li><li id="defining-models-html-foreign-key-associations" class="toc-item"><a href="defining-models.html#foreign-key-associations">Foreign Key Associations</a></li><li id="defining-models-html-join-table-associations" class="toc-item"><a href="defining-models.html#join-table-associations">Join Table Associations</a></li><li id="defining-models-html-foreign-key-constraints" class="toc-item"><a href="defining-models.html#foreign-key-constraints">Foreign Key Constraints</a></li></ul></li><li id="defining-models-html-indexes" class="toc-item"><a href="defining-models.html#indexes">Indexes</a><ul><li id="defining-models-html-introduction" class="toc-item"><a href="defining-models.html#introduction">Introduction</a></li><li id="defining-models-html-adding-indexes" class="toc-item"><a href="defining-models.html#adding-indexes">Adding indexes</a></li><li id="defining-models-html-index-options" class="toc-item"><a href="defining-models.html#index-options">Index options</a></li><li id="defining-models-html-special-indexes" class="toc-item"><a href="defining-models.html#special-indexes">Special indexes</a></li></ul></li><li id="defining-models-html-checks" class="toc-item"><a href="defining-models.html#checks">Checks</a></li><li id="defining-models-html-table-options" class="toc-item"><a href="defining-models.html#table-options">Table Options</a></li><li id="defining-models-html-record-filters" class="toc-item"><a href="defining-models.html#record-filters">Record Filters</a></li><li id="defining-models-html-transitive-persistence" class="toc-item"><a href="defining-models.html#transitive-persistence">Transitive Persistence</a><ul><li id="defining-models-html-application-level-cascades" class="toc-item"><a href="defining-models.html#application-level-cascades">Application-Level Cascades</a></li><li id="defining-models-html-database-level-cascades" class="toc-item"><a href="defining-models.html#database-level-cascades">Database-Level Cascades</a></li></ul></li><li id="defining-models-html-conclusion" class="toc-item"><a href="defining-models.html#conclusion">Conclusion</a></li></ul></li><li id="transactions-html-transactions" class="toc-item"><a href="transactions.html#transactions">Transactions</a><ul><li id="transactions-html-introduction" class="toc-item"><a href="transactions.html#introduction">Introduction</a></li><li id="transactions-html-nesting" class="toc-item"><a href="transactions.html#nesting">Nesting</a></li><li id="transactions-html-savepoints" class="toc-item"><a href="transactions.html#savepoints">Savepoints</a></li><li id="transactions-html-isolation-levels" class="toc-item"><a href="transactions.html#isolation-levels">Isolation Levels</a></li><li id="transactions-html-conclusion" class="toc-item"><a href="transactions.html#conclusion">Conclusion</a></li></ul></li><li id="exceptions-and-warnings-html-exceptions-and-warnings" class="toc-item"><a href="exceptions-and-warnings.html#exceptions-and-warnings">Exceptions and Warnings</a><ul><li id="exceptions-and-warnings-html-manager-exceptions" class="toc-item"><a href="exceptions-and-warnings.html#manager-exceptions">Manager exceptions</a></li><li id="exceptions-and-warnings-html-relation-exceptions" class="toc-item"><a href="exceptions-and-warnings.html#relation-exceptions">Relation exceptions</a></li><li id="exceptions-and-warnings-html-connection-exceptions" class="toc-item"><a href="exceptions-and-warnings.html#connection-exceptions">Connection exceptions</a></li><li id="exceptions-and-warnings-html-query-exceptions" class="toc-item"><a href="exceptions-and-warnings.html#query-exceptions">Query exceptions</a></li><li id="exceptions-and-warnings-html-conclusion" class="toc-item"><a href="exceptions-and-warnings.html#conclusion">Conclusion</a></li></ul></li><li id="unit-testing-html-unit-testing" class="toc-item"><a href="unit-testing.html#unit-testing">Unit Testing</a><ul><li id="unit-testing-html-running-tests" class="toc-item"><a href="unit-testing.html#running-tests">Running tests</a><ul><li id="unit-testing-html-cli" class="toc-item"><a href="unit-testing.html#cli">CLI</a></li><li id="unit-testing-html-browser" class="toc-item"><a href="unit-testing.html#browser">Browser</a></li></ul></li><li id="unit-testing-html-writing-tests" class="toc-item"><a href="unit-testing.html#writing-tests">Writing Tests</a><ul><li id="unit-testing-html-ticket-tests" class="toc-item"><a href="unit-testing.html#ticket-tests">Ticket Tests</a></li><li id="unit-testing-html-methods-for-testing" class="toc-item"><a href="unit-testing.html#methods-for-testing">Methods for testing</a></li><li id="unit-testing-html-mock-drivers" class="toc-item"><a href="unit-testing.html#mock-drivers">Mock Drivers</a></li><li id="unit-testing-html-test-class-guidelines" class="toc-item"><a href="unit-testing.html#test-class-guidelines">Test Class Guidelines</a></li><li id="unit-testing-html-test-method-guidelines" class="toc-item"><a href="unit-testing.html#test-method-guidelines">Test Method Guidelines</a></li></ul></li><li id="unit-testing-html-conclusion" class="toc-item"><a href="unit-testing.html#conclusion">Conclusion</a></li></ul></li><li id="real-world-examples-html-real-world-examples" class="toc-item"><a href="real-world-examples.html#real-world-examples">Real World Examples</a><ul><li id="real-world-examples-html-user-management-system" class="toc-item"><a href="real-world-examples.html#user-management-system">User Management System</a></li><li id="real-world-examples-html-forum-application" class="toc-item"><a href="real-world-examples.html#forum-application">Forum Application</a></li><li id="real-world-examples-html-conclusion" class="toc-item"><a href="real-world-examples.html#conclusion">Conclusion</a></li></ul></li><li id="getting-started-html-getting-started" class="toc-item"><a href="getting-started.html#getting-started">Getting Started</a><ul><li id="getting-started-html-checking-requirements" class="toc-item"><a href="getting-started.html#checking-requirements">Checking Requirements</a></li><li id="getting-started-html-installing" class="toc-item"><a href="getting-started.html#installing">Installing</a><ul><li id="getting-started-html-sandbox" class="toc-item"><a href="getting-started.html#sandbox">Sandbox</a></li><li id="getting-started-html-svn" class="toc-item"><a href="getting-started.html#svn">SVN</a></li><li id="getting-started-html-svn-externals" class="toc-item"><a href="getting-started.html#svn-externals">SVN Externals</a></li><li id="getting-started-html-pear-installer" class="toc-item"><a href="getting-started.html#pear-installer">PEAR Installer</a></li><li id="getting-started-html-download-pear-package" class="toc-item"><a href="getting-started.html#download-pear-package">Download Pear Package</a></li></ul></li><li id="getting-started-html-implementing" class="toc-item"><a href="getting-started.html#implementing">Implementing</a><ul><li id="getting-started-html-including-doctrine-libraries" class="toc-item"><a href="getting-started.html#including-doctrine-libraries">Including Doctrine Libraries</a></li><li id="getting-started-html-require-doctrine-base-class" class="toc-item"><a href="getting-started.html#require-doctrine-base-class">Require Doctrine Base Class</a></li><li id="getting-started-html-register-autoloader" class="toc-item"><a href="getting-started.html#register-autoloader">Register Autoloader</a></li><li id="getting-started-html-bootstrap-file" class="toc-item"><a href="getting-started.html#bootstrap-file">Bootstrap File</a></li><li id="getting-started-html-test-script" class="toc-item"><a href="getting-started.html#test-script">Test Script</a></li></ul></li><li id="getting-started-html-conclusion" class="toc-item"><a href="getting-started.html#conclusion">Conclusion</a></li></ul></li><li id="imprint-html-imprint" class="toc-item"><a href="imprint.html#imprint">Imprint</a></li><li id="dql-doctrine-query-language-html-dql-doctrine-query-language" class="toc-item"><a href="dql-doctrine-query-language.html#dql-doctrine-query-language">DQL: Doctrine Query Language</a><ul><li id="dql-doctrine-query-language-html-introduction" class="toc-item"><a href="dql-doctrine-query-language.html#introduction">Introduction</a></li><li id="dql-doctrine-query-language-html-select-queries" class="toc-item"><a href="dql-doctrine-query-language.html#select-queries">SELECT queries</a></li><li id="dql-doctrine-query-language-html-update-queries" class="toc-item"><a href="dql-doctrine-query-language.html#update-queries">UPDATE queries</a></li><li id="dql-doctrine-query-language-html-delete-queries" class="toc-item"><a href="dql-doctrine-query-language.html#delete-queries">DELETE Queries</a></li><li id="dql-doctrine-query-language-html-from-clause" class="toc-item"><a href="dql-doctrine-query-language.html#from-clause">FROM clause</a></li><li id="dql-doctrine-query-language-html-join-syntax" class="toc-item"><a href="dql-doctrine-query-language.html#join-syntax">JOIN syntax</a></li><li id="dql-doctrine-query-language-html-indexby-keyword" class="toc-item"><a href="dql-doctrine-query-language.html#indexby-keyword">INDEXBY keyword</a></li><li id="dql-doctrine-query-language-html-where-clause" class="toc-item"><a href="dql-doctrine-query-language.html#where-clause">WHERE clause</a></li><li id="dql-doctrine-query-language-html-conditional-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#conditional-expressions">Conditional expressions</a></li><li id="dql-doctrine-query-language-html-functional-expressions" class="toc-item"><a href="dql-doctrine-query-language.html#functional-expressions">Functional Expressions</a></li><li id="dql-doctrine-query-language-html-subqueries" class="toc-item"><a href="dql-doctrine-query-language.html#subqueries">Subqueries</a></li><li id="dql-doctrine-query-language-html-group-by-having-clauses" class="toc-item"><a href="dql-doctrine-query-language.html#group-by-having-clauses">GROUP BY, HAVING clauses</a></li><li id="dql-doctrine-query-language-html-order-by-clause" class="toc-item"><a href="dql-doctrine-query-language.html#order-by-clause">ORDER BY clause</a></li><li id="dql-doctrine-query-language-html-limit-and-offset-clauses" class="toc-item"><a href="dql-doctrine-query-language.html#limit-and-offset-clauses">LIMIT and OFFSET clauses</a></li><li id="dql-doctrine-query-language-html-named-queries" class="toc-item"><a href="dql-doctrine-query-language.html#named-queries">Named Queries</a></li><li id="dql-doctrine-query-language-html-bnf" class="toc-item"><a href="dql-doctrine-query-language.html#bnf">BNF</a></li><li id="dql-doctrine-query-language-html-magic-finders" class="toc-item"><a href="dql-doctrine-query-language.html#magic-finders">Magic Finders</a></li><li id="dql-doctrine-query-language-html-debugging-queries" class="toc-item"><a href="dql-doctrine-query-language.html#debugging-queries">Debugging Queries</a></li><li id="dql-doctrine-query-language-html-conclusion" class="toc-item"><a href="dql-doctrine-query-language.html#conclusion">Conclusion</a></li></ul></li><li id="behaviors-html-behaviors" class="toc-item"><a href="behaviors.html#behaviors">Behaviors</a><ul><li id="behaviors-html-introduction" class="toc-item"><a href="behaviors.html#introduction">Introduction</a></li><li id="behaviors-html-simple-templates" class="toc-item"><a href="behaviors.html#simple-templates">Simple Templates</a></li><li id="behaviors-html-templates-with-relations" class="toc-item"><a href="behaviors.html#templates-with-relations">Templates with Relations</a></li><li id="behaviors-html-delegate-methods" class="toc-item"><a href="behaviors.html#delegate-methods">Delegate Methods</a></li><li id="behaviors-html-creating-behaviors" class="toc-item"><a href="behaviors.html#creating-behaviors">Creating Behaviors</a></li><li id="behaviors-html-core-behaviors" class="toc-item"><a href="behaviors.html#core-behaviors">Core Behaviors</a><ul><li id="behaviors-html-introduction" class="toc-item"><a href="behaviors.html#introduction">Introduction</a></li><li id="behaviors-html-versionable" class="toc-item"><a href="behaviors.html#versionable">Versionable</a></li><li id="behaviors-html-timestampable" class="toc-item"><a href="behaviors.html#timestampable">Timestampable</a></li><li id="behaviors-html-sluggable" class="toc-item"><a href="behaviors.html#sluggable">Sluggable</a></li><li id="behaviors-html-i18n" class="toc-item"><a href="behaviors.html#i18n">I18n</a></li><li id="behaviors-html-nestedset" class="toc-item"><a href="behaviors.html#nestedset">NestedSet</a></li><li id="behaviors-html-searchable" class="toc-item"><a href="behaviors.html#searchable">Searchable</a></li><li id="behaviors-html-geographical" class="toc-item"><a href="behaviors.html#geographical">Geographical</a></li><li id="behaviors-html-softdelete" class="toc-item"><a href="behaviors.html#softdelete">SoftDelete</a></li></ul></li><li id="behaviors-html-nesting-behaviors" class="toc-item"><a href="behaviors.html#nesting-behaviors">Nesting Behaviors</a></li><li id="behaviors-html-generating-files" class="toc-item"><a href="behaviors.html#generating-files">Generating Files</a></li><li id="behaviors-html-querying-generated-classes" class="toc-item"><a href="behaviors.html#querying-generated-classes">Querying Generated Classes</a></li><li id="behaviors-html-conclusion" class="toc-item"><a href="behaviors.html#conclusion">Conclusion</a></li></ul></li><li id="introduction-html-introduction" class="toc-item"><a href="introduction.html#introduction">Introduction</a><ul><li id="introduction-html-about-this-version" class="toc-item"><a href="introduction.html#about-this-version">About this Version</a></li><li id="introduction-html-how-to-contribute" class="toc-item"><a href="introduction.html#how-to-contribute">How to Contribute</a></li><li id="introduction-html-what-is-doctrine" class="toc-item"><a href="introduction.html#what-is-doctrine">What is Doctrine?</a></li><li id="introduction-html-what-is-an-orm" class="toc-item"><a href="introduction.html#what-is-an-orm">What is an ORM?</a></li><li id="introduction-html-what-is-the-problem" class="toc-item"><a href="introduction.html#what-is-the-problem">What is the Problem?</a></li><li id="introduction-html-minimum-requirements" class="toc-item"><a href="introduction.html#minimum-requirements">Minimum Requirements</a></li><li id="introduction-html-basic-overview" class="toc-item"><a href="introduction.html#basic-overview">Basic Overview</a></li><li id="introduction-html-doctrine-explained" class="toc-item"><a href="introduction.html#doctrine-explained">Doctrine Explained</a></li><li id="introduction-html-key-concepts" class="toc-item"><a href="introduction.html#key-concepts">Key Concepts</a></li><li id="introduction-html-further-reading" class="toc-item"><a href="introduction.html#further-reading">Further Reading</a></li><li id="introduction-html-conclusion" class="toc-item"><a href="introduction.html#conclusion">Conclusion</a></li></ul></li><li id="index-html-english-documentation" class="toc-item"><a href="../index.html#english-documentation">English Documentation</a></li><li id="cookbook-code-igniter-and-doctrine-html-codeigniter-and-doctrine" class="toc-item"><a href="../cookbook/code-igniter-and-doctrine.html#codeigniter-and-doctrine">CodeIgniter and Doctrine</a><ul><li id="cookbook-code-igniter-and-doctrine-html-download-doctrine" class="toc-item"><a href="../cookbook/code-igniter-and-doctrine.html#download-doctrine">Download Doctrine</a></li><li id="cookbook-code-igniter-and-doctrine-html-setup-doctrine" class="toc-item"><a href="../cookbook/code-igniter-and-doctrine.html#setup-doctrine">Setup Doctrine</a></li><li id="cookbook-code-igniter-and-doctrine-html-setup-command-line-interface" class="toc-item"><a href="../cookbook/code-igniter-and-doctrine.html#setup-command-line-interface">Setup Command Line Interface</a></li><li id="cookbook-code-igniter-and-doctrine-html-start-using-doctrine" class="toc-item"><a href="../cookbook/code-igniter-and-doctrine.html#start-using-doctrine">Start Using Doctrine</a></li></ul></li><li id="cookbook-taking-advantage-of-column-aggregation-inheritance-html-taking-advantage-of-column-aggregation-inheritance" class="toc-item"><a href="../cookbook/taking-advantage-of-column-aggregation-inheritance.html#taking-advantage-of-column-aggregation-inheritance">Taking Advantage of Column Aggregation Inheritance</a></li><li id="cookbook-plug-and-play-schema-information-with-templates-html-plug-and-play-schema-information-with-templates" class="toc-item"><a href="../cookbook/plug-and-play-schema-information-with-templates.html#plug-and-play-schema-information-with-templates">Plug and Play Schema Information with Templates</a></li><li id="cookbook-record-based-retrieval-security-template-html-record-based-retrieval-security-template" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#record-based-retrieval-security-template">Record-based Retrieval Security Template</a><ul><li id="cookbook-record-based-retrieval-security-template-html-introduction" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#introduction">Introduction</a></li><li id="cookbook-record-based-retrieval-security-template-html-template" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#template">Template</a></li><li id="cookbook-record-based-retrieval-security-template-html-yaml-schema-syntax" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#yaml-schema-syntax">YAML schema syntax</a></li><li id="cookbook-record-based-retrieval-security-template-html-using-the-template" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#using-the-template">Using the template</a></li><li id="cookbook-record-based-retrieval-security-template-html-user-setup" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#user-setup">User setup</a></li><li id="cookbook-record-based-retrieval-security-template-html-querying" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#querying">Querying</a></li><li id="cookbook-record-based-retrieval-security-template-html-restrictions" class="toc-item"><a href="../cookbook/record-based-retrieval-security-template.html#restrictions">Restrictions</a></li></ul></li><li id="cookbook-creating-a-unit-of-work-using-doctrine-html-writing-a-unit-of-work-in-php-doctrine" class="toc-item"><a href="../cookbook/creating-a-unit-of-work-using-doctrine.html#writing-a-unit-of-work-in-php-doctrine">Writing a Unit of Work in PHP Doctrine</a></li><li id="cookbook-index-html-cookbook" class="toc-item"><a href="../cookbook/index.html#cookbook">Cookbook</a></li><li id="cookbook-my-first-project-html-introduction" class="toc-item"><a href="../cookbook/my-first-project.html#introduction">Introduction</a></li><li id="cookbook-my-first-project-html-download" class="toc-item"><a href="../cookbook/my-first-project.html#download">Download</a><ul><li id="cookbook-my-first-project-html-package-contents" class="toc-item"><a href="../cookbook/my-first-project.html#package-contents">Package Contents</a></li></ul></li><li id="cookbook-my-first-project-html-running-the-cli" class="toc-item"><a href="../cookbook/my-first-project.html#running-the-cli">Running the CLI</a></li><li id="cookbook-my-first-project-html-defining-schema" class="toc-item"><a href="../cookbook/my-first-project.html#defining-schema">Defining Schema</a></li><li id="cookbook-my-first-project-html-test-data-fixtures" class="toc-item"><a href="../cookbook/my-first-project.html#test-data-fixtures">Test Data Fixtures</a></li><li id="cookbook-my-first-project-html-building-everything-now-that-you-have-written-your-schema-files-and" class="toc-item"><a href="../cookbook/my-first-project.html#building-everything-now-that-you-have-written-your-schema-files-and">Building Everything Now that you have written your schema files and</a></li><li id="cookbook-my-first-project-html-running-tests" class="toc-item"><a href="../cookbook/my-first-project.html#running-tests">Running Tests</a><ul><li id="cookbook-my-first-project-html-user-crud" class="toc-item"><a href="../cookbook/my-first-project.html#user-crud">User CRUD</a></li></ul></li><li id="cookbook-master-and-slave-connections-html-master-and-slave-connections" class="toc-item"><a href="../cookbook/master-and-slave-connections.html#master-and-slave-connections">Master and Slave Connections</a></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://www.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "Doctrine1",
            "item": "https://www.doctrine-project.org/projects/doctrine1.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://www.doctrine-project.org/projects/doctrine1/en/latest/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "DQL: Doctrine Query Language",
            "item": "https://www.doctrine-project.org/projects/doctrine1/en/latest/manual/dql-doctrine-query-language.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine1.html">Doctrine1</a></li>
                                                <li class="breadcrumb-item"><a href="https://www.doctrine-project.org/projects/doctrine1/en/latest/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">DQL: Doctrine Query Language</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>This project is no longer maintained and has been archived.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine1/en/latest/manual/dql-doctrine-query-language.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        master
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item active" href="/projects/doctrine1/en/latest/manual/dql-doctrine-query-language.html">
                                                    master

                                                    
                                                                                                    </a>
                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                        </div>
                                </div>
                            
                            
<hr />
<div class="section"><a class="section-anchor" id="dql-doctrine-query-language" name="dql-doctrine-query-language"></a><h1 class="section-header"><a href="#dql-doctrine-query-language">DQL: Doctrine Query Language<i class="fas fa-link"></i></a></h1>
<hr />
<div class="section"><a class="section-anchor" id="introduction" name="introduction"></a><h2 class="section-header"><a href="#introduction">Introduction<i class="fas fa-link"></i></a></h2>
<p>Doctrine Query Language (DQL) is an Object Query Language created for helping
users in complex object retrieval. You should always consider using DQL (or raw
SQL) when retrieving relational data efficiently (eg.  when fetching users and
their phonenumbers).</p>
<p>In this chapter we will execute dozens of examples of how to use the Doctrine
Query Language. All of these examples assume you are using the schemas defined
in the previous chapters, primarily the <a href="defining-models.html">Defining Models</a> chapter. We will
define one additional model for our testing purposes:</p>
<pre><code class="">// models/Account.php
class Account extends Doctrine_Record
{
    public function setTableDefinition()
    {
        $this-&gt;hasColumn(&#039;name&#039;, &#039;string&#039;, 255);
        $this-&gt;hasColumn(&#039;amount&#039;, &#039;decimal&#039;);
    }
}
</code></pre>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a href="yaml-schema-files.html">YAML Schema Files</a> chapter:</p>
<pre><code class=""># schema.yml
Account:
  columns:
    name: string(255)
    amount: decimal
</code></pre>
<p>When compared to using raw SQL, DQL has several benefits:</p>
<ul><li> From the start it has been designed to retrieve records(objects) not
   result set rows</li>
<li> DQL understands relations so you don't have to type manually SQL
   joins and join conditions</li>
<li> DQL is portable on different databases</li>
<li> DQL has some very complex built-in algorithms like (the record limit
   algorithm) which can help the developer to efficiently retrieve
   objects</li>
<li> It supports some functions that can save time when dealing with
   one-to-many, many-to-many relational data with conditional fetching.</li>
</ul>

<p>If the power of DQL isn't enough, you should consider using the <a href="native-sql.html">RawSql
API</a> for object population.</p>
<p>You may already be familiar with the following syntax:</p>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>DO NOT USE THE FOLLOWING CODE. It uses many SQL queries
for object population.</p>
</td></tr></table></div>
<div class="console"><pre><code class="console">// test.php
<span class="noselect">$ </span>users = Doctrine_Core::getTable('User')->findAll();

foreach($users as $user) {
    echo $user->username . " has phonenumbers: ";

    foreach($user->Phonenumbers as $phonenumber) {
        echo $phonenumber->phonenumber . "\n";
    }
}</code></pre></div>
<div class="alert tip-admonition bg-success text-light border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-question-circle mr-2"></i></td><td><p>Here is the same code but implemented more efficiently using
only one SQL query for object population.</p>
<hr />
<blockquote><dl><dt>
                $q = Doctrine_Query

                                    <span class="classifier-delimiter">:</span><span class="classifier"></span><span class="classifier-delimiter">:</span><span class="classifier">create()</span></dt><dd>-&gt;from('User u') -&gt;leftJoin('u.Phonenumbers p'); </dd></dl>
<p>echo $q-&gt;getSqlQuery();</p>
</blockquote>
</td></tr></table></div>
<p>Lets take a look at the SQL that would be generated by the above query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="be89000f71a74f7f454eaf8befc3f96f4f6f2dae"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="be89000f71a74f7f454eaf8befc3f96f4f6f2dae"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-1" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-1">1</a></td><td class="code-line" rowspan="17"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.is_active <span class="hljs-keyword">AS</span> u__is_active,
    u.is_super_admin <span class="hljs-keyword">AS</span> u__is_super_admin,
    u.first_name <span class="hljs-keyword">AS</span> u__first_name,
    u.last_name <span class="hljs-keyword">AS</span> u__last_name,
    u.username <span class="hljs-keyword">AS</span> u__username,
    u.password <span class="hljs-keyword">AS</span> u__password,
    u.type <span class="hljs-keyword">AS</span> u__type,
    u.created_at <span class="hljs-keyword">AS</span> u__created_at,
    u.updated_at <span class="hljs-keyword">AS</span> u__updated_at,
    p.id <span class="hljs-keyword">AS</span> p__id,
    p.user_id <span class="hljs-keyword">AS</span> p__user_id,
    p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-2" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-3" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-4" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-5" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-6" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-7" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-8" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-9" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-10" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-11" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-12" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-13" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-14" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-15" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-16" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-17" class="line-number-anchor" /><a href="#line-number-be89000f71a74f7f454eaf8befc3f96f4f6f2dae-17">17</a></td></tr></table></div></code></pre>
<p>Now lets execute the query and play with the data:</p>
<pre><code class="">$users = $q-&gt;execute();

foreach($users as $user) {
    echo $user-&gt;username . &quot; has phonenumbers: &quot;;

    foreach($user-&gt;Phonenumbers as $phonenumber) {
        echo $phonenumber-&gt;phonenumber . &quot;\n&quot;;
    }
}
</code></pre>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>Using double quotes () in DQL strings is discouraged.  This is sensible in
MySQL standard but in DQL it can be confused as an identifier. Instead it is
recommended to use prepared statements for your values and it will be escaped
properly.</p>
</td></tr></table></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="select-queries" name="select-queries"></a><h2 class="section-header"><a href="#select-queries">SELECT queries<i class="fas fa-link"></i></a></h2>
<p><code>SELECT</code> statement syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="11e5ffc10bf60999700dbb8d5d86c889a447ba9f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="11e5ffc10bf60999700dbb8d5d86c889a447ba9f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-1" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-1">1</a></td><td class="code-line" rowspan="11"><span class="hljs-keyword">SELECT</span>
    [<span class="hljs-keyword">ALL</span> | <span class="hljs-keyword">DISTINCT</span>]
    &lt;select_expr&gt;, ...
    [<span class="hljs-keyword">FROM</span> &lt;components&gt;
    [<span class="hljs-keyword">WHERE</span> &lt;where_condition&gt;]
    [<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> &lt;groupby_expr&gt;
      [<span class="hljs-keyword">ASC</span> | <span class="hljs-keyword">DESC</span>], ... ]
    [<span class="hljs-keyword">HAVING</span> &lt;where_condition&gt;]
    [<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> &lt;orderby_expr&gt;
      [<span class="hljs-keyword">ASC</span> | <span class="hljs-keyword">DESC</span>], ...]
    [<span class="hljs-keyword">LIMIT</span> &lt;<span class="hljs-keyword">row_count</span>&gt; <span class="hljs-keyword">OFFSET</span> &lt;<span class="hljs-keyword">offset</span>&gt;]</td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-2" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-3" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-4" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-5" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-6" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-7" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-8" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-9" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-10" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-11" class="line-number-anchor" /><a href="#line-number-11e5ffc10bf60999700dbb8d5d86c889a447ba9f-11">11</a></td></tr></table></div></code></pre>
<p>The <code>SELECT</code> statement is used for the retrieval of data from one or more
components.</p>
<p>Each <code>select_expr</code> indicates a column or an aggregate function value that you
want to retrieve. There must be at least one <code>select_expr</code> in every
<code>SELECT</code> statement.</p>
<p>First insert a few sample <code>Account</code> records:</p>
<pre><code class="">// test.php
$account = new Account();
$account-&gt;name = &#039;test 1&#039;;

$account-&gt;amount = &#039;100.00&#039;;
$account-&gt;save();

$account = new Account();
$account-&gt;name = &#039;test 2&#039;;
$account-&gt;amount = &#039;200.00&#039;;
$account-&gt;save();
</code></pre>
<p>Be sure to execute test.php:</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php test.php
</code></pre></div>
<p>Now you can test the selecting of the data with these next few sample
queries:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;a.name&#039;)
        -&gt;from(&#039;Account a&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>Lets take a look at the SQL that would be generated by the above query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="5d1a86d91193988275c41d2c293e061e90491457"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="5d1a86d91193988275c41d2c293e061e90491457"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-5d1a86d91193988275c41d2c293e061e90491457-1" class="line-number-anchor" /><a href="#line-number-5d1a86d91193988275c41d2c293e061e90491457-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> a.id <span class="hljs-keyword">AS</span> a__id, a.name <span class="hljs-keyword">AS</span> a__name <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">account</span> a</td></tr></table></div></code></pre>
<div class="console"><pre><code class="console">// ...
<span class="noselect">$ </span>accounts = $q->execute();
print_r($accounts->toArray());</code></pre></div>
<p>The above example would produce the following output:</p>
<pre class="code-block-table"><code class="text"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a58d64f9bd1a88e2da76ef31339a50bd3701a4d0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a58d64f9bd1a88e2da76ef31339a50bd3701a4d0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-1" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-1">1</a></td><td class="code-line" rowspan="15">$ php test.php
Array (
    [0] => Array
        (
            [id] => 1
            [name] => test 1
            [amount] =>
        )
    [1] => Array
        (
            [id] => 2
            [name] => test 2
            [amount] =>
        )
)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-2" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-3" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-4" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-5" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-6" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-7" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-8" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-9" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-10" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-11" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-12" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-13" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-14" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-15" class="line-number-anchor" /><a href="#line-number-a58d64f9bd1a88e2da76ef31339a50bd3701a4d0-15">15</a></td></tr></table></div></code></pre>
<p>An asterisk can be used for selecting all columns from given component.
Even when using an asterisk the executed SQL queries never actually use
it (Doctrine converts asterisk to appropriate column names, hence
leading to better performance on some databases).</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.*')
        ->from('Account a');

echo $q->getSqlQuery();</code></pre></div>
<p>Compare the generated SQL from the last query example to the SQL
generated by the query right above:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="81f9c65d9ad8cea31978d38ce8bafc72adc0e059"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="81f9c65d9ad8cea31978d38ce8bafc72adc0e059"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-1" class="line-number-anchor" /><a href="#line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-keyword">SELECT</span>
    a.id <span class="hljs-keyword">AS</span> a__id,
    a.name <span class="hljs-keyword">AS</span> a__name,
    a.amount <span class="hljs-keyword">AS</span> a__amount
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">account</span> a</td></tr>
<tr><td class="line-number noselect"><a name="line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-2" class="line-number-anchor" /><a href="#line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-3" class="line-number-anchor" /><a href="#line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-4" class="line-number-anchor" /><a href="#line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-5" class="line-number-anchor" /><a href="#line-number-81f9c65d9ad8cea31978d38ce8bafc72adc0e059-5">5</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the asterisk is replace by all the real column names that exist
in the <code>Account</code> model.</p>
</td></tr></table></div>
<p>Now lets execute the query and inspect the results:</p>
<pre><code class="">$accounts = $q-&gt;execute();
print_r($accounts-&gt;toArray());
</code></pre>
<p>The above example would produce the following output:</p>
<pre class="code-block-table"><code class="text"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b083f6251013133dea5fdbc341a8c78b3e782c51"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b083f6251013133dea5fdbc341a8c78b3e782c51"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-1" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-1">1</a></td><td class="code-line" rowspan="15">$ php test.php
Array (
    [0] => Array
        (
            [id] => 1
            [name] => test 1
            [amount] => 100.00
        )
    [1] => Array
        (
            [id] => 2
            [name] => test 2
            [amount] => 200.00
        )
)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-2" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-3" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-4" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-5" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-6" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-7" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-8" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-9" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-10" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-11" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-12" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-13" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-14" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-15" class="line-number-anchor" /><a href="#line-number-b083f6251013133dea5fdbc341a8c78b3e782c51-15">15</a></td></tr></table></div></code></pre>
<p><code>FROM</code> clause components indicate the component or components
from which to retrieve records.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username, p.*')
        ->from('User u')
        ->leftJoin('u.Phonenumbers p')

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8a52e40137b925235b36ae342a46256badc68fcb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8a52e40137b925235b36ae342a46256badc68fcb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-1" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username,
    p.id <span class="hljs-keyword">AS</span> p__id,
    p.user_id <span class="hljs-keyword">AS</span> p__user_id,
    p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-2" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-3" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-4" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-5" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-6" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-7" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-8" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8a52e40137b925235b36ae342a46256badc68fcb-9" class="line-number-anchor" /><a href="#line-number-8a52e40137b925235b36ae342a46256badc68fcb-9">9</a></td></tr></table></div></code></pre>
<p>The <code>WHERE</code> clause, if given, indicates the condition or conditions
that the records must satisfy to be selected. <code>where_condition</code> is an
expression that evaluates to true for each row to be selected. The
statement selects all rows if there is no <code>WHERE</code> clause.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.name')
        ->from('Account a')
        ->where('a.amount > 2000');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9b90ec4ab80f546d32b9f3633d6bf829b9c41424"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9b90ec4ab80f546d32b9f3633d6bf829b9c41424"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9b90ec4ab80f546d32b9f3633d6bf829b9c41424-1" class="line-number-anchor" /><a href="#line-number-9b90ec4ab80f546d32b9f3633d6bf829b9c41424-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> a.id <span class="hljs-keyword">AS</span> a__id, a.name <span class="hljs-keyword">AS</span> a__name <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">account</span> a <span class="hljs-keyword">WHERE</span> a.amount &gt; <span class="hljs-number">2000</span></td></tr></table></div></code></pre>
<p>In the <code>WHERE</code> clause, you can use any of the functions and operators
that DQL supports, except for aggregate (summary) functions. The
<code>HAVING</code> clause can be used for narrowing the results with aggregate
functions:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.username&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p&#039;)
        -&gt;having(&#039;COUNT(p.id) &gt; 3&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="a97d9495d754bd3e98b4ae1d2825be5f35c2535a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="a97d9495d754bd3e98b4ae1d2825be5f35c2535a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-1" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-keyword">SELECT</span>
   u.id <span class="hljs-keyword">AS</span> u__id,
   u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(p.id) &gt; <span class="hljs-number">3</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-2" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-3" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-4" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-5" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-6" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-7" class="line-number-anchor" /><a href="#line-number-a97d9495d754bd3e98b4ae1d2825be5f35c2535a-7">7</a></td></tr></table></div></code></pre>
<p>The <code>ORDER BY</code> clause can be used for sorting the results:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.username&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;orderBy(&#039;u.username&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="09f216e1ee081f642c1ad372a0df4e0f2ce55cbb"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="09f216e1ee081f642c1ad372a0df4e0f2ce55cbb"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-1" class="line-number-anchor" /><a href="#line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> u.username</td></tr>
<tr><td class="line-number noselect"><a name="line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-2" class="line-number-anchor" /><a href="#line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-3" class="line-number-anchor" /><a href="#line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-4" class="line-number-anchor" /><a href="#line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-5" class="line-number-anchor" /><a href="#line-number-09f216e1ee081f642c1ad372a0df4e0f2ce55cbb-5">5</a></td></tr></table></div></code></pre>
<p>The <code>LIMIT</code> and <code>OFFSET</code> clauses can be used for efficiently
limiting the number of records to a given <code>row_count</code>:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.username&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;limit(20);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9d6cae60ecab0cc19a12f130ee29461241cde888"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9d6cae60ecab0cc19a12f130ee29461241cde888"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9d6cae60ecab0cc19a12f130ee29461241cde888-1" class="line-number-anchor" /><a href="#line-number-9d6cae60ecab0cc19a12f130ee29461241cde888-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id, u.username <span class="hljs-keyword">AS</span> u__username <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span></td></tr></table></div></code></pre>
<hr />
<div class="section"><a class="section-anchor" id="aggregate-values" name="aggregate-values"></a><h4 class="section-header"><a href="#aggregate-values">Aggregate values<i class="fas fa-link"></i></a></h4>
<p>Aggregate value <code>SELECT</code> syntax:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, COUNT(t.id) AS num_threads&#039;)
        -&gt;from(&#039;User u, u.Threads t&#039;)
        -&gt;where(&#039;u.id = ?&#039;, 1)
        -&gt;groupBy(&#039;u.id&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="cb8b5603b456ff969a7e6e488a94e54eb3564f29"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="cb8b5603b456ff969a7e6e488a94e54eb3564f29"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-1" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    <span class="hljs-keyword">COUNT</span>(f.id) <span class="hljs-keyword">AS</span> f__0
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> forum__thread f
        <span class="hljs-keyword">ON</span> u.id = f.user_id
<span class="hljs-keyword">WHERE</span> u.id = ?
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> u.id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-2" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-3" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-4" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-5" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-6" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-7" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-8" class="line-number-anchor" /><a href="#line-number-cb8b5603b456ff969a7e6e488a94e54eb3564f29-8">8</a></td></tr></table></div></code></pre>
<p>Now execute the query and inspect the results:</p>
<pre><code class="">$users = $q-&gt;execute();
</code></pre>
<p>You can easily access the <code>num_threads</code> data with the following code:</p>
<pre><code class="">echo $users-&gt;num_threads . &#039; threads found&#039;;
</code></pre>
<hr />
</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="update-queries" name="update-queries"></a><h2 class="section-header"><a href="#update-queries">UPDATE queries<i class="fas fa-link"></i></a></h2>
<p><code>UPDATE</code> statement syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4624339ee27520dc6970d4ab0f8d2544dd66dd57"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4624339ee27520dc6970d4ab0f8d2544dd66dd57"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-1" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-keyword">UPDATE</span> &lt;component_name&gt;
<span class="hljs-keyword">SET</span>
    &lt;col_name1&gt; = &lt;expr1&gt;,
    &lt;col_name2&gt; = &lt;expr2&gt;
<span class="hljs-keyword">WHERE</span> &lt;where_condition&gt;
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> &lt;order_by&gt;
<span class="hljs-keyword">LIMIT</span> &lt;record_count&gt;</td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-2" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-3" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-4" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-5" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-6" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-7" class="line-number-anchor" /><a href="#line-number-4624339ee27520dc6970d4ab0f8d2544dd66dd57-7">7</a></td></tr></table></div></code></pre>
<ul><li> The <code>UPDATE</code> statement updates columns of existing records in
   <code>component_name</code> with new values and returns the number of
   affected records.</li>
<li> The <code>SET</code> clause indicates which columns to modify and the values
   they should be given.</li>
<li> The optional <code>WHERE</code> clause specifies the conditions that identify
   which records to update. Without <code>WHERE</code> clause, all records are
   updated.</li>
<li> The optional <code>ORDER BY</code> clause specifies the order in which the
   records are being updated.</li>
<li> The <code>LIMIT</code> clause places a limit on the number of records that can
   be updated. You can use <code>LIMIT row_count</code> to restrict the scope of
   the <code>UPDATE</code>. A <code>LIMIT</code> clause is a <strong>rows-matched restriction</strong>
   not a rows-changed restriction. The statement stops as soon as it has
   found <code>record_count</code> rows that satisfy the <code>WHERE</code> clause,
   whether or not they actually were changed.</li>
</ul>

<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->update('Account')
        ->set('amount', 'amount + 200')
        ->where('id > 200');

// If you just want to set the amount to a value
//   $q->set('amount', '?', 500);

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8faca2c3c83db04321fdbd38dc98021a840190dd"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8faca2c3c83db04321fdbd38dc98021a840190dd"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8faca2c3c83db04321fdbd38dc98021a840190dd-1" class="line-number-anchor" /><a href="#line-number-8faca2c3c83db04321fdbd38dc98021a840190dd-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">account</span> <span class="hljs-keyword">SET</span> amount = amount + <span class="hljs-number">200</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span> &gt; <span class="hljs-number">200</span></td></tr></table></div></code></pre>
<p>Now to perform the update is simple. Just execute the query:</p>
<pre><code class="">$rows = $q-&gt;execute();

echo $rows;
</code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="delete-queries" name="delete-queries"></a><h2 class="section-header"><a href="#delete-queries">DELETE Queries<i class="fas fa-link"></i></a></h2>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-1" class="line-number-anchor" /><a href="#line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> &lt;component_name&gt;
<span class="hljs-keyword">WHERE</span> &lt;where_condition&gt;
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> &lt;order_by&gt;
<span class="hljs-keyword">LIMIT</span> &lt;record_count&gt;</td></tr>
<tr><td class="line-number noselect"><a name="line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-2" class="line-number-anchor" /><a href="#line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-3" class="line-number-anchor" /><a href="#line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-4" class="line-number-anchor" /><a href="#line-number-4072d840dec2b2ea9623c6cd91fadcf1a84c0b7a-4">4</a></td></tr></table></div></code></pre>
<ul><li> The <code>DELETE</code> statement deletes records from <code>component_name</code> and
   returns the number of records deleted.</li>
<li> The optional <code>WHERE</code> clause specifies the conditions that identify
   which records to delete. Without <code>WHERE</code> clause, all records are
   deleted.</li>
<li> If the <code>ORDER BY</code> clause is specified, the records are deleted in
   the order that is specified.</li>
<li> The <code>LIMIT</code> clause places a limit on the number of rows that can be
   deleted. The statement will stop as soon as it has deleted
   <code>record_count</code> records.</li>
</ul>

<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->delete('Account a')
        ->where('a.id > 3');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="478cde3716d088f20c7bea471194d8476a057b7b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="478cde3716d088f20c7bea471194d8476a057b7b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-478cde3716d088f20c7bea471194d8476a057b7b-1" class="line-number-anchor" /><a href="#line-number-478cde3716d088f20c7bea471194d8476a057b7b-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">account</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">id</span> &gt; <span class="hljs-number">3</span></td></tr></table></div></code></pre>
<p>Now executing the <code>DELETE</code> query is just as you would think:</p>
<pre><code class="">$rows = $q-&gt;execute();

echo $rows;
</code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>When executing DQL UPDATE and DELETE queries the executing
of a query returns the number of affected rows.</p>
</td></tr></table></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="from-clause" name="from-clause"></a><h2 class="section-header"><a href="#from-clause">FROM clause<i class="fas fa-link"></i></a></h2>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="94453b796a277f3e183c455bb16707971149ebd4"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="94453b796a277f3e183c455bb16707971149ebd4"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-94453b796a277f3e183c455bb16707971149ebd4-1" class="line-number-anchor" /><a href="#line-number-94453b796a277f3e183c455bb16707971149ebd4-1">1</a></td><td class="code-line" rowspan="2">FROM &lt;component_reference&gt;
    [[LEFT | INNER] JOIN &lt;component_reference&gt;] ...</td></tr>
<tr><td class="line-number noselect"><a name="line-number-94453b796a277f3e183c455bb16707971149ebd4-2" class="line-number-anchor" /><a href="#line-number-94453b796a277f3e183c455bb16707971149ebd4-2">2</a></td></tr></table></div></code></pre>
<p>The <code>FROM</code> clause indicates the component or components from which to
retrieve records. If you name more than one component, you are performing a
join. For each table specified, you can optionally specify an alias.</p>
<p>Consider the following DQL query:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4ec6f0292cd83702757a9a5b2480feb02015e2e9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4ec6f0292cd83702757a9a5b2480feb02015e2e9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4ec6f0292cd83702757a9a5b2480feb02015e2e9-1" class="line-number-anchor" /><a href="#line-number-4ec6f0292cd83702757a9a5b2480feb02015e2e9-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u</td></tr></table></div></code></pre>
<p>Here <code>User</code> is the name of the class (component) and <code>u</code> is the alias. You
should always use short aliases, since most of the time those make the query
much shorther and also because when using for example caching the cached form
of the query takes less space when short aliases are being used.</p>
<hr />
</div>
<div class="section"><a class="section-anchor" id="join-syntax" name="join-syntax"></a><h2 class="section-header"><a href="#join-syntax">JOIN syntax<i class="fas fa-link"></i></a></h2>
<p>DQL JOIN Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b821e87f7f65d4b204b28101db76450842533c0b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b821e87f7f65d4b204b28101db76450842533c0b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b821e87f7f65d4b204b28101db76450842533c0b-1" class="line-number-anchor" /><a href="#line-number-b821e87f7f65d4b204b28101db76450842533c0b-1">1</a></td><td class="code-line" rowspan="4">[[LEFT | INNER] JOIN &lt;component_reference1&gt;] [ON | <span class="hljs-keyword">WITH</span>] &lt;join_condition1&gt; [INDEXBY] &lt;map_condition1&gt;,
[[<span class="hljs-keyword">LEFT</span> | <span class="hljs-keyword">INNER</span>] <span class="hljs-keyword">JOIN</span> &lt;component_reference2&gt;] [<span class="hljs-keyword">ON</span> | <span class="hljs-keyword">WITH</span>] &lt;join_condition2&gt; [INDEXBY] &lt;map_condition2&gt;,
...
[[<span class="hljs-keyword">LEFT</span> | <span class="hljs-keyword">INNER</span>] <span class="hljs-keyword">JOIN</span> &lt;component_referenceN&gt;] [<span class="hljs-keyword">ON</span> | <span class="hljs-keyword">WITH</span>] &lt;join_conditionN&gt; [INDEXBY] &lt;map_conditionN&gt;</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b821e87f7f65d4b204b28101db76450842533c0b-2" class="line-number-anchor" /><a href="#line-number-b821e87f7f65d4b204b28101db76450842533c0b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b821e87f7f65d4b204b28101db76450842533c0b-3" class="line-number-anchor" /><a href="#line-number-b821e87f7f65d4b204b28101db76450842533c0b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b821e87f7f65d4b204b28101db76450842533c0b-4" class="line-number-anchor" /><a href="#line-number-b821e87f7f65d4b204b28101db76450842533c0b-4">4</a></td></tr></table></div></code></pre>
<p>DQL supports two kinds of joins INNER JOINs and LEFT JOINs. For each joined
component, you can optionally specify an alias.</p>
<p>The default join type is <code>LEFT JOIN</code>. This join can be indicated by the use
of either <code>LEFT JOIN</code> clause or simply '<code>,</code>', hence the following queries
are equal:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, p.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p&#039;);

$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, p.id&#039;)
        -&gt;from(&#039;User u, u.Phonenumbers p&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<div class="alert tip-admonition bg-success text-light border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-question-circle mr-2"></i></td><td><p>The recommended form is the first because it is more verbose
and easier to read and understand what is being done.</p>
</td></tr></table></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="6324e449f2fe2288dc119ee8f28a8af8a1004cb6"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="6324e449f2fe2288dc119ee8f28a8af8a1004cb6"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-1" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
u.id <span class="hljs-keyword">AS</span> u__id,
    p.id <span class="hljs-keyword">AS</span> p__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
<span class="hljs-keyword">ON</span> u.id = p.user_id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-2" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-3" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-4" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-5" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-6" class="line-number-anchor" /><a href="#line-number-6324e449f2fe2288dc119ee8f28a8af8a1004cb6-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the JOIN condition is automatically added for
you. This is because Doctrine knows how <code>User</code> and <code>Phonenumber</code>
are related so it is able to add it for you.</p>
</td></tr></table></div>
<p><code>INNER JOIN</code> produces an intersection between two specified components (that
is, each and every record in the first component is joined to each and every
record in the second component). So basically <code>INNER JOIN</code> can be used when
you want to efficiently fetch for example all users which have one or more
phonenumbers.</p>
<p>By default DQL auto-adds the primary key join condition:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, p.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-1" class="line-number-anchor" /><a href="#line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    p.id <span class="hljs-keyword">AS</span> p__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">User</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Phonenumbers p <span class="hljs-keyword">ON</span> u.id = p.user_id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-2" class="line-number-anchor" /><a href="#line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-3" class="line-number-anchor" /><a href="#line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-4" class="line-number-anchor" /><a href="#line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-5" class="line-number-anchor" /><a href="#line-number-ec0fc03f2fa5fe72d1bab0033fe7c724b5647cec-5">5</a></td></tr></table></div></code></pre>
<hr />
<div class="section"><a class="section-anchor" id="on-keyword" name="on-keyword"></a><h4 class="section-header"><a href="#on-keyword">ON keyword<i class="fas fa-link"></i></a></h4>
<p>If you want to override this behavior and add your own custom join condition
you can do it with the <code>ON</code> keyword. Consider the following DQL query:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, p.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p ON u.id = 2&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="623c310d80b341e219df1b5715b2a76d0d3ddb42"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="623c310d80b341e219df1b5715b2a76d0d3ddb42"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-1" class="line-number-anchor" /><a href="#line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    p.id <span class="hljs-keyword">AS</span> p__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">User</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Phonenumbers p <span class="hljs-keyword">ON</span> u.id = <span class="hljs-number">2</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-2" class="line-number-anchor" /><a href="#line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-3" class="line-number-anchor" /><a href="#line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-4" class="line-number-anchor" /><a href="#line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-5" class="line-number-anchor" /><a href="#line-number-623c310d80b341e219df1b5715b2a76d0d3ddb42-5">5</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the <code>ON</code> condition that would be normally automatically added
is not present and the user specified condition is used instead.</p>
</td></tr></table></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="with-keyword" name="with-keyword"></a><h4 class="section-header"><a href="#with-keyword">WITH keyword<i class="fas fa-link"></i></a></h4>
<p>Most of the time you don't need to override the primary join condition,
rather you may want to add some custom conditions. This can be achieved
with the <code>WITH</code> keyword.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.id, p.id')
        ->from('User u')
        ->leftJoin('u.Phonenumbers p WITH u.id = 2');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4262b1305fe0f4ec6146495f3acde894917a532f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4262b1305fe0f4ec6146495f3acde894917a532f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-1" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    p.id <span class="hljs-keyword">AS</span> p__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">User</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Phonenumbers p
        <span class="hljs-keyword">ON</span> u.id = p.user_id <span class="hljs-keyword">AND</span> u.id = <span class="hljs-number">2</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-2" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-3" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-4" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-5" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4262b1305fe0f4ec6146495f3acde894917a532f-6" class="line-number-anchor" /><a href="#line-number-4262b1305fe0f4ec6146495f3acde894917a532f-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the <code>ON</code> condition isn't completely replaced.
Instead the conditions you specify are appended on to the automatic
condition that is added for you.</p>
</td></tr></table></div>
<p>The Doctrine_Query API offers two convenience methods for adding JOINS.  These
are called leftJoin, which usage should
be quite intuitive as shown below:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Groups g&#039;)
        -&gt;innerJoin(&#039;u.Phonenumbers p WITH u.id &gt; 3&#039;)
        -&gt;leftJoin(&#039;u.Email e&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b52a81ce0e1409178e75c2fca0f0539c5408d3f4"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b52a81ce0e1409178e75c2fca0f0539c5408d3f4"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-1" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-1">1</a></td><td class="code-line" rowspan="11"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> user_group u2
        <span class="hljs-keyword">ON</span> u.id = u2.user_id
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">groups</span> g
        <span class="hljs-keyword">ON</span> g.id = u2.group_id
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id <span class="hljs-keyword">AND</span> u.id &gt; <span class="hljs-number">3</span>
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> email e
        <span class="hljs-keyword">ON</span> u.id = e.user_id</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-2" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-3" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-4" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-5" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-6" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-7" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-8" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-9" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-10" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-11" class="line-number-anchor" /><a href="#line-number-b52a81ce0e1409178e75c2fca0f0539c5408d3f4-11">11</a></td></tr></table></div></code></pre>
<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="indexby-keyword" name="indexby-keyword"></a><h2 class="section-header"><a href="#indexby-keyword">INDEXBY keyword<i class="fas fa-link"></i></a></h2>
<p>The <code>INDEXBY</code> keyword offers a way of mapping certain columns as collection /
array keys. By default Doctrine indexes multiple elements to numerically
indexed arrays / collections. The mapping starts from zero. In order to
override this behavior you need to use <code>INDEXBY</code> keyword as shown above:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;from(&#039;User u INDEXBY u.username&#039;);

$users = $q-&gt;execute();
</code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The <code>INDEXBY</code> keyword does not alter the generated SQL.
It is simply used internally by Doctrine_Query to hydrate the
data with the specified column as the key of each record in the
collection.</p>
</td></tr></table></div>
<p>Now the users in <code>$users</code> collection are accessible through their
names:</p>
<pre><code class="">echo $user[&#039;jack daniels&#039;]-&gt;id;
</code></pre>
<p>The <code>INDEXBY</code> keyword can be applied to any given JOIN. This means
that any given component can have each own indexing behavior. In the
following we use distinct indexing for both <code>Users</code> and <code>Groups</code>.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->from('User u INDEXBY u.username')
        ->innerJoin('u.Groups g INDEXBY g.name');

<span class="noselect">$ </span>users = $q->execute();</code></pre></div>
<p>Now lets print out the drinkers club's creation date.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>echo $users['jack daniels']->Groups['drinkers club']->createdAt;
</code></pre></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="where-clause" name="where-clause"></a><h2 class="section-header"><a href="#where-clause">WHERE clause<i class="fas fa-link"></i></a></h2>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="ac89201ee6c9a0ed59a73c49c23f7051dc6c6e54"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="ac89201ee6c9a0ed59a73c49c23f7051dc6c6e54"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-ac89201ee6c9a0ed59a73c49c23f7051dc6c6e54-1" class="line-number-anchor" /><a href="#line-number-ac89201ee6c9a0ed59a73c49c23f7051dc6c6e54-1">1</a></td><td class="code-line" rowspan="1">WHERE &lt;where_condition&gt;</td></tr></table></div></code></pre>
<ul><li> The <code>WHERE</code> clause, if given, indicates the condition or conditions
   that the records must satisfy to be selected.</li>
<li> where_condition is an expression that evaluates to true for each
   row to be selected.</li>
<li> The statement selects all rows if there is no <code>WHERE</code> clause.</li>
<li> When narrowing results with aggregate function values <code>HAVING</code>
   clause should be used instead of <code>WHERE</code> clause</li>
</ul>

<p>You can use the orWhere,
whereNotIn,
orWhereNotIn functions for building complex
where conditions using Doctrine_Query objects.</p>
<p>Here is an example where we retrieve all active registered users or
super administrators:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;where(&#039;u.type = ?&#039;, &#039;registered&#039;)
        -&gt;andWhere(&#039;u.is_active = ?&#039;, 1)
        -&gt;orWhere(&#039;u.is_super_admin = ?&#039;, 1);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="8e0f87838eb90f9ac5d3bb9db8f688c397db1783"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="8e0f87838eb90f9ac5d3bb9db8f688c397db1783"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-1" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-1">1</a></td><td class="code-line" rowspan="7"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
    u.type = ?
    <span class="hljs-keyword">AND</span> u.is_active = ?
    <span class="hljs-keyword">OR</span> u.is_super_admin = ?</td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-2" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-3" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-4" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-5" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-6" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-7" class="line-number-anchor" /><a href="#line-number-8e0f87838eb90f9ac5d3bb9db8f688c397db1783-7">7</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="conditional-expressions" name="conditional-expressions"></a><h2 class="section-header"><a href="#conditional-expressions">Conditional expressions<i class="fas fa-link"></i></a></h2>
<hr />
<div class="section"><a class="section-anchor" id="literals" name="literals"></a><h4 class="section-header"><a href="#literals">Literals<i class="fas fa-link"></i></a></h4>
<hr />
<div class="section"><a class="section-anchor" id="strings" name="strings"></a><h5 class="section-header"><a href="#strings">Strings<i class="fas fa-link"></i></a></h5>
<p>A string literal that includes a single quote is represented by two
single quotes; for example: ´´literal''s´´.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.id, u.username')
        ->from('User u')
        ->where('u.username = ?', 'Vincent');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7ef4a45e9661f14cb9115eec5238aa4681445244"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7ef4a45e9661f14cb9115eec5238aa4681445244"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-1" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
    u.username = ?</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-2" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-3" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-4" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-5" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-6" class="line-number-anchor" /><a href="#line-number-7ef4a45e9661f14cb9115eec5238aa4681445244-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Because we passed the value of the <code>username</code> as a
parameter to the where method it is not included in the
generated SQL. PDO handles the replacement when you execute the
query. To check the parameters that exist on a Doctrine_Query
instance you can use the getParams method.</p>
</td></tr></table></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="integers" name="integers"></a><h5 class="section-header"><a href="#integers">Integers<i class="fas fa-link"></i></a></h5>
<p>Integer literals support the use of PHP integer literal syntax.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.id')
        ->from('User u')
        ->where('u.id = 4');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="09566700ef9fb73ac8e59551967bf6806745b90a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="09566700ef9fb73ac8e59551967bf6806745b90a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-09566700ef9fb73ac8e59551967bf6806745b90a-1" class="line-number-anchor" /><a href="#line-number-09566700ef9fb73ac8e59551967bf6806745b90a-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">WHERE</span> u.id = <span class="hljs-number">4</span></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="floats" name="floats"></a><h5 class="section-header"><a href="#floats">Floats<i class="fas fa-link"></i></a></h5>
<p>Float literals support the use of PHP float literal syntax.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.id')
        ->from('Account a')
        ->where('a.amount = 432.123');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="63d1f7851458a773cb8558b39016af3c3c54d2c3"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="63d1f7851458a773cb8558b39016af3c3c54d2c3"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-63d1f7851458a773cb8558b39016af3c3c54d2c3-1" class="line-number-anchor" /><a href="#line-number-63d1f7851458a773cb8558b39016af3c3c54d2c3-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> a.id <span class="hljs-keyword">AS</span> a__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">account</span> a <span class="hljs-keyword">WHERE</span> a.amount = <span class="hljs-number">432.123</span></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="booleans" name="booleans"></a><h5 class="section-header"><a href="#booleans">Booleans<i class="fas fa-link"></i></a></h5>
<p>The boolean literals are true and false.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.id')
        ->from('User u')
        ->where('u.is_super_admin = true');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="fd6ed52d9e8082f7f2f7e7b4489dd3248ea15329"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="fd6ed52d9e8082f7f2f7e7b4489dd3248ea15329"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-fd6ed52d9e8082f7f2f7e7b4489dd3248ea15329-1" class="line-number-anchor" /><a href="#line-number-fd6ed52d9e8082f7f2f7e7b4489dd3248ea15329-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">WHERE</span> u.is_super_admin = <span class="hljs-number">1</span></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="enums" name="enums"></a><h5 class="section-header"><a href="#enums">Enums<i class="fas fa-link"></i></a></h5>
<p>The enumerated values work in the same way as string literals.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('a.id')
        ->from('User u')
        ->where("u.type = 'admin'");

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="0104716b23866bc52f2c6778cffa638bfe08c3c4"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="0104716b23866bc52f2c6778cffa638bfe08c3c4"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-0104716b23866bc52f2c6778cffa638bfe08c3c4-1" class="line-number-anchor" /><a href="#line-number-0104716b23866bc52f2c6778cffa638bfe08c3c4-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">WHERE</span> u.type = <span class="hljs-string">'admin'</span></td></tr></table></div></code></pre>
<p>Predefined reserved literals are case insensitive, although its a good standard
to write them in uppercase.</p>
<hr />
</div>
</div>
</div>
<div class="section"><a class="section-anchor" id="input-parameters" name="input-parameters"></a><h4 class="section-header"><a href="#input-parameters">Input parameters<i class="fas fa-link"></i></a></h4>
<p>Here are some examples of using positional parameters:</p>
<ul><li>Single positional parameter::
    $q = Doctrine_Query::create()
            -&gt;select('u.id')
            -&gt;from('User u')
            -&gt;where('u.username = ?', array('Arnold'));
    echo $q-&gt;getSqlQuery();
  .. note::
    When the passed parameter for a positional parameter
    contains only one value you can simply pass a single scalar value
    instead of an array containing one value.
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
    WHERE u.username = ?</li>
<li>Multiple positional parameters::
    $q = Doctrine_Query::create()
            -&gt;from('User u')
            -&gt;where('u.id &gt; ? AND u.username LIKE ?', array(50, 'A%'));
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
    WHERE (
        u.id &gt; ?
        AND u.username LIKE ?
    )</li>
</ul>

<p>Here are some examples of using named parameters:</p>
<ul><li>Single named parameter::
    $q = Doctrine_Query::create()
            -&gt;select('u.id')
            -&gt;from('User u')
            -&gt;where('u.username = :name', array(':name' =&gt; 'Arnold'));
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
    WHERE
        u.username = :name</li>
<li>Named parameter with a LIKE statement::
    $q = Doctrine_Query::create()
            -&gt;select('u.id')
            -&gt;from('User u')
            -&gt;where('u.id &gt; :id', array(':id' =&gt; 50))
            -&gt;andWhere('u.username LIKE :name', array(':name' =&gt; 'A%'));
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
    WHERE
        u.id &gt; :id
        AND u.username LIKE :name</li>
</ul>

<hr />
</div>
<div class="section"><a class="section-anchor" id="operators-and-operator-precedence" name="operators-and-operator-precedence"></a><h4 class="section-header"><a href="#operators-and-operator-precedence">Operators and operator precedence<i class="fas fa-link"></i></a></h4>
<p>The operators are listed below in order of decreasing precedence.</p>
<table>
            <thead>
            <tr>
                                    <th>Operator</th>
                                    <th>Description</th>
                            </tr>
        </thead>
    
    <tbody>
                    <tr>
                                    <td><code>.</code></td>
                                    <td>Navigation operator</td>
                            </tr>
                    <tr>
                                    <td>**Arithmetic operat</td>
                                    <td>rs:**</td>
                            </tr>
                    <tr>
                                    <td><code>+</code>, <code>-</code></td>
                                    <td>Unary</td>
                            </tr>
                    <tr>
                                    <td><code>*</code>, <code>/</code></td>
                                    <td>Multiplication and
division</td>
                            </tr>
                    <tr>
                                    <td><code>+</code>, <code>-</code></td>
                                    <td>Addition and subtraction</td>
                            </tr>
                    <tr>
                                    <td>**Comparison operat</td>
                                    <td>rs:**</td>
                            </tr>
                    <tr>
                                    <td><code>=</code>,
<code>&gt;</code>, <code>&gt;=</code>,
<code>&lt;</code>, <code>&lt;=</code>,
<code>&lt;&gt;</code> (not equal)</td>
                                    <td></td>
                            </tr>
                    <tr>
                                    <td><code>[NOT] LIKE</code>,
<code>[NOT] IN</code>,
<code>IS [NOT] NULL</code>,
<code>IS [NOT] EMPTY</code></td>
                                    <td></td>
                            </tr>
                    <tr>
                                    <td>**Logical operators</td>
                                    <td>**</td>
                            </tr>
                    <tr>
                                    <td><code>NOT</code>,
<code>AND</code>,
<code>OR</code>,</td>
                                    <td></td>
                            </tr>
            </tbody>
</table>
<hr />
</div>
<div class="section"><a class="section-anchor" id="in-expressions" name="in-expressions"></a><h4 class="section-header"><a href="#in-expressions">In expressions<i class="fas fa-link"></i></a></h4>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="36da2e999e910696081264dd884890a8410bebee"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="36da2e999e910696081264dd884890a8410bebee"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-36da2e999e910696081264dd884890a8410bebee-1" class="line-number-anchor" /><a href="#line-number-36da2e999e910696081264dd884890a8410bebee-1">1</a></td><td class="code-line" rowspan="1">&lt;operand&gt; IN (&lt;subquery&gt;|&lt;value list&gt;)</td></tr></table></div></code></pre>
<p>An <code>IN</code> conditional expression returns true if the <code>operand</code> is
found from result of the <code>subquery</code> or if its in the specificied comma
separated <code>value list</code>, hence the IN expression is always false if the
result of the subquery is empty.</p>
<p>When <code>value list</code> is being used there must be at least one element in
that list.</p>
<p>Here is an example where we use a subquery for the <code>IN</code>:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;from(&#039;User u&#039;)
        -&gt;where(&#039;u.id IN (SELECT u.id FROM User u INNER JOIN u.Groups g WHERE g.id = ?)&#039;, 1);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-1" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-1">1</a></td><td class="code-line" rowspan="13"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span> u.id <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span>
        u2.id <span class="hljs-keyword">AS</span> u2__id
    <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> user_group u3
        <span class="hljs-keyword">ON</span> u2.id = u3.user_id
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">groups</span> g
        <span class="hljs-keyword">ON</span> g.id = u3.group_id
    <span class="hljs-keyword">WHERE</span> g.id = ?
)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-2" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-3" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-4" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-5" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-6" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-7" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-8" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-9" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-10" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-11" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-12" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-13" class="line-number-anchor" /><a href="#line-number-1dddd2faa6eb8d7e0b22eeab425b9a7eed266f6b-13">13</a></td></tr></table></div></code></pre>
<p>Here is an example where we just use a list of integers:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;whereIn(&#039;u.id&#039;, array(1, 3, 4, 5));

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4864e6dcc671e9a94fdd83d5a7181db7b2f88b81"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4864e6dcc671e9a94fdd83d5a7181db7b2f88b81"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4864e6dcc671e9a94fdd83d5a7181db7b2f88b81-1" class="line-number-anchor" /><a href="#line-number-4864e6dcc671e9a94fdd83d5a7181db7b2f88b81-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">WHERE</span> u.id <span class="hljs-keyword">IN</span> (?, ?, ?, ?)</td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="like-expressions" name="like-expressions"></a><h4 class="section-header"><a href="#like-expressions">Like Expressions<i class="fas fa-link"></i></a></h4>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="77aaf0c80805b24d039411f1ad628309abf8fb5a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="77aaf0c80805b24d039411f1ad628309abf8fb5a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-77aaf0c80805b24d039411f1ad628309abf8fb5a-1" class="line-number-anchor" /><a href="#line-number-77aaf0c80805b24d039411f1ad628309abf8fb5a-1">1</a></td><td class="code-line" rowspan="1">string_expression [NOT] LIKE pattern_value [ESCAPE escape_character]</td></tr></table></div></code></pre>
<p>The string_expression must have a string value. The pattern_value is a
string literal or a string-valued input parameter in which an underscore
(<code>_</code>) stands for any single character, a percent (<code>%</code>) character
stands for any sequence of characters (including the empty sequence),
and all other characters stand for themselves. The optional
escape_character is a single-character string literal or a
character-valued input parameter (i.e., char or Character) and is used
to escape the special meaning of the underscore and percent characters
in <code>pattern_value</code>.</p>
<p>Examples:</p>
<ul><li> address.phone <code>LIKE</code> '12%3' is true for '123' '12993' and false for '1234'</li>
<li> asentence.word <code>LIKE</code> 'l_se' is true for 'lose' and false for 'loose'</li>
<li> aword.underscored <code>LIKE</code> '_%' ESCAPE '' is true for '_foo' and false for
   'bar'</li>
<li> address.phone <code>NOT LIKE</code> '12%3' is false for '123' and '12993' and true
   for '1234'</li>
</ul>

<p>If the value of the string_expression or pattern_value is NULL or
unknown, the value of the LIKE expression is unknown. If the
escape_characteris specified and is NULL, the value of the LIKE
expression is unknown.</p>
<ul><li>Find all users whose email ends with <a href="mailto:'@gmail.com">'@gmail.com</a>'::
    $q = Doctrine_Query::create()
            -&gt;select('u.id')
            -&gt;from('User u')
            -&gt;leftJoin('u.Email e')
            -&gt;where('e.address LIKE ?', <a href="mailto:'%@gmail.com">'%@gmail.com</a>');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
        LEFT JOIN email e ON u.id = e.user_id
    WHERE
        e.address LIKE ?</li>
<li>Find all users whose name starts with letter 'A'::
    $q = Doctrine_Query::create()
            -&gt;select('u.id')
            -&gt;from('User u')
            -&gt;where('u.username LIKE ?', 'A%');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id
    FROM user u
    WHERE
        u.username LIKE ?</li>
</ul>

<hr />
</div>
<div class="section"><a class="section-anchor" id="exists-expressions" name="exists-expressions"></a><h4 class="section-header"><a href="#exists-expressions">Exists Expressions<i class="fas fa-link"></i></a></h4>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7bc09485d32b8f032ae27a0ac38c47df0fbef077"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7bc09485d32b8f032ae27a0ac38c47df0fbef077"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7bc09485d32b8f032ae27a0ac38c47df0fbef077-1" class="line-number-anchor" /><a href="#line-number-7bc09485d32b8f032ae27a0ac38c47df0fbef077-1">1</a></td><td class="code-line" rowspan="1">[NOT] EXISTS (&lt;subquery&gt;)</td></tr></table></div></code></pre>
<p>The <code>EXISTS</code> operator returns <code>TRUE</code> if the subquery returns one or
more rows and <code>FALSE</code> otherwise.</p>
<p>The <code>NOT EXISTS</code> operator returns <code>TRUE</code> if the subquery returns 0
rows and <code>FALSE</code> otherwise.</p>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>For the next few examples we need to add the <code>ReaderLog</code>
model.</p>
<hr />
<blockquote><p>// models/ReaderLog.php
class ReaderLog extends Doctrine_Record
{
    public function setTableDefinition()
    {
        $this-&gt;hasColumn('article_id', 'integer', null, array(
            'primary' =&gt; true
        ));
        $this-&gt;hasColumn('user_id', 'integer', null, array(
            'primary' =&gt; true
        ));
    }
}</p>
</blockquote>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a href="yaml-schema-files.html">YAML Schema Files</a> chapter:</p>
<pre class="code-block-table"><code class="yaml"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9d24d4a1c106074642c3e605dae3c149c300c34f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9d24d4a1c106074642c3e605dae3c149c300c34f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-1" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-comment"># schema.yml</span>
<span class="hljs-attr">ReaderLog:</span>
  <span class="hljs-attr">columns:</span>
    <span class="hljs-attr">article_id:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">integer</span>
      <span class="hljs-attr">primary:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">user_id:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">integer</span>
      <span class="hljs-attr">primary:</span> <span class="hljs-literal">true</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-2" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-3" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-4" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-5" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-6" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-7" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-8" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-9" class="line-number-anchor" /><a href="#line-number-9d24d4a1c106074642c3e605dae3c149c300c34f-9">9</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>After adding the <code>ReaderLog</code> model don't forget to run the
generate.php script!</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>php generate.php
</code></pre></div>
</td></tr></table></div>
</td></tr></table></div>
<p>Now we can run some tests! First, finding all articles which have
readers:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;a.id&#039;)
        -&gt;from(&#039;Article a&#039;)
        -&gt;where(&#039;EXISTS (SELECT r.id FROM ReaderLog r WHERE r.article_id = a.id)&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-1" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-1">1</a></td><td class="code-line" rowspan="11"><span class="hljs-keyword">SELECT</span>
    a.id <span class="hljs-keyword">AS</span> a__id
<span class="hljs-keyword">FROM</span> article a
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span>
            r.id <span class="hljs-keyword">AS</span> r__id
        <span class="hljs-keyword">FROM</span> reader_log r
        <span class="hljs-keyword">WHERE</span>
            r.article_id = a.id
    )</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-2" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-3" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-4" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-5" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-6" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-7" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-8" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-9" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-10" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-11" class="line-number-anchor" /><a href="#line-number-7ca64a799dd80fecc8b3d49f0a50ef388e0cbfc9-11">11</a></td></tr></table></div></code></pre>
<p>Finding all articles which don't have readers:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;a.id&#039;)
        -&gt;from(&#039;Article a&#039;)
        -&gt;where(&#039;NOT EXISTS (SELECT r.id FROM ReaderLog r WHERE r.article_id = a.id)&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="702e8ebb2b1feb60f56a6422787237699528f4dc"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="702e8ebb2b1feb60f56a6422787237699528f4dc"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-1" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-1">1</a></td><td class="code-line" rowspan="11"><span class="hljs-keyword">SELECT</span>
    a.id <span class="hljs-keyword">AS</span> a__id
<span class="hljs-keyword">FROM</span> article a
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span>
            r.id <span class="hljs-keyword">AS</span> r__id
        <span class="hljs-keyword">FROM</span> reader_log r
        <span class="hljs-keyword">WHERE</span>
            r.article_id = a.id
    )</td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-2" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-3" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-4" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-5" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-6" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-7" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-8" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-9" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-10" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-11" class="line-number-anchor" /><a href="#line-number-702e8ebb2b1feb60f56a6422787237699528f4dc-11">11</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="all-and-any-expressions" name="all-and-any-expressions"></a><h4 class="section-header"><a href="#all-and-any-expressions">All and Any Expressions<i class="fas fa-link"></i></a></h4>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="cd65658506f02bd72d09a0cdfce228731e94d947"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="cd65658506f02bd72d09a0cdfce228731e94d947"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-cd65658506f02bd72d09a0cdfce228731e94d947-1" class="line-number-anchor" /><a href="#line-number-cd65658506f02bd72d09a0cdfce228731e94d947-1">1</a></td><td class="code-line" rowspan="3">operand comparison_operator ANY (subquery)
operand comparison_operator SOME (subquery)
operand comparison_operator ALL (subquery)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-cd65658506f02bd72d09a0cdfce228731e94d947-2" class="line-number-anchor" /><a href="#line-number-cd65658506f02bd72d09a0cdfce228731e94d947-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-cd65658506f02bd72d09a0cdfce228731e94d947-3" class="line-number-anchor" /><a href="#line-number-cd65658506f02bd72d09a0cdfce228731e94d947-3">3</a></td></tr></table></div></code></pre>
<p>An ALL conditional expression returns true if the comparison operation
is true for all values in the result of the subquery or the result of
the subquery is empty. An ALL conditional expression is false if the
result of the comparison is false for at least one row, and is unknown
if neither true nor false.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
       ->from('C')
       ->where('C.col1 < ALL (FROM C2(col1))');</code></pre></div>
<p>An ANY conditional expression returns true if the comparison operation
is true for some value in the result of the subquery. An ANY conditional
expression is false if the result of the subquery is empty or if the
comparison operation is false for every value in the result of the
subquery, and is unknown if neither true nor false.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->from('C')
        ->where('C.col1 > ANY (FROM C2(col1))');</code></pre></div>
<p>The keyword SOME is an alias for ANY.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->from('C')
        ->where('C.col1 > SOME (FROM C2(col1))');</code></pre></div>
<p>The comparison operators that can be used with ALL or ANY conditional
expressions are =, &lt;, &lt;=, &gt;, &gt;=, &lt;&gt;. The result of the subquery must be
same type with the conditional expression.</p>
<p>NOT IN is an alias for &lt;&gt; ALL. Thus, these two statements are equal:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="b111eeb5bd0a9f91316e8f360eab8de20d4808d0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="b111eeb5bd0a9f91316e8f360eab8de20d4808d0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-b111eeb5bd0a9f91316e8f360eab8de20d4808d0-1" class="line-number-anchor" /><a href="#line-number-b111eeb5bd0a9f91316e8f360eab8de20d4808d0-1">1</a></td><td class="code-line" rowspan="2">FROM C WHERE C.col1 &lt;&gt; ALL (FROM C2(col1));
FROM C WHERE C.col1 NOT IN (FROM C2(col1));</td></tr>
<tr><td class="line-number noselect"><a name="line-number-b111eeb5bd0a9f91316e8f360eab8de20d4808d0-2" class="line-number-anchor" /><a href="#line-number-b111eeb5bd0a9f91316e8f360eab8de20d4808d0-2">2</a></td></tr></table></div></code></pre>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->from('C')
        ->where('C.col1 <> ALL (FROM C2(col1))');
<span class="noselect">$ </span>q = Doctrine_Query::create()
        ->from('C')
        ->where('C.col1 NOT IN (FROM C2(col1))');</code></pre></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="subqueries" name="subqueries"></a><h4 class="section-header"><a href="#subqueries">Subqueries<i class="fas fa-link"></i></a></h4>
<p>A subquery can contain any of the keywords or clauses that an ordinary
SELECT query can contain.</p>
<p>Some advantages of the subqueries:</p>
<ul><li> They allow queries that are structured so that it is possible to
   isolate each part of a statement.</li>
<li> They provide alternative ways to perform operations that would
   otherwise require complex joins and unions.</li>
<li> They are, in many people's opinion, readable. Indeed, it was the
   innovation of subqueries that gave people the original idea of
   calling the early SQL &quot;Structured Query Language.&quot;</li>
</ul>

<p>Here is an example where we find all users which don't belong to the
group id 1:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;where(&#039;u.id NOT IN (SELECT u2.id FROM User u2 INNER JOIN u2.Groups g WHERE g.id = ?)&#039;, 1);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="30af7f5d44eecc8969f348e876554addeddc2ad3"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="30af7f5d44eecc8969f348e876554addeddc2ad3"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-1" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-1">1</a></td><td class="code-line" rowspan="13"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span> u.id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> u2.id <span class="hljs-keyword">AS</span>
        u2__id
    <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
        <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> user_group u3
            <span class="hljs-keyword">ON</span> u2.id = u3.user_id
        <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">groups</span> g
            <span class="hljs-keyword">ON</span> g.id = u3.group_id
    <span class="hljs-keyword">WHERE</span> g.id = ?
)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-2" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-3" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-4" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-5" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-6" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-7" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-8" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-9" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-10" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-11" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-12" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-13" class="line-number-anchor" /><a href="#line-number-30af7f5d44eecc8969f348e876554addeddc2ad3-13">13</a></td></tr></table></div></code></pre>
<p>Here is an example where we find all users which don't belong to any
groups:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;where(&#039;u.id NOT IN (SELECT u2.id FROM User u2 INNER JOIN u2.Groups g)&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="92d3c50e5c731608ba08dff58d12fbeaf111b1c8"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="92d3c50e5c731608ba08dff58d12fbeaf111b1c8"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-1" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-1">1</a></td><td class="code-line" rowspan="12"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span> u.id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span>
        u2.id <span class="hljs-keyword">AS</span> u2__id
    <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
        <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> user_group u3
            <span class="hljs-keyword">ON</span> u2.id = u3.user_id
        <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">groups</span> g
            <span class="hljs-keyword">ON</span> g.id = u3.group_id
)</td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-2" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-3" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-4" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-5" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-6" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-7" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-8" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-9" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-10" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-11" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-12" class="line-number-anchor" /><a href="#line-number-92d3c50e5c731608ba08dff58d12fbeaf111b1c8-12">12</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="functional-expressions" name="functional-expressions"></a><h2 class="section-header"><a href="#functional-expressions">Functional Expressions<i class="fas fa-link"></i></a></h2>
<hr />
<div class="section"><a class="section-anchor" id="string-functions" name="string-functions"></a><h4 class="section-header"><a href="#string-functions">String functions<i class="fas fa-link"></i></a></h4>
<p>The <code>CONCAT</code> function returns a string that is a concatenation of its
arguments. In the example above we map the concatenation of users
<code>first_name</code> and <code>last_name</code> to a value called <code>name</code>.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('CONCAT(u.first_name, u.last_name) AS name')
        ->from('User u');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7937e1a4e793372e5478dc49bf99bcb15878e8fa"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7937e1a4e793372e5478dc49bf99bcb15878e8fa"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-1" class="line-number-anchor" /><a href="#line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-1">1</a></td><td class="code-line" rowspan="4"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    <span class="hljs-keyword">CONCAT</span>(u.first_name, u.last_name) <span class="hljs-keyword">AS</span> u__0
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-2" class="line-number-anchor" /><a href="#line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-3" class="line-number-anchor" /><a href="#line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-4" class="line-number-anchor" /><a href="#line-number-7937e1a4e793372e5478dc49bf99bcb15878e8fa-4">4</a></td></tr></table></div></code></pre>
<p>Now we can execute the query and get the mapped function value:</p>
<pre><code class="">$users = $q-&gt;execute();

foreach($users as $user) {
    // here &#039;name&#039; is not a property of $user,
    // its a mapped function value echo $user-&gt;name;
}
</code></pre>
<p>The second and third arguments of the <code>SUBSTRING</code> function denote the
starting position and length of the substring to be returned. These
arguments are integers. The first position of a string is denoted by 1.
The <code>SUBSTRING</code> function returns a string.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username')
        ->from('User u')
        ->where("SUBSTRING(u.username, 0, 1) = 'z'");

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="4acd86ace47977623808a55d8c2a3e56dc7560e9"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="4acd86ace47977623808a55d8c2a3e56dc7560e9"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-1" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-keyword">SUBSTRING</span>(u.username <span class="hljs-keyword">FROM</span> <span class="hljs-number">0</span> <span class="hljs-keyword">FOR</span> <span class="hljs-number">1</span>) = <span class="hljs-string">'z'</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-2" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-3" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-4" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-5" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-6" class="line-number-anchor" /><a href="#line-number-4acd86ace47977623808a55d8c2a3e56dc7560e9-6">6</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the SQL is generated with the proper
<code>SUBSTRING</code> syntax for the DBMS you are using!</p>
</td></tr></table></div>
<p>The <code>TRIM</code> function trims the specified character from a string. If
the character to be trimmed is not specified, it is assumed to be space
(or blank). The optional trim_character is a single-character string
literal or a character-valued input parameter (i.e., char or
Character)[30]. If a trim specification is not provided, BOTH is
assumed. The <code>TRIM</code> function returns the trimmed string.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username')
        ->from('User u')
        ->where('TRIM(u.username) = ?', 'Someone');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9472dcf9741584fc1f59d2b8d76f76959a1e56d6"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9472dcf9741584fc1f59d2b8d76f76959a1e56d6"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-1" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
<span class="hljs-keyword">TRIM</span>(u.username) = ?</td></tr>
<tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-2" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-3" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-4" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-5" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-6" class="line-number-anchor" /><a href="#line-number-9472dcf9741584fc1f59d2b8d76f76959a1e56d6-6">6</a></td></tr></table></div></code></pre>
<p>The <code>LOWER</code> and <code>UPPER</code> functions convert a string to lower and
upper case, respectively. They return a string.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username')
        ->from('User u')
        ->where("LOWER(u.username) = 'jon wage'");

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="388cc30988f7bd639f8f0375525ba90808e360c2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="388cc30988f7bd639f8f0375525ba90808e360c2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-1" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-1">1</a></td><td class="code-line" rowspan="6"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
    <span class="hljs-keyword">LOWER</span>(u.username) = <span class="hljs-string">'someone'</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-2" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-3" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-4" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-5" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-388cc30988f7bd639f8f0375525ba90808e360c2-6" class="line-number-anchor" /><a href="#line-number-388cc30988f7bd639f8f0375525ba90808e360c2-6">6</a></td></tr></table></div></code></pre>
<p>The <code>LOCATE</code> function returns the position of a given string within a
string, starting the search at a specified position. It returns the
first position at which the string was found as an integer. The first
argument is the string to be located; the second argument is the string
to be searched; the optional third argument is an integer that
represents the string position at which the search is started (by
default, the beginning of the string to be searched). The first position
in a string is denoted by 1. If the string is not found, 0 is returned.</p>
<p>The <code>LENGTH</code> function returns the length of the string in characters
as an integer.</p>
<hr />
</div>
<div class="section"><a class="section-anchor" id="arithmetic-functions" name="arithmetic-functions"></a><h4 class="section-header"><a href="#arithmetic-functions">Arithmetic functions<i class="fas fa-link"></i></a></h4>
<p>Availible DQL arithmetic functions:</p>
<blockquote><p>ABS(simple_arithmetic_expression)
SQRT(simple_arithmetic_expression)
MOD(simple_arithmetic_expression`, :token:`simple_arithmetic_expression)</p>
</blockquote>
<ul><li> The <code>ABS</code> function returns the absolute value for given number.</li>
<li> The <code>SQRT</code> function returns the square root for given number.</li>
<li> The <code>MOD</code> function returns the modulus of first argument using the
   second argument.</li>
</ul>

<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="subqueries" name="subqueries"></a><h2 class="section-header"><a href="#subqueries">Subqueries<i class="fas fa-link"></i></a></h2>
<hr />
<div class="section"><a class="section-anchor" id="introduction" name="introduction"></a><h4 class="section-header"><a href="#introduction">Introduction<i class="fas fa-link"></i></a></h4>
<p>Doctrine allows you to use sub-dql queries in the FROM, SELECT and WHERE
statements. Below you will find examples for all the different types of
subqueries Doctrine supports.</p>
<hr />
</div>
<div class="section"><a class="section-anchor" id="comparisons-using-subqueries" name="comparisons-using-subqueries"></a><h4 class="section-header"><a href="#comparisons-using-subqueries">Comparisons using subqueries<i class="fas fa-link"></i></a></h4>
<p>Find all the users which are not in a specific group.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.id')
        ->from('User u')
        ->where('u.id NOT IN (
                    SELECT u.id
                    FROM User u
                    INNER JOIN u.Groups g
                    WHERE g.id = ?
                )', 1);

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-1" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-1">1</a></td><td class="code-line" rowspan="14"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span>
    u.id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (
        <span class="hljs-keyword">SELECT</span> u2.id <span class="hljs-keyword">AS</span>
            u2__id
        <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
            <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> user_group u3
                <span class="hljs-keyword">ON</span> u2.id = u3.user_id
            <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">groups</span> g
                <span class="hljs-keyword">ON</span> g.id = u3.group_id
        <span class="hljs-keyword">WHERE</span> g.id = ?
    )</td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-2" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-3" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-4" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-5" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-6" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-7" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-8" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-9" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-10" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-11" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-12" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-13" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-14" class="line-number-anchor" /><a href="#line-number-e3186b0f331c9ad5ee7705f649d7ffb39ea1bd19-14">14</a></td></tr></table></div></code></pre>
<p>Retrieve the users phonenumber in a subquery and include it in the
resultset of user information.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.id')
        ->addSelect('(SELECT p.phonenumber
                        FROM Phonenumber p
                        WHERE p.user_id = u.id
                        LIMIT 1) as phonenumber')
        ->from('User u');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="d5b237a15b1cb80d3b1e4822ee61d77b7fee207a"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="d5b237a15b1cb80d3b1e4822ee61d77b7fee207a"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-1" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-1">1</a></td><td class="code-line" rowspan="10"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    (
        <span class="hljs-keyword">SELECT</span>
            p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber
        <span class="hljs-keyword">FROM</span> phonenumber p
        <span class="hljs-keyword">WHERE</span> p.user_id = u.id
        <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span>
    ) <span class="hljs-keyword">AS</span> u__0
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u</td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-2" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-3" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-4" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-5" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-6" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-7" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-8" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-9" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-10" class="line-number-anchor" /><a href="#line-number-d5b237a15b1cb80d3b1e4822ee61d77b7fee207a-10">10</a></td></tr></table></div></code></pre>
<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="group-by-having-clauses" name="group-by-having-clauses"></a><h2 class="section-header"><a href="#group-by-having-clauses">GROUP BY, HAVING clauses<i class="fas fa-link"></i></a></h2>
<p>DQL GROUP BY syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="fccf648ca20fbcf7b6a7e4e297fea686f9ff5816"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="fccf648ca20fbcf7b6a7e4e297fea686f9ff5816"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-fccf648ca20fbcf7b6a7e4e297fea686f9ff5816-1" class="line-number-anchor" /><a href="#line-number-fccf648ca20fbcf7b6a7e4e297fea686f9ff5816-1">1</a></td><td class="code-line" rowspan="1">GROUP BY groupby_item {, groupby_item}*</td></tr></table></div></code></pre>
<p>DQL HAVING syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="6fbae51492b9b2520c8e1d962a345ac677586df0"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="6fbae51492b9b2520c8e1d962a345ac677586df0"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-6fbae51492b9b2520c8e1d962a345ac677586df0-1" class="line-number-anchor" /><a href="#line-number-6fbae51492b9b2520c8e1d962a345ac677586df0-1">1</a></td><td class="code-line" rowspan="1">HAVING conditional_expression</td></tr></table></div></code></pre>
<p><code>GROUP BY</code> and <code>HAVING</code> clauses can be used for dealing with
aggregate functions. The Following aggregate functions are available on
DQL: <code>COUNT</code>, <code>MAX</code>, <code>MIN</code>, <code>AVG</code>, <code>SUM</code></p>
<ul><li>Selecting alphabetically first user by name::
    $q = Doctrine_Query::create()
            -&gt;select('MIN(a.amount)')
            -&gt;from('Account a');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT MIN(a.amount) AS a_0 FROM account a</li>
<li>Selecting the sum of all Account amounts::
    $q = Doctrine_Query::create()
            -&gt;select('SUM(a.amount)')
            -&gt;from('Account a');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT SUM(a.amount) AS a_0 FROM account a</li>
<li>Using an aggregate function in a statement containing no <code>GROUP BY</code>
  clause, results in grouping on all rows. In the example below we fetch
  all users and the number of phonenumbers they have.
  ::
    $q = Doctrine_Query::create()
            -&gt;select('u.username')
            -&gt;addSelect('COUNT(p.id) as num_phonenumbers')
            -&gt;from('User u')
            -&gt;leftJoin('u.Phonenumbers p')
            -&gt;groupBy('u.id');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id,
        u.username AS u_username, COUNT(p.id) AS p_0
    FROM user u
        LEFT JOIN phonenumber p
            ON u.id = p.user_id
    GROUP BY u.id</li>
<li>The <code>HAVING</code> clause can be used for narrowing the results using
  aggregate values. In the following example we fetch all users which have
  at least 2 phonenumbers::
    $q = Doctrine_Query::create()
            -&gt;select('u.username')
            -&gt;addSelect('COUNT(p.id) as num_phonenumbers')
            -&gt;from('User u')
            -&gt;leftJoin('u.Phonenumbers p')
            -&gt;groupBy('u.id')
            -&gt;having('num_phonenumbers &gt;= 2');
    echo $q-&gt;getSqlQuery();
  The above call to getSqlQuery() would output the following SQL query:
  .. code-block:: sql
    SELECT
        u.id AS u_id,
        u.username AS u_username, COUNT(p.id) AS p_0
    FROM user u
        LEFT JOIN phonenumber p
            ON u.id = p.user_id
    GROUP BY u.id
    HAVING p_0 &gt;= 2
  You can access the number of phonenumbers with the following code::
    $users = $q-&gt;execute();
    foreach($users as $user) {
        echo $user-&gt;name
            . ' has '
            . $user-&gt;num_phonenumbers
            . ' phonenumbers';
    }</li>
</ul>

<hr />
</div>
<div class="section"><a class="section-anchor" id="order-by-clause" name="order-by-clause"></a><h2 class="section-header"><a href="#order-by-clause">ORDER BY clause<i class="fas fa-link"></i></a></h2>
<hr />
<div class="section"><a class="section-anchor" id="introduction" name="introduction"></a><h4 class="section-header"><a href="#introduction">Introduction<i class="fas fa-link"></i></a></h4>
<p>Record collections can be sorted efficiently at the database level using
the ORDER BY clause.</p>
<p>Syntax:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-1" class="line-number-anchor" /><a href="#line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-1">1</a></td><td class="code-line" rowspan="4">[
   ORDER BY {ComponentAlias.columnName}
   [ASC | DESC], ...
]</td></tr>
<tr><td class="line-number noselect"><a name="line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-2" class="line-number-anchor" /><a href="#line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-3" class="line-number-anchor" /><a href="#line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-4" class="line-number-anchor" /><a href="#line-number-7e5eea05501e2bf7e2d78eadbfad97ce8c5550e2-4">4</a></td></tr></table></div></code></pre>
<p>Examples:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.username&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p&#039;)
        -&gt;orderBy(&#039;u.username, p.phonenumber&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="d1a07dd3d836e7129457e5e66ff2978d86fa0644"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="d1a07dd3d836e7129457e5e66ff2978d86fa0644"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-1" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
    u.username,
    p.phonenumber</td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-2" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-3" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-4" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-5" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-6" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-7" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-8" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-9" class="line-number-anchor" /><a href="#line-number-d1a07dd3d836e7129457e5e66ff2978d86fa0644-9">9</a></td></tr></table></div></code></pre>
<p>In order to sort in reverse order you can add the <code>DESC</code> (descending) keyword
to the name of the column in the <code>ORDER BY</code> clause that you are sorting by.
The default is ascending order; this can be specified explicitly using the
<code>ASC</code> keyword.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username')
        ->from('User u')
        ->leftJoin('u.Email e')
        ->orderBy('e.address DESC, u.id ASC');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="9d6d83d73ee2399795d3edb0ebeab077cc06b213"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="9d6d83d73ee2399795d3edb0ebeab077cc06b213"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-1" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> email e
    <span class="hljs-keyword">ON</span> u.id = e.user_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
    e.address <span class="hljs-keyword">DESC</span>,
    u.id <span class="hljs-keyword">ASC</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-2" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-3" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-4" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-5" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-6" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-7" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-8" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-9" class="line-number-anchor" /><a href="#line-number-9d6d83d73ee2399795d3edb0ebeab077cc06b213-9">9</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="sorting-by-an-aggregate-value" name="sorting-by-an-aggregate-value"></a><h4 class="section-header"><a href="#sorting-by-an-aggregate-value">Sorting by an aggregate value<i class="fas fa-link"></i></a></h4>
<p>In the following example we fetch all users and sort those users by the
number of phonenumbers they have.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.username, COUNT(p.id) count')
        ->from('User u')
        ->innerJoin('u.Phonenumbers p')
        ->orderby('count');

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="38ae1e8beb6d6a699ff229adfb8af1825127951f"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="38ae1e8beb6d6a699ff229adfb8af1825127951f"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-1" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-1">1</a></td><td class="code-line" rowspan="8"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username,
    <span class="hljs-keyword">COUNT</span>(p.id) <span class="hljs-keyword">AS</span> p__0
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> p__0</td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-2" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-3" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-4" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-5" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-6" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-7" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-8" class="line-number-anchor" /><a href="#line-number-38ae1e8beb6d6a699ff229adfb8af1825127951f-8">8</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="using-random-order" name="using-random-order"></a><h4 class="section-header"><a href="#using-random-order">Using random order<i class="fas fa-link"></i></a></h4>
<p>In the following example we use random in the <code>ORDER BY</code> clause in
order to fetch random post.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('t.id, RANDOM() AS rand')
        ->from('Forum_Thread t')
        ->orderby('rand')
        ->limit(1);

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="50ba01caae831e93549fba454b570775129ef1a6"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="50ba01caae831e93549fba454b570775129ef1a6"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-50ba01caae831e93549fba454b570775129ef1a6-1" class="line-number-anchor" /><a href="#line-number-50ba01caae831e93549fba454b570775129ef1a6-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> f.id <span class="hljs-keyword">AS</span> f__id, <span class="hljs-keyword">RAND</span>() <span class="hljs-keyword">AS</span> f__0 <span class="hljs-keyword">FROM</span> forum__thread f <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> f__0 <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span></td></tr></table></div></code></pre>
<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="limit-and-offset-clauses" name="limit-and-offset-clauses"></a><h2 class="section-header"><a href="#limit-and-offset-clauses">LIMIT and OFFSET clauses<i class="fas fa-link"></i></a></h2>
<p>Propably the most complex feature DQL parser has to offer is its
<code>LIMIT</code> clause parser. Not only does the DQL <code>LIMIT</code> clause parser
take care of <code>LIMIT</code> database portability it is capable of limiting
the number of records instead of rows by using complex query analysis
and subqueries.</p>
<p>Retrieve the first 20 users and all their associated phonenumbers:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.username, p.phonenumber&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;leftJoin(&#039;u.Phonenumbers p&#039;)
        -&gt;limit(20);

echo $q-&gt;getSqlQuery();
</code></pre>
<div class="alert tip-admonition bg-success text-light border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-question-circle mr-2"></i></td><td><p>You can also use the offset method of the
limit
method to produce your desired <code>LIMIT</code> and <code>OFFSET</code> in the
executed SQL query.</p>
</td></tr></table></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="003645e943517b665988d13002bb2d455e8a4652"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="003645e943517b665988d13002bb2d455e8a4652"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-1" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-1">1</a></td><td class="code-line" rowspan="9"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username,
    p.id <span class="hljs-keyword">AS</span> p__id,
    p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-2" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-3" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-4" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-5" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-6" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-7" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-8" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-003645e943517b665988d13002bb2d455e8a4652-9" class="line-number-anchor" /><a href="#line-number-003645e943517b665988d13002bb2d455e8a4652-9">9</a></td></tr></table></div></code></pre>
<hr />
<div class="section"><a class="section-anchor" id="driver-portability" name="driver-portability"></a><h4 class="section-header"><a href="#driver-portability">Driver Portability<i class="fas fa-link"></i></a></h4>
<p>DQL <code>LIMIT</code> clause is portable on all supported databases. Special
attention have been paid to following facts:</p>
<ul><li> Only MySQL, PgSQL and Sqlite implement LIMIT / OFFSET clauses
   natively</li>
<li> In Oracle / MSSQL / Firebird LIMIT / OFFSET clauses need to be
   emulated in driver specific way</li>
<li> The limit-subquery-algorithm needs to execute to subquery separately
   in MySQL, since MySQL doesn't yet support LIMIT clause in subqueries</li>
<li> PgSQL needs the order by fields to be preserved in SELECT clause,
   hence limit-subquery-algorithm needs to take this into consideration
   when pgSQL driver is used</li>
<li> Oracle only allows &lt; 30 object identifiers (= table/column
   names/aliases), hence the limit subquery must use as short aliases as
   possible and it must avoid alias collisions with the main query.</li>
</ul>

<hr />
</div>
<div class="section"><a class="section-anchor" id="the-limit-subquery-algorithm" name="the-limit-subquery-algorithm"></a><h4 class="section-header"><a href="#the-limit-subquery-algorithm">The limit-subquery-algorithm<i class="fas fa-link"></i></a></h4>
<p>The limit-subquery-algorithm is an algorithm that DQL parser uses
internally when one-to-many / many-to-many relational data is being
fetched simultaneously. This kind of special algorithm is needed for the
LIMIT clause to limit the number of records instead of SQL result set
rows.</p>
<p>This behavior can be overwritten using the configuration system (at
global, connection or table level) using:</p>
<pre><code class="">$table-&gt;setAttribute(Doctrine_Core::ATTR_QUERY_LIMIT, Doctrine_Core::LIMIT_ROWS);
$table-&gt;setAttribute(Doctrine_Core::ATTR_QUERY_LIMIT, Doctrine_Core::LIMIT_RECORDS); // revert
</code></pre>
<p>In the following example we have users and phonenumbers with their
relation being one-to-many. Now lets say we want fetch the first 20
users and all their related phonenumbers.</p>
<p>Now one might consider that adding a simple driver specific LIMIT 20 at
the end of query would return the correct results. Thats wrong, since we
you might get anything between 1-20 users as the first user might have
20 phonenumbers and then record set would consist of 20 rows.</p>
<p>DQL overcomes this problem with subqueries and with complex but
efficient subquery analysis. In the next example we are going to fetch
first 20 users and all their phonenumbers with single efficient query.
Notice how the DQL parser is smart enough to use column aggregation
inheritance even in the subquery and how it's smart enough to use
different aliases for the tables in the subquery to avoid alias
collisions.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
        ->select('u.id, u.username, p.*')
        ->from('User u')
        ->leftJoin('u.Phonenumbers p')
        ->limit(20);

echo $q->getSqlQuery();</code></pre></div>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="014f0ce59a7d2f53700136a17753cf8e27698748"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="014f0ce59a7d2f53700136a17753cf8e27698748"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-1" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-1">1</a></td><td class="code-line" rowspan="16"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username,
    p.id <span class="hljs-keyword">AS</span> p__id,
    p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber,
    p.user_id <span class="hljs-keyword">AS</span> p__user_id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">WHERE</span>
    u.id <span class="hljs-keyword">IN</span> (
        <span class="hljs-keyword">SELECT</span>
            <span class="hljs-keyword">DISTINCT</span> u2.id
        <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
        <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span>
    )</td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-2" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-3" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-4" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-5" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-6" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-7" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-8" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-9" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-10" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-11" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-12" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-13" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-14" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-15" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-014f0ce59a7d2f53700136a17753cf8e27698748-16" class="line-number-anchor" /><a href="#line-number-014f0ce59a7d2f53700136a17753cf8e27698748-16">16</a></td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>Notice how the IN clause with the subquery was added. This
is so that the users are limited to 20 and the users phonenumbers
are not limited.</p>
</td></tr></table></div>
<p>In the next example we are going to fetch first 20 users and all their
phonenumbers and only those users that actually have phonenumbers with
single efficient query, hence we use an <code>INNER JOIN</code>. Notice how the
DQL parser is smart enough to use the <code>INNER JOIN</code> in the subquery:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id, u.username, p.*&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;innerJoin(&#039;u.Phonenumbers p&#039;)
        -&gt;limit(20);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="49f8c9b81130c6d65a1a9cb606e4a099596b5cad"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="49f8c9b81130c6d65a1a9cb606e4a099596b5cad"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-1" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-1">1</a></td><td class="code-line" rowspan="18"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username,
    p.id <span class="hljs-keyword">AS</span> p__id,
    p.phonenumber <span class="hljs-keyword">AS</span> p__phonenumber,
    p.user_id <span class="hljs-keyword">AS</span> p__user_id
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> phonenumber p
        <span class="hljs-keyword">ON</span> u.id = p.user_id
<span class="hljs-keyword">WHERE</span>
    u.id <span class="hljs-keyword">IN</span> (
        <span class="hljs-keyword">SELECT</span>
        <span class="hljs-keyword">DISTINCT</span> u2.id
        <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u2
            <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> phonenumber p2
                <span class="hljs-keyword">ON</span> u2.id = p2.user_id
        <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">20</span>
    )</td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-2" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-3" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-4" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-5" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-5">5</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-6" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-6">6</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-7" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-7">7</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-8" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-8">8</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-9" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-9">9</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-10" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-10">10</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-11" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-11">11</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-12" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-12">12</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-13" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-13">13</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-14" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-14">14</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-15" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-15">15</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-16" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-16">16</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-17" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-17">17</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-18" class="line-number-anchor" /><a href="#line-number-49f8c9b81130c6d65a1a9cb606e4a099596b5cad-18">18</a></td></tr></table></div></code></pre>
<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="named-queries" name="named-queries"></a><h2 class="section-header"><a href="#named-queries">Named Queries<i class="fas fa-link"></i></a></h2>
<p>When you are dealing with a model that may change, but you need to keep
your queries easily updated, you need to find an easy way to define
queries. Imagine for example that you change one field and you need to
follow all queries in your application to make sure it'll not break
anything.</p>
<p>Named Queries is a nice and effective way to solve this situation,
allowing you to create <code>Doctrine_Queries</code> and reuse them without the
need to keep rewritting them.</p>
<p>The Named Query support is built at the top of
<code>Doctrine_Query_Registry</code> support. <code>Doctrine_Query_Registry</code> is
a class for registering and naming queries. It helps with the
organization of your applications queries and along with that it offers
some very nice convenience stuff.</p>
<p>The queries are added using the add method of the registry object.
It takes two parameters, the query name and the actual DQL query.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>r = Doctrine_Manager::getInstance()->getQueryRegistry();
<span class="noselect">$ </span>r->add('User/all', 'FROM User u');

<span class="noselect">$ </span>userTable = Doctrine_Core::getTable('User');
// find all users $users = $userTable->find('all');</code></pre></div>
<p>To simplify this support, Doctrine_Table support some accessors to
<code>Doctrine_Query_Registry</code>.</p>
<hr />
<div class="section"><a class="section-anchor" id="creating-a-named-query" name="creating-a-named-query"></a><h4 class="section-header"><a href="#creating-a-named-query">Creating a Named Query<i class="fas fa-link"></i></a></h4>
<p>When you build your models with option <code>generateTableClasses</code> defined as
true, each record class will also generate a <code>*Table</code> class, extending from
Doctrine_Table.</p>
<p>Then, you can implement the method construct to include your Named
Queries:</p>
<pre><code class="">class UserTable extends Doctrine_Table
{
    public function construct()
    {
        // Named Query defined using DQL string
        $this-&gt;addNamedQuery(&#039;get.by.id&#039;, &#039;SELECT u.username FROM User u WHERE u.id = ?&#039;);

        // Named Query defined using Doctrine_Query object
        $this-&gt;addNamedQuery(
            &#039;get.by.similar.usernames&#039;,
            Doctrine_Query::create()
                -&gt;select(&#039;u.id, u.username&#039;)
                -&gt;from(&#039;User u&#039;)
                -&gt;where(&#039;LOWER(u.username) LIKE LOWER(?)&#039;)
        );
    }
}

</code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="accessing-named-query" name="accessing-named-query"></a><h4 class="section-header"><a href="#accessing-named-query">Accessing Named Query<i class="fas fa-link"></i></a></h4>
<p>To reach the <code>MyFooTable</code> class, which is a subclass of
Doctrine_Table, you can do the following:</p>
<pre><code class="">$userTable = Doctrine_Core::getTable(&#039;User&#039;);
</code></pre>
<p>To access the Named Query (will return you a Doctrine_Query
instance, always):</p>
<pre><code class="">$q = $userTable-&gt;createNamedQuery(&#039;get.by.id&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="1282a2a0abafd502114c34d54a62a5eeb1e6cc93"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="1282a2a0abafd502114c34d54a62a5eeb1e6cc93"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-1" class="line-number-anchor" /><a href="#line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-1">1</a></td><td class="code-line" rowspan="5"><span class="hljs-keyword">SELECT</span>
    u.id <span class="hljs-keyword">AS</span> u__id,
    u.username <span class="hljs-keyword">AS</span> u__username
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u
<span class="hljs-keyword">WHERE</span> u.id = ?</td></tr>
<tr><td class="line-number noselect"><a name="line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-2" class="line-number-anchor" /><a href="#line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-2">2</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-3" class="line-number-anchor" /><a href="#line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-3">3</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-4" class="line-number-anchor" /><a href="#line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-4">4</a></td></tr>
<tr><td class="line-number noselect"><a name="line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-5" class="line-number-anchor" /><a href="#line-number-1282a2a0abafd502114c34d54a62a5eeb1e6cc93-5">5</a></td></tr></table></div></code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="executing-a-named-query" name="executing-a-named-query"></a><h4 class="section-header"><a href="#executing-a-named-query">Executing a Named Query<i class="fas fa-link"></i></a></h4>
<p>There are two ways to execute a Named Query. The first one is by
retrieving the Doctrine_Query and then executing it normally, as a
normal instance:</p>
<pre><code class="">$users = Doctrine_Core::getTable(&#039;User&#039;)
            -&gt;createNamedQuery(&#039;get.by.similar.usernames&#039;)
            -&gt;execute(array(&#039;%jon%wage%&#039;));
</code></pre>
<p>You can also simplify the execution, by doing:</p>
<pre><code class="">$users = Doctrine_Core::getTable(&#039;User&#039;)
            -&gt;find(&#039;get.by.similar.usernames&#039;, array(&#039;%jon%wage%&#039;));
</code></pre>
<p>The method find also accepts a third parameter, which is the
hydration mode.</p>
<hr />
</div>
<div class="section"><a class="section-anchor" id="cross-accessing-named-query" name="cross-accessing-named-query"></a><h4 class="section-header"><a href="#cross-accessing-named-query">Cross-Accessing Named Query<i class="fas fa-link"></i></a></h4>
<p>If that's not enough, Doctrine take advantage the
<code>Doctrine_Query_Registry</code> and uses namespace queries to enable
cross-access of Named Queries between objects. Suppose you have the
<code>*Table</code> class instance of record <code>Article</code>. You want to call the
get.by.id Named Query of record <code>User</code>. To access the Named Query,
you have to do:</p>
<pre><code class="">$articleTable = Doctrine_Core::getTable(&#039;Article&#039;);
$users = $articleTable-&gt;find(&#039;User/get.by.id&#039;, array(1, 2, 3));
</code></pre>
<hr />
</div>
</div>
<div class="section"><a class="section-anchor" id="bnf" name="bnf"></a><h2 class="section-header"><a href="#bnf">BNF<i class="fas fa-link"></i></a></h2>
<blockquote><p>QL_statement: `select_statement`  `delete_statement`
select_statement: `select_clause` `from_clause`
                : [`where_clause`]
                : [`groupby_clause`]
                : [`having_clause`]
                : [`orderby_clause`]
update_statement: `update_clause` [`where_clause`]
delete_statement: `delete_clause` [`where_clause`]
from_clause: FROM `identification_variable_declaration`
           :     {
           :         ,<br />           :         {`identification_variable_declaration`  `fetch_join`}</em>
range_variable_declaration: `abstract_schema_name`
                          : [AS]
                          : `identification_variable`
join: `join_spec`
    : `join_association_path_expression`
    : [AS] `identification_variable`
fetch_join: `join_spec` FETCH `join_association_path_expression`
association_path_expression: `collection_valued_path_expression`
                           :      INNER]
         : JOIN
join_association_path_expression: `join_collection_valued_path_expression`
                                :      `single_valued_association_path_expression`
state_field_path_expression: {
                           :     `identification_variable`
                           :          `single_valued_association_field`}
           : =
           : `new_value`
new_value: `simple_arithmetic_expression`
         :      `datetime_primary`
         :      `enum_primary` `simple_entity_expression`
         :      `aggregate_expression`
                 :      OBJECT ( `identification_variable` )
                 :      `aggregate_expression`
aggregate_expression:     { AVG  MIN<br />                    :     COUNT (
                    :         [DISTINCT]
                    :         `identification_variable`
                    :              `single_valued_association_path_expression`
                    :     )
where_clause: WHERE `conditional_expression`
groupby_clause: GROUP BY `groupby_item` {, `groupby_item`}<em>
groupby_item: single_valued_path_expression`  DESC]
subquery: simple_select_clause` `subquery_from_clause` [`where_clause`] [`groupby_clause`] [`having_clause`]
subquery_from_clause: FROM `subselect_identification_variable_declaration`{, `subselect_identification_variable_declaration`}<em>
subselect_identification_variable_declaration: `identification_variable_declaration`
                                             :      `collection_member_declaration`
simple_select_clause: SELECT [DISTINCT] `simple_select_expression`
simple_select_expression: `single_valued_path_expression`
                        :      `identification_variable`
conditional_expression: `conditional_term`
                      :      `conditional_term` AND `conditional_factor`
conditional_factor: [NOT]
                  : `conditional_primary`
conditional_primary: `simple_cond_expression`
                   :      `between_expression`
                      :      `in_expression`
                      :      `empty_collection_comparison_expression`
                      :      `exists_expression`
between_expression: `arithmetic_expression` [NOT] BETWEEN `arithmetic_expression` AND `arithmetic_expression`
                  :      `datetime_expression` [NOT] BETWEEN `datetime_expression` AND `datetime_expression`
in_expression: `state_field_path_expression`
             : [NOT] IN
             : (
             :     `in_item` {, `in_item`}</em>  `input_parameter`
like_expression: `string_expression`
               : [NOT] LIKE
               : `pattern_value`
               : [ESCAPE `escape_character`]
null_comparison_expression: {`single_valued_path_expression`  ANY  `all_or_any_expression`}
                     :      &lt;&gt;} {`boolean_expression`  `enum_expression` {=  `all_or_any_expression`}
                     :      `all_or_any_expression`}
                     :      &lt;&gt;} {`entity_expression`  `arithmetic_expression` `comparison_operator` {`arithmetic_expression`  &gt;  &lt;  &lt;&gt;
arithmetic_expression: `simple_arithmetic_expression`  `simple_arithmetic_expression` {+  `arithmetic_term` { *  -}] `arithmetic_primary`
arithmetic_primary: `state_field_path_expression`
                  :      ( `simple_arithmetic_expression` )
                  :      `functions_returning_numerics`
                  :      ( `subquery` )
string_primary: `state_field_path_expression`
              :      `input_parameter`
              :      `aggregate_expression`
datetime_expression: datetime_primary`  `input_parameter`
                :      `aggregate_expression`
boolean_expression: boolean_primary`  `boolean_literal`  ( `subquery` )
enum_primary: state_field_path_expression`  `input_parameter`
entity_expression: `single_valued_association_path_expression`  `input_parameter`
functions_returning_numerics: LENGTH ( `string_primary` )
                            :      ABS ( `simple_arithmetic_expression` )
                            :      MOD ( `simple_arithmetic_expression` , `simple_arithmetic_expression` )
                            :      CURRENT_TIME  SUBSTRING ( `string_primary` , `simple_arithmetic_expression` , `simple_arithmetic_expression` )
                           :      LOWER ( `string_primary` )
                           :      TRAILING | BOTH</p>
</blockquote>
<hr />
</div>
<div class="section"><a class="section-anchor" id="magic-finders" name="magic-finders"></a><h2 class="section-header"><a href="#magic-finders">Magic Finders<i class="fas fa-link"></i></a></h2>
<p>Doctrine offers some magic finders for your Doctrine models that allow
you to find a record by any column that is present in the model. This is
helpful for simply finding a user by their username, or finding a group
by the name of it. Normally this would require writing a
Doctrine_Query instance and storing this somewhere so it can be
reused. That is no longer needed for simple situations like that.</p>
<p>The basic pattern for the finder methods are as follows:
<code>findBy%s($value)</code> or <code>findOneBy%s($value)</code>. The <code>%s</code> can
be a column name or a relation alias. If you give a column name you must
give the value you are looking for. If you specify a relationship alias,
you can either pass an instance of the relation class to find, or give
the actual primary key value.</p>
<p>First lets retrieve the <code>UserTable</code> instance to work with:</p>
<pre><code class="">$userTable = Doctrine_Core::getTable(&#039;User&#039;);
</code></pre>
<p>Now we can easily find a <code>User</code> record by its primary key by using the
find method:</p>
<pre><code class="">$user = $userTable-&gt;find(1);
</code></pre>
<p>Now if you want to find a single user by their username you can use the
following magic finder:</p>
<pre><code class="">$user = $userTable-&gt;findOneByUsername(&#039;jonwage&#039;);
</code></pre>
<p>You can also easily find records by using the relationships between
records. Because <code>User</code> has many <code>Phonenumbers</code> we can find those
<code>Phonenumbers</code> by passing the findBy**` method a ``User`
instance:</p>
<pre><code class="">$phonenumberTable = Doctrine_Core::getTable(&#039;Phonenumber&#039;);
$phonenumbers = $phonenumberTable-&gt;findByUser($user);
</code></pre>
<p>The magic finders will even allow a little more complex finds. You can
use the <code>And</code> and <code>Or</code> keywords in the method name to retrieve
record by multiple properties.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>user = $userTable->findOneByUsernameAndPassword('jonwage', md5('changeme'));</code></pre></div>
<p>You can even mix the conditions.</p>
<div class="console"><pre><code class="console"><span class="noselect">$ </span>users = $userTable->findByIsAdminAndIsModeratorOrIsSuperAdmin(true, true, true);</code></pre></div>
<div class="alert caution-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-exclamation-triangle text-danger mr-2"></i></td><td><p>These are very limited magic finders and it is always
recommended to expand your queries to be manually written DQL
queries. These methods are meant for only quickly accessing single
records, no relationships, and are good for prototyping code
quickly.</p>
</td></tr></table></div>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The documented magic finders above are made possibly by
using PHP's `__call() &lt;<a href="http://us3.php.net/__call">http://us3.php.net/__call</a>&gt;`_ overloading
functionality. The undefined functions are forwarded to
Doctrine_Query objects
are built, executed and returned to the user.</p>
</td></tr></table></div>
<hr />
</div>
<div class="section"><a class="section-anchor" id="debugging-queries" name="debugging-queries"></a><h2 class="section-header"><a href="#debugging-queries">Debugging Queries<i class="fas fa-link"></i></a></h2>
<p>The Doctrine_Query object has a few functions that can be used to
help debug problems with the query:</p>
<p>Sometimes you may want to see the complete SQL string of your
Doctrine_Query object:</p>
<pre><code class="">$q = Doctrine_Query::create()
        -&gt;select(&#039;u.id&#039;)
        -&gt;from(&#039;User u&#039;)
        -&gt;orderBy(&#039;u.username&#039;);

echo $q-&gt;getSqlQuery();
</code></pre>
<p>The above call to getSqlQuery() would output the following SQL query:</p>
<pre class="code-block-table"><code class="sql"><button
            type="button"
            class="copy-to-clipboard"
            data-copy-element-id="275886fb6e9b77665375669d3e9ec34277b15892"
            title="Copy to Clipboard"
        ><i class="fas fa-copy"></i></button><div id="275886fb6e9b77665375669d3e9ec34277b15892"><table class="code-block-table"><tr><td class="line-number noselect"><a name="line-number-275886fb6e9b77665375669d3e9ec34277b15892-1" class="line-number-anchor" /><a href="#line-number-275886fb6e9b77665375669d3e9ec34277b15892-1">1</a></td><td class="code-line" rowspan="1"><span class="hljs-keyword">SELECT</span> u.id <span class="hljs-keyword">AS</span> u__id <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> u <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> u.username</td></tr></table></div></code></pre>
<div class="alert note-admonition bg-light-yellow text-dark border"><table width="100%"><tr><td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td><td><p>The SQL returned above by the Doctrine_Query::getSql
function does not replace the tokens with the parameters. This is
the job of PDO and when we execute the query we pass the parameters
to PDO where the replacement is executed. You can retrieve the array
of parameters with the Doctrine_Query::getParams method.</p>
</td></tr></table></div>
<p>Get the array of parameters for the Doctrine_Query instance:</p>
<pre><code class="">print_r($q-&gt;getParams());
</code></pre>
<hr />
</div>
<div class="section"><a class="section-anchor" id="conclusion" name="conclusion"></a><h2 class="section-header"><a href="#conclusion">Conclusion<i class="fas fa-link"></i></a></h2>
<p>The Doctrine Query Language is by far one of the most advanced and
helpful feature of Doctrine. It allows you to easily select very complex
data from RDBMS relationships efficiently!</p>
<p>Now that we have gone over most of the major components of Doctrine and
how to use them we are going to take a step back in the next chapter and
look at everything from a birds eye view in the <a href="component-overview.html">Component Overview</a> chapter.</p>

</div>

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                    <footer class="footer">
                <div class="container">
                    <ul class="list-inline">
                        <li class="list-inline-item"><a href="/projects.html">Projects</a></li>
                        <li class="list-inline-item"><a href="/partners.html">Partners</a></li>
                        <li class="list-inline-item"><a href="/sponsorship.html">Sponsorship</a></li>
                        <li class="list-inline-item"><a href="/community/index.html">Community</a></li>
                        <li class="list-inline-item"><a href="/blog/index.html">Blog</a></li>
                        <li class="list-inline-item"><a href="/events.html">Events</a></li>
                        <li class="list-inline-item"><a href="/consulting.html">Consulting</a></li>
                    </ul>
                </div>
            </footer>
        
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://www.doctrine-project.org/frontend/js/bundle.js?5b3818"
                            integrity="sha384-fyrn6RNWHQbvjdZgboYZiPqKrNVycvMxvrO82FIf25RgB+5BeS7O7XJQuvJOJH3O"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'doctrine1';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search Doctrine1 master'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                ga('send', 'event', eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
            </body>
</html>
